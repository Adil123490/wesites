"use strict";!function(){window.Messenger=function(){function e(e,t,a){var i="";if(2>arguments.length?i="target error - target and name are both required":"object"!=typeof e?i="target error - target itself must be window object":"string"!=typeof t&&(i="target error - target name must be string type"),i)throw Error(i);this.target=e,this.name=t,this.prefix=a}function t(e,t){this.targets={},this.name=e,this.listenFunc=[],this.prefix=t||"[PROJECT_NAME]",this.initListen()}var a="postMessage"in window;return e.prototype.send=a?function(e){this.target.postMessage(this.prefix+"|"+this.name+"__Messenger__"+e,"*")}:function(e){var t=window.navigator[this.prefix+this.name];if("function"!=typeof t)throw Error("target callback function is not defined");t(this.prefix+e,window)},t.prototype.addTarget=function(t,a){var i=new e(t,a,this.prefix);this.targets[a]=i},t.prototype.initListen=function(){var e=this,t=function(t){"object"==typeof t&&t.data&&(t=t.data);var a=t.split("__Messenger__");t=a[1];for(var i=a[0].split("|"),a=i[0],i=i[1],n=0;n<e.listenFunc.length;n++)a+i===e.prefix+e.name&&e.listenFunc[n](t)};a?"addEventListener"in document?window.addEventListener("message",t,!1):"attachEvent"in document&&window.attachEvent("onmessage",t):window.navigator[this.prefix+this.name]=t},t.prototype.listen=function(e){for(var t=0,a=this.listenFunc.length,i=!1;a>t;t++)if(this.listenFunc[t]==e){i=!0;break}i||this.listenFunc.push(e)},t.prototype.clear=function(){this.listenFunc=[]},t.prototype.send=function(e){alert(e);var t,a=this.targets;for(t in a)a.hasOwnProperty(t)&&a[t].send(e)},t}()}(),function(){window.env={};var e=window.location.host;e.indexOf("home.dev.weimob.com")>-1?(window.env.development=!0,window.env.cookieName="weimobAuthData_dev",window.env.prefix="http://www.dev.weimob.com",window.env.loginout="http://www.dev.weimob.com/website/login.html"):e.indexOf("home.weimob.com")>-1?(window.env.production=!0,window.env.cookieName="weimobAuthData",window.env.prefix="http://www.weimob.com",window.env.loginout="http://www.weimob.com/website/login.html"):e.indexOf("home.pl.weimob.com")>-1?(window.env.pl=!0,window.env.cookieName="weimobAuthData",window.env.prefix="http://www.pl.weimob.com",window.env.loginout="http://www.pl.weimob.com/website/login.html"):e.indexOf("home.ppl.weimob.com")>-1?(window.env.ppl=!0,window.env.cookieName="weimobAuthData",window.env.prefix="http://www.ppl.weimob.com",window.env.loginout="http://www.ppl.weimob.com/website/login.html"):(window.env.localhost=!0,window.env.cookieName="weimobAuthData_local",window.env.prefix="http://www.dev.weimob.com",window.env.loginout="http://www.dev.weimob.com/website/login.html"),window.online="localhost"!=window.env,window.hideMenu={name:"页面跳转链接",status:1,item:[{name:"手动绑定",id:"manualbinding",url:window.env.prefix+"/plcaccount/add"},{name:"未认证商户",id:"unauthorized",url:window.env.prefix+"/shrz/attestation/indexPage/"},{name:"账户类型",id:"menuset",url:window.env.prefix+"/wechat/menuset/"},{name:"编辑公众号",id:"editaccount",url:window.env.prefix+"/plcaccount/add/"},{name:"修改密码",id:"modifypwd",url:window.env.prefix+"/wechat/modifypwd"},{name:"商户信息",id:"userInfo1",url:window.env.prefix+"/wechat/user"},{name:"账户信息",id:"plcaccountInfo",url:window.env.prefix+"/wechat/home"},{name:"退出",id:"logout",url:window.env.prefix+"/login/logout"},{name:"通知详情",id:"notices",url:window.env.prefix+"/wechat/Newdetail"},{name:"通知列表",id:"noticeslist",url:window.env.prefix+"/wechat/Newlist"},{name:"日历",id:"EventCalendar",url:window.env.prefix+"/wechat/EventCalendar"}]}}(),function(){!window.env.localhost}(),angular.module("ngTicket",["ngAnimate","ngCookies","ngTouch","ngSanitize","restangular","ui.router","ng-nestable","ui.bootstrap","ui.checkbox","ngStorage","ngTable","daterangepicker","toaster","ui.select","ui.bootstrap.datetimepicker","ui.bootstrap.tabs","ngFileUpload","ipCookie","dialogs.main","btford.socket-io","highcharts-ng"]),angular.module("ngTicket").directive("vipRelatedServiceCtrl",["$rootScope","vipCardBusinessServer","tableHelp","$config","$timeout",function(e,t,a,i){return{restrict:"AE",scope:{ngModel:"="},templateUrl:"/app/vip/components/relatedService/related.service.html",link:function(n){n.curService={},n.entity=n.ngModel,t.getRelatedServiceList().then(function(e){if(e.data){if(n.relatedServices=e.data,!n.entity.BusinessType)return;angular.forEach(n.relatedServices,function(e){e.type===n.entity.BusinessType&&(n.curService=e)})}},function(){}),n.mapId="vipRelatedServiceCtrl",n.onSearchMap=function(){e.safeApply(function(){n.entity.AddressObj.search()})},n.onAddressChanged=function(e){n.entity.Address=e.Address,n.entity.Longitude=e.Longitude,n.entity.Latitude=e.Latitude},n.onSelectType=function(e){n.entity.BusinessType=e.type,n.entity.SubType=null};var s=function(e){return e&&e[0]?(n.entity.SId&&angular.forEach(e[0].items,function(e){e.sid==n.entity.SId&&(e.checked=e.sid)}),e[0].items||[]):[]},o=a(n,{getData:s});n.tableParams=o.tableParams(i.api3.card.getRelatedServiceId,function(){var t={aid:e.accountBaseInfo.aid,bid:e.accountBaseInfo.bid,type:n.curService.type,subtype:n.entity.SubType};return t}),n.onSelectSubType=function(){e.safeApply(function(){("tw"===n.curService.type||"activity"===n.curService.type||"business"===n.curService.type||"life"===n.curService.type)&&n.entity.SubType&&(n.tableParams.page(1),n.tableParams.reload())})},n.onSelectSid=function(e){n.entity.SId=e}}}}]),angular.module("ngTicket").directive("vipMerchantCtrl",["$rootScope","$toaster","$locale",function(){return{restrict:"AE",scope:{ngModel:"="},templateUrl:"/app/vip/components/merchant/merchant.html",link:function(e){e.merchants=[],e.childMerchants=[];var t=function(){var t="美食-1$本帮江浙菜-11,川菜-12,粤菜-13,湘菜-14,贵州菜-15,东北菜-16,台湾菜-17,新疆/清真菜-18,西北菜-19,素菜-20,火锅-21,自助餐-22,小吃快餐-23,日本-24,韩国料理-25,东南亚菜-26,西餐-27,面包甜点-28,其他-29#休闲娱乐-2$密室-30,咖啡厅-31,酒吧-32,茶馆-33,KTV-34,电影院-35,文化艺术-36,景点/郊游-37,公园-38,足疗按摩-39,洗浴-40,游乐游艺-41,桌球-42,桌面游戏-43,DIY手工坊-44,其他-45#购物-3$综合商场-46,食品茶酒-47,服饰鞋包-48,珠宝饰品-49,化妆品-50,运动户外-51,亲子购物-52,品牌折扣店-53,数码家电-54,家居建材-55,特色集市-56,书店-57,花店-58,眼镜店-59,超市/便利店-60,药店-61,其他-62#丽人-4$美发-63,美容/SPA-64,化妆品-65,瘦身纤体-66,美甲-67,瑜伽-68,舞蹈-69,个性写真-70,整形-71,齿科-72,其他-73#结婚-5$婚纱摄影-74,婚宴-75,婚戒首饰-76,婚纱礼服-77,婚庆公司-78,彩妆造型-79,司仪主持-80,婚礼跟拍-81,婚车租赁-82,婚礼小商品-83,婚房装修-84,其他-85#亲子-6$幼儿教育-86,亲子摄影-87,亲子游乐-88,亲子购物-89,孕产护理-90,其他-91#运动健身-7$游泳馆-92,羽毛球馆-93,健身中心-94,瑜伽-95,舞蹈-96,篮球场-97,网球场-98,足球场-99,高尔夫场-100,保龄球馆-101,桌球馆-102,乒乓球馆-103,武术场馆-104,体育场馆-105,其他-106#酒店-8$五星级酒店-107,四星级酒店-108,三星级酒店-109,经济型酒店-110,公寓式酒店-111,精品酒店-112,青年旅舍-113,度假村-114,其他-115#爱车-9$4S店/汽车销售-116,汽车保险-117,维修保养-118,配件/车饰-119,驾校-120,汽车租赁-121,停车场-122,加油站-123,其他-124#生活服务-10$旅行社-125,培训-126,室内装潢-127,宠物-128,齿科-129,快照/冲印-130,家政-131,银行-132,学校-133,团购网站-134,其他-135",a=t.split("#");angular.forEach(a,function(t){var a=t.split("$"),i=a[0].split("-"),n=a[1].split(","),s={title:i[0],val:+i[1],children:[]};angular.forEach(n,function(e){var t=e.split("-");s.children.push({title:t[0],val:+t[1]})}),e.merchants.push(s)})};t(),e.onSelect=function(t){for(var a=0;a<e.merchants.length;++a)if(e.merchants[a].val==t){e.childMerchants=e.merchants[a].children;break}},e.ngModel.MerchantType&&e.onSelect(e.ngModel.MerchantType)}}}]),angular.module("ngTicket").directive("vipLabelCtrl",["$rootScope","vipManageServer",function(e,t){return{restrict:"AE",scope:{ngModel:"=",delTag:"&?"},templateUrl:"/app/vip/components/label/label.html",link:function(e){e.del=function(){e.delTag&&e.delTag({id:e.ngModel.Id})},e.onCreateLabel=function(){t.createLabelDialog(e.ngModel).result.then(function(t){e.ngModel.Name=t.Name},function(){})}}}}]),angular.module("ngTicket").directive("vipGiveTypeCtrl",["$rootScope","vipManageServer","$timeout",function(e,t){return{restrict:"AE",replace:!0,scope:{ngModel:"=",isActivation:"=?"},templateUrl:"/app/vip/components/giveType/give.type.html",link:function(a){a.entity=a.ngModel,a.isActivation&&(a.entity.GiveValue=a.entity.Value,a.entity.GiveType=a.entity.Type),a.selectCoupons=[],a.onAddCoupon=function(){a.selectCoupons.push({couponType:-1,Value:""})},a.onDelCoupon=function(){a.selectCoupons.pop()},t.GetCouponTemplatePageListAndTotal({AId:e.accountBaseInfo.aid,IsEffective:!0,IsOnlyEffective:!0,PageIndex:1,PageSize:100}).then(function(e){if(e.data&&(a.coupons={0:[],1:[],all:e.data.Items},angular.forEach(e.data.Items,function(e){0==e.CouponType?a.coupons[0].push(e):1==e.CouponType&&a.coupons[1].push(e)})),a.entity["GiveValue"+a.entity.GiveType]=a.entity.GiveValue,2==a.entity.GiveType){var t=[];a.entity.GiveValue&&(t=JSON.parse(a.entity.GiveValue)),angular.forEach(t,function(e){angular.forEach(a.coupons.all,function(t){t.Id==e&&a.selectCoupons.push({couponType:t.CouponType,Value:e})})})}a.selectCoupons.length<1&&a.selectCoupons.push({couponType:-1,Value:""}),a.onGiveValue()},function(){}),a.onGiveValue=function(){a.entity.GiveValue=a.entity["GiveValue"+a.entity.GiveType],2==a.entity.GiveType&&(a.entity.GiveValue2Selected=[],angular.forEach(a.selectCoupons,function(e){e.Value&&a.entity.GiveValue2Selected.push(e.Value)}),a.entity.GiveValue=JSON.stringify(a.entity.GiveValue2Selected)),a.isActivation&&(a.entity.Value=a.entity.GiveValue,a.entity.Type=a.entity.GiveType)},a.entity.CalcGiveValue=a.onGiveValue}}}]),angular.module("ngTicket").directive("vipCardCtrl",["$rootScope","vipManageServer",function(e,t){return{restrict:"AE",scope:{ngModel:"="},templateUrl:"/app/vip/components/card/card.html",link:function(a){a.entity=a.ngModel,t.Spoutlet({aid:e.accountBaseInfo.aid,bid:e.accountBaseInfo.bid}).then(function(e){e.data&&(a.stores=e.data)},function(){})}}}]),angular.module("ngTicket").factory("vipCardPrivilegeServer",["$httpApi","$config","$dialogs","$tableids",function(e,t){return{SaveMemberCardPrivilegeNote:function(a){return e.postJson2(t.apiVip.card.SaveMemberCardPrivilegeNote,a)},DeletePrivilegeNote:function(a){return e.postJson2(t.apiVip.card.DeletePrivilegeNote,a)},GetMemberCardPrivilegeNote:function(a){return e.postJson2(t.apiVip.card.GetMemberCardPrivilegeNote,a)}}}]),angular.module("ngTicket").controller("vipCardPrivilegeCtrl",["$scope","$rootScope","vipCardPrivilegeServer","$toaster","tableHelp","$config",function(e,t,a,i,n,s){var o=n(e,{vip:!0});e.tableParams=o.tableParams(s.apiVip.card.GetMemberCardPrivilegeNotePageListAndTotal,function(){var e={AId:t.accountBaseInfo.aid};return e}),e.delPrivilege=function(i){a.DeletePrivilegeNote({AId:t.accountBaseInfo.aid,Id:i}).then(function(){e.tableParams.reload()},function(){})},e.getState=function(e){var t=new Date(1e3*e.StartTime).getTime(),a=new Date(1e3*e.EndTime).getTime(),i=(new Date).getTime();return t>i?"未开始":a>i?"进行中":"已结束"},t.navPath="特权设置",e.$on("$destroy",function(){t.navPath=""})}]).controller("vipCardAddPrivilegeCtrl",["$scope","$rootScope","$state","$stateParams","vipCardPrivilegeServer","vipCardLevelServer","$toaster","$filter",function(e,t,a,i,n,s,o,l){e.entity={AId:t.accountBaseInfo.aid,MemberType:0},e.time={time:{}},i.id?(t.navPath="编辑特权设置",e.loading=!0,n.GetMemberCardPrivilegeNote({AId:t.accountBaseInfo.aid,Id:i.id}).then(function(t){e.loading=!1,t.data&&(t.data.StartTime&&(e.time.time.startDate=l("date")(1e3*t.data.StartTime,"yyyy-MM-dd HH:mm")),t.data.EndTime&&(e.time.time.endDate=l("date")(1e3*t.data.EndTime,"yyyy-MM-dd HH:mm")),e.entity=t.data)},function(){e.loading=!1})):t.navPath="添加特权设置",s.GetMemberCardLevelSet(e.entity).then(function(t){t.data&&(e.levels=t.data.ListDetail),e.levels.unshift({LevelNo:0,LevelName:"所有会员"})},function(){}),e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.entity.StartTime=Math.round(new Date(moment(e.time.time.startDate).format("YYYY-MM-DD")+" 00:00:00").getTime()/1e3),e.entity.EndTime=Math.round(new Date(moment(e.time.time.endDate).format("YYYY-MM-DD")+" 23:59:59").getTime()/1e3),e.saveloading=!0,n.SaveMemberCardPrivilegeNote(e.entity).then(function(){e.saveloading=!1,a.go("app.vip.card.privilege")},function(){e.saveloading=!1})})}},e.$on("$destroy",function(){t.navPath=""})}]),angular.module("ngTicket").factory("vipCardManageServer",["$httpApi","$config","$dialogs","$tableids",function(e,t,a){return{addMemberInfoDialog:function(e){return a.create("/app/vip/card/manage/addMemberInfo.dialog.html","addMemberInfoDialogCtrl",e)},GetMemberTemplate:function(a){return e.postJson2(t.apiVip.card.GetMemberTemplate,a)},GetMoveOldMemberCard:function(a){return e.postJson2(t.apiVip.card.GetMoveOldMemberCard,a)},IsHaveOldMemberCard:function(a){return e.postJson2(t.apiVip.card.IsHaveOldMemberCard,a)},MoveOldMemberCard:function(a){return e.postJson2(t.apiVip.card.MoveOldMemberCard,a)},SaveMemberTemplate:function(a,i){var n=t.apiVip.card.UpdateMemberTemplate;return i&&(n=t.apiVip.card.CreateMemberTemplate),e.postJson2(n,a)},getActivity:function(a){return e.post(t.api3.admin.getActivity,a)},OpenSyncToWX:function(a){return e.postJson2(t.apiVip.card.OpenSyncToWX,a)},moveMemberDialog:function(e){return a.create("/app/vip/card/manage/moveMember.dialog.html","moveMemberDialogCtrl",e)}}}]),angular.module("ngTicket").controller("vipCardManageCtrl",["$scope","$rootScope","vipCardManageServer","$state",function(e,t,a,i){e.curIndex=0,e.getSlideStyle=function(){return{transform:"translateX("+225*e.curIndex+"px)",transition:"transform .5s linear 0s"}},e.moveSlide=function(t){e.curIndex+t>0||e.curIndex+t<-2||(e.curIndex+=t)},e.onOpenSync=function(){a.OpenSyncToWX({AId:t.accountBaseInfo.aid}).then(function(){i.reload()},function(){})},e.loading=!0,t.$watch("vipType",function(i){i>-1&&(e.loading=!1),i>0||a.GetMoveOldMemberCard({UId:t.accountBaseInfo.bid,AId:t.accountBaseInfo.aid}).then(function(i){return i?1==i.data?(e.isMoving=!0,e.loading=!1):void a.IsHaveOldMemberCard({UId:t.accountBaseInfo.bid,AId:t.accountBaseInfo.aid}).then(function(t){t&&t.data&&(e.hasOldMember=!0),e.loading=!1},function(){e.loading=!1}):e.loading=!1},function(){})}),e.onCreateMemberCard=function(){return e.hasOldMember?void a.moveMemberDialog().result.then(function(n){2==n?i.go("app.vip.card.create"):1==n&&(e.isMoving=!0,a.MoveOldMemberCard({UId:t.accountBaseInfo.bid,AId:t.accountBaseInfo.aid}).then(function(){},function(){}))}):i.go("app.vip.card.create")},t.navPath="会员卡管理",e.$on("$destroy",function(){t.navPath=""})}]).controller("vipCardCreateCtrl",["$scope","$rootScope","vipCardManageServer","$toaster","$stateParams","$filter","$locale","$state","$dialogs",function(e,t,a,i,n,s,o,l){t.navPath="创建会员卡",e.isEdit=n.edit,e.isEdit&&(t.navPath="编辑会员卡"),e.curStep=1,e.entity={AId:+t.accountBaseInfo.aid,Colour:0,Address:{MapType:0},business:[],IsSyncWX:!1,bkType:0,CardNoType:0,ExpireDateType:0,CanUseTimeType:0,CodeType:0,WordsColour:"#fff",enableDate:{}},e.bks=[];for(var r=1;10>r;++r)e.bks.push({title:"0"+r,value:r});for(var r=10;24>r;++r)e.bks.push({title:""+r,value:r});e.onSearchMap=function(){e.safeApply(function(){e.entity.Address.search()})},e.canUseTimes=[{title:"周一",val:1,check:!1},{title:"周二",val:2,check:!1},{title:"周三",val:3,check:!1},{title:"周四",val:4,check:!1},{title:"周五",val:5,check:!1},{title:"周六",val:6,check:!1},{title:"周日",val:0,check:!1}],e.MerchantService=[{title:"免费WIFI",check:!1},{title:"可带宠物",check:!1},{title:"免费停车",check:!1},{title:"可外卖",check:!1}],e.onAddressSelected=function(t){t&&(e.entity.Address.Address=t.province_name+t.city_name+t.district_name,e.entity.Address.search())},e.entity.MemberInfoTemplate=[{Name:"手机号",Display:!0,Must:!0,Modify:!0},{Name:"姓名",Display:!0,Must:!0,Modify:!1},{Name:"性别",Display:!1,Must:!1,Modify:!1},{Name:"生日",Display:!1,Must:!1,Modify:!1},{Name:"邮箱",Display:!1,Must:!1,Modify:!1},{Name:"详细地址",Display:!1,Must:!1,Modify:!1},{Name:"学历",Display:!1,Must:!1,Modify:!1},{Name:"行业",Display:!1,Must:!1,Modify:!1},{Name:"收入",Display:!1,Must:!1,Modify:!1},{Name:"爱好",Display:!1,Must:!1,Modify:!1}],e.setTemplateValue=function(e,t,a){"手机号"!==e.Name&&(e[t]=a)},e.onChangeDisplay=function(e){e.Display||(e.Must=!1,e.Modify=!1)},e.canAddMemberInfo=function(){var t=0;return angular.forEach(e.entity.MemberInfoTemplate,function(e){e.IsCustom&&++t}),3>t},e.addMemberInfo=function(t,i){a.addMemberInfoDialog(t).result.then(function(a){t?e.entity.MemberInfoTemplate.splice(i,1,a):e.entity.MemberInfoTemplate.push(a)})},e.delMemberInfo=function(t,a){e.entity.MemberInfoTemplate.splice(a,1)},e.isEdit&&(e.loading=!0,a.GetMemberTemplate({UId:t.accountBaseInfo.bid,AId:t.accountBaseInfo.aid}).then(function(a){if(e.loading=!1,a&&a.data){if(e.entity=a.data,e.entity.AId=+t.accountBaseInfo.aid,e.entity.BackGroundId?(e.entity.bkType=0,e.entity.BackGroundUrl=""):e.entity.bkType=1,e.entity.enableDate||(e.entity.enableDate={}),a.data.StartDate&&(e.entity.enableDate.startDate=s("date")(1e3*a.data.StartDate,"yyyy-MM-dd")+" 00:00:00"),a.data.ExpireDate&&(e.entity.enableDate.endDate=s("date")(1e3*a.data.ExpireDate,"yyyy-MM-dd")+" 23:59:59"),e.entity.Address={province_name:e.entity.Address.ProvinceName,province:e.entity.Address.ProvinceId,city_name:e.entity.Address.CityName,city:e.entity.Address.CityId,district_name:e.entity.Address.DistrictName,district:e.entity.Address.DistrictId,Address:e.entity.Address.Address,MapType:e.entity.Address.MapType,Longitude:e.entity.Address.Longitude,Latitude:e.entity.Address.Latitude},1==a.data.CanUseTimeType)for(var i=0;7>i;++i)angular.forEach(a.data.CanUseTime,function(t){t==e.canUseTimes[i].val&&(e.canUseTimes[i].check=!0)});angular.forEach(e.MerchantService,function(e){angular.forEach(a.data.MerchantService,function(t){e.title==t&&(e.check=!0)})})}},function(){e.loading=!1})),e.eventformvalidate={submitHandler:function(){e.$apply(function(){var t=angular.copy(e.entity);if(0==e.entity.bkType)t.BackGroundId=+t.BackGroundId,t.BackGroundUrl="http://stc.weimob.com/img/web_bb/card/cardbg/card_bg"+t.BackGroundId+".png";else{if(1!=e.entity.bkType||!t.BackGroundUrl)return void i.error("请选择会员卡背景");t.BackGroundId=0}if(!t.WordsColour)return void i.error("请填写卡面字体颜色");if(2==t.CardNoType){if(!t.CardNoBefore&&!t.CardNoEnd)return void i.error("会员卡号前缀或后缀不能同时为空")}else if(angular.isUndefined(t.CardNoType))return void i.error("请填写会员卡号");if(0==t.ExpireDateType);else if(1==t.ExpireDateType){if(!t.enableDate.startDate||!t.enableDate.endDate)return void i.error("请填写有效期");t.StartDate=Math.round(new Date(t.enableDate.startDate).getTime()/1e3),t.ExpireDate=Math.round(new Date(t.enableDate.endDate).getTime()/1e3)}else{if(2!=t.ExpireDateType)return void i.error("请填写有效期");if(!t.ExpDayCount)return void i.error("请填写有效期");t.ExpDayCount=+t.ExpDayCount}if(1==t.CanUseTimeType){t.CanUseTime=[];for(var n=0;7>n;++n)e.canUseTimes[n].check&&t.CanUseTime.push(n);if(!t.CanUseTime.length)return void i.error("请填写可用时段")}return t.MerchantService=[],angular.forEach(e.MerchantService,function(e){e.check&&t.MerchantService.push(e.title)}),t.MerchantType&&(t.MerchantType=Number(t.MerchantType)),t.MerchantSubType&&(t.MerchantSubType=Number(t.MerchantSubType)),1==e.curStep?(e.curStep=2,void $(".scrollable.wrapper").scrollTop(0)):(t.ActivationType=+t.ActivationType,t.IsNeedMessage=+t.IsNeedMessage,t.CanBindEntityCard=+t.CanBindEntityCard,t.CodeType=+t.CodeType,t.MemberCardType=+t.MemberCardType,t.GiftCanSendToPhone=+t.GiftCanSendToPhone,t.Address={ProvinceName:t.Address.province_name,ProvinceId:t.Address.province,CityName:t.Address.city_name,CityId:t.Address.city,DistrictName:t.Address.district_name,DistrictId:t.Address.district,Address:t.Address.Address,MapType:t.Address.MapType,Longitude:t.Address.Longitude,Latitude:t.Address.Latitude},t.CanRechargeByPhone=t.CanRechargeByPhone?1:0,t.RechargeSendMessage=t.RechargeSendMessage?1:0,t.CanConsumeByPhone=t.CanConsumeByPhone?1:0,t.ConsumeSendMessage=t.ConsumeSendMessage?1:0,t.IsNeedMessage=1,t.CanBindEntityCard=1,t.MemberCardType=1,t.GiftCanSendToPhone=1,t.ActivationType=1,e.saveloading=!0,void a.SaveMemberTemplate(t,!e.isEdit).then(function(){e.saveloading=!1,l.go("app.vip.card.manage")},function(){e.saveloading=!1}))})}},e.last=function(){e.curStep=1},e.$on("$destroy",function(){t.navPath=""})}]).controller("vipCardUseCtrl",["$scope","$rootScope","vipCardManageServer","$toaster","$stateParams",function(e,t,a,i){t.navPath="开启会员卡",e.entity={color:"",Address:{MapType:0},business:[],AId:t.accountBaseInfo.aid},e.canUseTimes=[{title:"周一",val:1,check:!1},{title:"周二",val:2,check:!1},{title:"周三",val:3,check:!1},{title:"周四",val:4,check:!1},{title:"周五",val:5,check:!1},{title:"周六",val:6,check:!1},{title:"周日",val:0,check:!1}],e.loading=!0,a.GetMemberTemplate({UId:t.accountBaseInfo.bid,AId:t.accountBaseInfo.aid}).then(function(a){if(e.loading=!1,a&&a.data){if(e.entity=a.data,e.entity.AId=+t.accountBaseInfo.aid,e.entity.BackGroundId?(e.entity.bkType=0,e.entity.BackGroundUrl=""):e.entity.bkType=1,e.entity.enableDate||(e.entity.enableDate={}),a.data.StartDate&&(e.entity.enableDate.startDate=$filter("date")(a.data.StartDate,"yyyy-MM-dd")+" 00:00:00"),a.data.ExpireDate&&(e.entity.enableDate.endDate=$filter("date")(a.data.ExpireDate,"yyyy-MM-dd")+" 23:59:59"),e.entity.Address={province_name:e.entity.Address.ProvinceName,province:e.entity.Address.ProvinceId,city_name:e.entity.Address.CityName,city:e.entity.Address.CityId,district_name:e.entity.Address.DistrictName,district:e.entity.Address.DistrictId,Address:e.entity.Address.Address,MapType:e.entity.Address.MapType,Longitude:e.entity.Address.Longitude,Latitude:e.entity.Address.Latitude},1==a.data.CanUseTimeType)for(var i=0;7>i;++i)angular.forEach(a.data.CanUseTime,function(t){t==e.canUseTimes[i].val&&(e.canUseTimes[i].check=!0)});angular.forEach(e.MerchantService,function(e){angular.forEach(a.data.MerchantService,function(t){e.title==t&&(e.check=!0)})})}},function(){e.loading=!1}),e.eventformvalidate={submitHandler:function(){e.$apply(function(){var t=angular.copy(e.entity);if(0==t.ExpireDateType);else if(1==t.ExpireDateType){if(!t.enableDate.startDate||!t.enableDate.endDate)return void i.error("请填写有效期");t.StartDate=Math.round(new Date(t.enableDate.startDate).getTime()/1e3),t.ExpireDate=Math.round(new Date(t.enableDate.endDate).getTime()/1e3)}else{if(2!=t.ExpireDateType)return void i.error("请填写有效期");if(!t.ExpDayCount)return void i.error("请填写有效期");t.ExpDayCount=+t.ExpDayCount}if(1==t.CanUseTimeType){t.CanUseTime=[];for(var n=0;7>n;++n)e.canUseTimes[n].check&&t.CanUseTime.push(n);if(!t.CanUseTime.length)return void i.error("请填写可用时段")}e.saveloading=!0,a.SaveMemberTemplate(t).then(function(){i.success($locale.FORMTIPS.saveSuccess),e.saveloading=!1},function(){e.saveloading=!1})})}},e.$on("$destroy",function(){t.navPath=""})}]).controller("addMemberInfoDialogCtrl",["$scope","$modalInstance","$toaster","data","vipCardManageServer","$locale",function(e,t,a,i){e.cancel=function(){t.dismiss("Canceled")},i&&i.Name&&(e.isEdit=!0),e.entity=i||{},e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.entity.Values=[],e.entity.strValue&&(e.entity.Values=e.entity.strValue.split("|")),e.entity.IsCustom=!0,t.close(e.entity)})}}}]).controller("moveMemberDialogCtrl",["$scope","$modalInstance","data",function(e,t){e.cancel=function(){t.dismiss("Canceled")},e.onMove=function(e){t.close(e)}}]).filter("ActivationType",function(){return function(e){return 1==e?"需填写会员信息":"自动激活"}}),angular.module("ngTicket").factory("vipCardLevelServer",["$httpApi","$config","$dialogs","$tableids",function(e,t){return{SaveMemberCardLeveSet:function(a){return e.postJson2(t.apiVip.card.SaveMemberCardLeveSet,a)},GetMemberCardLevelSet:function(a){return e.postJson2(t.apiVip.card.GetMemberCardLevelSet,a)},ExportMemberInfoList:function(a){return e.postJson2(t.apiVip.card.ExportMemberInfoList,a)},GetLastMemberExportLog:function(a){return e.postJson2(t.apiVip.card.GetLastMemberExportLog,a)}}}]),angular.module("ngTicket").controller("vipCardLevelCtrl",["$scope","$rootScope","vipCardLevelServer","$toaster","$locale",function(e,t,a,i,n){e.entity={ListDetail:[{AId:t.accountBaseInfo.aid,LevelMin:0}],AId:t.accountBaseInfo.aid,LevelType:0,LevelClearType:0},e.loading=!0,a.GetMemberCardLevelSet(e.entity).then(function(a){a.data&&(e.entity=a.data),e.entity.ListDetail||(e.entity.ListDetail=[{AId:t.accountBaseInfo.aid,LevelMin:0}]),e.loading=!1},function(){e.loading=!1}),e.addLevel=function(){e.entity.ListDetail.length>1&&!e.entity.ListDetail[e.entity.ListDetail.length-1].LevelMin||(e.entity.ListDetail.length&&e.entity.ListDetail[e.entity.ListDetail.length-1]&&delete e.entity.ListDetail[e.entity.ListDetail.length-1].LevelMax,e.entity.ListDetail.push({AId:t.accountBaseInfo.aid}))},e.delLevel=function(){e.entity.ListDetail.pop(),e.entity.ListDetail.length&&e.entity.ListDetail[e.entity.ListDetail.length-1]&&(e.entity.ListDetail[e.entity.ListDetail.length-1].LevelMax=100000002)},e.eventformvalidate={submitHandler:function(){e.$apply(function(){angular.forEach(e.entity.ListDetail,function(e,t){e.LevelNo=t+1,e.LevelMin||(e.LevelMin=0)}),e.saveloading=!0,a.SaveMemberCardLeveSet(e.entity).then(function(){i.success(n.FORMTIPS.saveSuccess),e.saveloading=!1},function(){e.saveloading=!1})})}},e.getMinNum=function(t){return 0==t?0:e.entity.ListDetail[t].LevelMin+1},e.getMaxNum=function(t){return t>=e.entity.ListDetail.length-2?1e8:e.entity.ListDetail[t+1].LevelMax-2},e.calcMin=function(t){e.entity.ListDetail[t+1].LevelMin=+e.entity.ListDetail[t].LevelMax+1},t.navPath="等级设置",e.$on("$destroy",function(){t.navPath=""})}]),angular.module("ngTicket").factory("vipCardInfoServer",["$httpApi","$config","$dialogs","$tableids",function(e,t){return{GetAddMemberStatistics:function(a){return e.postJson2(t.apiVip.card.GetAddMemberStatistics,a)}}}]),angular.module("ngTicket").controller("vipCardInfoCtrl",["$scope","$rootScope","vipCardInfoServer","$timeout","ticketCharts",function(e,t,a,i,n){var s=new Date;e.years=[],e.months=[];for(var o=0;12>o;++o)e.years.unshift({val:s.getFullYear()-o,text:s.getFullYear()-o+"年"}),e.months.push({val:o+1,text:o+1+"月"});e.searchParams={year:s.getFullYear(),month:s.getMonth()+1},e.query=function(){e.total=0;var s={AId:t.accountBaseInfo.aid,PageIndex:1,PageSize:50};s.BeginTime=parseInt(new Date(e.searchParams.year,e.searchParams.month-1,1).getTime()/1e3),s.EndTime=parseInt(new Date(e.searchParams.year,e.searchParams.month,0,23,59,59).getTime()/1e3),a.GetAddMemberStatistics(s).then(function(t){if(t.data){var a=[];angular.forEach(t.data.Items,function(t){e.total+=t.AddCount;var i=n.getDateNum(1e3*t.StatisticsDate);a.push([i,t.AddCount])}),a=n.getLineMonthData(e.searchParams.year,e.searchParams.month,a),e.chartLoaded=!0,i(function(){n.line("chart1",[{data:a,name:"新增会员"}])})}},function(){})},e.query(),t.navPath="会员卡数据",e.$on("$destroy",function(){t.navPath=""})}]),angular.module("ngTicket").factory("vipCardEntryServer",["$httpApi","$config","$dialogs","$tableids",function(e,t){return{GetMemberCardSet:function(a){return e.postJson2(t.apiVip.card.GetMemberCardSet,a)},SaveMemberCardSet:function(a){return e.postJson2(t.apiVip.card.SaveMemberCardSet,a)},GetMemberCardUrlInfo:function(a){return e.postJson2(t.apiVip.card.GetMemberCardUrlInfo,a)}}}]),angular.module("ngTicket").controller("vipCardEntryCtrl",["$scope","$rootScope","vipCardEntryServer","$toaster","$locale",function(e,t,a,i,n){e.entity={AId:t.accountBaseInfo.aid,ShareLogoUrl:"/assets/images/memberShare.png"},e.loading=!0,a.GetMemberCardSet({AId:t.accountBaseInfo.aid}).then(function(i){i.data&&(e.entity=i.data),a.GetMemberCardUrlInfo({AId:t.accountBaseInfo.aid}).then(function(t){t.data?(e.urlInfo=t.data,e.urlInfo.couponListUrl=e.urlInfo.CardUrl+"/couponlist",e.urlInfo.signUrl=e.urlInfo.CardUrl+"/sign",e.urlInfo.exchangeUrl=e.urlInfo.CardUrl+"/exchange"):e.urlInfo={},e.entity.ShareLogoUrl||(e.entity.ShareLogoUrl="/assets/images/memberShare.png"),e.shareLogoUrl=e.entity.ShareLogoUrl,e.loading=!1},function(){e.loading=!1})},function(){e.loading=!1}),e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.entity.ShareLogoUrl||i.error("请上传分享图标"),e.saveloading=!0,a.SaveMemberCardSet(e.entity).then(function(){i.success(n.FORMTIPS.saveSuccess),e.saveloading=!1},function(){e.saveloading=!1})})}},t.navPath="入口设置",e.$on("$destroy",function(){t.navPath=""})}]),angular.module("ngTicket").factory("vipCardBusinessServer",["$httpApi","$config","$dialogs",function(e,t,a){return{addBusinessDialog:function(e){return a.create("/app/vip/card/business/addBusiness.dialog.html","addBusinessDialogCtrl",e)},getRelatedServiceList:function(a){return e.get(t.api3.card.getRelatedServiceList,a)},GetOtherBusiness:function(a){return e.postJson2(t.apiVip.card.GetOtherBusiness,a)},SaveOhterBusiness:function(a){return e.postJson2(t.apiVip.card.SaveOhterBusiness,a)},DeleteOtherBusiness:function(a){return e.postJson2(t.apiVip.card.DeleteOtherBusiness,a)}}}]),angular.module("ngTicket").controller("vipCardBusinessCtrl",["$scope","$rootScope","vipCardBusinessServer","tableHelp","$config",function(e,t,a,i,n){var s=i(e,{vip:!0});e.tableParams=s.tableParams(n.apiVip.card.GetOtherBusinessPageListAndTotal,function(){var e={AId:t.accountBaseInfo.aid};return e}),e.loading=!0;var o={};a.getRelatedServiceList().then(function(t){t.data&&angular.forEach(t.data,function(e){o["type"+e.type]=e.name,angular.forEach(e.items,function(e){o["subtype"+e.subtype]=e.subname})}),e.loading=!1},function(){}),e.getName=function(e){var t=o[e];return t||(t="无"),t},e.addBusiness=function(t){a.addBusinessDialog(t).result.then(function(){e.tableParams.reload()})},e.delBusiness=function(t){a.DeleteOtherBusiness(t).then(function(){e.tableParams.reload()})},t.navPath="业务关联",e.$on("$destroy",function(){t.navPath=""})}]).controller("addBusinessDialogCtrl",["$scope","$rootScope","$modalInstance","$toaster","data","vipCardBusinessServer",function(e,t,a,i,n,s){e.cancel=function(){a.dismiss("Canceled")},e.entity={AId:t.accountBaseInfo.aid,AddressObj:{}},n&&n.Id&&(e.loading=!0,s.GetOtherBusiness({AId:t.accountBaseInfo.aid,Id:n.Id}).then(function(t){t.data&&(e.entity=t.data,"navigation"===e.entity.BusinessType&&(e.entity.AddressObj={Address:e.entity.Address,Longitude:e.entity.Longitude,Latitude:e.entity.Latitude})),e.loading=!1},function(){e.loading=!1})),e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.saveloading=!0;var t=angular.copy(e.entity);"navigation"===t.BusinessType&&(t.Address=t.AddressObj.Address,t.Longitude=t.AddressObj.Longitude,t.Latitude=t.AddressObj.Latitude),s.SaveOhterBusiness(t).then(function(){e.saveloading=!1,a.close(e.entity)},function(){e.saveloading=!1})})}}}]).filter("serviceTypeDesc",function(){return function(e){var t="功能模块";switch(e){case"link":t="页面URL";break;case"link":t="电话号码";break;case"navigation":t="经纬度";break;case"activity":t="活动类型"}return t}}),angular.module("ngTicket").factory("vipTradeServer",["$httpApi","$config","$dialogs","$tableids",function(e,t){return{GetMemberCardConsumeStatistics:function(a){return e.postJson2(t.apiVip.card.GetMemberCardConsumeStatistics,a)},GetMemberCardRechargeStatistics:function(a){return e.postJson2(t.apiVip.card.GetMemberCardRechargeStatistics,a)},GetMemberCardPointsStatistics:function(a){return e.postJson2(t.apiVip.card.GetMemberCardPointsStatistics,a)}}}]),angular.module("ngTicket").controller("vipTradeCtrl",["$scope","$rootScope","vipMarketingServer","vipManageServer",function(e,t,a,i){e.consume=function(){i.consumeDialog().result.then(function(){})},e.recharge=function(){i.rechargeDialog().result.then(function(){})},e.changePoints=function(){i.changePointsDialog().result.then(function(){})},e.useCoupon=function(){i.useCouponDialog().result.then(function(){})}}]).controller("vipTradeConsumeDataCtrl",["$scope","$rootScope","vipTradeServer","$timeout","ticketCharts",function(e,t,a,i,n){var s=new Date;e.years=[],e.months=[];for(var o=0;12>o;++o)e.years.unshift({val:s.getFullYear()-o,text:s.getFullYear()-o+"年"}),e.months.push({val:o+1,text:o+1+"月"});e.searchParams={year:s.getFullYear(),month:s.getMonth()+1},e.query=function(){var s={AId:t.accountBaseInfo.aid,PageIndex:1,PageSize:50};s.BeginTime=parseInt(new Date(e.searchParams.year,e.searchParams.month-1,1).getTime()/1e3),s.EndTime=parseInt(new Date(e.searchParams.year,e.searchParams.month,0,23,59,59).getTime()/1e3),e.consumeTotal=0,a.GetMemberCardConsumeStatistics(s).then(function(t){if(t.data){var a=[],s=[],o=[],l=[];
angular.forEach(t.data.Items,function(t){e.consumeTotal+=t.ConsumingAmount;var i=n.getDateNum(1e3*t.Time);a.push([i,t.ConsumingAmount]),s.push([i,t.ConsumingCount]),o.push([i,t.BalanceAmount]),l.push([i,t.BalanceCount])}),a=n.getLineMonthData(e.searchParams.year,e.searchParams.month,a),s=n.getLineMonthData(e.searchParams.year,e.searchParams.month,s),o=n.getLineMonthData(e.searchParams.year,e.searchParams.month,o),l=n.getLineMonthData(e.searchParams.year,e.searchParams.month,l),e.chartLoaded=!0,i(function(){n.line("chart1",[{data:a,name:"消费总金额"},{data:s,name:"消费次数",yAxis:1},{data:o,name:"余额消费金额"},{data:l,name:"余额消费次数",yAxis:1}],{yTitle:"金额（元）",y1Title:"次数"})})}},function(){})},e.query()}]).controller("vipTradeRechargeDataCtrl",["$scope","$rootScope","vipTradeServer","$timeout","ticketCharts",function(e,t,a,i,n){var s=new Date;e.years=[],e.months=[];for(var o=0;12>o;++o)e.years.unshift({val:s.getFullYear()-o,text:s.getFullYear()-o+"年"}),e.months.push({val:o+1,text:o+1+"月"});e.searchParams={year:s.getFullYear(),month:s.getMonth()+1},e.query=function(){var s={AId:t.accountBaseInfo.aid,PageIndex:1,PageSize:50};s.BeginTime=parseInt(new Date(e.searchParams.year,e.searchParams.month-1,1).getTime()/1e3),s.EndTime=parseInt(new Date(e.searchParams.year,e.searchParams.month,0,23,59,59).getTime()/1e3),e.consumeTotal=0,a.GetMemberCardRechargeStatistics(s).then(function(t){if(t.data){var a=[],s=[];angular.forEach(t.data.Items,function(t){e.consumeTotal+=t.Amount;var i=n.getDateNum(1e3*t.Time);a.push([i,t.Amount]),s.push([i,t.Count])}),a=n.getLineMonthData(e.searchParams.year,e.searchParams.month,a),s=n.getLineMonthData(e.searchParams.year,e.searchParams.month,s),e.chartLoaded=!0,i(function(){n.line("chart1",[{data:a,name:"充值金额"},{data:s,name:"充值次数",yAxis:1}],{yTitle:"金额（元）",y1Title:"次数"})})}},function(){})},e.query()}]).controller("vipTradePointDataCtrl",["$scope","$rootScope","vipTradeServer","$timeout","ticketCharts",function(e,t,a,i,n){var s=new Date;e.years=[],e.months=[];for(var o=0;12>o;++o)e.years.unshift({val:s.getFullYear()-o,text:s.getFullYear()-o+"年"}),e.months.push({val:o+1,text:o+1+"月"});e.searchParams={year:s.getFullYear(),month:s.getMonth()+1},e.query=function(){var s={AId:t.accountBaseInfo.aid,PageIndex:1,PageSize:50};s.BeginTime=parseInt(new Date(e.searchParams.year,e.searchParams.month-1,1).getTime()/1e3),s.EndTime=parseInt(new Date(e.searchParams.year,e.searchParams.month,0,23,59,59).getTime()/1e3),a.GetMemberCardPointsStatistics(s).then(function(t){if(t.data){var a=[],s=[],o=[],l=[];angular.forEach(t.data.Items,function(e){var t=n.getDateNum(1e3*e.Time);a.push([t,e.GivePoints]),s.push([t,e.GiveCount]),o.push([t,e.ConsumPoints]),l.push([t,e.ConsumCount])}),a=n.getLineMonthData(e.searchParams.year,e.searchParams.month,a),a=n.getLineMonthData(e.searchParams.year,e.searchParams.month,a),o=n.getLineMonthData(e.searchParams.year,e.searchParams.month,o),l=n.getLineMonthData(e.searchParams.year,e.searchParams.month,l),e.chartLoaded=!0,i(function(){n.line("chart1",[{data:a,name:"发出积分"},{data:s,name:"发出次数",yAxis:1},{data:o,name:"收回积分"},{data:l,name:"收回次数",yAxis:1}],{yTitle:"金额（元）",y1Title:"次数"})})}},function(){})},e.query()}]).controller("vipTradeConsumeLogCtrl",["$scope","$rootScope","vipTradeServer","vipManageServer","tableHelp","$config","$filter",function(e,t,a,i,n,s,o){e.searchParams={},i.Spoutlet({aid:t.accountBaseInfo.aid}).then(function(t){t.data&&(e.stores=t.data)},function(){});var l=n(e,{vip:!0});e.tableParams=l.tableParams(s.apiVip.card.GetConsumingLogPageListAndTotal,function(){var a={AId:t.accountBaseInfo.aid};return e.searchParams.Name&&(a.Name=e.searchParams.Name),e.searchParams.CouponType&&(a.CouponType=e.searchParams.CouponType),e.searchParams.Phone&&(a.Phone=e.searchParams.Phone),e.searchParams.AmountMin&&(a.AmountMin=e.searchParams.AmountMin),e.searchParams.AmountMax&&(a.AmountMax=e.searchParams.AmountMax),e.searchParams.StoreId&&(a.AmountMax=e.searchParams.StoreId),e.searchParams.time&&(a.BeginTime=Math.round(new Date(o("date")(e.searchParams.time.startDate,"yyyy-MM-dd")+" 00:00:00").getTime()/1e3),a.EndTime=Math.round(new Date(o("date")(e.searchParams.time.endDate,"yyyy-MM-dd")+" 23:59:59").getTime()/1e3)),a}),e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.tableParams.page(1),e.tableParams.reload()})}},e.setMore=function(e,t,a){if(a){var i=angular.copy(e[t]);i.isCopy=!0,e[t].isMore=!0,e.splice(t+1,0,i)}else e[t].isMore=!1,e.splice(t+1,1)},e.printTicket=function(e){i.consumePrintDialog({hasData:!0,data:e}).result.then(function(){})}}]).controller("vipTradeRechargeLogCtrl",["$scope","$rootScope","vipTradeServer","vipManageServer","tableHelp","$config","$filter",function(e,t,a,i,n,s,o){e.searchParams={},i.Spoutlet({aid:t.accountBaseInfo.aid}).then(function(t){t.data&&(e.stores=t.data)},function(){});var l=n(e,{vip:!0});e.tableParams=l.tableParams(s.apiVip.card.GetRechargeLogPageListAndTotal,function(){var a={AId:t.accountBaseInfo.aid};return e.searchParams.Name&&(a.Name=e.searchParams.Name),e.searchParams.MemberCardNo&&(a.MemberCardNo=e.searchParams.MemberCardNo),e.searchParams.Phone&&(a.Phone=e.searchParams.Phone),e.searchParams.AmountMin&&(a.AmountMin=e.searchParams.AmountMin),e.searchParams.AmountMax&&(a.AmountMax=e.searchParams.AmountMax),e.searchParams.StoreId&&(a.StoreId=e.searchParams.StoreId),e.searchParams.time&&(a.BeginTime=Math.round(new Date(o("date")(e.searchParams.time.startDate,"yyyy-MM-dd")+" 00:00:00").getTime()/1e3),a.EndTime=Math.round(new Date(o("date")(e.searchParams.time.endDate,"yyyy-MM-dd")+" 23:59:59").getTime()/1e3)),a}),e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.tableParams.page(1),e.tableParams.reload()})}}}]).controller("vipTradePointLogCtrl",["$scope","$rootScope","vipTradeServer","vipManageServer","tableHelp","$config","$filter",function(e,t,a,i,n,s,o){e.searchParams={};var l=n(e,{vip:!0});e.tableParams=l.tableParams(s.apiVip.card.GetPointsLogPageListAndTotal,function(){var a={AId:t.accountBaseInfo.aid};return e.searchParams.Name&&(a.Name=e.searchParams.Name),e.searchParams.PointsPayType&&(a.PointsPayType=e.searchParams.PointsPayType),e.searchParams.Phone&&(a.Phone=e.searchParams.Phone),e.searchParams.time&&(a.BeginTime=Math.round(new Date(o("date")(e.searchParams.time.startDate,"yyyy-MM-dd")+" 00:00:00").getTime()/1e3),a.EndTime=Math.round(new Date(o("date")(e.searchParams.time.endDate,"yyyy-MM-dd")+" 23:59:59").getTime()/1e3)),a}),e.pointsPayTypes=[];for(var r=1;10>r;++r)e.pointsPayTypes.push(r);e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.tableParams.page(1),e.tableParams.reload()})}}}]),angular.module("ngTicket").factory("vipMarketingServer",["$httpApi","$config","$dialogs","$tableids",function(e,t,a){return{pointPreviewDialog:function(e){return a.create("/app/vip/marketing/pointPreview.dialog.html","pointPreviewDialogCtrl",e)},GetMemberCardPointsRule:function(a){return e.postJson2(t.apiVip.card.GetMemberCardPointsRule,a)},SaveMemberCardPointsRule:function(a){for(var i in a)a[i]||delete a[i];return e.postJson2(t.apiVip.card.SaveMemberCardPointsRule,a)},DeleteMemberCardRecommend:function(a){return e.postJson2(t.apiVip.card.DeleteMemberCardRecommend,a)},DeleteMemberCardRecommendList:function(a){return e.postJson2(t.apiVip.card.DeleteMemberCardRecommendList,a)},DeleteMemberCardSolicitudeList:function(a){return e.postJson2(t.apiVip.card.DeleteMemberCardSolicitudeList,a)},GetMemberCardRecommend:function(a){return e.postJson2(t.apiVip.card.GetMemberCardRecommend,a)},SaveMemberCardRecommend:function(a){return e.postJson2(t.apiVip.card.SaveMemberCardRecommend,a)},DeleteMemberCardBroadcast:function(a){return e.postJson2(t.apiVip.card.DeleteMemberCardBroadcast,a)},DeleteMemberCardBroadcastList:function(a){return e.postJson2(t.apiVip.card.DeleteMemberCardBroadcastList,a)},SaveMemberCardBroadcast:function(a){return e.postJson2(t.apiVip.card.SaveMemberCardBroadcast,a)},GetMemberCardBroadcast:function(a){return e.postJson2(t.apiVip.card.GetMemberCardBroadcast,a)},DeleteMemberCardActivationGiving:function(a){return e.postJson2(t.apiVip.card.DeleteMemberCardActivationGiving,a)},DeleteMemberCardActivationGivingList:function(a){return e.postJson2(t.apiVip.card.DeleteMemberCardActivationGivingList,a)},SaveMemberCardActivationGiving:function(a){return e.postJson2(t.apiVip.card.SaveMemberCardActivationGiving,a)},GetMemberCardActivationGiving:function(a){return e.postJson2(t.apiVip.card.GetMemberCardActivationGiving,a)},DeleteMemberCardCostGivingList:function(a){return e.postJson2(t.apiVip.card.DeleteMemberCardCostGivingList,a)},GetMemberCardCostGiving:function(a){return e.postJson2(t.apiVip.card.GetMemberCardCostGiving,a)},SaveMemberCardCostGiving:function(a){return e.postJson2(t.apiVip.card.SaveMemberCardCostGiving,a)},DeleteMemberCardRechargeGivingList:function(a){return e.postJson2(t.apiVip.card.DeleteMemberCardRechargeGivingList,a)},GetMemberCardRechargeGiving:function(a){return e.postJson2(t.apiVip.card.GetMemberCardRechargeGiving,a)},SaveMemberCardRechargeGiving:function(a){return e.postJson2(t.apiVip.card.SaveMemberCardRechargeGiving,a)},OpenOrCloseMemberCardSolicitude:function(a){return e.postJson2(t.apiVip.card.OpenOrCloseMemberCardSolicitude,a)},GetMemberCardSolicitude:function(a){return e.postJson2(t.apiVip.card.GetMemberCardSolicitude,a)},SaveMemberCardSolicitude:function(a){return e.postJson2(t.apiVip.card.SaveMemberCardSolicitude,a)},SaveMemberCouponTemplate:function(a){return e.postJson2(t.apiVip.card.SaveMemberCouponTemplate,a)},GetMemberCouponTemplate:function(a){return e.postJson2(t.apiVip.card.GetMemberCouponTemplate,a)},DeleteOrRecoverMemberCouponTemplate:function(a){return e.postJson2(t.apiVip.card.DeleteOrRecoverMemberCouponTemplate,a)}}}]),angular.module("ngTicket").controller("vipMarketingCtrl",["$scope","$rootScope","vipMarketingServer","$toaster",function(){}]).controller("vipMarketingCouponCtrl",["$scope","$rootScope","vipMarketingServer","$toaster","tableHelp","$config",function(e,t,a,i,n,s){e.searchParams={};var o=n(e,{vip:!0});e.tableParams=o.tableParams(s.apiVip.card.GetCouponTemplatePageListAndTotal,function(){var a={AId:t.accountBaseInfo.aid};return e.searchParams.text&&(a.SearchInfo=e.searchParams.text),a}),e.search=function(){e.tableParams.page(1),e.tableParams.reload()},e.searchEnter=function(t){var t=t||event,a=t.keyCode||t.which||t.charCode;return 13==a?(e.search(t),!1):void 0},e.del=function(n,s){a.DeleteOrRecoverMemberCouponTemplate({AId:t.accountBaseInfo.aid,Id:n.Id,DeleteOrRecover:!s}).then(function(){e.tableParams.reload(),s||i.success('优惠券删除成功！ <a class="pull-right recover" style="text-decoration: underline ">恢复</a>',1e4,"trustedHtml",function(i){i.target.className.indexOf("recover")>-1&&a.DeleteOrRecoverMemberCouponTemplate({AId:t.accountBaseInfo.aid,Id:n.Id,DeleteOrRecover:!1}).then(function(){e.tableParams.reload()},function(){})})},function(){})},e.delMulti=function(n){if(!n||!n.length)return void i.error("请先选择");var s=[];angular.forEach(n,function(e){s.push(e.Id)}),a.DeleteMemberCardRecommendList({AId:t.accountBaseInfo.aid,IdList:s}).then(function(){e.tableParams.reload()},function(){})}}]).controller("vipMarketingCouponGetListCtrl",["$scope","$rootScope","vipMarketingServer","$toaster","tableHelp","$config","$stateParams",function(e,t,a,i,n,s,o){e.uses=[{value:0,title:"全部"},{value:1,title:"已使用"},{value:2,title:"未使用"}],e.searchParams={};var l=n(e,{vip:!0});e.tableParams=l.tableParams(s.apiVip.card.GetMemberCouponGetListAndTotal,function(){var a={AId:t.accountBaseInfo.aid,CouponTemlateId:o.id};return 1==e.searchParams.use?a.IsUsed=!0:2==e.searchParams.use&&(a.IsUsed=!1),a}),e.search=function(){e.tableParams.page(1),e.tableParams.reload()}}]).controller("vipMarketingCouponAddCtrl",["$scope","$rootScope","$stateParams","vipMarketingServer","$state","vipCardLevelServer","$filter","$toaster",function(e,t,a,i,n,s,o,l){if(e.id=a.id,s.GetMemberCardLevelSet({AId:t.accountBaseInfo.aid}).then(function(t){t.data&&t.data.ListDetail&&(e.levels=t.data.ListDetail)},function(){}),e.entity={AId:t.accountBaseInfo.aid,LogoPreview:"http://oss.aliyuncs.com/weimob-com/image/87/32/51/20160810/20160810180937_31450.png",Logo:"http://oss.aliyuncs.com/weimob-com/image/87/32/51/20160810/20160810180937_31450.png",CouponType:0,GetType:0},a.id)e.loading=!0,i.GetMemberCouponTemplate({AId:t.accountBaseInfo.aid,Id:e.id}).then(function(t){e.loading=!1,t&&t.data&&(e.entity=t.data,e.entity.LogoPreview=e.entity.Logo,e.entity.MemberType||(e.entity.MemberType=""),e.entity.time={startDate:o("date")(1e3*e.entity.StartTime,"yyyy-MM-dd"),endDate:o("date")(1e3*e.entity.EndTime,"yyyy-MM-dd")})},function(){e.loading=!1});else{var r=new Date;e.entity.time={startDate:o("date")(new Date(r.getFullYear(),r.getMonth(),r.getDate()),"yyyy-MM-dd"),endDate:o("date")(new Date(r.getFullYear(),r.getMonth()+1,r.getDate()),"yyyy-MM-dd")}}e.eventformvalidate={submitHandler:function(){e.$apply(function(){if(!e.entity.CouponType){if(!e.entity.Logo)return void l.error("请上传优惠券图片");if(!e.entity.Description)return void l.error("请填写优惠券使用说明")}var t=angular.copy(e.entity);t.MemberType||(t.MemberType=0),t.StartTime=Math.round(new Date(o("date")(e.entity.time.startDate,"yyyy-MM-dd")+" 00:00:00").getTime()/1e3),t.EndTime=Math.round(new Date(o("date")(e.entity.time.endDate,"yyyy-MM-dd")+" 23:59:59").getTime()/1e3),e.saveloading=!0,i.SaveMemberCouponTemplate(t).then(function(){e.saveloading=!1,n.go("app.vip.marketingCoupon")},function(){e.saveloading=!1})})}}}]).controller("vipMarketingPointCtrl",["$scope","$rootScope","vipMarketingServer","$toaster","$locale",function(e,t,a,i,n){e.entity={AId:t.accountBaseInfo.aid,ClearType:0},e.loading=!0,a.GetMemberCardPointsRule(e.entity).then(function(t){e.loading=!1,t&&t.data&&(e.entity=t.data)},function(){e.loading=!1}),e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.saveloading=!0,a.SaveMemberCardPointsRule(e.entity).then(function(){i.success(n.FORMTIPS.saveSuccess),e.saveloading=!1},function(){e.saveloading=!1})})}},e.onPreview=function(){t.safeApply(function(){a.pointPreviewDialog(e.entity).result.then(function(){})})}}]).controller("pointPreviewDialogCtrl",["$scope","$modalInstance","$toaster","data","vipCardManageServer","$locale",function(e,t,a,i){e.cancel=function(){t.dismiss("Canceled")},e.entity=i||{},e.eventformvalidate={submitHandler:function(){e.$apply(function(){t.close(e.entity)})}}}]).controller("vipMarketingRecommendCtrl",["$scope","$rootScope","vipMarketingServer","$toaster","tableHelp","$config","vipCardBusinessServer",function(e,t,a,i,n,s,o){var l=n(e,{vip:!0});e.tableParams=l.tableParams(s.apiVip.card.GetMemberCardRecommendPageListAndTotal,function(){var e={AId:t.accountBaseInfo.aid};return e}),e.loading=!0;var r={};o.getRelatedServiceList().then(function(t){t.data&&angular.forEach(t.data,function(e){r["type"+e.type]=e.name,angular.forEach(e.items,function(e){r["subtype"+e.subtype]=e.subname})}),e.loading=!1},function(){}),e.getName=function(e){var t=r[e];return t||(t="无"),t},e.del=function(i){a.DeleteMemberCardRecommend({AId:t.accountBaseInfo.aid,Id:i.Id}).then(function(){e.tableParams.reload()},function(){})},e.delMulti=function(n){if(!n||!n.length)return void i.error("请先选择");var s=[];angular.forEach(n,function(e){s.push(e.Id)}),a.DeleteMemberCardRecommendList({AId:t.accountBaseInfo.aid,IdList:s}).then(function(){e.tableParams.reload()},function(){})}}]).controller("vipMarketingRecommendAddCtrl",["$scope","$rootScope","$stateParams","vipMarketingServer","$state",function(e,t,a,i,n){e.entity={AId:t.accountBaseInfo.aid,LogoPreview:"http://oss.aliyuncs.com/weimob-com/image/51/3e/04/20160816/20160816103433_30039.png",LogoUrl:"http://oss.aliyuncs.com/weimob-com/image/51/3e/04/20160816/20160816103433_30039.png",AddressObj:{}},a.id&&(e.id=a.id,e.loading=!0,i.GetMemberCardRecommend({AId:t.accountBaseInfo.aid,Id:e.id}).then(function(t){e.loading=!1,t&&t.data&&(e.entity=t.data,"navigation"===e.entity.BusinessType&&(e.entity.AddressObj={Address:e.entity.Address,Longitude:e.entity.Longitude,Latitude:e.entity.Latitude}),e.entity.LogoPreview=e.entity.LogoUrl)},function(){e.loading=!1})),e.urlTypes=[];for(var s=1;14>s;++s)e.urlTypes.push(s);e.eventformvalidate={submitHandler:function(){e.$apply(function(){var t=angular.copy(e.entity);"navigation"===t.BusinessType&&(t.Address=t.AddressObj.Address,t.Longitude=t.AddressObj.Longitude,t.Latitude=t.AddressObj.Latitude),e.saveloading=!0,i.SaveMemberCardRecommend(t).then(function(){e.saveloading=!1,n.go("app.vip.marketingRecommend")},function(){e.saveloading=!1})})}}}]).controller("vipMarketingBroadcastCtrl",["$scope","$rootScope","vipMarketingServer","$toaster","tableHelp","$config",function(e,t,a,i,n,s){var o=n(e,{vip:!0});e.tableParams=o.tableParams(s.apiVip.card.GetMemberCardBroadcastPageListAndTotal,function(){var e={AId:t.accountBaseInfo.aid};return e}),e.del=function(i){a.DeleteMemberCardBroadcast({AId:t.accountBaseInfo.aid,Id:i.Id}).then(function(){e.tableParams.reload()},function(){})},e.delMulti=function(n){if(!n||!n.length)return void i.error("请先选择");var s=[];angular.forEach(n,function(e){s.push(e.Id)}),a.DeleteMemberCardBroadcastList({AId:t.accountBaseInfo.aid,IdList:s}).then(function(){e.tableParams.reload()},function(){})}}]).controller("vipMarketingBroadcastAddCtrl",["$scope","$rootScope","$stateParams","vipMarketingServer","$state","vipCardLevelServer",function(e,t,a,i,n,s){s.GetMemberCardLevelSet({AId:t.accountBaseInfo.aid}).then(function(t){t.data&&t.data.ListDetail&&(e.levels=t.data.ListDetail)},function(){}),e.entity={AId:t.accountBaseInfo.aid,LogoPreview:"http://stc.weimob.cn/h5static/membership/images/in_info_user.png",Logo:"http://stc.weimob.cn/h5static/membership/images/in_info_user.png"},a.id&&(e.id=a.id,e.loading=!0,i.GetMemberCardBroadcast({AId:t.accountBaseInfo.aid,Id:e.id}).then(function(t){e.loading=!1,t&&t.data&&(e.entity=t.data,e.entity.LogoPreview=e.entity.Logo,e.entity.MemberType&&(e.entity.MemberType=""))},function(){e.loading=!1})),e.eventformvalidate={submitHandler:function(){e.$apply(function(){var t=angular.copy(e.entity);t.MemberType||(t.MemberType=0),e.saveloading=!0,i.SaveMemberCardBroadcast(t).then(function(){e.saveloading=!1,n.go("app.vip.marketingBroadcast")},function(){e.saveloading=!1})})}}}]).controller("vipMarketingActivationGivingCtrl",["$scope","$rootScope","vipMarketingServer","$toaster","tableHelp","$config",function(e,t,a,i,n,s){var o=n(e,{vip:!0});e.tableParams=o.tableParams(s.apiVip.card.GetMemberCardActivationGivingPageListAndTotal,function(){var e={AId:t.accountBaseInfo.aid};return e}),e.del=function(i){a.DeleteMemberCardActivationGiving({AId:t.accountBaseInfo.aid,Id:i.Id}).then(function(){e.tableParams.reload()},function(){})},e.delMulti=function(n){if(!n||!n.length)return void i.error("请先选择");var s=[];angular.forEach(n,function(e){s.push(e.Id)}),a.DeleteMemberCardActivationGivingList({AId:t.accountBaseInfo.aid,IdList:s}).then(function(){e.tableParams.reload()},function(){})}}]).controller("vipMarketingActivationGivingAddCtrl",["$scope","$rootScope","$stateParams","vipMarketingServer","$state","$filter","vipManageServer",function(e,t,a,i,n,s){e.entity={AId:t.accountBaseInfo.aid},e.id=a.id,a.id&&(e.loading=!0,i.GetMemberCardActivationGiving({AId:t.accountBaseInfo.aid,Id:e.id}).then(function(t){t&&t.data&&(e.entity=t.data,e.entity.IsNeedMessage&&(e.entity.IsNeedMessage=!0),e.entity.time={startDate:s("date")(1e3*e.entity.StartTime,"yyyy-MM-dd"),endDate:s("date")(1e3*e.entity.EndTime,"yyyy-MM-dd")}),e.loading=!1},function(){e.loading=!1})),e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.entity.CalcGiveValue();var t=angular.copy(e.entity);t.IsNeedMessage=t.IsNeedMessage?1:0,t.StartTime=Math.round(new Date(s("date")(e.entity.time.startDate,"yyyy-MM-dd")+" 00:00:00").getTime()/1e3),t.EndTime=Math.round(new Date(s("date")(e.entity.time.endDate,"yyyy-MM-dd")+" 23:59:59").getTime()/1e3),e.saveloading=!0,i.SaveMemberCardActivationGiving(t).then(function(){e.saveloading=!1,n.go("app.vip.marketingActivationGiving")},function(){e.saveloading=!1})})}}}]).controller("vipMarketingCostGivingCtrl",["$scope","$rootScope","vipMarketingServer","$toaster","tableHelp","$config",function(e,t,a,i,n,s){var o=n(e,{vip:!0});e.tableParams=o.tableParams(s.apiVip.card.GetMemberCardCostGivingPageListAndTotal,function(){var e={AId:t.accountBaseInfo.aid};return e}),e.del=function(i){a.DeleteMemberCardCostGivingList({AId:t.accountBaseInfo.aid,IdList:[i.Id]}).then(function(){e.tableParams.reload()},function(){})},e.delMulti=function(n){if(!n||!n.length)return void i.error("请先选择");var s=[];angular.forEach(n,function(e){s.push(e.Id)}),a.DeleteMemberCardCostGivingList({AId:t.accountBaseInfo.aid,IdList:s}).then(function(){e.tableParams.reload()},function(){})}}]).controller("vipMarketingCostGivingAddCtrl",["$scope","$rootScope","$stateParams","vipMarketingServer","$state","vipCardManageServer","vipManageServer","vipCardLevelServer","$filter",function(e,t,a,i,n,s,o,l,r){l.GetMemberCardLevelSet({AId:t.accountBaseInfo.aid}).then(function(t){t.data&&t.data.ListDetail&&(e.levels=t.data.ListDetail)},function(){}),e.id=a.id,e.entity={AId:t.accountBaseInfo.aid,LimitType:0},a.id&&(e.loading=!0,i.GetMemberCardCostGiving({AId:t.accountBaseInfo.aid,Id:e.id}).then(function(t){t&&t.data&&(e.entity=t.data,e.entity["ConditionValue"+e.entity.GiveCondition]=e.entity.ConditionValue,e.entity.IsNeedMessage&&(e.entity.IsNeedMessage=!0),e.entity.time={startDate:r("date")(1e3*e.entity.StartTime,"yyyy-MM-dd"),endDate:r("date")(1e3*e.entity.EndTime,"yyyy-MM-dd")}),e.loading=!1},function(){e.loading=!1}),o.Spoutlet({aid:t.accountBaseInfo.aid}).then(function(t){t.data&&(e.stores=t.data)},function(){})),e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.entity.CalcGiveValue();var t=angular.copy(e.entity);t.IsNeedMessage=t.IsNeedMessage?1:0,t.StartTime=Math.round(new Date(r("date")(e.entity.time.startDate,"yyyy-MM-dd")+" 00:00:00").getTime()/1e3),t.EndTime=Math.round(new Date(r("date")(e.entity.time.endDate,"yyyy-MM-dd")+" 23:59:59").getTime()/1e3),t.ConditionValue=t.GiveCondition<3?t["ConditionValue"+t.GiveCondition]:0,e.saveloading=!0,t.MemberType||(t.MemberType=0),i.SaveMemberCardCostGiving(t).then(function(){e.saveloading=!1,n.go("app.vip.marketingCostGiving")},function(){e.saveloading=!1})})}}}]).controller("vipMarketingRechargeGivingCtrl",["$scope","$rootScope","vipMarketingServer","$toaster","tableHelp","$config",function(e,t,a,i,n,s){var o=n(e,{vip:!0});e.tableParams=o.tableParams(s.apiVip.card.GetMemberCardRechargeGivingPageListAndTotal,function(){var e={AId:t.accountBaseInfo.aid};return e}),e.del=function(i){a.DeleteMemberCardRechargeGivingList({AId:t.accountBaseInfo.aid,IdList:[i.Id]}).then(function(){e.tableParams.reload()},function(){})},e.delMulti=function(n){if(!n||!n.length)return void i.error("请先选择");var s=[];angular.forEach(n,function(e){s.push(e.Id)}),a.DeleteMemberCardRechargeGivingList({AId:t.accountBaseInfo.aid,IdList:s}).then(function(){e.tableParams.reload()},function(){})}}]).controller("vipMarketingRechargeGivingAddCtrl",["$scope","$rootScope","$stateParams","vipMarketingServer","$state","vipCardManageServer","vipManageServer","vipCardLevelServer","$filter",function(e,t,a,i,n,s,o,l,r){e.id=a.id,l.GetMemberCardLevelSet({AId:t.accountBaseInfo.aid}).then(function(t){t.data&&t.data.ListDetail&&(e.levels=t.data.ListDetail)},function(){}),e.entity={AId:t.accountBaseInfo.aid,RechargeType:0},a.id&&(e.loading=!0,i.GetMemberCardRechargeGiving({AId:t.accountBaseInfo.aid,Id:e.id}).then(function(t){e.loading=!1,t&&t.data&&(e.entity=t.data,e.entity.IsNeedMessage&&(e.entity.IsNeedMessage=!0),e.entity.time={startDate:r("date")(1e3*e.entity.StartTime,"yyyy-MM-dd"),endDate:r("date")(1e3*e.entity.EndTime,"yyyy-MM-dd")})},function(){e.loading=!1}),o.Spoutlet({aid:t.accountBaseInfo.aid}).then(function(t){t.data&&(e.stores=t.data)},function(){})),e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.entity.CalcGiveValue();var t=angular.copy(e.entity);t.IsNeedMessage=t.IsNeedMessage?1:0,t.StartTime=Math.round(new Date(r("date")(e.entity.time.startDate,"yyyy-MM-dd")+" 00:00:00").getTime()/1e3),t.EndTime=Math.round(new Date(r("date")(e.entity.time.endDate,"yyyy-MM-dd")+" 23:59:59").getTime()/1e3),t.MemberType||(t.MemberType=0),e.saveloading=!0,i.SaveMemberCardRechargeGiving(t).then(function(){e.saveloading=!1,n.go("app.vip.marketingRechargeGiving")},function(){e.saveloading=!1})})}}}]).controller("vipMarketingPointExchangeCtrl",["$scope","$rootScope","vipMarketingServer","$toaster","tableHelp","$config",function(){}]).controller("vipMarketingPointExchangeAddCtrl",["$scope","$rootScope","vipMarketingServer","$toaster",function(){}]).controller("vipMarketingSolicitudeCtrl",["$scope","$rootScope","vipMarketingServer","$toaster","tableHelp","$config","vipCardLevelServer",function(e,t,a,i,n,s,o){var l=n(e,{vip:!0});e.QueryType=0,e.tableParams=l.tableParams(s.apiVip.card.GetMemberCardSolicitudePageListAndTotal,function(){var a={AId:t.accountBaseInfo.aid,QueryType:e.QueryType};return a}),e.query=function(t){e.QueryType=t,e.tableParams.page(1),e.tableParams.reload()},e.del=function(i){a.DeleteMemberCardSolicitudeList({AId:t.accountBaseInfo.aid,IdList:[i.Id]}).then(function(){e.tableParams.reload()},function(){})},e.delMulti=function(n){if(!n||!n.length)return void i.error("请先选择");var s=[];angular.forEach(n,function(e){s.push(e.Id)}),a.DeleteMemberCardSolicitudeList({AId:t.accountBaseInfo.aid,IdList:s}).then(function(){e.tableParams.reload()},function(){})},e.openSolicitude=function(e,i){a.OpenOrCloseMemberCardSolicitude({AId:t.accountBaseInfo.aid,Id:e.Id,IsClose:i}).then(function(){e.IsClose=i},function(){})},e.levels=[],o.GetMemberCardLevelSet({AId:t.accountBaseInfo.aid}).then(function(t){t.data&&t.data.MemberCardLevelSetDetail&&(e.levels=t.data.MemberCardLevelSetDetail)},function(){}),e.getPeopleDesc=function(t){var a="全部";return angular.forEach(e.levels,function(e){e.LevelNo==t&&(a=e.LevelName)}),a}}]).controller("vipMarketingSolicitudeAddCtrl",["$scope","$rootScope","$stateParams","vipMarketingServer","$state","vipCardManageServer","vipManageServer","vipCardLevelServer","$filter",function(e,t,a,i,n,s,o,l,r){e.id=a.id,l.GetMemberCardLevelSet({AId:t.accountBaseInfo.aid}).then(function(t){t.data&&t.data.ListDetail&&(e.levels=t.data.ListDetail)},function(){}),e.entity={AId:t.accountBaseInfo.aid,Type:0},a.id&&(e.loading=!0,i.GetMemberCardSolicitude({AId:t.accountBaseInfo.aid,Id:e.id}).then(function(t){e.loading=!1,t&&t.data&&(e.entity=t.data,e.entity.MemberType||(e.entity.MemberType=""),e.entity.IsNeedMessage&&(e.entity.IsNeedMessage=!0),e.entity.GiveTime&&(e.entity.GiveTime=r("date")(1e3*e.entity.GiveTime,"yyyy-MM-dd HH:mm")))},function(){e.loading=!1})),e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.entity.CalcGiveValue();var t=angular.copy(e.entity);t.IsNeedMessage=t.IsNeedMessage?1:0,t.MemberType||(t.MemberType=0),t.GiveTime&&(t.GiveTime=Math.round(new Date(r("date")(t.GiveTime,"yyyy-MM-dd HH:mm")).getTime()/1e3)),e.saveloading=!0,i.SaveMemberCardSolicitude(t).then(function(){e.saveloading=!1,n.go("app.vip.marketingSolicitude")},function(){e.saveloading=!1})})}},e.shortTimes=[];for(var d=0;24>d;++d)for(var c=0;60>c;c+=5){var p=d,m=c;10>d&&(p="0"+p),10>c&&(m="0"+m),e.shortTimes.push(p+":"+m+":00")}}]).filter("activityType",function(){return function(e){return 1==e?"链接":2==e?"电话":3==e?"导航":4==e?"活动":5==e?"业务模块":6==e?"微汽车":7==e?"微房":8==e?"微餐饮":9==e?"微生活":10==e?"微团购":11==e?"微外卖":12==e?"微盟旺铺":13==e?"微酒店":""}}).filter("endTime",function(){return function(e,t){var a=(new Date).getTime()/1e3;return a>t?"已过期":e>a?"未开启":"已开启"}}).filter("couponType",function(){return function(e){return 0==e?"优惠券":1==e?"代金券":""}}).filter("giving",function(){return function(e){return 0==e?"积分":1==e?"红包":2==e?"优惠券":3==e?"余额":""}}).filter("solicitudeType",function(){return function(e){return 0==e?"节日关怀":1==e?"生日关怀":""}}),angular.module("ngTicket").factory("vipStoreServer",["$httpApi","$config","$dialogs","$tableids",function(e,t){return{DeleteOfflineMemberInfoByPhoneList:function(a){return e.postJson2(t.apiVip.card.DeleteOfflineMemberInfoByPhoneList,a)},AddOfflineMemberInfo:function(a){return e.postJson2(t.apiVip.card.AddOfflineMemberInfo,a)}}}]),angular.module("ngTicket").controller("vipStoreVipCtrl",["$scope","$rootScope","vipStoreServer","$toaster","tableHelp","$config",function(e,t,a,i,n,s){e.searchParams={},e.onClear=function(){e.searchParams={}},e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.tableParams.reload()})}};var o=n(e,{vip:!0});e.tableParams=o.tableParams(s.apiVip.card.GetOffLineMemberInfoPageListAndTotal,function(){var a={AId:t.accountBaseInfo.aid};return e.searchParams.text&&(11==e.searchParams.text.length&&/^((1)+\d{10})$/.test(e.searchParams.text)?a.Phone=e.searchParams.text:a.Name=e.searchParams.text),a}),e.del=function(i){var n=[];angular.forEach(i,function(e){n.push(e.Phone)}),a.DeleteOfflineMemberInfoByPhoneList({AId:t.accountBaseInfo.aid,PhoneList:n}).then(function(){e.tableParams.reload()})},e.uploadFinished=function(t){console.info(t),t.data&&t.data.data&&t.data.data.length&&i.error("有 "+t.data.data.length+" 条记录导入失败。"),e.tableParams.reload()}}]).controller("vipStoreVipAddCtrl",["$scope","$rootScope","vipStoreServer","$state","$toaster",function(e,t,a,i){e.sexs=[{value:0,title:"不限"},{value:1,title:"男"},{value:2,title:"女"}],e.entity={AId:t.accountBaseInfo.aid,Address:{}},e.address={},e.eventformvalidate={submitHandler:function(){e.$apply(function(){var t=angular.copy(e.entity);t.Address.ProvinceId=e.address.province,t.Address.CityId=e.address.city,t.Address.DistrictId=e.address.district,t.Birthday=Math.round(new Date(t.Birthday).getTime()/1e3),e.saveloading=!0,a.AddOfflineMemberInfo(t).then(function(){i.go("app.vip.storeVip"),e.saveloading=!1},function(){e.saveloading=!1})})}}}]).filter("storeVipStatus",function(){return function(e){return 1==e?"已绑定":"未绑定"}}),angular.module("ngTicket").factory("vipManageServer",["$httpApi","$config","$dialogs","$q",function(e,t,a,i){return{setDegreeDialog:function(e){return a.create("/app/vip/manage/setDegree.dialog.html","setDegreeDialogCtrl",e)},setRemarkNameDialog:function(e){return a.create("/app/vip/manage/setRemarkName.dialog.html","setRemarkNameDialogCtrl",e)},setTagDialog:function(e){return a.create("/app/vip/manage/setTag.dialog.html","setTagDialogCtrl",e)},rechargeDialog:function(e){return a.create("/app/vip/manage/recharge.dialog.html","rechargeDialogCtrl",e)},consumeDialog:function(e){return a.create("/app/vip/manage/consume.dialog.html","consumeDialogCtrl",e)},consumeResultDialog:function(e){return a.create("/app/vip/manage/consume.result.dialog.html","consumeResultDialogCtrl",e)},consumePrintDialog:function(e){return a.create("/app/vip/manage/consume.print.dialog.html","consumePrintDialogCtrl",e)},changePointsDialog:function(e){return a.create("/app/vip/manage/points.dialog.html","pointsDialogCtrl",e)},useCouponDialog:function(e){return a.create("/app/vip/manage/useCoupon.dialog.html","useCouponDialogCtrl",e)},GetMemberCardTagsPageListAndTotal:function(a){return a.PageIndex||(a.PageIndex=1,a.PageSize=100),e.postJson2(t.apiVip.card.GetMemberCardTagsPageListAndTotal,a)},DeleteMemberCardTag:function(a){return e.postJson2(t.apiVip.card.DeleteMemberCardTag,a)},SaveMemberCardTag:function(a){return e.postJson2(t.apiVip.card.SaveMemberCardTag,a)},GetMemberCardTag:function(a){return e.postJson2(t.apiVip.card.GetMemberCardTag,a)},DealMemberTag:function(a){return e.postJson2(t.apiVip.card.DealMemberTag,a)},ChangeMemberLevel:function(a){return e.postJson2(t.apiVip.card.ChangeMemberLevel,a)},ClearMemberPoints:function(a){return e.postJson2(t.apiVip.card.ClearMemberPoints,a)},OpenOrCloseMember:function(a){return e.postJson2(t.apiVip.card.OpenOrCloseMember,a)},Spoutlet:function(e){var t=i.defer();return t.resolve([]),t.promise},Getspheader:function(a){return e.get(t.api3.card.Getspheader,a)},RechargeForAdmin:function(a){return e.postJson2(t.apiVip.card.RechargeForAdmin,a)
},ConsumeForAdmin:function(a){return e.postJson2(t.apiVip.card.ConsumeForAdmin,a)},GetConsumingLog:function(a){return e.postJson2(t.apiVip.card.GetConsumingLog,a)},GetMemberCouponPageListAndTotal:function(a){return e.postJson2(t.apiVip.card.GetMemberCouponPageListAndTotal,a)},GetCouponTemplatePageListAndTotal:function(a){return e.postJson2(t.apiVip.card.GetCouponTemplatePageListAndTotal,a)},ChangeMemberPoints:function(a){return e.postJson2(t.apiVip.card.ChangeMemberPoints,a)},GetMemberInfo:function(a){return e.postJson2(t.apiVip.card.GetMemberInfo,a)},SaveMemberInfo:function(a){return e.postJson2(t.apiVip.card.SaveMemberInfo,a)},UseMemberCoupon:function(a){return e.postJson2(t.apiVip.card.UseMemberCoupon,a)},UpdateMemberRemarkName:function(a){return e.postJson2(t.apiVip.card.UpdateMemberRemarkName,a)},createLabelDialog:function(e){return a.create("/app/vip/manage/create.label.dialog.html","createLabelDialogCtrl",e)},UpdateMemberHeadUrl:function(a){return e.postJson2(t.apiVip.card.UpdateMemberHeadUrl,a)},ResetMemberExpireDateInfo:function(a){return e.postJson2(t.apiVip.card.ResetMemberExpireDateInfo,a)}}}]),angular.module("ngTicket").controller("vipManageCtrl",["$scope","$rootScope","$timeout","vipManageServer","$toaster","tableHelp","$config","vipCardLevelServer",function(e,t,a,i,n,s,o,l){e.isMore=!1,e.showMore=function(){e.isMore=!e.isMore},l.GetMemberCardLevelSet({AId:t.accountBaseInfo.aid}).then(function(t){t.data&&(e.vipDegrees=t.data.ListDetail)},function(){}),e.searchParams={},e.vipTags2=[],e.loading=!0,i.GetMemberCardTagsPageListAndTotal({AId:t.accountBaseInfo.aid}).then(function(t){t.data&&(e.vipTags=t.data.Items,angular.forEach(e.vipTags,function(t){1!=t.Type&&e.vipTags2.push(t)})),e.loading=!1},function(){e.loading=!1}),e.isConditionTag=function(t){var a=!1;return angular.forEach(e.vipTags,function(e){e.Name===t&&1==e.Type&&(a=!0)}),a},e.sexs=[{value:1,title:"男"},{value:2,title:"女"}],e.ages=[{value:1,title:"18岁以下"},{value:2,title:"18-24岁"},{value:3,title:"25-30岁"},{value:4,title:"31-35岁"},{value:5,title:"36-40岁"},{value:6,title:"40岁以上"}],e.lastTimes=[{value:1,title:"1个月内"},{value:2,title:"1-3个月内"},{value:3,title:"3-6个月内"},{value:4,title:"6-12个月内"},{value:5,title:"12个月以上"}],e.address={},e.onClear=function(){e.searchParams={},e.address.province=0},e.eventformvalidate={submitHandler:function(){e.$apply(function(){})}},e.setDegree=function(t){if(!t.length)return void n.error("请选择会员");var a=[];angular.forEach(t,function(e){a.push(e.MemberCardNo)}),i.setDegreeDialog({vipDegrees:e.vipDegrees,ids:a}).result.then(function(e){angular.forEach(t,function(t){t.Level={Key:e.LevelNo,Value:e.LevelName}})})},e.setRemarkName=function(e){i.setRemarkNameDialog(e).result.then(function(t){e.NickName=t.NickName})};var r=s(e,{vip:!0}),d=function(){var a={AId:t.accountBaseInfo.aid,IsNeedConditionTags:!0,AscOrDesc:1};if(e.searchParams.Info&&(a.Info=e.searchParams.Info),e.isMore){switch(e.searchParams.Sex&&(a.Sex=+e.searchParams.Sex),e.searchParams.ListLevelNo&&e.searchParams.ListLevelNo.length&&(a.ListLevelNo=[],angular.forEach(e.searchParams.ListLevelNo,function(e){a.ListLevelNo.push(e.LevelNo)})),e.searchParams.ListTagId&&e.searchParams.ListTagId.length&&(a.ListTagId=[],angular.forEach(e.searchParams.ListTagId,function(e){a.ListTagId.push(e.Id)})),1==e.searchParams.Age?a.AgeMax=18:2==e.searchParams.Age?(a.AgeMin=18,a.AgeMax=24):3==e.searchParams.Age?(a.AgeMin=25,a.AgeMax=30):4==e.searchParams.Age?(a.AgeMin=31,a.AgeMax=35):5==e.searchParams.Age?(a.AgeMin=36,a.AgeMax=40):6==e.searchParams.Age&&(a.AgeMin=40),e.address&&e.address.city&&(a.ProvinceId=e.address.province,a.CityId=e.address.city),e.searchParams.LastConsumingTime){case 1:a.LastConsumingTimeMin=moment().subtract("month",1).startOf("day").unix();break;case 2:a.LastConsumingTimeMin=moment().subtract("month",3).startOf("day").unix(),a.LastConsumingTimeMax=moment().subtract("month",1).startOf("day").unix();break;case 3:a.LastConsumingTimeMin=moment().subtract("month",6).startOf("day").unix(),a.LastConsumingTimeMax=moment().subtract("month",3).startOf("day").unix();break;case 4:a.LastConsumingTimeMin=moment().subtract("month",12).startOf("day").unix(),a.LastConsumingTimeMax=moment().subtract("month",6).startOf("day").unix();break;case 5:a.LastConsumingTimeMax=moment().subtract("month",12).startOf("day").unix()}e.searchParams.ConsumingCountMin&&(a.ConsumingCountMin=e.searchParams.ConsumingCountMin),e.searchParams.ConsumingCountMax&&(a.ConsumingCountMax=e.searchParams.ConsumingCountMax),e.searchParams.AllConsumingAmountMin&&(a.AllConsumingAmountMin=e.searchParams.AllConsumingAmountMin),e.searchParams.AllConsumingAmountMax&&(a.AllConsumingAmountMax=e.searchParams.AllConsumingAmountMax)}return a};e.tableParams=r.tableParams(o.apiVip.card.GetMemberInfoPagelistAndTotal,function(){return d()});var c=function(){a(function(){l.GetLastMemberExportLog({AId:t.accountBaseInfo.aid}).then(function(t){t.data&&(e.exportData=t.data),1==e.exportData.Status?e.exportDataing=!1:c()},function(){})},1e3)};e.exportMemberInfoList=function(){e.exportDataing=!0,e.exportData={},l.ExportMemberInfoList(d()).then(function(e){e.data&&c()},function(){})},e.setTag=function(t,a){if(!t.length)return void n.error("请选择会员");var s=[];angular.forEach(t,function(e){s.push(e.MemberCardNo)}),i.setTagDialog({tags:e.vipTags,noTags:a,ids:s}).result.then(function(e){angular.forEach(t,function(t){t.Tags||(t.Tags=[]);var a=0;for(a=0;a<t.Tags.length&&t.Tags[a].Key!==e.Id;++a);a>=t.Tags.length&&t.Tags.push({Key:e.Id,Value:e.Name})})})},e.removeTag=function(e,a){i.DealMemberTag({AId:t.accountBaseInfo.aid,IsAdd:0,TagId:a.Key,ListMemberCardNo:[e.MemberCardNo]}).then(function(){for(var t=0;t<e.Tags.length;++t)e.Tags[t].Key===a.Key&&e.Tags.splice(t,1)},function(){})},e.clearPoint=function(e){if(!e.length)return void n.error("请选择会员");var a=[];angular.forEach(e,function(e){a.push(e.MemberCardNo)}),i.ClearMemberPoints({AId:t.accountBaseInfo.aid,ListMemberCardNo:a}).then(function(){angular.forEach(e,function(e){e.Points=0})},function(){})},e.freeze=function(e,a){if(!e.length)return void n.error("请选择会员");var s=[];angular.forEach(e,function(e){s.push(e.MemberCardNo)}),i.OpenOrCloseMember({AId:t.accountBaseInfo.aid,ListMemberCardNo:s,IsClose:a}).then(function(){angular.forEach(e,function(e){e.MemberStatus=a?2:1})},function(){})},e.recharge=function(e){i.rechargeDialog(e).result.then(function(t){e.Amount+=+t.Amount})},e.consume=function(e){i.consumeDialog(e).result.then(function(t){e.Amount-=t.BlancheAmount,e.Points-=t.Points})},e.changePoints=function(e){i.changePointsDialog(e).result.then(function(t){e.Points+=+t.Points})},e.search=function(){e.tableParams.page(1),e.tableParams.reload()},e.searchEnter=function(t){var t=t||event,a=t.keyCode||t.which||t.charCode;return 13==a?(e.search(t),!1):void 0},e.getName=function(e){return e.NickName?e.Name+"（"+e.NickName+"）":e.Name},e.resetExpire=function(e){i.ResetMemberExpireDateInfo({AId:t.accountBaseInfo.aid,MemberCardNo:e.MemberCardNo}).then(function(t){t&&(e.MemberStatus=1,n.success("重置成功！"))},function(){})}}]).controller("vipManageTagMemberCtrl",["$scope","$rootScope","$timeout","vipManageServer","$toaster","tableHelp","$config","vipCardLevelServer","$stateParams",function(e,t,a,i,n,s,o,l,r){e.entity={},e.loading=!0,i.GetMemberCardTag({AId:t.accountBaseInfo.aid,Id:r.id}).then(function(t){e.entity=t.data,e.loading=!1},function(){e.loading=!1}),e.setDegree=function(t){if(!t.length)return void n.error("请选择会员");var a=[];angular.forEach(t,function(e){a.push(e.MemberCardNo)}),i.setDegreeDialog({vipDegrees:e.vipDegrees,ids:a}).result.then(function(e){angular.forEach(t,function(t){t.Level={Key:e.LevelNo,Value:e.LevelName}})})},e.setRemarkName=function(e){i.setRemarkNameDialog(e).result.then(function(t){e.NickName=t.NickName})};var d=s(e,{vip:!0});e.tableParams=d.tableParams(o.apiVip.card.GetMemberInfoPagelistAndTotalByTagId,function(){var e={AId:t.accountBaseInfo.aid,TagId:+r.id};return e}),e.setTag=function(t,a){if(!t.length)return void n.error("请选择会员");var s=[];angular.forEach(t,function(e){s.push(e.MemberCardNo)}),i.setTagDialog({tags:e.vipTags,noTags:a,ids:s}).result.then(function(e){angular.forEach(t,function(t){t.Tags||(t.Tags=[]);var a=0;for(a=0;a<t.Tags.length&&t.Tags[a].Key!==e.Id;++a);a>=t.Tags.length&&t.Tags.push({Key:e.Id,Value:e.Name})})})},e.removeTag=function(e,a){i.DealMemberTag({AId:t.accountBaseInfo.aid,IsAdd:0,TagId:a.Key,ListMemberCardNo:[e.MemberCardNo]}).then(function(){for(var t=0;t<e.Tags.length;++t)e.Tags[t].Key===a.Key&&e.Tags.splice(t,1)},function(){})},e.clearPoint=function(e){if(!e.length)return void n.error("请选择会员");var a=[];angular.forEach(e,function(e){a.push(e.MemberCardNo)}),i.ClearMemberPoints({AId:t.accountBaseInfo.aid,ListMemberCardNo:a}).then(function(){angular.forEach(e,function(e){e.Points=0})},function(){})},e.freeze=function(e,a){if(!e.length)return void n.error("请选择会员");var s=[];angular.forEach(e,function(e){s.push(e.MemberCardNo)}),i.OpenOrCloseMember({AId:t.accountBaseInfo.aid,ListMemberCardNo:s,IsClose:a}).then(function(){angular.forEach(e,function(e){e.MemberStatus=a?2:1})},function(){})},e.recharge=function(e){i.rechargeDialog(e).result.then(function(t){e.Amount+=+t.Amount})},e.consume=function(e){i.consumeDialog(e).result.then(function(t){e.Amount-=t.BlancheAmount,e.Points-=t.Points})},e.changePoints=function(e){i.changePointsDialog(e).result.then(function(t){e.Points+=+t.Points})},e.search=function(){e.tableParams.page(1),e.tableParams.reload()},e.searchEnter=function(t){var t=t||event,a=t.keyCode||t.which||t.charCode;return 13==a?(e.search(t),!1):void 0}}]).controller("vipManageLabelCtrl",["$scope","$rootScope","vipManageServer","$toaster",function(e,t,a){e.searchParams={},e.getTags=function(i){var n={AId:t.accountBaseInfo.aid,IsNeedMemberCount:!0};i&&(n.Type=0),e.searchParams.text&&(n.Name=e.searchParams.text),a.GetMemberCardTagsPageListAndTotal(n).then(function(t){t.data&&(e.vipTags=t.data.Items),i||(e.vipTags2=e.vipTags)},function(){})},e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.getTags(!0)})}},e.getTags(),e.onDelTag=function(i){a.DeleteMemberCardTag({AId:t.accountBaseInfo.aid,Id:i}).then(function(){e.getTags()},function(){})},e.onCreateLabel=function(){a.createLabelDialog({}).result.then(function(){e.getTags()},function(){})},e.canAddConditionLabel=function(){var t=0;return angular.forEach(e.vipTags2,function(e){1==e.Type&&++t}),10>t}}]).controller("vipManageVipViewCtrl",["$scope","$rootScope","$stateParams","vipManageServer","$toaster","$locale","tableHelp","$config","vipCardManageServer","$filter",function(e,t,a,i,n,s,o,l,r,d){e.isEdit=!1,e.entity={AddressInfo:{},Level:{}},e.address={},e.loading=!0;var c=function(){i.GetMemberInfo({AId:t.accountBaseInfo.aid,MemberCardNo:a.id,IsNeedTagsInfo:!0}).then(function(t){e.entity=t.data,e.address.province=e.entity.AddressInfo.ProvinceId,e.address.city=e.entity.AddressInfo.CityId,e.address.district=e.entity.AddressInfo.DistrictId,e.entity.Birthday&&(e.entity.Birthday=d("date")(1e3*e.entity.Birthday,"yyyy-MM-dd")),e.loading=!1},function(){e.loading=!1})};r.GetMemberTemplate({AId:t.accountBaseInfo.aid}).then(function(t){e.templateInfos=t.data.MemberInfoTemplate,c()},function(){}),e.degrees=[];for(var p=1;7>p;++p)e.degrees.push(p);e.professions=[];for(var p=1;13>p;++p)e.professions.push(p);e.incomes=[];for(var p=1;4>p;++p)e.incomes.push(p);e.hobbies=[];for(var p=1;16>p;++p)e.hobbies.push(p);e.getValue=function(t,a){var i="";if(a)return angular.forEach(e.entity.ListOther,function(e){e.Key==t&&(i=e.Value)}),i;switch(t){case"姓名":i=e.entity.Name;break;case"性别":i=d("sex")(e.entity.Sex);break;case"生日":i=e.entity.Birthday;break;case"手机号":i=e.entity.Phone;break;case"邮箱":i=e.entity.EMail;break;case"详细地址":e.entity.AddressInfo.ProvinceName&&(i=e.entity.AddressInfo.ProvinceName+" "+e.entity.AddressInfo.CityName+" "+e.entity.AddressInfo.DistrictName+" "+(e.entity.AddressInfo.Address||""));break;case"学历":i=d("degree")(e.entity.Degree);break;case"行业":i=d("profession")(e.entity.Profession);break;case"收入":i=d("income")(e.entity.Income);break;case"爱好":i=d("hobby")(e.entity.Hobby)}return i},e.hobbies=[];for(var p=1;16>p;++p)e.hobbies.push(p);e.hobbies.push(0),e.sexes=[];for(var p=1;3>p;++p)e.sexes.push(p);e.sexes.push(0),e.professions=[];for(var p=1;13>p;++p)e.professions.push(p);e.professions.push(0),e.incomes=[];for(var p=0;4>p;++p)e.incomes.push(p);e.curTab=1,e.selectTab=function(t){e.curTab=t},e.recharge=function(e){i.rechargeDialog(e).result.then(function(t){e.Amount+=+t.Amount})},e.consume=function(e){i.consumeDialog(e).result.then(function(t){e.Amount-=t.BlancheAmount,e.Points-=t.Points})},e.changePoints=function(e){i.changePointsDialog(e).result.then(function(t){e.Points+=+t.Points})},e.setDegree=function(e){i.setDegreeDialog({ids:[e.MemberCardNo]}).result.then(function(t){e.Level={Key:t.LevelNo,Value:t.LevelName}})},e.setTag=function(t,a){if(t.length){var n=[];angular.forEach(t,function(e){n.push(e.MemberCardNo)}),i.setTagDialog({tags:e.vipTags,noTags:a,ids:n}).result.then(function(e){angular.forEach(t,function(t){t.Tags||(t.Tags=[]);var a=0;for(a=0;a<t.Tags.length&&t.Tags[a].Key!==e.Id;++a);a>=t.Tags.length&&t.Tags.push({Key:e.Id,Value:e.Name})})})}},e.removeTag=function(e,a){i.DealMemberTag({AId:t.accountBaseInfo.aid,IsAdd:0,TagId:a.Key,ListMemberCardNo:[e.MemberCardNo]}).then(function(){for(var t=0;t<e.Tags.length;++t)e.Tags[t].Key===a.Key&&e.Tags.splice(t,1)},function(){})},e.isModifyRemarkName=!1,e.setRemarkName=function(){return e.isModifyRemarkName?void i.UpdateMemberRemarkName({AId:e.entity.AId,MemberCardNo:e.entity.MemberCardNo,RemarkName:e.entity.NickName}).then(function(){e.isModifyRemarkName=!1},function(){}):e.isModifyRemarkName=!0};var m={};e.custom={},e.onEdit=function(t){t?(m=angular.copy(e.entity),angular.forEach(e.entity.ListOther,function(t){e.custom[t.Key]=t.Value})):e.entity=m,e.isEdit=t},e.onSave=function(){var t=angular.copy(e.entity);t.AddressInfo.ProvinceName=e.address.province_name,t.AddressInfo.ProvinceId=e.address.province,t.AddressInfo.CityName=e.address.city_name,t.AddressInfo.CityId=e.address.city,t.AddressInfo.DistrictId=e.address.district,t.AddressInfo.DistrictName=e.address.district_name,t.Birthday&&(t.Birthday=Math.round(new Date(d("date")(t.Birthday,"yyyy-MM-dd")).getTime()/1e3)),i.SaveMemberInfo(t).then(function(){e.isEdit=!1,e.saveloading=!1},function(){e.saveloading=!1})},e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.saveloading=!0,angular.forEach(e.entity.ListOther,function(t){angular.forEach(e.custom,function(e){e[t.Key]&&(t.Value=e[t.Key])})}),e.onSave()})}};var u=o(e,{vip:!0});e.tableParamsConsuming=u.tableParams(l.apiVip.card.GetConsumingLogPageListAndTotal,function(){var e={AId:t.accountBaseInfo.aid,MemberCardNo:a.id};return e}),e.tableParamsRecharge=u.tableParams(l.apiVip.card.GetRechargeLogPageListAndTotal,function(){var e={AId:t.accountBaseInfo.aid,MemberCardNo:a.id};return e}),e.tableParamsPoints=u.tableParams(l.apiVip.card.GetPointsLogPageListAndTotal,function(){var e={AId:t.accountBaseInfo.aid,MemberCardNo:a.id};return e}),e.onUploadAvatar=function(){e.isUploading=!0,i.UpdateMemberHeadUrl({AId:e.entity.AId,MemberCardNo:e.entity.MemberCardNo}).then(function(t){e.isUploading=!1,e.entity.HeadUrl=t.data},function(){e.isUploading=!1})}}]).controller("vipManageCreateLabelCtrl",["$scope","$rootScope","$stateParams","vipManageServer","$state","vipCardLevelServer",function(e,t,a,i,n,s){e.entity={AId:t.accountBaseInfo.aid,Type:1,ConditionType:0},e.activateDays=[{val:1,text:"今天开卡会员"},{val:7,text:"最近7天开卡会员"},{val:30,text:"最近30天开卡会员"}],e.consumingDays=[{val:1,text:"今天交易会员"},{val:7,text:"最近7天交易会员"},{val:30,text:"最近30天交易会员"}],e.sexs=[{val:1,text:"男"},{val:2,text:"女"}],e.address={},a.id&&(e.loading=!0,e.id=a.id,i.GetMemberCardTag({AId:t.accountBaseInfo.aid,Id:e.id}).then(function(t){t.data&&(t.data.ActivateDay&&(t.data.isActivateDay=!0),t.data.ConsumingDay&&(t.data.isConsumingDay=!0),t.data.LevelNo&&(t.data.isLevelNo=!0),t.data.Sex&&(t.data.isSex=!0),t.data.CityId&&(t.data.isAddress=!0,e.address.province=t.data.ProvinceId,e.address.city=t.data.CityId),(t.data.TransactionsCountMin||t.data.TransactionsCountMax)&&(t.data.isTransactionsCount=!0),(t.data.ConsumingAmountMin||t.data.ConsumingAmountMax)&&(t.data.isConsumingAmount=!0),(t.data.PerSalesMin||t.data.PerSalesMax)&&(t.data.isPerSales=!0),e.entity=t.data),e.loading=!1},function(){e.loading=!1})),s.GetMemberCardLevelSet(e.entity).then(function(t){t.data&&(e.levels=t.data.ListDetail)},function(){}),e.eventformvalidate={submitHandler:function(){e.$apply(function(){var t=angular.copy(e.entity);t.isAddress?(t.ProvinceId=e.address.province,t.CityId=e.address.city):(t.ProvinceId="",t.CityId=""),t.isActivateDay||delete t.ActivateDay,t.isConsumingDay||delete t.ConsumingDay,t.isSex||delete t.Sex,t.isLevelNo||delete t.LevelNo,t.isTransactionsCount||(delete t.TransactionsCountMin,delete t.TransactionsCountMax),t.isConsumingAmount||(delete t.ConsumingAmountMin,delete t.ConsumingAmountMax),t.isPerSales||(delete t.PerSalesMin,delete t.PerSalesMax),e.saveloading=!0,i.SaveMemberCardTag(t).then(function(){e.saveloading=!1,n.go("app.vip.manageLabel")},function(){e.saveloading=!1})})}},e.canSave=function(){return e.entity.isAddress||e.entity.isPerSales||e.entity.isActivateDay||e.entity.isConsumingDay||e.entity.isLevelNo||e.entity.isSex||e.entity.isTransactionsCount||e.entity.isConsumingAmount?!0:!1},e.onChange=function(t,a){e.entity[a]=e.entity[t]?1:0}}]).controller("setDegreeDialogCtrl",["$scope","$rootScope","$modalInstance","$toaster","data","vipCardLevelServer","vipManageServer",function(e,t,a,i,n,s,o){e.cancel=function(){a.dismiss("Canceled")},n&&n.vipDegrees?e.vipDegrees=n.vipDegrees:s.GetMemberCardLevelSet({AId:t.accountBaseInfo.aid}).then(function(t){t.data&&(e.vipDegrees=t.data.ListDetail)},function(){}),e.entity={level:{}},e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.saveloading=!0,o.ChangeMemberLevel({AId:t.accountBaseInfo.aid,NewLevelNo:e.entity.level.LevelNo,ListMemberCardNo:n.ids}).then(function(){e.saveloading=!1,a.close(e.entity.level)},function(){e.saveloading=!1})})}}}]).controller("setTagDialogCtrl",["$scope","$rootScope","$modalInstance","$toaster","data","vipManageServer",function(e,t,a,i,n,s){e.cancel=function(){a.dismiss("Canceled")};var o=[],l=!1,r=0;n&&n.noTags&&(o=n.noTags),n&&n.tags?(e.vipTags=[],angular.forEach(n.tags,function(t){if(0==t.Type){for(l=!1,r=0;r<o.length&&(o[r].Key!==t.Id&&o[r].Id!==t.Id);++r);r>=o.length&&e.vipTags.push(t)}})):s.GetMemberCardTagsPageListAndTotal({AId:t.accountBaseInfo.aid}).then(function(t){t.data&&(e.vipTags=[],angular.forEach(t.data.Items,function(t){if(0==t.Type){for(l=!1,r=0;r<o.length&&(o[r].Key!==t.Id&&o[r].Id!==t.Id);++r);r>=o.length&&e.vipTags.push(t)}}))},function(){}),e.entity={tag:{}},e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.saveloading=!0,s.DealMemberTag({AId:t.accountBaseInfo.aid,IsAdd:1,TagId:e.entity.tag.Id,ListMemberCardNo:n.ids}).then(function(){e.saveloading=!1,a.close(e.entity.tag)},function(){e.saveloading=!1})})}}}]).controller("rechargeDialogCtrl",["$scope","$rootScope","$modalInstance","$toaster","data","vipManageServer","$timeout",function(e,t,a,i,n,s,o){e.cancel=function(){a.dismiss("Canceled")},s.Spoutlet({aid:t.accountBaseInfo.aid}).then(function(t){t.data&&(e.stores=t.data)},function(){});var l=function(){e.member={},e.entity={AId:t.accountBaseInfo.aid,Operator:t.businessBaseInfo.username},n?(e.entity.MemberCardNo=n.MemberCardNo,e.member=n):(e.needQuery=!0,e.queryType=2)};l(),e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.saveloading=!0,s.RechargeForAdmin(e.entity).then(function(){e.saveloading=!1,a.close(e.entity)},function(){e.saveloading=!1})})}},e.clearMember=function(){e.member={},l()};var r;e.queryMember=function(a){r&&o.cancel(r),e.member.queried=!1,2==a&&e.member.Phone&&11!=e.member.Phone.length||(r=o(function(){r=null,e.queryError="";var i={AId:t.accountBaseInfo.aid};1==a?i.MemberCardNo=e.member.MemberCardNo:i.Phone=e.member.Phone,(i.MemberCardNo||i.Phone)&&s.GetMemberInfo(i).then(function(t){t.data?(e.member=t.data,e.member.queried=!0,e.entity.MemberCardNo=t.data.MemberCardNo):e.queryError="找不到此会员"},function(){})},300))}}]).controller("consumeDialogCtrl",["$scope","$rootScope","$modalInstance","$toaster","data","vipManageServer","vipCardLevelServer","vipMarketingServer","$timeout",function(e,t,a,i,n,s,o,l,r){e.cancel=function(){a.dismiss("Canceled")},e.coupons={0:[],1:[],all:[]},e.member={};var d=function(){e.entity={AId:t.accountBaseInfo.aid,Operator:t.businessBaseInfo.username,RealAmount:0,BlancheAmount:0,Points:0,CashAmount:0,BackAmount:0},e.PointAmount=0,e.member.queried=!1,e.member.isBlancheAmount=!1,e.member.isPoints=!1,e.member.isCashAmount=!1};d(),n?(e.member=n,e.entity.MemberCardNo=n.MemberCardNo,e.entity.Amount=n.Amount):(e.needQuery=!0,e.queryType=2),e.clearMember=function(){e.member={},d()};var c;e.queryMember=function(a){c&&r.cancel(c),d(),2==a&&e.member.Phone&&11!=e.member.Phone.length||(c=r(function(){c=null,e.queryError="";var i={AId:t.accountBaseInfo.aid};1==a?i.MemberCardNo=e.member.MemberCardNo:i.Phone=e.member.Phone,(i.MemberCardNo||i.Phone)&&s.GetMemberInfo(i).then(function(t){t.data?(e.member=t.data,e.member.queried=!0,e.entity.MemberCardNo=t.data.MemberCardNo,e.entity.Amount=t.data.Amount,m()):e.queryError="找不到此会员"},function(){})},300))},e.couponType=-1,e.discount=1,e.PointsPerYuan=1;var p,m=function(){p&&e.member.Level&&(angular.forEach(p,function(t){t.LevelNo==e.member.Level.Key&&(e.discount=t.Discount/100)}),s.GetMemberCouponPageListAndTotal({AId:t.accountBaseInfo.aid,MemberCardNo:e.entity.MemberCardNo,IsEffective:!0,PageIndex:1,PageSize:100}).then(function(t){t.data&&(e.coupons.all=t.data.Items,e.calcCoupons())},function(){}))};s.Spoutlet({aid:t.accountBaseInfo.aid}).then(function(a){a.data&&(e.stores=a.data),o.GetMemberCardLevelSet({AId:t.accountBaseInfo.aid}).then(function(a){a.data&&a.data.ListDetail&&(p=a.data.ListDetail,m()),l.GetMemberCardPointsRule({AId:t.accountBaseInfo.aid}).then(function(t){t&&t.data&&(e.PointsPerYuan=t.data.PointsPerYuan)},function(){})},function(){})},function(){}),e.eventformvalidate={submitHandler:function(){e.$apply(function(){return+e.entity.BackAmount+ +e.entity.RealAmount>+e.entity.CashAmount+ +e.entity.BlancheAmount+ +e.PointAmount?void i.warning("支付金额不足!"):e.entity.RealAmount>+e.entity.TotalAmount?void i.error("实收金额必须小于等于折后价"):e.entity.RealAmount<+e.entity.BlancheAmount?void i.error("余额支付金额不可大于实收金额"):e.entity.RealAmount<+e.entity.PointAmount?void i.error("积分抵现金额不可大于实收金额"):(e.saveloading=!0,void s.ConsumeForAdmin(e.entity).then(function(t){e.entity.cId=t.data,e.saveloading=!1,s.consumeResultDialog(e.entity).result.then(function(){}),a.close(e.entity)},function(){e.saveloading=!1}))})}},e.onChangeAmount=function(){e.changeAmount(),e.member.isBlancheAmount=!1,e.member.isPoints=!1,e.member.isCashAmount=!1},e.onSelectCouponType=function(t){1!=t&&(e.curCoupon=null,e.entity.SNNo="",e.calcAmount())},e.onSelectCoupon=function(t,a){e.curCoupon=null,1==t&&a&&angular.forEach(e.coupons[1],function(t){t.SNNo==a&&(e.curCoupon=t)}),e.calcAmount()},e.calcCoupons=function(){e.coupons[0]=[],e.coupons[1]=[],angular.forEach(e.coupons.all,function(t){0==t.CouponType?e.coupons[0].push(t):1==t.CouponType&&e.entity.TotalAmount&&e.entity.TotalAmount*e.discount>t.ConditionAmount&&e.coupons[1].push(t)})},e.calcAmount=function(){e.entity.RealAmount=e.entity.TotalAmount*e.discount,e.curCoupon&&(e.entity.RealAmount-=e.curCoupon.DiscountAmount),e.entity.RealAmount=e.entity.RealAmount.toFixed(2),e.member.isCashAmount&&(e.entity.CashAmount=e.entity.RealAmount)},e.changeAmount=function(){e.calcCoupons(),e.calcAmount()},e.$watch("member.isBlancheAmount",function(t){if(!t)return void(e.entity.BlancheAmount=0);if(e.member.Amount){var a=e.entity.RealAmount-e.PointAmount-e.entity.CashAmount;if(a=Math.round(100*a)/100,0>=a)return void(e.member.isBlancheAmount=!1);e.entity.BlancheAmount=e.member.Amount<a?e.member.Amount:a,e.entity.BlancheAmount=+e.entity.BlancheAmount.toFixed(2)}}),e.$watch("member.isPoints",function(t){if(!t)return e.entity.Points=0,void(e.PointAmount=0);if(e.member.Points){var a=e.entity.RealAmount-e.entity.BlancheAmount-e.entity.CashAmount;if(a=Math.round(100*a)/100,0>=a)return void(e.member.isPoints=!1);var i=e.member.Points/e.PointsPerYuan;a>i?(e.entity.Points=e.member.Points,a=i):e.entity.Points=parseInt(a*e.PointsPerYuan),e.PointAmount=(e.entity.Points/e.PointsPerYuan).toFixed(2)}}),e.$watch("member.isCashAmount",function(t){return t?(e.entity.CashAmount=e.entity.RealAmount-e.entity.BlancheAmount-e.PointAmount,e.entity.CashAmount=+Math.round(100*e.entity.CashAmount)/100,void(e.entity.CashAmount<=0?e.member.isCashAmount=!1:e.entity.CashAmount=+e.entity.CashAmount.toFixed(2))):(e.entity.CashAmount=0,void(e.entity.BackAmount=0))}),e.calcPointAmount=function(){e.PointAmount=e.entity.Points/e.PointsPerYuan,e.PointAmount=e.PointAmount.toFixed(2)},e.calcBackAmount=function(){e.entity.BackAmount=+e.entity.CashAmount+ +e.entity.BlancheAmount+ +e.PointAmount-e.entity.RealAmount,e.entity.BackAmount<0?e.entity.BackAmount=0:e.entity.BackAmount>+e.entity.CashAmount&&(e.entity.BackAmount=+e.entity.CashAmount),e.entity.BackAmount=e.entity.BackAmount.toFixed(2)}}]).controller("consumeResultDialogCtrl",["$scope","$rootScope","$modalInstance","$toaster","data","vipManageServer",function(e,t,a,i,n,s){e.cancel=function(){a.dismiss("Canceled")},e.entity=n,e.printTicket=function(){s.consumePrintDialog(n).result.then(function(){}),a.close()}}]).controller("consumePrintDialogCtrl",["$scope","$rootScope","$modalInstance","data","vipManageServer","vipCardManageServer","$timeout",function(e,t,a,i,n,s,o){e.cancel=function(){a.dismiss("Canceled")},e.pageLoading=!0,i.hasData?(e.entity=i.data,n.GetMemberInfo({AId:t.accountBaseInfo.aid,MemberCardNo:e.entity.MemberCardNo}).then(function(a){a.data?(e.entity.Amount=a.data.Amount,e.entity.StoreName="总店",e.entity.StoreId?n.Getspheader({aid:t.accountBaseInfo.aid,bid:t.accountBaseInfo.bid,spoutlet_id:e.entity.StoreId}).then(function(t){t.data&&(e.entity.tel=t.data.tel,e.entity.StoreName=t.data.name),e.pageLoading=!1,o(function(){e.printDiv=document.getElementById("print-div").innerHTML})},function(){e.pageLoading=!1}):s.GetMemberTemplate({UId:t.accountBaseInfo.bid,AId:t.accountBaseInfo.aid}).then(function(t){t&&t.data&&(e.entity.tel=t.data.ServicePhoneNo),e.pageLoading=!1,o(function(){e.printDiv=document.getElementById("print-div").innerHTML})},function(){e.pageLoading=!1})):e.pageLoading=!1},function(){e.pageLoading=!1})):n.GetConsumingLog({AId:t.accountBaseInfo.aid,Id:i.cId}).then(function(a){a.data?(e.entity=a.data,e.entity.Amount=i.Amount-a.data.BlancheAmount,e.entity.StoreName="总店",e.entity.StoreId?n.Getspheader({aid:t.accountBaseInfo.aid,bid:t.accountBaseInfo.bid,spoutlet_id:e.entity.StoreId}).then(function(t){t.data&&(e.entity.tel=t.data.tel,e.entity.StoreName=t.data.name),e.pageLoading=!1,o(function(){e.printDiv=document.getElementById("print-div").innerHTML})},function(){e.pageLoading=!1}):s.GetMemberTemplate({UId:t.accountBaseInfo.bid,AId:t.accountBaseInfo.aid}).then(function(t){t&&t.data&&(e.entity.tel=t.data.ServicePhoneNo),e.pageLoading=!1,o(function(){e.printDiv=document.getElementById("print-div").innerHTML})},function(){e.pageLoading=!1})):e.pageLoading=!1},function(){})}]).controller("pointsDialogCtrl",["$scope","$rootScope","$modalInstance","$toaster","data","vipManageServer","$timeout",function(e,t,a,i,n,s,o){e.cancel=function(){a.dismiss("Canceled")},s.Spoutlet({aid:t.accountBaseInfo.aid}).then(function(t){t.data&&(e.stores=t.data)},function(){}),e.member={},e.entity={AId:t.accountBaseInfo.aid,Operator:t.businessBaseInfo.username,Title:"手动修改积分"},n?(e.entity.MemberCardNo=n.MemberCardNo,e.member=n):(e.needQuery=!0,e.queryType=2),e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.saveloading=!0,+e.entity.Points>0?(e.entity.IsAboutGrowthValue=!0,e.entity.PointsPayType=5,e.entity.Title="手动增加积分"):(e.entity.IsAboutGrowthValue=!1,e.entity.PointsPayType=6,e.entity.Title="手动扣除积分"),s.ChangeMemberPoints(e.entity).then(function(){e.saveloading=!1,a.close(e.entity)},function(){e.saveloading=!1})})}},e.clearMember=function(){e.member={},init()};var l;e.queryMember=function(a){l&&o.cancel(l),e.member.queried=!1,2==a&&e.member.Phone&&11!=e.member.Phone.length||(l=o(function(){l=null,e.queryError="";var i={AId:t.accountBaseInfo.aid};1==a?i.MemberCardNo=e.member.MemberCardNo:i.Phone=e.member.Phone,(i.MemberCardNo||i.Phone)&&s.GetMemberInfo(i).then(function(t){t.data?(e.member=t.data,e.member.queried=!0,e.entity.MemberCardNo=t.data.MemberCardNo):e.queryError="找不到此会员"},function(){})},300))}}]).controller("useCouponDialogCtrl",["$scope","$rootScope","$modalInstance","$toaster","data","vipManageServer","$timeout",function(e,t,a,i,n,s,o){e.cancel=function(){a.dismiss("Canceled")},s.Spoutlet({aid:t.accountBaseInfo.aid}).then(function(t){t.data&&(e.stores=t.data)},function(){}),e.member={},e.entity={AId:t.accountBaseInfo.aid,Operator:t.businessBaseInfo.username};var l=function(){e.entity.MemberCardNo&&s.GetMemberCouponPageListAndTotal({AId:t.accountBaseInfo.aid,MemberCardNo:e.entity.MemberCardNo,IsEffective:!0,PageIndex:1,PageSize:100}).then(function(t){t.data&&(e.coupons=[],angular.forEach(t.data.Items,function(t){0==t.CouponType&&e.coupons.push(t)}))},function(){})};n?(e.entity.MemberCardNo=n.MemberCardNo,l()):(e.needQuery=!0,e.queryType=2),e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.saveloading=!0,s.UseMemberCoupon(e.entity).then(function(){e.saveloading=!1,a.close(e.entity)},function(){e.saveloading=!1})})}};var r;e.queryMember=function(a){r&&o.cancel(r),e.coupons=[],e.member.queried=!1,2==a&&e.member.Phone&&11!=e.member.Phone.length||(r=o(function(){r=null,e.queryError="";var i={AId:t.accountBaseInfo.aid};1==a?i.MemberCardNo=e.member.MemberCardNo:i.Phone=e.member.Phone,(i.MemberCardNo||i.Phone)&&s.GetMemberInfo(i).then(function(t){t.data?(e.member=t.data,e.member.queried=!0,e.entity.MemberCardNo=t.data.MemberCardNo,l()):e.queryError="找不到此会员"},function(){})},300))}}]).controller("setRemarkNameDialogCtrl",["$scope","$rootScope","$modalInstance","$toaster","data","vipManageServer","$timeout",function(e,t,a,i,n,s){e.cancel=function(){a.dismiss("Canceled")},e.entity=n,e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.saveloading=!0,s.UpdateMemberRemarkName({AId:e.entity.AId,MemberCardNo:e.entity.MemberCardNo,RemarkName:e.entity.NickName}).then(function(){e.saveloading=!1,a.close(e.entity)},function(){e.saveloading=!1})})}}}]).controller("createLabelDialogCtrl",["$scope","$rootScope","$modalInstance","$toaster","data","vipManageServer","$timeout",function(e,t,a,i,n,s){e.cancel=function(){a.dismiss("Canceled")},e.entity=n,e.entity&&e.entity.Id||(e.entity={AId:t.accountBaseInfo.aid,Type:0}),e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.saveloading=!0,s.SaveMemberCardTag(e.entity).then(function(){e.saveloading=!1,a.close(e.entity)},function(){e.saveloading=!1})})}}}]).filter("hobby",function(){return function(e){return 1==e?"游戏":2==e?"阅读":3==e?"音乐":4==e?"运动":5==e?"动漫":6==e?"旅行":7==e?"家居":8==e?"曲艺":9==e?"宠物":10==e?"娱乐":11==e?"电影":12==e?"电视剧":13==e?"健康养生":14==e?"数码":15==e?"美食":"其他"}}).filter("sex",function(){return function(e){return 1==e?"男":2==e?"女":"其他"}}).filter("profession",function(){return function(e){return 1==e?"IT/互联网/通信/电子":2==e?"金融/投资/财会":3==e?"广告/媒体/出版/艺术":4==e?"市场/销售/客服":5==e?"人事/行政/管理":6==e?"建筑/房产/物业":7==e?"消费品/贸易/物流":8==e?"咨询/法律/认证":9==e?"生产/制造/营运/采购":10==e?"生物/制药/医疗/护理":11==e?"教育/培训/翻译":12==e?"科研/环保/休闲/其他":"其他"}}).filter("income",function(){return function(e){return 1==e?"5-15万":2==e?"15万-30万":3==e?"30万以上":"5万以下"}}).filter("memberStatus",function(){return function(e){return 0==e?"已领卡":1==e?"生效中":2==e?"已冻结":3==e?"已过期":4==e?"未开始":""}}).filter("userFromType",function(){return function(){return"未知"
}}).filter("pointsPayType",function(){return function(e){return 1==e?"消费赠送":2==e?"兑换使用":3==e?"生日赠送":4==e?"活动赠送":5==e?"手动增加":6==e?"手动扣除":7==e?"签到赠送":8==e?"分享赠送":9==e?"消费使用":10==e?"开卡赠送":11==e?"充值赠送":12==e?"积分规则扣除":"未知"}}).filter("pointsType",function(){return function(e){return 1==e?"+":2==e?"+":3==e?"+":4==e?"+":5==e?"+":6==e?"-":7==e?"+":8==e?"+":9==e?"-":"+"}}).filter("degree",function(){return function(e){return 1==e?"小学":2==e?"初中":3==e?"高中":4==e?"大专":5==e?"大学":6==e?"研究生":""}}).filter("memberStatus",function(){return function(e){return 0==e?"已领卡":1==e?"生效中":2==e?"已冻结":3==e?"已过期":4==e?"未开始":""}}).filter("discount",function(){return function(e){return+e>99?"无":e=e%10===0?parseInt(e/10):(e/10).toFixed(1)}}),angular.module("ngTicket").directive("zeroclipboardCtrl",["$toaster","$timeout",function(e,t){return{restrict:"A",scope:{zeroclipboardCtrl:"=",copyComplete:"&?"},link:function(a,i){ZeroClipboard.setDefaults({moviePath:"/zeroclipboard/1.2.0/zeroclipboard.swf"});var n="zeroclipboard-"+Date.now(),s=document.createElement("textarea");$(i).attr("data-clipboard-target",n),s.id=n,s.style.display="none",document.body.appendChild(s),a.$watch("zeroclipboardCtrl",function(e){s.innerHTML=e},!0);var o=new ZeroClipboard(i,{forceEnhancedClipboard:!0});o.on("complete",function(){a.copyComplete&&a.copyComplete(),t(function(){e.success("复制成功,请粘帖到您需要的地方")})})}}}]),angular.module("ngTicket").directive("uploadImgList",["Upload","$config","$rootScope","$toaster","$locale","ipCookie",function(e,t,a,i,n,s){return{restrict:"AE",scope:{fileList:"=?",fileUrl:"=?",fileUrls:"=?",maxCount:"=?",maxSizeFile:"=?",tip:"@?"},templateUrl:"/app/components/upload/upload.img.html",link:function(o){o.del=function(e){o.fileList.splice(e,1)},o.maxCount=o.maxCount||5,o.maxSizeFile=o.maxSizeFile||2,o.fileList=o.fileList||[],o.fileUrls=o.fileUrls||[];var l=function(){return o.maxCount-o.fileList.length};o.upload=function(r){if(r){var d=l();if(d<r.length)return i.info(n.FORMTIPS.uplodMax.format(d)),!1;for(var c=0;c<r.length;c++){var p=r[c];p.success=!0,p.size/1048576>o.maxSizeFile?i.warning(n.FORMTIPS.uplodSizeMax.format(o.maxSizeFile)):(o.freLoading=!0,p.success=!1,e.upload({url:t.api3.upload.upfile,headers:{weimobAuthData:s(window.env.cookieName||"weimobAuthData"),Apiclient:"weimob-pc"},data:{imgFile:p,aid:a.accountBaseInfo.aid,bid:a.accountBaseInfo.bid}}).then(function(e){p.success=!0,e.data.data&&e.data.data.url?(o.fileList.push(e.data.data),o.fileUrl=e.data.data.url):i.info(e.data.message),o.freLoading=!1},function(e){p.success=!0,console.log("Error status: "+e.status)},function(e){p.fileProgress=parseInt(100*e.loaded/e.total),o.fileProgress=parseInt(100*e.loaded/e.total)}))}}}}}}]).directive("uploadFileList",["Upload","$config","$rootScope","$toaster","$locale",function(e,t,a,i,n){return{restrict:"AE",scope:{fileList:"=?",maxSizeFile:"=?",maxCount:"=?"},templateUrl:"/app/components/upload/upload.file.html",link:function(s){s.del=function(e){s.fileList.splice(e,1)},s.maxCount=s.maxCount||5,s.maxSizeFile=s.maxSizeFile||2,s.fileList=s.fileList||[];var o=function(){return s.maxCount-s.fileList.length};s.upload=function(l){if(l){var r=o();if(r<l.length)return i.info(n.FORMTIPS.uplodMax.format(r)),!1;for(var d=0;d<l.length;d++){var c=l[d];c.success=!0,c.size/1048576>s.maxSizeFile?i.warning(n.FORMTIPS.uplodSizeMax.format(s.maxSizeFile)):(s.freLoading=!0,c.success=!1,e.upload({url:t.api3.upload.upfile,headers:{weimobAuthData:ipCookie(window.env.cookieName||"weimobAuthData"),Apiclient:"weimob-pc"},data:{imgFile:c,aid:a.accountBaseInfo.aid,bid:a.accountBaseInfo.bid}}).then(function(e){c.success=!0,console.info(111,e),e.data.data&&e.data.data.url?s.fileList.push(e.data.data):i.info(e.data.message),s.freLoading=!1},function(e){c.success=!0,console.log("Error status: "+e.status)},function(e){c.fileProgress=parseInt(100*e.loaded/e.total),s.fileProgress=parseInt(100*e.loaded/e.total)}))}}}}}}]).directive("uploadButton",["Upload","$config","$rootScope","$toaster","$locale","ipCookie",function(e,t,a,i,n,s){return{restrict:"AE",scope:{buttonClass:"@?",buttonText:"@?",uploadUrl:"@",uploadFinished:"&?",ngfAccept:"=",maxSizeFile:"=?"},templateUrl:"/app/components/upload/upload.button.html",link:function(i){i.buttonClass||(i.buttonClass="btn btn-default btn-sm"),i.maxSizeFile=i.maxSizeFile||2,i.upload=function(n){n&&(i.uploading=!0,e.upload({url:i.uploadUrl||t.api3.upload.upfile,headers:{weimobAuthData:s(window.env.cookieName||"weimobAuthData"),Apiclient:"weimob-pc"},data:{files:n,AId:a.accountBaseInfo.aid}}).then(function(e){i.uploading=!1,i.uploadFinished&&i.uploadFinished({data:e})},function(e){i.uploading=!1,console.log("Error status: "+e.status)},function(e){i.progressPercentage=parseInt(100*e.loaded/e.total)}))}}}}]),!function(e){var t={membersp:"p"},i=function(t,a){return a||(a={}),{id:t.id,parent:t.parentid||"#",text:t.name,state:{opened:a.selected?t.id==a.selected||-1==a.selected&&0==t.parentid:0==t.parentid,disabled:t.is_readonly,selected:e.inArray(t.id,a.selected)>-1},wid:t.wid}},n=function(e,t){t||(t={});var a={id:e.id,name:e.name,keywords:[e.name,e.pinyinname],wid:e.wid,readonly:t.readonly};return e.name&&a.keywords.push(e.name),e.pinyinname&&a.keywords.push(e.pinyinname),a},s=function(e,a){a||(a={});var i={id:t.membersp+e.id,name:e.username,username:e.username,keywords:[],thumb_path:e.thumb_path,readonly:a.readonly,JoinStatus:e.JoinStatus};return e.username&&i.keywords.push(e.username),e.pinyinname&&i.keywords.push(e.pinyinname),e.bizmpid&&i.keywords.push(e.bizmpid),i};e.tokenInputConverter={party2node:function(e,t){return i(e,t)},forparty2node:function(t,a){var n=[];return e.each(t,function(e,t){n.push(i(t,a))}),n},party2token:function(){return n(item,options)},forparty2token:function(t,a){var i=[];return e.each(t,function(e,t){i.push(n(t,a))}),i},member2token:function(e,t){return s(e,t)},formember2token:function(t,a){var i=[];return e.each(t,function(e,t){i.push(s(t,a))}),i},membersForValue:function(e){var t=e.split(","),i=[];return a.each(t,function(e,t){t&&t[0]!=b&&i.push(t)}),i},partiesForValue:function(e){var t=e.split(","),i=[];return a.each(t,function(e,t){t&&t[0]==b&&i.push(t.substr(1))}),i}}}(jQuery),!function(e){function t(e){return e.replace(n,function(e){return i[e]})}var a={membersp:"p"},i={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"},n=/[&<>"'\/]/g,s={init:function(i,n,s,o){var l=this,r=l.data("organization"),d=function(t){if(!l.data("jstree")){var a=e('<div class="token-input-jstree">token-input-jstree</div>').appendTo(t).on("select_node.jstree",function(e,t){l.data("tokeninput").tokenInput("add",{id:t.node.id,name:t.node.text})});a.jstree({core:{themes:{name:!1,url:!1,dir:!1,icons:!0,variant:!1,stripes:!1,responsive:!0,dots:!0},data:n},types:{"default":{icon:"icon icon_folder_blue"}},plugins:["wholerow","types"]}),l.data("jstree",a)}},c=function(e){var i=e.id.toString(),n=e.name;return i[0]==a.membersp?"<li><img src='"+e.thumb_path+"' style='float:left;width:26px;height:26px;margin-right:6px'><span>"+(this.enableHTML?n:t(n))+"</span></li>":"<li><i style='color:#C9DDF6;' class='fa fa-folder m-r-xs'></i>"+(this.enableHTML?n:t(n))+"</li>"},p=function(e){var i=e.id.toString(),n=e.name;return i[0]==a.membersp?"<li><img src='"+e.thumb_path+"' style='float:left;width:26px;height:26px'><p class='group_item_name'>"+(this.enableHTML?n:t(n))+"</p></li>":"<li><p class='group_item_name'><i style='color:#6EA6E7;' class='fa fa-folder m-r-xs'></i>"+(this.enableHTML?n:t(n))+"</p></li>"},m={propertyToSearch:"keywords",searchDelay:50,searchingText:null,resultsLimit:20,excludeCurrent:!0,preventDuplicates:!0,animateDropdown:!1,hintText:r?"输入搜索条件":n&&n.length?d:"请输入目录名称",resultsFormatter:c,tokenFormatter:p};s=e.extend({},m,s);var u=l.tokenInput(i,s);o&&e.each(n,function(t,a){e.inArray(a.id,o)>-1&&u.tokenInput("add",{id:a.id.toString(),name:a.text,wid:a.wid})}),l.data("tokeninput",u)},destroy:function(){this.data("jstree")&&(this.data("jstree").jstree().destroy(),this.removeData("jstree")),this.data("tokeninput")&&(this.data("tokeninput").tokenInput("destroy"),this.removeData("tokeninput"))},addtoken:function(){}};e.fn.tokenInputTree=function(e){return s[e]?s[e].apply(this,Array.prototype.slice.call(arguments,1)):s.init.apply(this,arguments)}}(jQuery),angular.module("ngTicket").directive("tokeninputTree",["$rootScope",function(e){return{restrict:"AE",require:"ngModel",scope:{costom:"&"},link:function(t,a,i,n){var s=$(a),o=s.data("path"),l=(s.data("contact"),s.data("selected")),r=(s.data("selectedContact"),s.data("tokenLimit")),d=s.data("part"),c=s.data("submit"),p=(s.data("organization"),s.data("member"),"");c?p=c:(p="js_no_submit_css",c="js_space_tree_placeholder");var m=function(){t.$apply(function(){n.$setViewValue(a.tokenInput("get")),t.costom()})};o&&$.ajax(o,{type:"get",data:d?{department:l}:!1,beforeSend:function(t){t.setRequestHeader("Authorization",e.locals.access_token)},dataType:"json"}).done(function(e){s.tokenInputTree($.tokenInputConverter.forparty2token(e),$.tokenInputConverter.forparty2node(e),{classes:{dropdown:"token-input-dropdown memberDialog_selectTree "+p},onAdd:m,onDelete:m,tokenLimit:r||999},n.$viewValue||[])})}}}]),angular.module("ngTicket").directive("jsTree",["$rootScope",function(e){return{restrict:"AE",require:"?ngModel",scope:{costom:"&",selected:"=?"},link:function(t,a,i,n){var s=$(a),o=s.data("methodPath"),l=s.data("edit");o&&$.ajax(o,{type:"get",beforeSend:function(t){t.setRequestHeader("Authorization",e.locals.access_token)},dataType:"json"}).done(function(e){var i=$.tokenInputConverter.forparty2node(e,{selected:t.selected||[-1]});s.jstree({core:{data:i,check_callback:function(){return!0},themes:{name:!1,url:!1,dir:!1,icons:!0,variant:!1,stripes:!1,responsive:!0,dots:!0}},contextmenu:{select_node:!1,items:function(){if(l){var e=$.jstree.defaults.contextmenu.items();return e.create.label="添加子部门",e.create.action=function(e){var t=$.jstree.reference(e.reference),a=t.get_node(e.reference);t.create_node(a,{type:"default",text:"新建部门"},"last",function(e){setTimeout(function(){t.edit(e)},0)})},e.rename.label="重命名",e.remove.label="删除",e.remove.action=function(e){var t=$.jstree.reference(e.reference),a=t.get_node(e.reference);config.msg.msgbox.confirm("<p>确定删除 {0} ?</p><p>没有子部门且没有成员的部门才可以被删除。</p>".format(a.text),function(e){e&&method.postd(o.format("delete"),function(e){config.issucceed(e)?t.delete_node(t.is_selected(a)?t.get_selected():a):config.msg.error(e.message||config.lang.removeError,e.url)},{id:a.id})})},delete e.ccp,e}}},types:{"default":{icon:"icon icon_folder_blue"}},plugins:["types","contextmenu","wholerow"]}).on("delete_node.jstree",function(){}).on("create_node.jstree",function(e,t){method.postd(o.format("create"),function(e){t.instance.set_id(t.node,e.id)},{type:t.node.type,pid:t.node.parent,text:t.node.text})}).on("rename_node.jstree",function(e,t){method.postd(o.format("rename"),function(e){t.instance.set_id(t.node,e.id)},{id:t.node.id,text:t.text})}).on("select_node.jstree",function(e,a){t.$apply(function(){n.$setViewValue([{name:a.node.text,id:a.node.id}]),t.costom()})}).on("ready.jstree",function(){t.selected&&t.selected[0]&&$(a).scrollTop($("#"+t.selected[0]).position().top+$(a).scrollTop())})})}}}]),!function(e){function t(e){return String(null===e||void 0===e?"":e)}function a(e){return t(e).replace(r,function(e){return l[e]})}var i={method:"GET",queryParam:"q",searchDelay:300,minChars:1,propertyToSearch:"name",propertyToDisplay:"name",jsonContainer:null,contentType:"json",excludeCurrent:!1,excludeCurrentParameter:"x",prePopulate:null,processPrePopulate:!1,hintText:"Type in a search term",noResultsText:"无搜索结果",searchingText:"Searching...",deleteText:"&#215;",animateDropdown:!0,placeholder:null,theme:null,zindex:9999,resultsLimit:null,enableHTML:!1,resultsFormatter:function(e){var t=e[this.propertyToDisplay];return"<li>"+(this.enableHTML?t:a(t))+"</li>"},tokenFormatter:function(e){var t=e[this.propertyToDisplay];return"<li><p class='group_item_name'>"+(this.enableHTML?t:a(t))+"</p></li>"},tokenLimit:null,tokenDelimiter:",",preventDuplicates:!1,tokenValue:"id",allowFreeTagging:!1,allowTabOut:!1,autoSelectFirstResult:!1,onResult:null,onCachedResult:null,onAdd:null,onFreeTaggingAdd:null,onDelete:null,onReady:null,idPrefix:"token-input-",disabled:!1},n={tokenList:"token-input-list input_text",token:"token-input-token group_item",tokenReadOnly:"token-input-token-readonly",tokenDelete:"token-input-delete-token  group_item_close",selectedToken:"token-input-selected-token",highlightedToken:"token-input-highlighted-token",dropdown:"token-input-dropdown",dropdownItem:"token-input-dropdown-item",dropdownItem2:"token-input-dropdown-item2",selectedDropdownItem:"token-input-selected-dropdown-item",inputToken:"token-input-input-token",focused:"token-input-focused",disabled:"token-input-disabled"},s={BEFORE:0,AFTER:1,END:2},o={BACKSPACE:8,TAB:9,ENTER:13,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,NUMPAD_ENTER:108,COMMA:188},l={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","/":"&#x2F;"},r=/[&<>"'\/]/g,d={init:function(t,a){var n=e.extend({},i,a||{});return this.each(function(){e(this).data("settings",n),e(this).data("tokenInputObject",new e.TokenList(this,t,n))})},clear:function(){return this.data("tokenInputObject").clear(),this},add:function(e){return this.data("tokenInputObject").add(e),this},remove:function(e){return this.data("tokenInputObject").remove(e),this},get:function(){return this.data("tokenInputObject").getTokens()},toggleDisabled:function(e){return this.data("tokenInputObject").toggleDisabled(e),this},setOptions:function(t){return e(this).data("settings",e.extend({},e(this).data("settings"),t||{})),this},destroy:function(){if(this.data("tokenInputObject")){this.data("tokenInputObject").destroy();var e=this,t=this.parent();return t.empty(),e.show(),t.append(e),e}}};e.fn.tokenInput=function(e){return d[e]?d[e].apply(this,Array.prototype.slice.call(arguments,1)):d.init.apply(this,arguments)},e.TokenList=function(t,i,l){function r(i){return e(t).data("settings").enableHTML?i:a(i)}function d(a){e(t).data("settings").disabled="boolean"==typeof a?a:!e(t).data("settings").disabled,V.attr("disabled",e(t).data("settings").disabled),W.toggleClass(e(t).data("settings").classes.disabled,e(t).data("settings").disabled),z&&f(e(z),s.END),U.attr("disabled",e(t).data("settings").disabled)}function c(){return null!==e(t).data("settings").tokenLimit&&q>=e(t).data("settings").tokenLimit?(V.hide(),void w()):void 0}function p(){if(G!==(G=V.val())){var e=W.width()-V.offset().left-W.offset().left;tt.html(a(G)||a(l.placeholder)),V.width(Math.min(W.width(),Math.max(e,tt.width()+30)))}}function m(){var a=e.trim(V.val()),i=a.split(e(t).data("settings").tokenDelimiter);e.each(i,function(a,i){if(i){e.isFunction(e(t).data("settings").onFreeTaggingAdd)&&(i=e(t).data("settings").onFreeTaggingAdd.call(U,i));var n={};n[e(t).data("settings").tokenValue]=n[e(t).data("settings").propertyToDisplay]=i,h(n)}})}function u(a){var i=e(e(t).data("settings").tokenFormatter(a)),n=a.readonly===!0?!0:!1;n&&i.addClass(e(t).data("settings").classes.tokenReadOnly),i.addClass(e(t).data("settings").classes.token).insertBefore(Y),n||e("<span>").addClass(e(t).data("settings").classes.tokenDelete+" js_close").appendTo(i).click(function(){return e(t).data("settings").disabled?void 0:(b(e(this).parent()),U.change(),U.data("submit")&&U.closest("form").submit(),!1)});var s=a;return e.data(i.get(0),"tokeninput",a),R=R.slice(0,H).concat([s]).concat(R.slice(H)),H++,y(R,U),q+=1,null!==e(t).data("settings").tokenLimit&&q>=e(t).data("settings").tokenLimit&&(V.hide(),w()),i}function h(a){var i=e(t).data("settings").onAdd;if(q>0&&e(t).data("settings").preventDuplicates){var n=null;if(W.children().each(function(){var t=e(this),i=e.data(t.get(0),"tokeninput");return i&&i[l.tokenValue]===a[l.tokenValue]?(n=t,!1):void 0}),n)return}V.width(1),(null==e(t).data("settings").tokenLimit||q<e(t).data("settings").tokenLimit)&&(u(a),V.attr("placeholder",null),c()),V.val(""),w(),e.isFunction(i)&&i.call(U,a)}function g(a){e(t).data("settings").disabled||(a.addClass(e(t).data("settings").classes.selectedToken),z=a.get(0),V.val(""),w())}function f(a,i){a.removeClass(e(t).data("settings").classes.selectedToken),z=null,i===s.BEFORE?(Y.insertBefore(a),H--):i===s.AFTER?(Y.insertAfter(a),H++):(Y.appendTo(W),H=q),E(V)}function v(t){var a=z;z&&f(e(z),s.END),a===t.get(0)?f(t,s.END):g(t)}function b(a){var i=e.data(a.get(0),"tokeninput"),n=e(t).data("settings").onDelete,s=a.prevAll().length;s>H&&s--,a.remove(),z=null,E(V),R=R.slice(0,s).concat(R.slice(s+1)),0==R.length&&(V.attr("placeholder",l.placeholder),V.css("width","auto")),H>s&&H--,y(R,U),q-=1,null!==e(t).data("settings").tokenLimit&&(V.show().val(""),E(V)),e.isFunction(n)&&n.call(U,i)}function y(a,i){var n=e.map(a,function(a){return"function"==typeof e(t).data("settings").tokenValue?e(t).data("settings").tokenValue.call(this,a):a[e(t).data("settings").tokenValue]});i.val(n.join(e(t).data("settings").tokenDelimiter))}function w(){Q.hide(),J=null}function x(){Q.css({position:"absolute",top:W.offset().top+W.outerHeight(!0)-1,left:W.offset().left,width:W.innerWidth(),"z-index":e(t).data("settings").zindex}).show()}function _(t){Q.children("div").each(function(a,i){t.get(0)==i&&e(this).show()||e(this).hide()})}function k(){e(t).data("settings").hintText&&("string"===e.type(e(t).data("settings").hintText)?X.html("<p>"+r(e(t).data("settings").hintText)+"</p>"):"function"===e.type(e(t).data("settings").hintText)&&e(t).data("settings").hintText(X),_(X),x())}function C(){e(t).data("settings").searchingText&&(Z.html("<p>"+r(e(t).data("settings").searchingText)+"</p>"),_(Z))}function M(){_(et)}function T(e){return e.replace(it,"\\$&")}function $(e,t){return e.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+T(t)+")(?![^<>]*>)(?![^&;]+;)","gi"),function(e,t){return"<b>"+r(t)+"</b>"})}function P(e,t,a){return e.replace(new RegExp("(?![^&;]+;)(?!<[^<>]*)("+T(t)+")(?![^<>]*>)(?![^&;]+;)","g"),$(t,a))}function S(a){if(e(t).data("settings").excludeCurrent){var i=e(t).data("tokenInputObject").getTokens(),n=[];i.length&&(e.each(a,function(a,s){var o=!0;e.each(i,function(a,i){return s[e(t).data("settings").propertyToDisplay]==i[e(t).data("settings").propertyToDisplay]?(o=!1,!1):void 0}),o&&n.push(s)}),a=n)}return a}function I(a,i){if(i=S(i),i&&i.length){et.empty();var n=e("<ul/>").appendTo(et).mouseover(function(t){A(e(t.target).closest("li"))}).mousedown(function(t){return h(e(t.target).closest("li").data("tokeninput")),U.change(),U.data("submit")&&U.closest("form").submit(),!1}).hide();e(t).data("settings").resultsLimit&&i.length>e(t).data("settings").resultsLimit&&(i=i.slice(0,e(t).data("settings").resultsLimit)),e.each(i,function(i,s){var o=e(t).data("settings").resultsFormatter(s);o=P(o,s[e(t).data("settings").propertyToDisplay],a),o=e(o).appendTo(n),o.addClass(i%2?e(t).data("settings").classes.dropdownItem:e(t).data("settings").classes.dropdownItem2),0===i&&e(t).data("settings").autoSelectFirstResult&&A(o),e.data(o.get(0),"tokeninput",s)}),M(),e(t).data("settings").animateDropdown?n.slideDown("fast"):n.show()}else e(t).data("settings").noResultsText&&(et.html("<p>"+r(e(t).data("settings").noResultsText)+"</p>"),M())}function A(a){a&&(J&&D(e(J)),a.addClass(e(t).data("settings").classes.selectedDropdownItem),J=a.get(0))}function D(a){a.removeClass(e(t).data("settings").classes.selectedDropdownItem),J=null}function L(){var a=V.val();a&&a.length&&(z&&f(e(z),s.AFTER),a.length>=e(t).data("settings").minChars?(C(),clearTimeout(O),O=setTimeout(function(){j(a)},e(t).data("settings").searchDelay)):w())}function j(a){var i=a+N(),n=F.get(i);if(n)e.isFunction(e(t).data("settings").onCachedResult)&&(n=e(t).data("settings").onCachedResult.call(U,n)),I(a,n);else if(e(t).data("settings").url){var s=N(),o={};if(o.data={},s.indexOf("?")>-1){var r=s.split("?");o.url=r[0];var d=r[1].split("&");e.each(d,function(e,t){var a=t.split("=");o.data[a[0]]=a[1]})}else o.url=s;if(o.data[e(t).data("settings").queryParam]=a,o.type=e(t).data("settings").method,o.dataType=e(t).data("settings").contentType,e(t).data("settings").crossDomain&&(o.dataType="jsonp"),e(t).data("settings").excludeCurrent){var c=e(t).data("tokenInputObject").getTokens(),p=e.map(c,function(a){return"function"==typeof e(t).data("settings").tokenValue?e(t).data("settings").tokenValue.call(this,a):a[e(t).data("settings").tokenValue]});o.data[e(t).data("settings").excludeCurrentParameter]=p.join(e(t).data("settings").tokenDelimiter)}o.success=function(n){F.add(i,e(t).data("settings").jsonContainer?n[e(t).data("settings").jsonContainer]:n),e.isFunction(e(t).data("settings").onResult)&&(n=e(t).data("settings").onResult.call(U,n)),V.val()===a&&I(a,e(t).data("settings").jsonContainer?n[e(t).data("settings").jsonContainer]:n)},l.onSend&&l.onSend(o),e.ajax(o)}else if(e(t).data("settings").local_data){var m=e.grep(e(t).data("settings").local_data,function(i){var n=i[e(t).data("settings").propertyToSearch];if(e.isArray(n)){var s=!1;return e.each(n,function(e,t){return t.toLowerCase().indexOf(a.toLowerCase())>-1?(s=!0,!1):void 0}),s}return n.toLowerCase().indexOf(a.toLowerCase())>-1});F.add(i,m),e.isFunction(e(t).data("settings").onResult)&&(m=e(t).data("settings").onResult.call(U,m)),I(a,m)}}function N(){var a=e(t).data("settings").url;return"function"==typeof e(t).data("settings").url&&(a=e(t).data("settings").url.call(e(t).data("settings"))),a}function E(e){setTimeout(function(){e.focus()},50)}if("string"==typeof i||"function"==typeof i){e(t).data("settings").url=i;var B=N();void 0===e(t).data("settings").crossDomain&&"string"==typeof B&&(e(t).data("settings").crossDomain=-1===B.indexOf("://")?!1:location.href.split(/\/+/g)[1]!==B.split(/\/+/g)[1])}else"object"==typeof i&&(e(t).data("settings").local_data=i);e(t).data("settings").classes?e(t).data("settings").classes=e.extend({},n,e(t).data("settings").classes):e(t).data("settings").theme?(e(t).data("settings").classes={},e.each(n,function(a,i){e(t).data("settings").classes[a]=i+"-"+e(t).data("settings").theme})):e(t).data("settings").classes=n;var O,G,R=[],q=0,F=new e.TokenList.Cache,V=e('<input type="text" class="input_group_add" autocomplete="off" autocapitalize="off"/>').css({outline:"none"}).attr("id",e(t).data("settings").idPrefix+t.id).focus(function(){return e(t).data("settings").disabled?!1:((null===e(t).data("settings").tokenLimit||e(t).data("settings").tokenLimit!==q)&&k(),void W.addClass(e(t).data("settings").classes.focused))}).blur(function(){K?E(V):w(),e(t).data("settings").allowFreeTagging&&m(),e(this).val(""),W.removeClass(e(t).data("settings").classes.focused)}).bind("keyup keydown blur update",p).keydown(function(a){var i,n;switch(a.keyCode){case o.LEFT:case o.RIGHT:case o.UP:case o.DOWN:if(0===this.value.length)i=Y.prev(),n=Y.next(),i.length&&i.get(0)===z||n.length&&n.get(0)===z?a.keyCode===o.LEFT||a.keyCode===o.UP?f(e(z),s.BEFORE):f(e(z),s.AFTER):a.keyCode!==o.LEFT&&a.keyCode!==o.UP||!i.length?a.keyCode!==o.RIGHT&&a.keyCode!==o.DOWN||!n.length||g(e(n.get(0))):g(e(i.get(0)));else{var l=null;a.keyCode===o.DOWN||a.keyCode===o.RIGHT?(l=e(et).find("li").first(),J&&(l=e(J).next())):(l=e(et).find("li").last(),J&&(l=e(J).prev())),A(l)}break;case o.BACKSPACE:if(i=Y.prev(),0===this.value.length)return z?e(z).hasClass(e(t).data("settings").classes.tokenReadOnly)||(b(e(z)),U.change(),U.data("submit")&&U.closest("form").submit()):i.length?g(e(i.get(0))):(w(),k()),!1;1===this.value.length?(w(),k()):setTimeout(function(){L()},5);break;case o.TAB:case o.ENTER:case o.NUMPAD_ENTER:case o.COMMA:if(J)h(e(J).data("tokeninput")),U.change(),k();else{if(e(t).data("settings").allowFreeTagging){if(e(t).data("settings").allowTabOut&&""===e(this).val())return!0;m()}else if(e(this).val(""),e(t).data("settings").allowTabOut)return!0;a.stopPropagation(),a.preventDefault()}return!1;case o.ESCAPE:return w(),!0;default:0===this.value.length&&(w(),k()),String.fromCharCode(a.which)&&setTimeout(function(){L()},5)}});l.placeholder&&V.attr("placeholder",l.placeholder);var U=e(t).hide().val("").focus(function(){E(V)}).blur(function(){return V.blur(),U}),z=null,H=0,J=null,W=e("<ul />").addClass(e(t).data("settings").classes.tokenList).click(function(t){var a=e(t.target).closest("li");a&&a.get(0)&&e.data(a.get(0),"tokeninput")?v(a):(z&&f(e(z),s.END),E(V))}).mouseover(function(a){var i=e(a.target).closest("li");i&&z!==this&&i.addClass(e(t).data("settings").classes.highlightedToken)}).mouseout(function(a){var i=e(a.target).closest("li");i&&z!==this&&i.removeClass(e(t).data("settings").classes.highlightedToken)}).insertBefore(U),Y=e("<li />").addClass(e(t).data("settings").classes.inputToken).appendTo(W).append(V),K=!1,Q=e("<div/>").addClass(e(t).data("settings").classes.dropdown).appendTo("body").hide().mousemove(function(){K=!0}).mouseout(function(){K=!1}),X=e("<div id='token-input-dropdown-hint'/>").appendTo(Q).hide(),Z=e("<div id='token-input-dropdown-searching'/>").appendTo(Q).hide(),et=e("<div id='token-input-dropdown-result'/>").appendTo(Q).hide(),tt=e("<tester/>").insertAfter(V).css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:V.css("fontSize"),fontFamily:V.css("fontFamily"),fontWeight:V.css("fontWeight"),letterSpacing:V.css("letterSpacing"),whiteSpace:"nowrap"});U.val("");var at=e(t).data("settings").prePopulate||U.data("pre");e(t).data("settings").processPrePopulate&&e.isFunction(e(t).data("settings").onResult)&&(at=e(t).data("settings").onResult.call(U,at)),at&&at.length&&e.each(at,function(e,t){u(t),c(),V.attr("placeholder",null)}),e(t).data("settings").disabled&&d(!0),"function"==typeof e(t).data("settings").onReady&&e(t).data("settings").onReady.call(),this.clear=function(){W.children("li").each(function(){0===e(this).children("input").length&&b(e(this))})},this.add=function(e){h(e)},this.remove=function(t){W.children("li").each(function(){if(0===e(this).children("input").length){var a=e(this).data("tokeninput"),i=!0;for(var n in t)if(t[n]!==a[n]){i=!1;break}i&&b(e(this))}})},this.getTokens=function(){return R},this.toggleDisabled=function(e){d(e)},this.destroy=function(){this.clear(),Q.remove()},p();var it=new RegExp("[.\\\\+*?\\[\\^\\]$(){}=!<>|:\\-]","g")},e.TokenList.Cache=function(t){var a,i,n={},s=0;a=e.extend({max_size:500},t),i=function(){n={},s=0},this.add=function(e,t){s>a.max_size&&i(),n[e]||(s+=1),n[e]=t},this.get=function(e){return n[e]}}}(jQuery),function(e,t){var a,i,n;if(!e.jstree){var s,o,l=0,r=!1,d=!1,c=!1,p=[],m=e("script:last").attr("src"),u=document,h=u.createElement("LI");h.setAttribute("role","treeitem"),s=u.createElement("I"),s.className="jstree-icon jstree-ocl",h.appendChild(s),s=u.createElement("A"),s.className="jstree-anchor",s.setAttribute("href","#"),o=u.createElement("I"),o.className="jstree-icon jstree-themeicon",s.appendChild(o),h.appendChild(s),s=o=null,e.jstree={version:"3.0.2",defaults:{plugins:[]},plugins:{},path:m&&-1!==m.indexOf("/")?m.replace(/\/[^\/]+$/,""):"",idregex:/[\\:&!^|()\[\]<>@*'+~#";.,=\- \/${}%]/g},e.jstree.create=function(t,a){var i=new e.jstree.core(++l),n=a;return a=e.extend(!0,{},e.jstree.defaults,a),n&&n.plugins&&(a.plugins=n.plugins),e.each(a.plugins,function(e,t){"core"!==e&&(i=i.plugin(t,a[t]))}),i.init(t,a),i},e.jstree.core=function(e){this._id=e,this._cnt=0,this._wrk=null,this._data={core:{themes:{name:!1,dots:!1,icons:!1},selected:[],last_error:{},working:!1,worker_queue:[]}}},e.jstree.reference=function(t){var a=null,i=null;if(t&&t.id&&(t=t.id),!i||!i.length)try{i=e(t)}catch(n){}if(!i||!i.length)try{i=e("#"+t.replace(e.jstree.idregex,"\\$&"))}catch(n){}return i&&i.length&&(i=i.closest(".jstree")).length&&(i=i.data("jstree"))?a=i:e(".jstree").each(function(){var i=e(this).data("jstree");return i&&i._model.data[t]?(a=i,!1):void 0}),a},e.fn.jstree=function(a){var i="string"==typeof a,n=Array.prototype.slice.call(arguments,1),s=null;return this.each(function(){var o=e.jstree.reference(this),l=i&&o?o[a]:null;return s=i&&l?l.apply(o,n):null,o||i||a!==t&&!e.isPlainObject(a)||e(this).data("jstree",new e.jstree.create(this,a)),(o&&!i||a===!0)&&(s=o||!1),null!==s&&s!==t?!1:void 0}),null!==s&&s!==t?s:this},e.expr[":"].jstree=e.expr.createPseudo(function(){return function(a){return e(a).hasClass("jstree")&&e(a).data("jstree")!==t}}),e.jstree.defaults.core={data:!1,strings:!1,check_callback:!1,error:e.noop,animation:200,multiple:!0,themes:{name:!1,url:!1,dir:!1,dots:!0,icons:!0,stripes:!1,variant:!1,responsive:!1},expand_selected_onload:!0,worker:!0,force_text:!1},e.jstree.core.prototype={plugin:function(t,a){var i=e.jstree.plugins[t];return i?(this._data[t]={},i.prototype=this,new i(a,this)):this},init:function(t,a){this._model={data:{"#":{id:"#",parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}}},changed:[],force_full_redraw:!1,redraw_timeout:!1,default_state:{loaded:!0,opened:!1,selected:!1,disabled:!1}},this.element=e(t).addClass("jstree jstree-"+this._id),this.settings=a,this.element.bind("destroyed",e.proxy(this.teardown,this)),this._data.core.ready=!1,this._data.core.loaded=!1,this._data.core.rtl="rtl"===this.element.css("direction"),this.element[this._data.core.rtl?"addClass":"removeClass"]("jstree-rtl"),this.element.attr("role","tree"),this.bind(),this.trigger("init"),this._data.core.original_container_html=this.element.find(" > ul > li").clone(!0),this._data.core.original_container_html.find("li").addBack().contents().filter(function(){return 3===this.nodeType&&(!this.nodeValue||/^\s+$/.test(this.nodeValue))}).remove(),this.element.html("<ul class='jstree-container-ul jstree-children'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this._data.core.li_height=this.get_container_ul().children("li:eq(0)").height()||24,this.trigger("loading"),this.load_node("#")},destroy:function(e){e||this.element.empty(),this.element.unbind("destroyed",this.teardown),this.teardown()},teardown:function(){this.unbind(),this.element.removeClass("jstree").removeData("jstree").find("[class^='jstree']").addBack().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/gi,"")}),this.element=null},bind:function(){this.element.on("dblclick.jstree",function(){if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){var e=window.getSelection();try{e.removeAllRanges(),e.collapse()}catch(t){}}}).on("click.jstree",".jstree-ocl",e.proxy(function(e){this.toggle_node(e.target)},this)).on("click.jstree",".jstree-anchor",e.proxy(function(t){t.preventDefault(),e(t.currentTarget).focus(),this.activate_node(t.currentTarget,t)},this)).on("keydown.jstree",".jstree-anchor",e.proxy(function(t){if("INPUT"===t.target.tagName)return!0;var a=null;switch(t.which){case 13:case 32:t.type="click",e(t.currentTarget).trigger(t);break;case 37:t.preventDefault(),this.is_open(t.currentTarget)?this.close_node(t.currentTarget):(a=this.get_prev_dom(t.currentTarget),a&&a.length&&a.children(".jstree-anchor").focus());break;case 38:t.preventDefault(),a=this.get_prev_dom(t.currentTarget),a&&a.length&&a.children(".jstree-anchor").focus();break;case 39:t.preventDefault(),this.is_closed(t.currentTarget)?this.open_node(t.currentTarget,function(e){this.get_node(e,!0).children(".jstree-anchor").focus()}):(a=this.get_next_dom(t.currentTarget),a&&a.length&&a.children(".jstree-anchor").focus());break;case 40:t.preventDefault(),a=this.get_next_dom(t.currentTarget),a&&a.length&&a.children(".jstree-anchor").focus();break;case 46:t.preventDefault(),a=this.get_node(t.currentTarget),a&&a.id&&"#"!==a.id&&(a=this.is_selected(a)?this.get_selected():a);break;case 113:t.preventDefault(),a=this.get_node(t.currentTarget)}},this)).on("load_node.jstree",e.proxy(function(t,a){if(a.status&&("#"!==a.node.id||this._data.core.loaded||(this._data.core.loaded=!0,this.trigger("loaded")),!this._data.core.ready&&!this.get_container_ul().find(".jstree-loading:eq(0)").length)){if(this._data.core.ready=!0,this._data.core.selected.length){if(this.settings.core.expand_selected_onload){for(var i=[],n=0,s=this._data.core.selected.length;s>n;n++)i=i.concat(this._model.data[this._data.core.selected[n]].parents);
for(i=e.vakata.array_unique(i),n=0,s=i.length;s>n;n++)this.open_node(i[n],!1,0)}this.trigger("changed",{action:"ready",selected:this._data.core.selected})}setTimeout(e.proxy(function(){this.trigger("ready")},this),0)}},this)).on("init.jstree",e.proxy(function(){var e=this.settings.core.themes;this._data.core.themes.dots=e.dots,this._data.core.themes.stripes=e.stripes,this._data.core.themes.icons=e.icons,this.set_theme(e.name||"default",e.url),this.set_theme_variant(e.variant)},this)).on("loading.jstree",e.proxy(function(){this[this._data.core.themes.dots?"show_dots":"hide_dots"](),this[this._data.core.themes.icons?"show_icons":"hide_icons"](),this[this._data.core.themes.stripes?"show_stripes":"hide_stripes"]()},this)).on("blur.jstree",".jstree-anchor",e.proxy(function(t){e(t.currentTarget).filter(".jstree-hovered").mouseleave()},this)).on("focus.jstree",".jstree-anchor",e.proxy(function(t){this.element.find(".jstree-hovered").not(t.currentTarget).mouseleave(),e(t.currentTarget).mouseenter()},this)).on("mouseenter.jstree",".jstree-anchor",e.proxy(function(e){this.hover_node(e.currentTarget)},this)).on("mouseleave.jstree",".jstree-anchor",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},unbind:function(){this.element.off(".jstree"),e(document).off(".jstree-"+this._id)},trigger:function(e,t){t||(t={}),t.instance=this,this.element.triggerHandler(e.replace(".jstree","")+".jstree",t)},get_container:function(){return this.element},get_container_ul:function(){return this.element.children(".jstree-children:eq(0)")},get_string:function(t){var a=this.settings.core.strings;return e.isFunction(a)?a.call(this,t):a&&a[t]?a[t]:t},_firstChild:function(e){for(e=e?e.firstChild:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_nextSibling:function(e){for(e=e?e.nextSibling:null;null!==e&&1!==e.nodeType;)e=e.nextSibling;return e},_previousSibling:function(e){for(e=e?e.previousSibling:null;null!==e&&1!==e.nodeType;)e=e.previousSibling;return e},get_node:function(t,a){t&&t.id&&(t=t.id);var i;try{if(this._model.data[t])t=this._model.data[t];else if(((i=e(t,this.element)).length||(i=e("#"+t.replace(e.jstree.idregex,"\\$&"),this.element)).length)&&this._model.data[i.closest(".jstree-node").attr("id")])t=this._model.data[i.closest(".jstree-node").attr("id")];else{if(!(i=e(t,this.element)).length||!i.hasClass("jstree"))return!1;t=this._model.data["#"]}return a&&(t="#"===t.id?this.element:e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)),t}catch(n){return!1}},get_path:function(e,t,a){if(e=e.parents?e:this.get_node(e),!e||"#"===e.id||!e.parents)return!1;var i,n,s=[];for(s.push(a?e.id:e.text),i=0,n=e.parents.length;n>i;i++)s.push(a?e.parents[i]:this.get_text(e.parents[i]));return s=s.reverse().slice(1),t?s.join(t):s},get_next_dom:function(t,a){var i;return t=this.get_node(t,!0),t[0]===this.element[0]?(i=this._firstChild(this.get_container_ul()[0]),i?e(i):!1):t&&t.length?a?(i=this._nextSibling(t[0]),i?e(i):!1):t.hasClass("jstree-open")?(i=this._firstChild(t.children(".jstree-children")[0]),i?e(i):!1):null!==(i=this._nextSibling(t[0]))?e(i):t.parentsUntil(".jstree",".jstree-node").next(".jstree-node").eq(0):!1},get_prev_dom:function(t,a){var i;if(t=this.get_node(t,!0),t[0]===this.element[0])return i=this.get_container_ul()[0].lastChild,i?e(i):!1;if(!t||!t.length)return!1;if(a)return i=this._previousSibling(t[0]),i?e(i):!1;if(null!==(i=this._previousSibling(t[0]))){for(t=e(i);t.hasClass("jstree-open");)t=t.children(".jstree-children:eq(0)").children(".jstree-node:last");return t}return i=t[0].parentNode.parentNode,i&&i.className&&-1!==i.className.indexOf("jstree-node")?e(i):!1},get_parent:function(e){return e=this.get_node(e),e&&"#"!==e.id?e.parent:!1},get_children_dom:function(e){return e=this.get_node(e,!0),e[0]===this.element[0]?this.get_container_ul().children(".jstree-node"):e&&e.length?e.children(".jstree-children").children(".jstree-node"):!1},is_parent:function(e){return e=this.get_node(e),e&&(e.state.loaded===!1||e.children.length>0)},is_loaded:function(e){return e=this.get_node(e),e&&e.state.loaded},is_loading:function(e){return e=this.get_node(e),e&&e.state&&e.state.loading},is_open:function(e){return e=this.get_node(e),e&&e.state.opened},is_closed:function(e){return e=this.get_node(e),e&&this.is_parent(e)&&!e.state.opened},is_leaf:function(e){return!this.is_parent(e)},load_node:function(t,a){var i,n,s,o,l;if(e.isArray(t))return this._load_nodes(t.slice(),a),!0;if(t=this.get_node(t),!t)return a&&a.call(this,t,!1),!1;if(t.state.loaded){for(t.state.loaded=!1,i=0,n=t.children_d.length;n>i;i++){for(s=0,o=t.parents.length;o>s;s++)this._model.data[t.parents[s]].children_d=e.vakata.array_remove_item(this._model.data[t.parents[s]].children_d,t.children_d[i]);this._model.data[t.children_d[i]].state.selected&&(l=!0,this._data.core.selected=e.vakata.array_remove_item(this._data.core.selected,t.children_d[i])),delete this._model.data[t.children_d[i]]}t.children=[],t.children_d=[],l&&this.trigger("changed",{action:"load_node",node:t,selected:this._data.core.selected})}return t.state.loading=!0,this.get_node(t,!0).addClass("jstree-loading"),this._load_node(t,e.proxy(function(e){t=this._model.data[t.id],t.state.loading=!1,t.state.loaded=e;var i=this.get_node(t,!0);t.state.loaded&&!t.children.length&&i&&i.length&&!i.hasClass("jstree-leaf")&&i.removeClass("jstree-closed jstree-open").addClass("jstree-leaf"),i.removeClass("jstree-loading"),this.trigger("load_node",{node:t,status:e}),a&&a.call(this,t,e)},this)),!0},_load_nodes:function(e,t,a){for(var i=!0,n=function(){this._load_nodes(e,t,!0)},s=this._model.data,o=0,l=e.length;l>o;o++)!s[e[o]]||s[e[o]].state.loaded&&a||(this.is_loading(e[o])||this.load_node(e[o],n),i=!1);i&&(t.done||(t.call(this,e),t.done=!0))},_load_node:function(t,a){var i,n=this.settings.core.data;return n?e.isFunction(n)?n.call(this,t,e.proxy(function(i){i===!1&&a.call(this,!1),this["string"==typeof i?"_append_html_data":"_append_json_data"](t,"string"==typeof i?e(i):i,function(e){a.call(this,e)})},this)):"object"==typeof n?n.url?(n=e.extend(!0,{},n),e.isFunction(n.url)&&(n.url=n.url.call(this,t)),e.isFunction(n.data)&&(n.data=n.data.call(this,t)),e.ajax(n).done(e.proxy(function(i,n,s){var o=s.getResponseHeader("Content-Type");return-1!==o.indexOf("json")||"object"==typeof i?this._append_json_data(t,i,function(e){a.call(this,e)}):-1!==o.indexOf("html")||"string"==typeof i?this._append_html_data(t,e(i),function(e){a.call(this,e)}):(this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:s})},this.settings.core.error.call(this,this._data.core.last_error),a.call(this,!1))},this)).fail(e.proxy(function(e){a.call(this,!1),this._data.core.last_error={error:"ajax",plugin:"core",id:"core_04",reason:"Could not load node",data:JSON.stringify({id:t.id,xhr:e})},this.settings.core.error.call(this,this._data.core.last_error)},this))):(i=e.isArray(n)||e.isPlainObject(n)?JSON.parse(JSON.stringify(n)):n,"#"===t.id?this._append_json_data(t,i,function(e){a.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_05",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),a.call(this,!1))):"string"==typeof n?"#"===t.id?this._append_html_data(t,e(n),function(e){a.call(this,e)}):(this._data.core.last_error={error:"nodata",plugin:"core",id:"core_06",reason:"Could not load node",data:JSON.stringify({id:t.id})},this.settings.core.error.call(this,this._data.core.last_error),a.call(this,!1)):a.call(this,!1):"#"===t.id?this._append_html_data(t,this._data.core.original_container_html.clone(!0),function(e){a.call(this,e)}):a.call(this,!1)},_node_changed:function(e){e=this.get_node(e),e&&this._model.changed.push(e.id)},_append_html_data:function(t,a,i){t=this.get_node(t),t.children=[],t.children_d=[];var n,s,o,l=a.is("ul")?a.children():a,r=t.id,d=[],c=[],p=this._model.data,m=p[r],u=this._data.core.selected.length;for(l.each(e.proxy(function(t,a){n=this._parse_model_from_html(e(a),r,m.parents.concat()),n&&(d.push(n),c.push(n),p[n].children_d.length&&(c=c.concat(p[n].children_d)))},this)),m.children=d,m.children_d=c,s=0,o=m.parents.length;o>s;s++)p[m.parents[s]].children_d=p[m.parents[s]].children_d.concat(c);this.trigger("model",{nodes:c,parent:r}),"#"!==r?(this._node_changed(r),this.redraw()):(this.get_container_ul().children(".jstree-initial-node").remove(),this.redraw(!0)),this._data.core.selected.length!==u&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),i.call(this,!0)},_append_json_data:function(t,a,i){t=this.get_node(t),t.children=[],t.children_d=[],a.d&&(a=a.d,"string"==typeof a&&(a=JSON.parse(a))),e.isArray(a)||(a=[a]);var n=null,s={df:this._model.default_state,dat:a,par:t.id,m:this._model.data,t_id:this._id,t_cnt:this._cnt,sel:this._data.core.selected},o=function(e,t){e.data&&(e=e.data);var a,i,n,s,o=e.dat,l=e.par,r=[],d=[],c=[],p=e.df,m=e.t_id,u=e.t_cnt,h=e.m,g=h[l],f=e.sel,v=function(e,a,i){i=i?i.concat():[],a&&i.unshift(a);var n,s,o,l,r=e.id.toString(),d={id:r,text:e.text||"",icon:e.icon!==t?e.icon:!0,parent:a,parents:i,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(n in p)p.hasOwnProperty(n)&&(d.state[n]=p[n]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(d.icon=e.data.jstree.icon),e&&e.data&&(d.data=e.data,e.data.jstree))for(n in e.data.jstree)e.data.jstree.hasOwnProperty(n)&&(d.state[n]=e.data.jstree[n]);if(e&&"object"==typeof e.state)for(n in e.state)e.state.hasOwnProperty(n)&&(d.state[n]=e.state[n]);if(e&&"object"==typeof e.li_attr)for(n in e.li_attr)e.li_attr.hasOwnProperty(n)&&(d.li_attr[n]=e.li_attr[n]);if(d.li_attr.id||(d.li_attr.id=r),e&&"object"==typeof e.a_attr)for(n in e.a_attr)e.a_attr.hasOwnProperty(n)&&(d.a_attr[n]=e.a_attr[n]);for(e&&e.children&&e.children===!0&&(d.state.loaded=!1,d.children=[],d.children_d=[]),h[d.id]=d,n=0,s=d.children.length;s>n;n++)o=v(h[d.children[n]],d.id,i),l=h[o],d.children_d.push(o),l.children_d.length&&(d.children_d=d.children_d.concat(l.children_d));return delete e.data,delete e.children,h[d.id].original=e,d.state.selected&&c.push(d.id),d.id},b=function(e,a,i){i=i?i.concat():[],a&&i.unshift(a);var n,s,o,l,r,d=!1;do d="j"+m+"_"+ ++u;while(h[d]);r={id:!1,text:"string"==typeof e?e:"",icon:"object"==typeof e&&e.icon!==t?e.icon:!0,parent:a,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(n in p)p.hasOwnProperty(n)&&(r.state[n]=p[n]);if(e&&e.id&&(r.id=e.id.toString()),e&&e.text&&(r.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(r.icon=e.data.jstree.icon),e&&e.data&&(r.data=e.data,e.data.jstree))for(n in e.data.jstree)e.data.jstree.hasOwnProperty(n)&&(r.state[n]=e.data.jstree[n]);if(e&&"object"==typeof e.state)for(n in e.state)e.state.hasOwnProperty(n)&&(r.state[n]=e.state[n]);if(e&&"object"==typeof e.li_attr)for(n in e.li_attr)e.li_attr.hasOwnProperty(n)&&(r.li_attr[n]=e.li_attr[n]);if(r.li_attr.id&&!r.id&&(r.id=r.li_attr.id.toString()),r.id||(r.id=d),r.li_attr.id||(r.li_attr.id=r.id),e&&"object"==typeof e.a_attr)for(n in e.a_attr)e.a_attr.hasOwnProperty(n)&&(r.a_attr[n]=e.a_attr[n]);if(e&&e.children&&e.children.length){for(n=0,s=e.children.length;s>n;n++)o=b(e.children[n],r.id,i),l=h[o],r.children.push(o),l.children_d.length&&(r.children_d=r.children_d.concat(l.children_d));r.children_d=r.children_d.concat(r.children)}return e&&e.children&&e.children===!0&&(r.state.loaded=!1,r.children=[],r.children_d=[]),delete e.data,delete e.children,r.original=e,h[r.id]=r,r.state.selected&&c.push(r.id),r.id};if(o.length&&o[0].id!==t&&o[0].parent!==t){for(i=0,n=o.length;n>i;i++)o[i].children||(o[i].children=[]),h[o[i].id.toString()]=o[i];for(i=0,n=o.length;n>i;i++)h[o[i].parent.toString()]?(h[o[i].parent.toString()].children.push(o[i].id.toString()),g.children_d.push(o[i].id.toString())):console.info("parent "+o[i].parent.toString()+" null");for(i=0,n=g.children.length;n>i;i++)a=v(h[g.children[i]],l,g.parents.concat()),d.push(a),h[a].children_d.length&&(d=d.concat(h[a].children_d));for(i=0,n=g.parents.length;n>i;i++)h[g.parents[i]].children_d=h[g.parents[i]].children_d.concat(d);s={cnt:u,mod:h,sel:f,par:l,dpc:d,add:c}}else{for(i=0,n=o.length;n>i;i++)a=b(o[i],l,g.parents.concat()),a&&(r.push(a),d.push(a),h[a].children_d.length&&(d=d.concat(h[a].children_d)));for(g.children=r,g.children_d=d,i=0,n=g.parents.length;n>i;i++)h[g.parents[i]].children_d=h[g.parents[i]].children_d.concat(d);s={cnt:u,mod:h,sel:f,par:l,dpc:d,add:c}}return s},l=function(t,a){if(this._cnt=t.cnt,this._model.data=t.mod,a){var n,s,o=t.add,l=t.sel,r=this._data.core.selected.slice(),d=this._model.data;if(l.length!==r.length||e.vakata.array_unique(l.concat(r)).length!==l.length){for(n=0,s=l.length;s>n;n++)-1===e.inArray(l[n],o)&&-1===e.inArray(l[n],r)&&(d[l[n]].state.selected=!1);for(n=0,s=r.length;s>n;n++)-1===e.inArray(r[n],l)&&(d[r[n]].state.selected=!0)}}t.add.length&&(this._data.core.selected=this._data.core.selected.concat(t.add)),this.trigger("model",{nodes:t.dpc,parent:t.par}),"#"!==t.par?(this._node_changed(t.par),this.redraw()):this.redraw(!0),t.add.length&&this.trigger("changed",{action:"model",selected:this._data.core.selected}),i.call(this,!0)};if(this.settings.core.worker&&window.Blob&&window.URL&&window.Worker)try{null===this._wrk&&(this._wrk=window.URL.createObjectURL(new window.Blob(["self.onmessage = "+o.toString().replace(/return ([^;}]+)[\s;}]+$/,"postMessage($1);}")],{type:"text/javascript"}))),n=new window.Worker(this._wrk),n.onmessage=e.proxy(function(e){l.call(this,e.data,!0),this._data.core.working=!1,this._data.core.worker_queue.length&&this._append_json_data.apply(this,this._data.core.worker_queue.shift())},this),this._data.core.working?this._data.core.worker_queue.push([t,a,i]):(this._data.core.working=!0,n.postMessage(s))}catch(r){l.call(this,o(s),!1)}else l.call(this,o(s),!1)},_parse_model_from_html:function(t,a,i){i=i?[].concat(i):[],a&&i.unshift(a);var n,s,o,l,r,d=this._model.data,c={id:!1,text:!1,icon:!0,parent:a,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(o in this._model.default_state)this._model.default_state.hasOwnProperty(o)&&(c.state[o]=this._model.default_state[o]);if(l=e.vakata.attributes(t,!0),e.each(l,function(t,a){return a=e.trim(a),a.length?(c.li_attr[t]=a,void("id"===t&&(c.id=a.toString()))):!0}),l=t.children("a").eq(0),l.length&&(l=e.vakata.attributes(l,!0),e.each(l,function(t,a){a=e.trim(a),a.length&&(c.a_attr[t]=a)})),l=t.children("a:eq(0)").length?t.children("a:eq(0)").clone():t.clone(),l.children("ins, i, ul").remove(),l=l.html(),l=e("<div />").html(l),c.text=this.settings.core.force_text?l.text():l.html(),l=t.data(),c.data=l?e.extend(!0,{},l):null,c.state.opened=t.hasClass("jstree-open"),c.state.selected=t.children("a").hasClass("jstree-clicked"),c.state.disabled=t.children("a").hasClass("jstree-disabled"),c.data&&c.data.jstree)for(o in c.data.jstree)c.data.jstree.hasOwnProperty(o)&&(c.state[o]=c.data.jstree[o]);l=t.children("a").children(".jstree-themeicon"),l.length&&(c.icon=l.hasClass("jstree-themeicon-hidden")?!1:l.attr("rel")),c.state.icon&&(c.icon=c.state.icon),l=t.children("ul").children("li");do r="j"+this._id+"_"+ ++this._cnt;while(d[r]);return c.id=c.li_attr.id?c.li_attr.id.toString():r,l.length?(l.each(e.proxy(function(t,a){n=this._parse_model_from_html(e(a),c.id,i),s=this._model.data[n],c.children.push(n),s.children_d.length&&(c.children_d=c.children_d.concat(s.children_d))},this)),c.children_d=c.children_d.concat(c.children)):t.hasClass("jstree-closed")&&(c.state.loaded=!1),c.li_attr["class"]&&(c.li_attr["class"]=c.li_attr["class"].replace("jstree-closed","").replace("jstree-open","")),c.a_attr["class"]&&(c.a_attr["class"]=c.a_attr["class"].replace("jstree-clicked","").replace("jstree-disabled","")),d[c.id]=c,c.state.selected&&this._data.core.selected.push(c.id),c.id},_parse_model_from_flat_json:function(e,a,i){i=i?i.concat():[],a&&i.unshift(a);var n,s,o,l,r=e.id.toString(),d=this._model.data,c=this._model.default_state,p={id:r,text:e.text||"",icon:e.icon!==t?e.icon:!0,parent:a,parents:i,children:e.children||[],children_d:e.children_d||[],data:e.data,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(n in c)c.hasOwnProperty(n)&&(p.state[n]=c[n]);if(e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(p.icon=e.data.jstree.icon),e&&e.data&&(p.data=e.data,e.data.jstree))for(n in e.data.jstree)e.data.jstree.hasOwnProperty(n)&&(p.state[n]=e.data.jstree[n]);if(e&&"object"==typeof e.state)for(n in e.state)e.state.hasOwnProperty(n)&&(p.state[n]=e.state[n]);if(e&&"object"==typeof e.li_attr)for(n in e.li_attr)e.li_attr.hasOwnProperty(n)&&(p.li_attr[n]=e.li_attr[n]);if(p.li_attr.id||(p.li_attr.id=r),e&&"object"==typeof e.a_attr)for(n in e.a_attr)e.a_attr.hasOwnProperty(n)&&(p.a_attr[n]=e.a_attr[n]);for(e&&e.children&&e.children===!0&&(p.state.loaded=!1,p.children=[],p.children_d=[]),d[p.id]=p,n=0,s=p.children.length;s>n;n++)o=this._parse_model_from_flat_json(d[p.children[n]],p.id,i),l=d[o],p.children_d.push(o),l.children_d.length&&(p.children_d=p.children_d.concat(l.children_d));return delete e.data,delete e.children,d[p.id].original=e,p.state.selected&&this._data.core.selected.push(p.id),p.id},_parse_model_from_json:function(e,a,i){i=i?i.concat():[],a&&i.unshift(a);var n,s,o,l,r,d=!1,c=this._model.data,p=this._model.default_state;do d="j"+this._id+"_"+ ++this._cnt;while(c[d]);r={id:!1,text:"string"==typeof e?e:"",icon:"object"==typeof e&&e.icon!==t?e.icon:!0,parent:a,parents:i,children:[],children_d:[],data:null,state:{},li_attr:{id:!1},a_attr:{href:"#"},original:!1};for(n in p)p.hasOwnProperty(n)&&(r.state[n]=p[n]);if(e&&e.id&&(r.id=e.id.toString()),e&&e.text&&(r.text=e.text),e&&e.data&&e.data.jstree&&e.data.jstree.icon&&(r.icon=e.data.jstree.icon),e&&e.data&&(r.data=e.data,e.data.jstree))for(n in e.data.jstree)e.data.jstree.hasOwnProperty(n)&&(r.state[n]=e.data.jstree[n]);if(e&&"object"==typeof e.state)for(n in e.state)e.state.hasOwnProperty(n)&&(r.state[n]=e.state[n]);if(e&&"object"==typeof e.li_attr)for(n in e.li_attr)e.li_attr.hasOwnProperty(n)&&(r.li_attr[n]=e.li_attr[n]);if(r.li_attr.id&&!r.id&&(r.id=r.li_attr.id.toString()),r.id||(r.id=d),r.li_attr.id||(r.li_attr.id=r.id),e&&"object"==typeof e.a_attr)for(n in e.a_attr)e.a_attr.hasOwnProperty(n)&&(r.a_attr[n]=e.a_attr[n]);if(e&&e.children&&e.children.length){for(n=0,s=e.children.length;s>n;n++)o=this._parse_model_from_json(e.children[n],r.id,i),l=c[o],r.children.push(o),l.children_d.length&&(r.children_d=r.children_d.concat(l.children_d));r.children_d=r.children_d.concat(r.children)}return e&&e.children&&e.children===!0&&(r.state.loaded=!1,r.children=[],r.children_d=[]),delete e.data,delete e.children,r.original=e,c[r.id]=r,r.state.selected&&this._data.core.selected.push(r.id),r.id},_redraw:function(){for(var e,t=this._model.force_full_redraw?this._model.data["#"].children.concat([]):this._model.changed.concat([]),a=document.createElement("UL"),i=0,n=t.length;n>i;i++)e=this.redraw_node(t[i],!0,this._model.force_full_redraw),e&&this._model.force_full_redraw&&a.appendChild(e);this._model.force_full_redraw&&(a.className=this.get_container_ul()[0].className,this.element.empty().append(a)),this._model.force_full_redraw=!1,this._model.changed=[],this.trigger("redraw",{nodes:t})},redraw:function(e){e&&(this._model.force_full_redraw=!0),this._redraw()},redraw_node:function(t,a,i){var n=this.get_node(t),s=!1,o=!1,l=!1,r=!1,d=!1,c=!1,p="",m=document,u=this._model.data,g=!1,f=!1,v=null;if(!n)return!1;if("#"===n.id)return this.redraw(!0);if(a=a||0===n.children.length,t=document.querySelector?this.element[0].querySelector("#"+(-1!=="0123456789".indexOf(n.id[0])?"\\3"+n.id[0]+" "+n.id.substr(1).replace(e.jstree.idregex,"\\$&"):n.id.replace(e.jstree.idregex,"\\$&"))):document.getElementById(n.id))t=e(t),i||(s=t.parent().parent()[0],s===this.element[0]&&(s=null),o=t.index()),a||!n.children.length||t.children(".jstree-children").length||(a=!0),a||(l=t.children(".jstree-children")[0]),f=t.attr("aria-selected"),g=t.children(".jstree-anchor")[0]===document.activeElement,t.remove();else if(a=!0,!i){if(s="#"!==n.parent?e("#"+n.parent.replace(e.jstree.idregex,"\\$&"),this.element)[0]:null,!(null===s||s&&u[n.parent].state.opened))return!1;o=e.inArray(n.id,null===s?u["#"].children:u[n.parent].children)}t=h.cloneNode(!0),p="jstree-node ";for(r in n.li_attr)if(n.li_attr.hasOwnProperty(r)){if("id"===r)continue;"class"!==r?t.setAttribute(r,n.li_attr[r]):p+=n.li_attr[r]}f&&"false"!==f&&t.setAttribute("aria-selected",!0),n.state.loaded&&!n.children.length?p+=" jstree-leaf":(p+=n.state.opened&&n.state.loaded?" jstree-open":" jstree-closed",t.setAttribute("aria-expanded",n.state.opened&&n.state.loaded)),null!==n.parent&&u[n.parent].children[u[n.parent].children.length-1]===n.id&&(p+=" jstree-last"),t.id=n.id,t.className=p,p=(n.state.selected?" jstree-clicked":"")+(n.state.disabled?" jstree-disabled":"");for(d in n.a_attr)if(n.a_attr.hasOwnProperty(d)){if("href"===d&&"#"===n.a_attr[d])continue;"class"!==d?t.childNodes[1].setAttribute(d,n.a_attr[d]):p+=" "+n.a_attr[d]}if(p.length&&(t.childNodes[1].className="jstree-anchor "+p),(n.icon&&n.icon!==!0||n.icon===!1)&&(n.icon===!1?t.childNodes[1].childNodes[0].className+=" jstree-themeicon-hidden":-1===n.icon.indexOf("/")&&-1===n.icon.indexOf(".")?t.childNodes[1].childNodes[0].className+=" "+n.icon+" jstree-themeicon-custom":(t.childNodes[1].childNodes[0].style.backgroundImage="url("+n.icon+")",t.childNodes[1].childNodes[0].style.backgroundPosition="center center",t.childNodes[1].childNodes[0].style.backgroundSize="auto",t.childNodes[1].childNodes[0].className+=" jstree-themeicon-custom")),this.settings.core.force_text?t.childNodes[1].appendChild(m.createTextNode(n.text)):t.childNodes[1].innerHTML+=n.text,a&&n.children.length&&n.state.opened&&n.state.loaded){for(c=m.createElement("UL"),c.setAttribute("role","group"),c.className="jstree-children",r=0,d=n.children.length;d>r;r++)c.appendChild(this.redraw_node(n.children[r],a,!0));t.appendChild(c)}if(l&&t.appendChild(l),!i){for(s||(s=this.element[0]),r=0,d=s.childNodes.length;d>r;r++)if(s.childNodes[r]&&s.childNodes[r].className&&-1!==s.childNodes[r].className.indexOf("jstree-children")){v=s.childNodes[r];break}v||(v=m.createElement("UL"),v.setAttribute("role","group"),v.className="jstree-children",s.appendChild(v)),s=v,o<s.childNodes.length?s.insertBefore(t,s.childNodes[o]):s.appendChild(t),g&&t.childNodes[1].focus()}return n.state.opened&&!n.state.loaded&&(n.state.opened=!1,setTimeout(e.proxy(function(){this.open_node(n.id,!1,0)},this),0)),t},open_node:function(a,i,n){var s,o,l,r;if(e.isArray(a)){for(a=a.slice(),s=0,o=a.length;o>s;s++)this.open_node(a[s],i,n);return!0}if(a=this.get_node(a),!a||"#"===a.id)return!1;if(n=n===t?this.settings.core.animation:n,!this.is_closed(a))return i&&i.call(this,a,!1),!1;if(this.is_loaded(a))l=this.get_node(a,!0),r=this,l.length&&(a.children.length&&!this._firstChild(l.children(".jstree-children")[0])&&(a.state.opened=!0,this.redraw_node(a,!0),l=this.get_node(a,!0)),n?(this.trigger("before_open",{node:a}),l.children(".jstree-children").css("display","none").end().removeClass("jstree-closed").addClass("jstree-open").attr("aria-expanded",!0).children(".jstree-children").stop(!0,!0).slideDown(n,function(){this.style.display="",r.trigger("after_open",{node:a})})):(this.trigger("before_open",{node:a}),l[0].className=l[0].className.replace("jstree-closed","jstree-open"),l[0].setAttribute("aria-expanded",!0))),a.state.opened=!0,i&&i.call(this,a,!0),l.length||this.trigger("before_open",{node:a}),this.trigger("open_node",{node:a}),n&&l.length||this.trigger("after_open",{node:a});else{if(this.is_loading(a))return setTimeout(e.proxy(function(){this.open_node(a,i,n)},this),500);this.load_node(a,function(e,t){return t?this.open_node(e,i,n):i?i.call(this,e,!1):!1})}},_open_to:function(t){if(t=this.get_node(t),!t||"#"===t.id)return!1;for(var a=t.parents,i=0,n=a.length;n>i;i+=1)"#"!==i&&this.open_node(a[i],!1,0);return e("#"+t.id.replace(e.jstree.idregex,"\\$&"),this.element)},close_node:function(a,i){var n,s,o,l;if(e.isArray(a)){for(a=a.slice(),n=0,s=a.length;s>n;n++)this.close_node(a[n],i);return!0}return a=this.get_node(a),!a||"#"===a.id||this.is_closed(a)?!1:(i=i===t?this.settings.core.animation:i,o=this,l=this.get_node(a,!0),l.length&&(i?l.children(".jstree-children").attr("style","display:block !important").end().removeClass("jstree-open").addClass("jstree-closed").attr("aria-expanded",!1).children(".jstree-children").stop(!0,!0).slideUp(i,function(){this.style.display="",l.children(".jstree-children").remove(),o.trigger("after_close",{node:a})}):(l[0].className=l[0].className.replace("jstree-open","jstree-closed"),l.attr("aria-expanded",!1).children(".jstree-children").remove())),a.state.opened=!1,this.trigger("close_node",{node:a}),void(i&&l.length||this.trigger("after_close",{node:a})))},toggle_node:function(t){var a,i;if(e.isArray(t)){for(t=t.slice(),a=0,i=t.length;i>a;a++)this.toggle_node(t[a]);return!0}return this.is_closed(t)?this.open_node(t):this.is_open(t)?this.close_node(t):void 0},open_all:function(e,t,a){if(e||(e="#"),e=this.get_node(e),!e)return!1;var i,n,s,o="#"===e.id?this.get_container_ul():this.get_node(e,!0);if(!o.length){for(i=0,n=e.children_d.length;n>i;i++)this.is_closed(this._model.data[e.children_d[i]])&&(this._model.data[e.children_d[i]].state.opened=!0);return this.trigger("open_all",{node:e})}a=a||o,s=this,o=this.is_closed(e)?o.find(".jstree-closed").addBack():o.find(".jstree-closed"),o.each(function(){s.open_node(this,function(e,i){i&&this.is_parent(e)&&this.open_all(e,t,a)},t||0)}),0===a.find(".jstree-closed").length&&this.trigger("open_all",{node:this.get_node(a)})},close_all:function(t,a){if(t||(t="#"),t=this.get_node(t),!t)return!1;var i,n,s="#"===t.id?this.get_container_ul():this.get_node(t,!0),o=this;if(!s.length){for(i=0,n=t.children_d.length;n>i;i++)this._model.data[t.children_d[i]].state.opened=!1;return this.trigger("close_all",{node:t})}s=this.is_open(t)?s.find(".jstree-open").addBack():s.find(".jstree-open"),e(s.get().reverse()).each(function(){o.close_node(this,a||0)}),this.trigger("close_all",{node:t})},is_disabled:function(e){return e=this.get_node(e),e&&e.state&&e.state.disabled},enable_node:function(t){var a,i;if(e.isArray(t)){for(t=t.slice(),a=0,i=t.length;i>a;a++)this.enable_node(t[a]);return!0}return t=this.get_node(t),t&&"#"!==t.id?(t.state.disabled=!1,this.get_node(t,!0).children(".jstree-anchor").removeClass("jstree-disabled"),void this.trigger("enable_node",{node:t})):!1},disable_node:function(t){var a,i;if(e.isArray(t)){for(t=t.slice(),a=0,i=t.length;i>a;a++)this.disable_node(t[a]);return!0}return t=this.get_node(t),t&&"#"!==t.id?(t.state.disabled=!0,this.get_node(t,!0).children(".jstree-anchor").addClass("jstree-disabled"),void this.trigger("disable_node",{node:t})):!1},activate_node:function(e,a){if(this.is_disabled(e))return!1;if(this._data.core.last_clicked=this._data.core.last_clicked&&this._data.core.last_clicked.id!==t?this.get_node(this._data.core.last_clicked.id):null,this._data.core.last_clicked&&!this._data.core.last_clicked.state.selected&&(this._data.core.last_clicked=null),!this._data.core.last_clicked&&this._data.core.selected.length&&(this._data.core.last_clicked=this.get_node(this._data.core.selected[this._data.core.selected.length-1])),this.settings.core.multiple&&(a.metaKey||a.ctrlKey||a.shiftKey)&&(!a.shiftKey||this._data.core.last_clicked&&this.get_parent(e)&&this.get_parent(e)===this._data.core.last_clicked.parent))if(a.shiftKey)for(var i=this.get_node(e).id,n=this._data.core.last_clicked.id,s=this.get_node(this._data.core.last_clicked.parent).children,o=!1,l=0,r=s.length;r>l;l+=1)s[l]===i&&(o=!o),s[l]===n&&(o=!o),o||s[l]===i||s[l]===n?this.select_node(s[l],!1,!1,a):this.deselect_node(s[l],!1,a);else this.is_selected(e)?this.deselect_node(e,!1,a):this.select_node(e,!1,!1,a);else!this.settings.core.multiple&&(a.metaKey||a.ctrlKey||a.shiftKey)&&this.is_selected(e)?this.deselect_node(e,!1,a):(this.deselect_all(!0),this.select_node(e,!1,!1,a),this._data.core.last_clicked=this.get_node(e));this.trigger("activate_node",{node:this.get_node(e)})},hover_node:function(e){if(e=this.get_node(e,!0),!e||!e.length||e.children(".jstree-hovered").length)return!1;var t=this.element.find(".jstree-hovered"),a=this.element;t&&t.length&&this.dehover_node(t),e.children(".jstree-anchor").addClass("jstree-hovered"),this.trigger("hover_node",{node:this.get_node(e)}),setTimeout(function(){a.attr("aria-activedescendant",e[0].id),e.attr("aria-selected",!0)},0)},dehover_node:function(e){return e=this.get_node(e,!0),e&&e.length&&e.children(".jstree-hovered").length?(e.attr("aria-selected",!1).children(".jstree-anchor").removeClass("jstree-hovered"),void this.trigger("dehover_node",{node:this.get_node(e)})):!1},select_node:function(t,a,i,n){var s,o,l;if(e.isArray(t)){for(t=t.slice(),o=0,l=t.length;l>o;o++)this.select_node(t[o],a,i,n);return!0}return t=this.get_node(t),t&&"#"!==t.id?(s=this.get_node(t,!0),void(t.state.selected||(t.state.selected=!0,this._data.core.selected.push(t.id),i||(s=this._open_to(t)),s&&s.length&&s.children(".jstree-anchor").addClass("jstree-clicked"),this.trigger("select_node",{node:t,selected:this._data.core.selected,event:n}),a||this.trigger("changed",{action:"select_node",node:t,selected:this._data.core.selected,event:n})))):!1},deselect_node:function(t,a,i){var n,s,o;if(e.isArray(t)){for(t=t.slice(),n=0,s=t.length;s>n;n++)this.deselect_node(t[n],a,i);return!0}return t=this.get_node(t),t&&"#"!==t.id?(o=this.get_node(t,!0),void(t.state.selected&&(t.state.selected=!1,this._data.core.selected=e.vakata.array_remove_item(this._data.core.selected,t.id),o.length&&o.children(".jstree-anchor").removeClass("jstree-clicked"),this.trigger("deselect_node",{node:t,selected:this._data.core.selected,event:i}),a||this.trigger("changed",{action:"deselect_node",node:t,selected:this._data.core.selected,event:i})))):!1},select_all:function(e){var t,a,i=this._data.core.selected.concat([]);for(this._data.core.selected=this._model.data["#"].children_d.concat(),t=0,a=this._data.core.selected.length;a>t;t++)this._model.data[this._data.core.selected[t]]&&(this._model.data[this._data.core.selected[t]].state.selected=!0);this.redraw(!0),this.trigger("select_all",{selected:this._data.core.selected}),e||this.trigger("changed",{action:"select_all",selected:this._data.core.selected,old_selection:i})},deselect_all:function(e){for(var t=this._data.core.selected.concat([]),a=0,i=this._data.core.selected.length;i>a;a++)this._model.data[this._data.core.selected[a]]&&(this._model.data[this._data.core.selected[a]].state.selected=!1);this._data.core.selected=[],this.element.find(".jstree-clicked").removeClass("jstree-clicked"),this.trigger("deselect_all",{selected:this._data.core.selected,node:t}),e||this.trigger("changed",{action:"deselect_all",selected:this._data.core.selected,old_selection:t})},is_selected:function(e){return e=this.get_node(e),e&&"#"!==e.id?e.state.selected:!1},get_selected:function(t){return t?e.map(this._data.core.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.core.selected},get_top_selected:function(t){for(var a,i,n=this.get_selected(!0),s={},o=0,l=n.length;l>o;o++)s[n[o].id]=n[o];for(o=0,l=n.length;l>o;o++)for(a=0,i=n[o].children_d.length;i>a;a++)s[n[o].children_d[a]]&&delete s[n[o].children_d[a]];n=[];for(o in s)s.hasOwnProperty(o)&&n.push(o);return t?e.map(n,e.proxy(function(e){return this.get_node(e)},this)):n},get_bottom_selected:function(t){for(var a=this.get_selected(!0),i=[],n=0,s=a.length;s>n;n++)a[n].children.length||i.push(a[n].id);return t?e.map(i,e.proxy(function(e){return this.get_node(e)},this)):i},get_state:function(){var e={core:{open:[],scroll:{left:this.element.scrollLeft(),top:this.element.scrollTop()},selected:[]}};
for(var t in this._model.data)this._model.data.hasOwnProperty(t)&&"#"!==t&&(this._model.data[t].state.opened&&e.core.open.push(t),this._model.data[t].state.selected&&e.core.selected.push(t));return e},set_state:function(a,i){if(a){if(a.core){var n,s,o,l;if(a.core.open)return e.isArray(a.core.open)?(n=!0,s=!1,o=this,e.each(a.core.open.concat([]),function(t,l){s=o.get_node(l),s&&(o.is_loaded(l)?(o.is_closed(l)&&o.open_node(l,!1,0),a&&a.core&&a.core.open&&e.vakata.array_remove_item(a.core.open,l)):(o.is_loading(l)||o.open_node(l,e.proxy(function(t,n){!n&&a&&a.core&&a.core.open&&e.vakata.array_remove_item(a.core.open,t.id),this.set_state(a,i)},o),0),n=!1))}),n&&(delete a.core.open,this.set_state(a,i)),!1):(delete a.core.open,this.set_state(a,i),!1);if(a.core.scroll)return a.core.scroll&&a.core.scroll.left!==t&&this.element.scrollLeft(a.core.scroll.left),a.core.scroll&&a.core.scroll.top!==t&&this.element.scrollTop(a.core.scroll.top),delete a.core.scroll,this.set_state(a,i),!1;if(a.core.selected)return l=this,this.deselect_all(),e.each(a.core.selected,function(e,t){l.select_node(t)}),delete a.core.selected,this.set_state(a,i),!1;if(e.isEmptyObject(a.core))return delete a.core,this.set_state(a,i),!1}return e.isEmptyObject(a)?(a=null,i&&i.call(this),this.trigger("set_state"),!1):!0}return!1},refresh:function(t){this._data.core.state=this.get_state(),this._cnt=0,this._model.data={"#":{id:"#",parent:null,parents:[],children:[],children_d:[],state:{loaded:!1}}};var a=this.get_container_ul()[0].className;t||this.element.html("<ul class='"+a+"'><li class='jstree-initial-node jstree-loading jstree-leaf jstree-last'><i class='jstree-icon jstree-ocl'></i><a class='jstree-anchor' href='#'><i class='jstree-icon jstree-themeicon-hidden'></i>"+this.get_string("Loading ...")+"</a></li></ul>"),this.load_node("#",function(t,i){i&&(this.get_container_ul()[0].className=a,this.set_state(e.extend(!0,{},this._data.core.state),function(){this.trigger("refresh")})),this._data.core.state=null})},refresh_node:function(t){if(t=this.get_node(t),!t||"#"===t.id)return!1;{var a=[],i=[];this._data.core.selected.concat([])}i.push(t.id),t.state.opened===!0&&a.push(t.id),this.get_node(t,!0).find(".jstree-open").each(function(){a.push(this.id)}),this._load_nodes(i,e.proxy(function(e){this.open_node(a,!1,0),this.select_node(this._data.core.selected),this.trigger("refresh_node",{node:t,nodes:e})},this))},set_id:function(t,a){if(t=this.get_node(t),!t||"#"===t.id)return!1;var i,n,s=this._model.data;for(a=a.toString(),s[t.parent].children[e.inArray(t.id,s[t.parent].children)]=a,i=0,n=t.parents.length;n>i;i++)s[t.parents[i]].children_d[e.inArray(t.id,s[t.parents[i]].children_d)]=a;for(i=0,n=t.children.length;n>i;i++)s[t.children[i]].parent=a;for(i=0,n=t.children_d.length;n>i;i++)s[t.children_d[i]].parents[e.inArray(t.id,s[t.children_d[i]].parents)]=a;return i=e.inArray(t.id,this._data.core.selected),-1!==i&&(this._data.core.selected[i]=a),i=this.get_node(t.id,!0),i&&i.attr("id",a),delete s[t.id],t.id=a,s[a]=t,!0},get_text:function(e){return e=this.get_node(e),e&&"#"!==e.id?e.text:!1},set_text:function(t,a){var i,n;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;n>i;i++)this.set_text(t[i],a);return!0}return t=this.get_node(t),t&&"#"!==t.id?(t.text=a,this.get_node(t,!0).length&&this.redraw_node(t.id),this.trigger("set_text",{obj:t,text:a}),!0):!1},get_json:function(e,t,a){if(e=this.get_node(e||"#"),!e)return!1;t&&t.flat&&!a&&(a=[]);var i,n,s={id:e.id,text:e.text,icon:this.get_icon(e),li_attr:e.li_attr,a_attr:e.a_attr,state:{},data:t&&t.no_data?!1:e.data};if(t&&t.flat?s.parent=e.parent:s.children=[],!t||!t.no_state)for(i in e.state)e.state.hasOwnProperty(i)&&(s.state[i]=e.state[i]);if(t&&t.no_id&&(delete s.id,s.li_attr&&s.li_attr.id&&delete s.li_attr.id),t&&t.flat&&"#"!==e.id&&a.push(s),!t||!t.no_children)for(i=0,n=e.children.length;n>i;i++)t&&t.flat?this.get_json(e.children[i],t,a):s.children.push(this.get_json(e.children[i],t));return t&&t.flat?a:"#"===e.id?s.children:s},create_node:function(a,i,n,s,o){if(null===a&&(a="#"),a=this.get_node(a),!a)return!1;if(n=n===t?"last":n,!n.toString().match(/^(before|after)$/)&&!o&&!this.is_loaded(a))return this.load_node(a,function(){this.create_node(a,i,n,s,!0)});i||(i={text:this.get_string("New node")}),i.text===t&&(i.text=this.get_string("New node"));var l,r,d,c;switch("#"===a.id&&("before"===n&&(n="first"),"after"===n&&(n="last")),n){case"before":l=this.get_node(a.parent),n=e.inArray(a.id,l.children),a=l;break;case"after":l=this.get_node(a.parent),n=e.inArray(a.id,l.children)+1,a=l;break;case"inside":case"first":n=0;break;case"last":n=a.children.length;break;default:n||(n=0)}if(n>a.children.length&&(n=a.children.length),i.id||(i.id=!0),!this.check("create_node",i,a,n))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(i.id===!0&&delete i.id,i=this._parse_model_from_json(i,a.id,a.parents.concat()),!i)return!1;for(l=this.get_node(i),r=[],r.push(i),r=r.concat(l.children_d),this.trigger("model",{nodes:r,parent:a.id}),a.children_d=a.children_d.concat(r),d=0,c=a.parents.length;c>d;d++)this._model.data[a.parents[d]].children_d=this._model.data[a.parents[d]].children_d.concat(r);for(i=l,l=[],d=0,c=a.children.length;c>d;d++)l[d>=n?d+1:d]=a.children[d];return l[n]=i.id,a.children=l,this.redraw_node(a,!0),s&&s.call(this,this.get_node(i)),this.trigger("create_node",{node:this.get_node(i),parent:a.id,position:n}),i.id},rename_node:function(t,a){var i,n,s;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;n>i;i++)this.rename_node(t[i],a);return!0}return t=this.get_node(t),t&&"#"!==t.id?(s=t.text,this.check("rename_node",t,this.get_parent(t),a)?(this.set_text(t,a),this.trigger("rename_node",{node:t,text:a,old:s}),!0):(this.settings.core.error.call(this,this._data.core.last_error),!1)):!1},delete_node:function(t){var a,i,n,s,o,l,r,d,c,p;if(e.isArray(t)){for(t=t.slice(),a=0,i=t.length;i>a;a++)this.delete_node(t[a]);return!0}if(t=this.get_node(t),!t||"#"===t.id)return!1;if(n=this.get_node(t.parent),s=e.inArray(t.id,n.children),p=!1,!this.check("delete_node",t,n,s))return this.settings.core.error.call(this,this._data.core.last_error),!1;for(-1!==s&&(n.children=e.vakata.array_remove(n.children,s)),o=t.children_d.concat([]),o.push(t.id),d=0,c=o.length;c>d;d++){for(l=0,r=t.parents.length;r>l;l++)s=e.inArray(o[d],this._model.data[t.parents[l]].children_d),-1!==s&&(this._model.data[t.parents[l]].children_d=e.vakata.array_remove(this._model.data[t.parents[l]].children_d,s));this._model.data[o[d]].state.selected&&(p=!0,s=e.inArray(o[d],this._data.core.selected),-1!==s&&(this._data.core.selected=e.vakata.array_remove(this._data.core.selected,s)))}for(this.trigger("delete_node",{node:t,parent:n.id}),p&&this.trigger("changed",{action:"delete_node",node:t,selected:this._data.core.selected,parent:n.id}),d=0,c=o.length;c>d;d++)delete this._model.data[o[d]];return this.redraw_node(n,!0),!0},check:function(t,a,i,n,s){a=a&&a.id?a:this.get_node(a),i=i&&i.id?i:this.get_node(i);var o=t.match(/^move_node|copy_node|create_node$/i)?i:a,l=this.settings.core.check_callback;return"move_node"!==t&&"copy_node"!==t||s&&s.is_multi||a.id!==i.id&&e.inArray(a.id,i.children)!==n&&-1===e.inArray(i.id,a.children_d)?(o&&o.data&&(o=o.data),o&&o.functions&&(o.functions[t]===!1||o.functions[t]===!0)?(o.functions[t]===!1&&(this._data.core.last_error={error:"check",plugin:"core",id:"core_02",reason:"Node data prevents function: "+t,data:JSON.stringify({chk:t,pos:n,obj:a&&a.id?a.id:!1,par:i&&i.id?i.id:!1})}),o.functions[t]):l===!1||e.isFunction(l)&&l.call(this,t,a,i,n,s)===!1||l&&l[t]===!1?(this._data.core.last_error={error:"check",plugin:"core",id:"core_03",reason:"User config for core.check_callback prevents function: "+t,data:JSON.stringify({chk:t,pos:n,obj:a&&a.id?a.id:!1,par:i&&i.id?i.id:!1})},!1):!0):(this._data.core.last_error={error:"check",plugin:"core",id:"core_01",reason:"Moving parent inside child",data:JSON.stringify({chk:t,pos:n,obj:a&&a.id?a.id:!1,par:i&&i.id?i.id:!1})},!1)},last_error:function(){return this._data.core.last_error},move_node:function(a,i,n,s,o){var l,r,d,c,p,m,u,h,g,f,v,b,y,w;if(i=this.get_node(i),n=n===t?0:n,!i)return!1;if(!n.toString().match(/^(before|after)$/)&&!o&&!this.is_loaded(i))return this.load_node(i,function(){this.move_node(a,i,n,s,!0)});if(e.isArray(a)){for(a=a.reverse().slice(),l=0,r=a.length;r>l;l++)this.move_node(a[l],i,n,s,o);return!0}if(a=a&&a.id?a:this.get_node(a),!a||"#"===a.id)return!1;if(d=(a.parent||"#").toString(),p=n.toString().match(/^(before|after)$/)&&"#"!==i.id?this.get_node(i.parent):i,m=a.instance?a.instance:this._model.data[a.id]?this:e.jstree.reference(a.id),u=!m||!m._id||this._id!==m._id,c=m&&m._id&&d&&m._model.data[d]&&m._model.data[d].children?e.inArray(a.id,m._model.data[d].children):-1,u)return this.copy_node(a,i,n,s,o)?(m&&m.delete_node(a),!0):!1;switch("#"===p.id&&("before"===n&&(n="first"),"after"===n&&(n="last")),n){case"before":n=e.inArray(i.id,p.children);break;case"after":n=e.inArray(i.id,p.children)+1;break;case"inside":case"first":n=0;break;case"last":n=p.children.length;break;default:n||(n=0)}if(n>p.children.length&&(n=p.children.length),!this.check("move_node",a,p,n,{core:!0,is_multi:m&&m._id&&m._id!==this._id,is_foreign:!m||!m._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(a.parent===p.id){for(h=p.children.concat(),g=e.inArray(a.id,h),-1!==g&&(h=e.vakata.array_remove(h,g),n>g&&n--),g=[],f=0,v=h.length;v>f;f++)g[f>=n?f+1:f]=h[f];g[n]=a.id,p.children=g,this._node_changed(p.id),this.redraw("#"===p.id)}else{for(g=a.children_d.concat(),g.push(a.id),f=0,v=a.parents.length;v>f;f++){for(h=[],w=m._model.data[a.parents[f]].children_d,b=0,y=w.length;y>b;b++)-1===e.inArray(w[b],g)&&h.push(w[b]);m._model.data[a.parents[f]].children_d=h}for(m._model.data[d].children=e.vakata.array_remove_item(m._model.data[d].children,a.id),f=0,v=p.parents.length;v>f;f++)this._model.data[p.parents[f]].children_d=this._model.data[p.parents[f]].children_d.concat(g);for(h=[],f=0,v=p.children.length;v>f;f++)h[f>=n?f+1:f]=p.children[f];for(h[n]=a.id,p.children=h,p.children_d.push(a.id),p.children_d=p.children_d.concat(a.children_d),a.parent=p.id,g=p.parents.concat(),g.unshift(p.id),w=a.parents.length,a.parents=g,g=g.concat(),f=0,v=a.children_d.length;v>f;f++)this._model.data[a.children_d[f]].parents=this._model.data[a.children_d[f]].parents.slice(0,-1*w),Array.prototype.push.apply(this._model.data[a.children_d[f]].parents,g);this._node_changed(d),this._node_changed(p.id),this.redraw("#"===d||"#"===p.id)}return s&&s.call(this,a,p,n),this.trigger("move_node",{node:a,parent:p.id,position:n,old_parent:d,old_position:c,is_multi:m&&m._id&&m._id!==this._id,is_foreign:!m||!m._id,old_instance:m,new_instance:this}),!0},copy_node:function(a,i,n,s,o){var l,r,d,c,p,m,u,h,g,f,v;if(i=this.get_node(i),n=n===t?0:n,!i)return!1;if(!n.toString().match(/^(before|after)$/)&&!o&&!this.is_loaded(i))return this.load_node(i,function(){this.copy_node(a,i,n,s,!0)});if(e.isArray(a)){for(a=a.reverse().slice(),l=0,r=a.length;r>l;l++)this.copy_node(a[l],i,n,s,o);return!0}if(a=a&&a.id?a:this.get_node(a),!a||"#"===a.id)return!1;switch(h=(a.parent||"#").toString(),g=n.toString().match(/^(before|after)$/)&&"#"!==i.id?this.get_node(i.parent):i,f=a.instance?a.instance:this._model.data[a.id]?this:e.jstree.reference(a.id),v=!f||!f._id||this._id!==f._id,"#"===g.id&&("before"===n&&(n="first"),"after"===n&&(n="last")),n){case"before":n=e.inArray(i.id,g.children);break;case"after":n=e.inArray(i.id,g.children)+1;break;case"inside":case"first":n=0;break;case"last":n=g.children.length;break;default:n||(n=0)}if(n>g.children.length&&(n=g.children.length),!this.check("copy_node",a,g,n,{core:!0,is_multi:f&&f._id&&f._id!==this._id,is_foreign:!f||!f._id}))return this.settings.core.error.call(this,this._data.core.last_error),!1;if(u=f?f.get_json(a,{no_id:!0,no_data:!0,no_state:!0}):a,!u||(u.id===!0&&delete u.id,u=this._parse_model_from_json(u,g.id,g.parents.concat()),!u))return!1;for(c=this.get_node(u),a&&a.state&&a.state.loaded===!1&&(c.state.loaded=!1),d=[],d.push(u),d=d.concat(c.children_d),this.trigger("model",{nodes:d,parent:g.id}),p=0,m=g.parents.length;m>p;p++)this._model.data[g.parents[p]].children_d=this._model.data[g.parents[p]].children_d.concat(d);for(d=[],p=0,m=g.children.length;m>p;p++)d[p>=n?p+1:p]=g.children[p];return d[n]=c.id,g.children=d,g.children_d.push(c.id),g.children_d=g.children_d.concat(c.children_d),this._node_changed(g.id),this.redraw("#"===g.id),s&&s.call(this,c,g,n),this.trigger("copy_node",{node:c,original:a,parent:g.id,position:n,old_parent:h,old_position:f&&f._id&&h&&f._model.data[h]&&f._model.data[h].children?e.inArray(a.id,f._model.data[h].children):-1,is_multi:f&&f._id&&f._id!==this._id,is_foreign:!f||!f._id,old_instance:f,new_instance:this}),c.id},cut:function(t){if(t||(t=this._data.core.selected.concat()),e.isArray(t)||(t=[t]),!t.length)return!1;for(var a,i=[],n=0,s=t.length;s>n;n++)a=this.get_node(t[n]),a&&a.id&&"#"!==a.id&&i.push(a);return i.length?(r=i,c=this,d="move_node",void this.trigger("cut",{node:t})):!1},copy:function(t){if(t||(t=this._data.core.selected.concat()),e.isArray(t)||(t=[t]),!t.length)return!1;for(var a,i=[],n=0,s=t.length;s>n;n++)a=this.get_node(t[n]),a&&a.id&&"#"!==a.id&&i.push(a);return i.length?(r=i,c=this,d="copy_node",void this.trigger("copy",{node:t})):!1},get_buffer:function(){return{mode:d,node:r,inst:c}},can_paste:function(){return d!==!1&&r!==!1},paste:function(e,t){return e=this.get_node(e),e&&d&&d.match(/^(copy_node|move_node)$/)&&r?(this[d](r,e,t)&&this.trigger("paste",{parent:e.id,node:r,mode:d}),r=!1,d=!1,void(c=!1)):!1},edit:function(t,a){if(t=this.get_node(t),!t)return!1;if(this.settings.core.check_callback===!1)return this._data.core.last_error={error:"check",plugin:"core",id:"core_07",reason:"Could not edit node because of check_callback"},this.settings.core.error.call(this,this._data.core.last_error),!1;a="string"==typeof a?a:t.text,this.set_text(t,""),t=this._open_to(t);var i=this._data.core.rtl,n=this.element.width(),s=t.children(".jstree-anchor"),o=e("<span>"),l=a,r=e("<div />",{css:{position:"absolute",top:"-200px",left:i?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),d=e("<input />",{value:l,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver","box-sizing":"border-box",display:"inline-block",height:this._data.core.li_height+"px",lineHeight:this._data.core.li_height+"px",width:"150px"},blur:e.proxy(function(){var a=o.children(".jstree-rename-input"),i=a.val();""===i&&(i=l),r.remove(),o.replaceWith(s),o.remove(),this.set_text(t,l),this.rename_node(t,e("<div></div>").text(i)[this.settings.core.force_text?"text":"html"]())===!1&&this.set_text(t,l)},this),keydown:function(e){var t=e.which;27===t&&(this.value=l),(27===t||13===t||37===t||38===t||39===t||40===t||32===t)&&e.stopImmediatePropagation(),(27===t||13===t)&&(e.preventDefault(),this.blur())},click:function(e){e.stopImmediatePropagation()},mousedown:function(e){e.stopImmediatePropagation()},keyup:function(){d.width(Math.min(r.text("pW"+this.value).width(),n))},keypress:function(e){return 13===e.which?!1:void 0}}),c={fontFamily:s.css("fontFamily")||"",fontSize:s.css("fontSize")||"",fontWeight:s.css("fontWeight")||"",fontStyle:s.css("fontStyle")||"",fontStretch:s.css("fontStretch")||"",fontVariant:s.css("fontVariant")||"",letterSpacing:s.css("letterSpacing")||"",wordSpacing:s.css("wordSpacing")||""};o.attr("class",s.attr("class")).append(s.contents().clone()).append(d),s.replaceWith(o),r.css(c),d.css(c).width(Math.min(r.text("pW"+d[0].value).width(),n))[0].select()},set_theme:function(t,a){if(!t)return!1;if(a===!0){var i=this.settings.core.themes.dir;i||(i=e.jstree.path+"/themes"),a=i+"/"+t+"/style.css"}a&&-1===e.inArray(a,p)&&(e("head").append('<link rel="stylesheet" href="'+a+'" type="text/css" />'),p.push(a)),this._data.core.themes.name&&this.element.removeClass("jstree-"+this._data.core.themes.name),this._data.core.themes.name=t,this.element.addClass("jstree-"+t),this.element[this.settings.core.themes.responsive?"addClass":"removeClass"]("jstree-"+t+"-responsive"),this.trigger("set_theme",{theme:t})},get_theme:function(){return this._data.core.themes.name},set_theme_variant:function(e){this._data.core.themes.variant&&this.element.removeClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant),this._data.core.themes.variant=e,e&&this.element.addClass("jstree-"+this._data.core.themes.name+"-"+this._data.core.themes.variant)},get_theme_variant:function(){return this._data.core.themes.variant},show_stripes:function(){this._data.core.themes.stripes=!0,this.get_container_ul().addClass("jstree-striped")},hide_stripes:function(){this._data.core.themes.stripes=!1,this.get_container_ul().removeClass("jstree-striped")},toggle_stripes:function(){this._data.core.themes.stripes?this.hide_stripes():this.show_stripes()},show_dots:function(){this._data.core.themes.dots=!0,this.get_container_ul().removeClass("jstree-no-dots")},hide_dots:function(){this._data.core.themes.dots=!1,this.get_container_ul().addClass("jstree-no-dots")},toggle_dots:function(){this._data.core.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this._data.core.themes.icons=!0,this.get_container_ul().removeClass("jstree-no-icons")},hide_icons:function(){this._data.core.themes.icons=!1,this.get_container_ul().addClass("jstree-no-icons")},toggle_icons:function(){this._data.core.themes.icons?this.hide_icons():this.show_icons()},set_icon:function(t,a){var i,n,s,o;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;n>i;i++)this.set_icon(t[i],a);return!0}return t=this.get_node(t),t&&"#"!==t.id?(o=t.icon,t.icon=a,s=this.get_node(t,!0).children(".jstree-anchor").children(".jstree-themeicon"),a===!1?this.hide_icon(t):a===!0?s.removeClass("jstree-themeicon-custom "+o).css("background","").removeAttr("rel"):-1===a.indexOf("/")&&-1===a.indexOf(".")?(s.removeClass(o).css("background",""),s.addClass(a+" jstree-themeicon-custom").attr("rel",a)):(s.removeClass(o).css("background",""),s.addClass("jstree-themeicon-custom").css("background","url('"+a+"') center center no-repeat").attr("rel",a)),!0):!1},get_icon:function(e){return e=this.get_node(e),e&&"#"!==e.id?e.icon:!1},hide_icon:function(t){var a,i;if(e.isArray(t)){for(t=t.slice(),a=0,i=t.length;i>a;a++)this.hide_icon(t[a]);return!0}return t=this.get_node(t),t&&"#"!==t?(t.icon=!1,this.get_node(t,!0).children(".jstree-anchor").children(".jstree-themeicon").addClass("jstree-themeicon-hidden"),!0):!1},show_icon:function(t){var a,i,n;if(e.isArray(t)){for(t=t.slice(),a=0,i=t.length;i>a;a++)this.show_icon(t[a]);return!0}return t=this.get_node(t),t&&"#"!==t?(n=this.get_node(t,!0),t.icon=n.length?n.children(".jstree-anchor").children(".jstree-themeicon").attr("rel"):!0,t.icon||(t.icon=!0),n.children(".jstree-anchor").children(".jstree-themeicon").removeClass("jstree-themeicon-hidden"),!0):!1}},e.vakata={},e.vakata.attributes=function(t,a){t=e(t)[0];var i=a?{}:[];return t&&t.attributes&&e.each(t.attributes,function(t,n){-1===e.inArray(n.nodeName.toLowerCase(),["style","contenteditable","hasfocus","tabindex"])&&null!==n.nodeValue&&""!==e.trim(n.nodeValue)&&(a?i[n.nodeName]=n.nodeValue:i.push(n.nodeName))}),i},e.vakata.array_unique=function(e){for(var t,a=[],i=0,n=e.length;n>i;i++){for(t=0;i>=t&&e[i]!==e[t];t++);t===i&&a.push(e[i])}return a},e.vakata.array_remove=function(e,t,a){var i=e.slice((a||t)+1||e.length);return e.length=0>t?e.length+t:t,e.push.apply(e,i),e},e.vakata.array_remove_item=function(t,a){var i=e.inArray(a,t);return-1!==i?e.vakata.array_remove(t,i):t},a=document.createElement("I"),a.className="jstree-icon jstree-checkbox",e.jstree.defaults.checkbox={visible:!0,three_state:!0,whole_node:!0,keep_selected_style:!0,cascade:"",tie_selection:!0},e.jstree.plugins.checkbox=function(t,i){this.bind=function(){i.bind.call(this),this._data.checkbox.uto=!1,this._data.checkbox.selected=[],this.settings.checkbox.three_state&&(this.settings.checkbox.cascade="up+down+undetermined"),this.element.on("init.jstree",e.proxy(function(){this._data.checkbox.visible=this.settings.checkbox.visible,this.settings.checkbox.keep_selected_style||this.element.addClass("jstree-checkbox-no-clicked"),this.settings.checkbox.tie_selection&&this.element.addClass("jstree-checkbox-selection")},this)).on("loading.jstree",e.proxy(function(){this[this._data.checkbox.visible?"show_checkboxes":"hide_checkboxes"]()},this)),-1!==this.settings.checkbox.cascade.indexOf("undetermined")&&this.element.on("changed.jstree uncheck_node.jstree check_node.jstree uncheck_all.jstree check_all.jstree move_node.jstree copy_node.jstree redraw.jstree open_node.jstree",e.proxy(function(){this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)},this)),this.settings.checkbox.tie_selection||this.element.on("model.jstree",e.proxy(function(e,t){for(var a=this._model.data,i=(a[t.parent],t.nodes),n=0,s=i.length;s>n;n++)a[i[n]].state.checked=a[i[n]].original&&a[i[n]].original.state&&a[i[n]].original.state.checked,a[i[n]].state.checked&&this._data.checkbox.selected.push(i[n])},this)),(-1!==this.settings.checkbox.cascade.indexOf("up")||-1!==this.settings.checkbox.cascade.indexOf("down"))&&this.element.on("model.jstree",e.proxy(function(t,a){var i,n,s,o,l,r,d=this._model.data,c=d[a.parent],p=a.nodes,m=[],u=this.settings.checkbox.cascade,h=this.settings.checkbox.tie_selection;if(-1!==u.indexOf("down"))if(c.state[h?"selected":"checked"]){for(n=0,s=p.length;s>n;n++)d[p[n]].state[h?"selected":"checked"]=!0;this._data[h?"core":"checkbox"].selected=this._data[h?"core":"checkbox"].selected.concat(p)}else for(n=0,s=p.length;s>n;n++)if(d[p[n]].state[h?"selected":"checked"]){for(o=0,l=d[p[n]].children_d.length;l>o;o++)d[d[p[n]].children_d[o]].state[h?"selected":"checked"]=!0;this._data[h?"core":"checkbox"].selected=this._data[h?"core":"checkbox"].selected.concat(d[p[n]].children_d)}if(-1!==u.indexOf("up")){for(n=0,s=c.children_d.length;s>n;n++)d[c.children_d[n]].children.length||m.push(d[c.children_d[n]].parent);for(m=e.vakata.array_unique(m),o=0,l=m.length;l>o;o++)for(c=d[m[o]];c&&"#"!==c.id;){for(i=0,n=0,s=c.children.length;s>n;n++)i+=d[c.children[n]].state[h?"selected":"checked"];if(i!==s)break;c.state[h?"selected":"checked"]=!0,this._data[h?"core":"checkbox"].selected.push(c.id),r=this.get_node(c,!0),r&&r.length&&r.children(".jstree-anchor").addClass(h?"jstree-clicked":"jstree-checked"),c=this.get_node(c.parent)}}this._data[h?"core":"checkbox"].selected=e.vakata.array_unique(this._data[h?"core":"checkbox"].selected)},this)).on(this.settings.checkbox.tie_selection?"select_node.jstree":"check_node.jstree",e.proxy(function(t,a){var i,n,s,o,l=a.node,r=this._model.data,d=this.get_node(l.parent),c=this.get_node(l,!0),p=this.settings.checkbox.cascade,m=this.settings.checkbox.tie_selection;if(-1!==p.indexOf("down"))for(this._data[m?"core":"checkbox"].selected=e.vakata.array_unique(this._data[m?"core":"checkbox"].selected.concat(l.children_d)),i=0,n=l.children_d.length;n>i;i++)o=r[l.children_d[i]],o.state[m?"selected":"checked"]=!0,o&&o.original&&o.original.state&&o.original.state.undetermined&&(o.original.state.undetermined=!1);if(-1!==p.indexOf("up"))for(;d&&"#"!==d.id;){for(s=0,i=0,n=d.children.length;n>i;i++)s+=r[d.children[i]].state[m?"selected":"checked"];if(s!==n)break;d.state[m?"selected":"checked"]=!0,this._data[m?"core":"checkbox"].selected.push(d.id),o=this.get_node(d,!0),o&&o.length&&o.children(".jstree-anchor").addClass(m?"jstree-clicked":"jstree-checked"),d=this.get_node(d.parent)}-1!==p.indexOf("down")&&c.length&&c.find(".jstree-anchor").addClass(m?"jstree-clicked":"jstree-checked")},this)).on(this.settings.checkbox.tie_selection?"deselect_all.jstree":"uncheck_all.jstree",e.proxy(function(){for(var e,t=this.get_node("#"),a=this._model.data,i=0,n=t.children_d.length;n>i;i++)e=a[t.children_d[i]],e&&e.original&&e.original.state&&e.original.state.undetermined&&(e.original.state.undetermined=!1)},this)).on(this.settings.checkbox.tie_selection?"deselect_node.jstree":"uncheck_node.jstree",e.proxy(function(t,a){var i,n,s,o=a.node,l=this.get_node(o,!0),r=this.settings.checkbox.cascade,d=this.settings.checkbox.tie_selection;if(o&&o.original&&o.original.state&&o.original.state.undetermined&&(o.original.state.undetermined=!1),-1!==r.indexOf("down"))for(i=0,n=o.children_d.length;n>i;i++)s=this._model.data[o.children_d[i]],s.state[d?"selected":"checked"]=!1,s&&s.original&&s.original.state&&s.original.state.undetermined&&(s.original.state.undetermined=!1);if(-1!==r.indexOf("up"))for(i=0,n=o.parents.length;n>i;i++)s=this._model.data[o.parents[i]],s.state[d?"selected":"checked"]=!1,s&&s.original&&s.original.state&&s.original.state.undetermined&&(s.original.state.undetermined=!1),s=this.get_node(o.parents[i],!0),s&&s.length&&s.children(".jstree-anchor").removeClass(d?"jstree-clicked":"jstree-checked");for(s=[],i=0,n=this._data[d?"core":"checkbox"].selected.length;n>i;i++)(-1===r.indexOf("down")||-1===e.inArray(this._data[d?"core":"checkbox"].selected[i],o.children_d))&&(-1===r.indexOf("up")||-1===e.inArray(this._data[d?"core":"checkbox"].selected[i],o.parents))&&s.push(this._data[d?"core":"checkbox"].selected[i]);this._data[d?"core":"checkbox"].selected=e.vakata.array_unique(s),-1!==r.indexOf("down")&&l.length&&l.find(".jstree-anchor").removeClass(d?"jstree-clicked":"jstree-checked")},this)),-1!==this.settings.checkbox.cascade.indexOf("up")&&this.element.on("delete_node.jstree",e.proxy(function(e,t){for(var a,i,n,s,o=this.get_node(t.parent),l=this._model.data,r=this.settings.checkbox.tie_selection;o&&"#"!==o.id;){for(n=0,a=0,i=o.children.length;i>a;a++)n+=l[o.children[a]].state[r?"selected":"checked"];if(n!==i)break;o.state[r?"selected":"checked"]=!0,this._data[r?"core":"checkbox"].selected.push(o.id),s=this.get_node(o,!0),s&&s.length&&s.children(".jstree-anchor").addClass(r?"jstree-clicked":"jstree-checked"),o=this.get_node(o.parent)}},this)).on("move_node.jstree",e.proxy(function(t,a){var i,n,s,o,l,r=a.is_multi,d=a.old_parent,c=this.get_node(a.parent),p=this._model.data,m=this.settings.checkbox.tie_selection;if(!r)for(i=this.get_node(d);i&&"#"!==i.id;){for(n=0,s=0,o=i.children.length;o>s;s++)n+=p[i.children[s]].state[m?"selected":"checked"];if(n!==o)break;i.state[m?"selected":"checked"]=!0,this._data[m?"core":"checkbox"].selected.push(i.id),l=this.get_node(i,!0),l&&l.length&&l.children(".jstree-anchor").addClass(m?"jstree-clicked":"jstree-checked"),i=this.get_node(i.parent)}for(i=c;i&&"#"!==i.id;){for(n=0,s=0,o=i.children.length;o>s;s++)n+=p[i.children[s]].state[m?"selected":"checked"];if(n===o)i.state[m?"selected":"checked"]||(i.state[m?"selected":"checked"]=!0,this._data[m?"core":"checkbox"].selected.push(i.id),l=this.get_node(i,!0),l&&l.length&&l.children(".jstree-anchor").addClass(m?"jstree-clicked":"jstree-checked"));else{if(!i.state[m?"selected":"checked"])break;i.state[m?"selected":"checked"]=!1,this._data[m?"core":"checkbox"].selected=e.vakata.array_remove_item(this._data[m?"core":"checkbox"].selected,i.id),l=this.get_node(i,!0),l&&l.length&&l.children(".jstree-anchor").removeClass(m?"jstree-clicked":"jstree-checked")}i=this.get_node(i.parent)}},this))},this._undetermined=function(){for(var t=this._model.data,a=this.settings.checkbox.tie_selection,i=this._data[a?"core":"checkbox"].selected,n=[],s=this,o=0,l=i.length;l>o;o++)t[i[o]]&&t[i[o]].parents&&(n=n.concat(t[i[o]].parents));for(this.element.find(".jstree-closed").not(":has(.jstree-children)").each(function(){var e,a=s.get_node(this);if(a.state.loaded)for(o=0,l=a.children_d.length;l>o;o++)e=t[a.children_d[o]],!e.state.loaded&&e.original&&e.original.state&&e.original.state.undetermined&&e.original.state.undetermined===!0&&(n.push(e.id),n=n.concat(e.parents));else a.original&&a.original.state&&a.original.state.undetermined&&a.original.state.undetermined===!0&&(n.push(a.id),n=n.concat(a.parents))}),n=e.vakata.array_unique(n),n=e.vakata.array_remove_item(n,"#"),this.element.find(".jstree-undetermined").removeClass("jstree-undetermined"),o=0,l=n.length;l>o;o++)t[n[o]].state[a?"selected":"checked"]||(i=this.get_node(n[o],!0),i&&i.length&&i.children(".jstree-anchor").children(".jstree-checkbox").addClass("jstree-undetermined"))},this.redraw_node=function(t,n,s){if(t=i.redraw_node.call(this,t,n,s)){for(var o=null,l=0,r=t.childNodes.length;r>l;l++)if(t.childNodes[l]&&t.childNodes[l].className&&-1!==t.childNodes[l].className.indexOf("jstree-anchor")){o=t.childNodes[l];break}o&&(!this.settings.checkbox.tie_selection&&this._model.data[t.id].state.checked&&(o.className+=" jstree-checked"),o.insertBefore(a.cloneNode(!1),o.childNodes[0]))}return s||-1===this.settings.checkbox.cascade.indexOf("undetermined")||(this._data.checkbox.uto&&clearTimeout(this._data.checkbox.uto),this._data.checkbox.uto=setTimeout(e.proxy(this._undetermined,this),50)),t},this.show_checkboxes=function(){this._data.core.themes.checkboxes=!0,this.get_container_ul().removeClass("jstree-no-checkboxes")},this.hide_checkboxes=function(){this._data.core.themes.checkboxes=!1,this.get_container_ul().addClass("jstree-no-checkboxes")},this.toggle_checkboxes=function(){this._data.core.themes.checkboxes?this.hide_checkboxes():this.show_checkboxes()},this.is_undetermined=function(t){t=this.get_node(t);var a,i,n=this.settings.checkbox.cascade,s=this.settings.checkbox.tie_selection,o=this._data[s?"core":"checkbox"].selected,l=this._model.data;if(!t||t.state[s?"selected":"checked"]===!0||-1===n.indexOf("undetermined")||-1===n.indexOf("down")&&-1===n.indexOf("up"))return!1;if(!t.state.loaded&&t.original.state.undetermined===!0)return!0;for(a=0,i=t.children_d.length;i>a;a++)if(-1!==e.inArray(t.children_d[a],o)||!l[t.children_d[a]].state.loaded&&l[t.children_d[a]].original.state.undetermined)return!0;return!1},this.activate_node=function(t,a){return this.settings.checkbox.tie_selection&&(this.settings.checkbox.whole_node||e(a.target).hasClass("jstree-checkbox"))&&(a.ctrlKey=!0),this.settings.checkbox.tie_selection||!this.settings.checkbox.whole_node&&!e(a.target).hasClass("jstree-checkbox")?i.activate_node.call(this,t,a):(this.is_checked(t)?this.uncheck_node(t,a):this.check_node(t,a),void this.trigger("activate_node",{node:this.get_node(t)}))},this.check_node=function(t,a){if(this.settings.checkbox.tie_selection)return this.select_node(t,!1,!0,a);var i,n,s;if(e.isArray(t)){for(t=t.slice(),n=0,s=t.length;s>n;n++)this.check_node(t[n],a);return!0}return t=this.get_node(t),t&&"#"!==t.id?(i=this.get_node(t,!0),void(t.state.checked||(t.state.checked=!0,this._data.checkbox.selected.push(t.id),i&&i.length&&i.children(".jstree-anchor").addClass("jstree-checked"),this.trigger("check_node",{node:t,selected:this._data.checkbox.selected,event:a})))):!1},this.uncheck_node=function(t,a){if(this.settings.checkbox.tie_selection)return this.deselect_node(t,!1,a);var i,n,s;if(e.isArray(t)){for(t=t.slice(),i=0,n=t.length;n>i;i++)this.uncheck_node(t[i],a);return!0}return t=this.get_node(t),t&&"#"!==t.id?(s=this.get_node(t,!0),void(t.state.checked&&(t.state.checked=!1,this._data.checkbox.selected=e.vakata.array_remove_item(this._data.checkbox.selected,t.id),s.length&&s.children(".jstree-anchor").removeClass("jstree-checked"),this.trigger("uncheck_node",{node:t,selected:this._data.checkbox.selected,event:a})))):!1},this.check_all=function(){if(this.settings.checkbox.tie_selection)return this.select_all();{var e,t;this._data.checkbox.selected.concat([])}for(this._data.checkbox.selected=this._model.data["#"].children_d.concat(),e=0,t=this._data.checkbox.selected.length;t>e;e++)this._model.data[this._data.checkbox.selected[e]]&&(this._model.data[this._data.checkbox.selected[e]].state.checked=!0);this.redraw(!0),this.trigger("check_all",{selected:this._data.checkbox.selected})},this.uncheck_all=function(){if(this.settings.checkbox.tie_selection)return this.deselect_all();for(var e=this._data.checkbox.selected.concat([]),t=0,a=this._data.checkbox.selected.length;a>t;t++)this._model.data[this._data.checkbox.selected[t]]&&(this._model.data[this._data.checkbox.selected[t]].state.checked=!1);
this._data.checkbox.selected=[],this.element.find(".jstree-checked").removeClass("jstree-checked"),this.trigger("uncheck_all",{selected:this._data.checkbox.selected,node:e})},this.is_checked=function(e){return this.settings.checkbox.tie_selection?this.is_selected(e):(e=this.get_node(e),e&&"#"!==e.id?e.state.checked:!1)},this.get_checked=function(t){return this.settings.checkbox.tie_selection?this.get_selected(t):t?e.map(this._data.checkbox.selected,e.proxy(function(e){return this.get_node(e)},this)):this._data.checkbox.selected},this.get_top_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_top_selected(t);for(var a,i,n=this.get_checked(!0),s={},o=0,l=n.length;l>o;o++)s[n[o].id]=n[o];for(o=0,l=n.length;l>o;o++)for(a=0,i=n[o].children_d.length;i>a;a++)s[n[o].children_d[a]]&&delete s[n[o].children_d[a]];n=[];for(o in s)s.hasOwnProperty(o)&&n.push(o);return t?e.map(n,e.proxy(function(e){return this.get_node(e)},this)):n},this.get_bottom_checked=function(t){if(this.settings.checkbox.tie_selection)return this.get_bottom_selected(t);for(var a=this.get_checked(!0),i=[],n=0,s=a.length;s>n;n++)a[n].children.length||i.push(a[n].id);return t?e.map(i,e.proxy(function(e){return this.get_node(e)},this)):i}},e.jstree.defaults.contextmenu={select_node:!0,show_at_node:!0,items:function(){return{create:{separator_before:!1,separator_after:!0,_disabled:!1,label:"Create",action:function(t){var a=e.jstree.reference(t.reference),i=a.get_node(t.reference);a.create_node(i,{},"last",function(e){setTimeout(function(){a.edit(e)},0)})}},rename:{separator_before:!1,separator_after:!1,_disabled:!1,label:"Rename",action:function(t){var a=e.jstree.reference(t.reference),i=a.get_node(t.reference);a.edit(i)}},remove:{separator_before:!1,icon:!1,separator_after:!1,_disabled:!1,label:"Delete",action:function(t){var a=e.jstree.reference(t.reference),i=a.get_node(t.reference);a.delete_node(a.is_selected(i)?a.get_selected():i)}},ccp:{separator_before:!0,icon:!1,separator_after:!1,label:"Edit",action:!1,submenu:{cut:{separator_before:!1,separator_after:!1,label:"Cut",action:function(t){var a=e.jstree.reference(t.reference),i=a.get_node(t.reference);a.cut(a.is_selected(i)?a.get_selected():i)}},copy:{separator_before:!1,icon:!1,separator_after:!1,label:"Copy",action:function(t){var a=e.jstree.reference(t.reference),i=a.get_node(t.reference);a.copy(a.is_selected(i)?a.get_selected():i)}},paste:{separator_before:!1,icon:!1,_disabled:function(t){return!e.jstree.reference(t.reference).can_paste()},separator_after:!1,label:"Paste",action:function(t){var a=e.jstree.reference(t.reference),i=a.get_node(t.reference);a.paste(i)}}}}}}},e.jstree.plugins.contextmenu=function(a,i){this.bind=function(){i.bind.call(this);var t=0;this.element.on("contextmenu.jstree",".jstree-anchor",e.proxy(function(e){e.preventDefault(),t=e.ctrlKey?e.timeStamp:0,this.is_loading(e.currentTarget)||this.show_contextmenu(e.currentTarget,e.pageX,e.pageY,e)},this)).on("click.jstree",".jstree-anchor",e.proxy(function(a){this._data.contextmenu.visible&&(!t||a.timeStamp-t>250)&&e.vakata.context.hide()},this)),e(document).on("context_hide.vakata",e.proxy(function(){this._data.contextmenu.visible=!1},this))},this.teardown=function(){this._data.contextmenu.visible&&e.vakata.context.hide(),i.teardown.call(this)},this.show_contextmenu=function(a,i,n,s){if(a=this.get_node(a),!a||"#"===a.id)return!1;var o=this.settings.contextmenu,l=this.get_node(a,!0),r=l.children(".jstree-anchor"),d=!1,c=!1;(o.show_at_node||i===t||n===t)&&(d=r.offset(),i=d.left,n=d.top+this._data.core.li_height),this.settings.contextmenu.select_node&&!this.is_selected(a)&&this.activate_node(a,s),c=o.items,e.isFunction(c)&&(c=c.call(this,a,e.proxy(function(e){this._show_contextmenu(a,i,n,e)},this))),e.isPlainObject(c)&&this._show_contextmenu(a,i,n,c)},this._show_contextmenu=function(t,a,i,n){var s=this.get_node(t,!0),o=s.children(".jstree-anchor");e(document).one("context_show.vakata",e.proxy(function(t,a){var i="jstree-contextmenu jstree-"+this.get_theme()+"-contextmenu";e(a.element).addClass(i)},this)),this._data.contextmenu.visible=!0,e.vakata.context.show(o,{x:a,y:i},n),this.trigger("show_contextmenu",{node:t,x:a,y:i})}},function(e){var t=!1,a={element:!1,reference:!1,position_x:0,position_y:0,items:[],html:"",is_visible:!1};e.vakata.context={settings:{hide_onmouseleave:0,icons:!0},_trigger:function(t){e(document).triggerHandler("context_"+t+".vakata",{reference:a.reference,element:a.element,position:{x:a.position_x,y:a.position_y}})},_execute:function(t){return t=a.items[t],t&&(!t._disabled||e.isFunction(t._disabled)&&!t._disabled({item:t,reference:a.reference,element:a.element}))&&t.action?t.action.call(null,{item:t,reference:a.reference,element:a.element,position:{x:a.position_x,y:a.position_y}}):!1},_parse:function(t,i){if(!t)return!1;i||(a.html="",a.items=[]);var n,s="",o=!1;return i&&(s+="<ul>"),e.each(t,function(t,i){return i?(a.items.push(i),!o&&i.separator_before&&(s+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>"),o=!1,s+="<li class='"+(i._class||"")+(i._disabled===!0||e.isFunction(i._disabled)&&i._disabled({item:i,reference:a.reference,element:a.element})?" vakata-contextmenu-disabled ":"")+"' "+(i.shortcut?" data-shortcut='"+i.shortcut+"' ":"")+">",s+="<a href='#' rel='"+(a.items.length-1)+"'>",e.vakata.context.settings.icons&&(s+="<i ",i.icon&&(s+=-1!==i.icon.indexOf("/")||-1!==i.icon.indexOf(".")?" style='background:url(\""+i.icon+"\") center center no-repeat' ":" class='"+i.icon+"' "),s+="></i><span class='vakata-contextmenu-sep'>&#160;</span>"),s+=(e.isFunction(i.label)?i.label({item:t,reference:a.reference,element:a.element}):i.label)+(i.shortcut?' <span class="vakata-contextmenu-shortcut vakata-contextmenu-shortcut-'+i.shortcut+'">'+(i.shortcut_label||"")+"</span>":"")+"</a>",i.submenu&&(n=e.vakata.context._parse(i.submenu,!0),n&&(s+=n)),s+="</li>",void(i.separator_after&&(s+="<li class='vakata-context-separator'><a href='#' "+(e.vakata.context.settings.icons?"":'style="margin-left:0px;"')+">&#160;</a></li>",o=!0))):!0}),s=s.replace(/<li class\='vakata-context-separator'\><\/li\>$/,""),i&&(s+="</ul>"),i||(a.html=s,e.vakata.context._trigger("parse")),s.length>10?s:!1},_show_submenu:function(a){if(a=e(a),a.length&&a.children("ul").length){var i=a.children("ul"),n=a.offset().left+a.outerWidth(),s=a.offset().top,o=i.width(),l=i.height(),r=e(window).width()+e(window).scrollLeft(),d=e(window).height()+e(window).scrollTop();t?a[n-(o+10+a.outerWidth())<0?"addClass":"removeClass"]("vakata-context-left"):a[n+o+10>r?"addClass":"removeClass"]("vakata-context-right"),s+l+10>d&&i.css("bottom","-1px"),i.show()}},show:function(i,n,s){var o,l,r,d,c,p,m,u;switch(a.element&&a.element.length&&a.element.width(""),!0){case!n&&!i:return!1;case!!n&&!!i:a.reference=i,a.position_x=n.x,a.position_y=n.y;break;case!n&&!!i:a.reference=i,o=i.offset(),a.position_x=o.left+i.outerHeight(),a.position_y=o.top;break;case!!n&&!i:a.position_x=n.x,a.position_y=n.y}!i||s||!e(i).data("vakata_contextmenu")||(s=e(i).data("vakata_contextmenu")),e.vakata.context._parse(s)&&a.element.html(a.html),a.items.length&&(l=a.element,r=a.position_x,d=a.position_y,c=l.width(),p=l.height(),m=e(window).width()+e(window).scrollLeft(),u=e(window).height()+e(window).scrollTop(),t&&(r-=l.outerWidth(),r<e(window).scrollLeft()+20&&(r=e(window).scrollLeft()+20)),r+c+20>m&&(r=m-(c+20)),d+p+20>u&&(d=u-(p+20)),a.element.css({left:r,top:d}).show().find("a:eq(0)").focus().parent().addClass("vakata-context-hover"),a.is_visible=!0,e.vakata.context._trigger("show"))},hide:function(){a.is_visible&&(a.element.hide().find("ul").hide().end().find(":focus").blur(),a.is_visible=!1,e.vakata.context._trigger("hide"))}},e(function(){t="rtl"===e("body").css("direction");var i=!1;a.element=e("<ul class='vakata-context'></ul>"),a.element.on("mouseenter","li",function(t){t.stopImmediatePropagation(),e.contains(this,t.relatedTarget)||(i&&clearTimeout(i),a.element.find(".vakata-context-hover").removeClass("vakata-context-hover").end(),e(this).siblings().find("ul").hide().end().end().parentsUntil(".vakata-context","li").addBack().addClass("vakata-context-hover"),e.vakata.context._show_submenu(this))}).on("mouseleave","li",function(t){e.contains(this,t.relatedTarget)||e(this).find(".vakata-context-hover").addBack().removeClass("vakata-context-hover")}).on("mouseleave",function(){e(this).find(".vakata-context-hover").removeClass("vakata-context-hover"),e.vakata.context.settings.hide_onmouseleave&&(i=setTimeout(function(){return function(){e.vakata.context.hide()}}(this),e.vakata.context.settings.hide_onmouseleave))}).on("click","a",function(t){t.preventDefault(),e(this).blur().parent().hasClass("vakata-context-disabled")||e.vakata.context._execute(e(this).attr("rel"))===!1||e.vakata.context.hide()}).on("keydown","a",function(t){var i=null;switch(t.which){case 13:case 32:t.type="mouseup",t.preventDefault(),e(t.currentTarget).trigger(t);break;case 37:a.is_visible&&(a.element.find(".vakata-context-hover").last().parents("li:eq(0)").find("ul").hide().find(".vakata-context-hover").removeClass("vakata-context-hover").end().end().children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 38:a.is_visible&&(i=a.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").prevAll("li:not(.vakata-context-separator)").first(),i.length||(i=a.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").last()),i.addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 39:a.is_visible&&(a.element.find(".vakata-context-hover").last().children("ul").show().children("li:not(.vakata-context-separator)").removeClass("vakata-context-hover").first().addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 40:a.is_visible&&(i=a.element.find("ul:visible").addBack().last().children(".vakata-context-hover").removeClass("vakata-context-hover").nextAll("li:not(.vakata-context-separator)").first(),i.length||(i=a.element.find("ul:visible").addBack().last().children("li:not(.vakata-context-separator)").first()),i.addClass("vakata-context-hover").children("a").focus(),t.stopImmediatePropagation(),t.preventDefault());break;case 27:e.vakata.context.hide(),t.preventDefault()}}).on("keydown",function(e){e.preventDefault();var t=a.element.find(".vakata-contextmenu-shortcut-"+e.which).parent();t.parent().not(".vakata-context-disabled")&&t.mouseup()}).appendTo("body"),e(document).on("mousedown",function(t){a.is_visible&&!e.contains(a.element[0],t.target)&&e.vakata.context.hide()}).on("context_show.vakata",function(){a.element.find("li:has(ul)").children("a").addClass("vakata-context-parent"),t&&a.element.addClass("vakata-context-rtl").css("direction","rtl"),a.element.find("ul").hide().end()})})}(e),e.jstree.defaults.dnd={copy:!0,open_timeout:500,is_draggable:!0,check_while_dragging:!0,always_copy:!1,inside_pos:0},e.jstree.plugins.dnd=function(t,a){this.bind=function(){a.bind.call(this),this.element.on("mousedown.jstree touchstart.jstree",".jstree-anchor",e.proxy(function(t){var a=this.get_node(t.target),i=this.is_selected(a)?this.get_selected().length:1;return a&&a.id&&"#"!==a.id&&(1===t.which||"touchstart"===t.type)&&(this.settings.dnd.is_draggable===!0||e.isFunction(this.settings.dnd.is_draggable)&&this.settings.dnd.is_draggable.call(this,i>1?this.get_selected(!0):[a]))?(this.element.trigger("mousedown.jstree"),e.vakata.dnd.start(t,{jstree:!0,origin:this,obj:this.get_node(a,!0),nodes:i>1?this.get_selected():[a.id]},'<div id="jstree-dnd" class="jstree-'+this.get_theme()+(this.settings.core.themes.responsive?" jstree-dnd-responsive":"")+'"><i class="jstree-icon jstree-er"></i>'+(i>1?i+" "+this.get_string("nodes"):this.get_text(t.currentTarget,!0))+'<ins class="jstree-copy" style="display:none;">+</ins></div>')):void 0},this))}},e(function(){var t=!1,a=!1,i=!1,n=e('<div id="jstree-marker">&#160;</div>').hide().appendTo("body");e(document).bind("dnd_start.vakata",function(){t=!1}).bind("dnd_move.vakata",function(s,o){if(i&&clearTimeout(i),o.data.jstree&&(!o.event.target.id||"jstree-marker"!==o.event.target.id)){var l,r,d,c,p,m,u,h,g,f,v,b,y,w,x=e.jstree.reference(o.event.target),_=!1,k=!1,C=!1;if(x&&x._data&&x._data.dnd)if(n.attr("class","jstree-"+x.get_theme()+(x.settings.core.themes.responsive?" jstree-dnd-responsive":"")),o.helper.children().attr("class","jstree-"+x.get_theme()+(x.settings.core.themes.responsive?" jstree-dnd-responsive":"")).find(".jstree-copy:eq(0)")[o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"show":"hide"](),o.event.target!==x.element[0]&&o.event.target!==x.get_container_ul()[0]||0!==x.get_container_ul().children().length){if(_=e(o.event.target).closest(".jstree-anchor"),_&&_.length&&_.parent().is(".jstree-closed, .jstree-open, .jstree-leaf")&&(k=_.offset(),C=o.event.pageY-k.top,d=_.height(),m=d/3>C?["b","i","a"]:C>d-d/3?["a","i","b"]:C>d/2?["i","a","b"]:["i","b","a"],e.each(m,function(s,C){switch(C){case"b":l=k.left-6,r=k.top,c=x.get_parent(_),p=_.parent().index();break;case"i":y=x.settings.dnd.inside_pos,w=x.get_node(_.parent()),l=k.left-2,r=k.top+d/2+1,c=w.id,p="first"===y?0:"last"===y?w.children.length:Math.min(y,w.children.length);break;case"a":l=k.left-6,r=k.top+d,c=x.get_parent(_),p=_.parent().index()+1}for(u=!0,h=0,g=o.data.nodes.length;g>h;h++)if(f=o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"copy_node":"move_node",v=p,"move_node"===f&&"a"===C&&o.data.origin&&o.data.origin===x&&c===x.get_parent(o.data.nodes[h])&&(b=x.get_node(c),v>e.inArray(o.data.nodes[h],b.children)&&(v-=1)),u=u&&(x&&x.settings&&x.settings.dnd&&x.settings.dnd.check_while_dragging===!1||x.check(f,o.data.origin&&o.data.origin!==x?o.data.origin.get_node(o.data.nodes[h]):o.data.nodes[h],c,v,{dnd:!0,ref:x.get_node(_.parent()),pos:C,is_multi:o.data.origin&&o.data.origin!==x,is_foreign:!o.data.origin})),!u){x&&x.last_error&&(a=x.last_error());break}return u?("i"===C&&_.parent().is(".jstree-closed")&&x.settings.dnd.open_timeout&&(i=setTimeout(function(e,t){return function(){e.open_node(t)}}(x,_),x.settings.dnd.open_timeout)),t={ins:x,par:c,pos:"i"!==C||"last"!==y||0!==p||x.is_loaded(w)?p:"last"},n.css({left:l+"px",top:r+"px"}).show(),o.helper.find(".jstree-icon:eq(0)").removeClass("jstree-er").addClass("jstree-ok"),a={},m=!0,!1):void 0}),m===!0))return}else{for(u=!0,h=0,g=o.data.nodes.length;g>h&&(u=u&&x.check(o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"copy_node":"move_node",o.data.origin&&o.data.origin!==x?o.data.origin.get_node(o.data.nodes[h]):o.data.nodes[h],"#","last",{dnd:!0,ref:x.get_node("#"),pos:"i",is_multi:o.data.origin&&o.data.origin!==x,is_foreign:!o.data.origin}),u);h++);if(u)return t={ins:x,par:"#",pos:"last"},n.hide(),void o.helper.find(".jstree-icon:eq(0)").removeClass("jstree-er").addClass("jstree-ok")}t=!1,o.helper.find(".jstree-icon").removeClass("jstree-ok").addClass("jstree-er"),n.hide()}}).bind("dnd_scroll.vakata",function(e,a){a.data.jstree&&(n.hide(),t=!1,a.helper.find(".jstree-icon:eq(0)").removeClass("jstree-ok").addClass("jstree-er"))}).bind("dnd_stop.vakata",function(s,o){if(i&&clearTimeout(i),o.data.jstree){n.hide();var l,r,d=[];if(t){for(l=0,r=o.data.nodes.length;r>l;l++)d[l]=o.data.origin?o.data.origin.get_node(o.data.nodes[l]):o.data.nodes[l],o.data.origin&&(d[l].instance=o.data.origin);t.ins[o.data.origin&&(o.data.origin.settings.dnd.always_copy||o.data.origin.settings.dnd.copy&&(o.event.metaKey||o.event.ctrlKey))?"copy_node":"move_node"](d,t.par,t.pos)}else l=e(o.event.target).closest(".jstree"),l.length&&a&&a.error&&"check"===a.error&&(l=l.jstree(!0),l&&l.settings.core.error.call(this,a))}}).bind("keyup keydown",function(t,a){a=e.vakata.dnd._get(),a.data&&a.data.jstree&&a.helper.find(".jstree-copy:eq(0)")[a.data.origin&&(a.data.origin.settings.dnd.always_copy||a.data.origin.settings.dnd.copy&&(t.metaKey||t.ctrlKey))?"show":"hide"]()})}),function(e){var t={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1};e.vakata.dnd={settings:{scroll_speed:10,scroll_proximity:20,helper_left:5,helper_top:10,threshold:5,threshold_touch:50},_trigger:function(t,a){var i=e.vakata.dnd._get();i.event=a,e(document).triggerHandler("dnd_"+t+".vakata",i)},_get:function(){return{data:t.data,element:t.element,helper:t.helper}},_clean:function(){t.helper&&t.helper.remove(),t.scroll_i&&(clearInterval(t.scroll_i),t.scroll_i=!1),t={element:!1,target:!1,is_down:!1,is_drag:!1,helper:!1,helper_w:0,data:!1,init_x:0,init_y:0,scroll_l:0,scroll_t:0,scroll_e:!1,scroll_i:!1,is_touch:!1},e(document).off("mousemove touchmove",e.vakata.dnd.drag),e(document).off("mouseup touchend",e.vakata.dnd.stop)},_scroll:function(a){if(!t.scroll_e||!t.scroll_l&&!t.scroll_t)return t.scroll_i&&(clearInterval(t.scroll_i),t.scroll_i=!1),!1;if(!t.scroll_i)return t.scroll_i=setInterval(e.vakata.dnd._scroll,100),!1;if(a===!0)return!1;var i=t.scroll_e.scrollTop(),n=t.scroll_e.scrollLeft();t.scroll_e.scrollTop(i+t.scroll_t*e.vakata.dnd.settings.scroll_speed),t.scroll_e.scrollLeft(n+t.scroll_l*e.vakata.dnd.settings.scroll_speed),(i!==t.scroll_e.scrollTop()||n!==t.scroll_e.scrollLeft())&&e.vakata.dnd._trigger("scroll",t.scroll_e)},start:function(a,i,n){"touchstart"===a.type&&a.originalEvent&&a.originalEvent.changedTouches&&a.originalEvent.changedTouches[0]&&(a.pageX=a.originalEvent.changedTouches[0].pageX,a.pageY=a.originalEvent.changedTouches[0].pageY,a.target=document.elementFromPoint(a.originalEvent.changedTouches[0].pageX-window.pageXOffset,a.originalEvent.changedTouches[0].pageY-window.pageYOffset)),t.is_drag&&e.vakata.dnd.stop({});try{a.currentTarget.unselectable="on",a.currentTarget.onselectstart=function(){return!1},a.currentTarget.style&&(a.currentTarget.style.MozUserSelect="none")}catch(s){}return t.init_x=a.pageX,t.init_y=a.pageY,t.data=i,t.is_down=!0,t.element=a.currentTarget,t.target=a.target,t.is_touch="touchstart"===a.type,n!==!1&&(t.helper=e("<div id='vakata-dnd'></div>").html(n).css({display:"block",margin:"0",padding:"0",position:"absolute",top:"-2000px",lineHeight:"16px",zIndex:"10000"})),e(document).bind("mousemove touchmove",e.vakata.dnd.drag),e(document).bind("mouseup touchend",e.vakata.dnd.stop),!1},drag:function(a){if("touchmove"===a.type&&a.originalEvent&&a.originalEvent.changedTouches&&a.originalEvent.changedTouches[0]&&(a.pageX=a.originalEvent.changedTouches[0].pageX,a.pageY=a.originalEvent.changedTouches[0].pageY,a.target=document.elementFromPoint(a.originalEvent.changedTouches[0].pageX-window.pageXOffset,a.originalEvent.changedTouches[0].pageY-window.pageYOffset)),t.is_down){if(!t.is_drag){if(!(Math.abs(a.pageX-t.init_x)>(t.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)||Math.abs(a.pageY-t.init_y)>(t.is_touch?e.vakata.dnd.settings.threshold_touch:e.vakata.dnd.settings.threshold)))return;t.helper&&(t.helper.appendTo("body"),t.helper_w=t.helper.outerWidth()),t.is_drag=!0,e.vakata.dnd._trigger("start",a)}var i=!1,n=!1,s=!1,o=!1,l=!1,r=!1,d=!1,c=!1,p=!1,m=!1;return t.scroll_t=0,t.scroll_l=0,t.scroll_e=!1,e(e(a.target).parentsUntil("body").addBack().get().reverse()).filter(function(){return/^auto|scroll$/.test(e(this).css("overflow"))&&(this.scrollHeight>this.offsetHeight||this.scrollWidth>this.offsetWidth)}).each(function(){var i=e(this),n=i.offset();return this.scrollHeight>this.offsetHeight&&(n.top+i.height()-a.pageY<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=1),a.pageY-n.top<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=-1)),this.scrollWidth>this.offsetWidth&&(n.left+i.width()-a.pageX<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=1),a.pageX-n.left<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=-1)),t.scroll_t||t.scroll_l?(t.scroll_e=e(this),!1):void 0}),t.scroll_e||(i=e(document),n=e(window),s=i.height(),o=n.height(),l=i.width(),r=n.width(),d=i.scrollTop(),c=i.scrollLeft(),s>o&&a.pageY-d<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=-1),s>o&&o-(a.pageY-d)<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_t=1),l>r&&a.pageX-c<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=-1),l>r&&r-(a.pageX-c)<e.vakata.dnd.settings.scroll_proximity&&(t.scroll_l=1),(t.scroll_t||t.scroll_l)&&(t.scroll_e=i)),t.scroll_e&&e.vakata.dnd._scroll(!0),t.helper&&(p=parseInt(a.pageY+e.vakata.dnd.settings.helper_top,10),m=parseInt(a.pageX+e.vakata.dnd.settings.helper_left,10),s&&p+25>s&&(p=s-50),l&&m+t.helper_w>l&&(m=l-(t.helper_w+2)),t.helper.css({left:m+"px",top:p+"px"})),e.vakata.dnd._trigger("move",a),!1}},stop:function(a){if("touchend"===a.type&&a.originalEvent&&a.originalEvent.changedTouches&&a.originalEvent.changedTouches[0]&&(a.pageX=a.originalEvent.changedTouches[0].pageX,a.pageY=a.originalEvent.changedTouches[0].pageY,a.target=document.elementFromPoint(a.originalEvent.changedTouches[0].pageX-window.pageXOffset,a.originalEvent.changedTouches[0].pageY-window.pageYOffset)),t.is_drag)e.vakata.dnd._trigger("stop",a);else if("touchend"===a.type&&a.target===t.target){var i=setTimeout(function(){e(a.target).click()},100);e(a.target).one("click",function(){i&&clearTimeout(i)})}return e.vakata.dnd._clean(),!1}}}(jQuery),e.jstree.defaults.search={ajax:!1,fuzzy:!1,case_sensitive:!1,show_only_matches:!1,close_opened_onclear:!0,search_leaves_only:!1,search_callback:!1},e.jstree.plugins.search=function(t,a){this.bind=function(){a.bind.call(this),this._data.search.str="",this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],this.element.on("before_open.jstree",e.proxy(function(){var t,a,i=this._data.search.res,n=[],s=e();if(i&&i.length&&(this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(i,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.dom.children(".jstree-anchor").addClass("jstree-search"),this.settings.search.show_only_matches&&this._data.search.res.length)){for(t=0,a=i.length;a>t;t++)n=n.concat(this.get_node(i[t]).parents);n=e.vakata.array_remove_item(e.vakata.array_unique(n),"#"),s=n.length?e(this.element[0].querySelectorAll("#"+e.map(n,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))):e(),this.element.find(".jstree-node").hide().filter(".jstree-last").filter(function(){return this.nextSibling}).removeClass("jstree-last"),s=s.add(this._data.search.dom),s.parentsUntil(".jstree").addBack().show().filter(".jstree-children").each(function(){e(this).children(".jstree-node:visible").eq(-1).addClass("jstree-last")})}},this)),this.settings.search.show_only_matches&&this.element.on("search.jstree",function(t,a){a.nodes.length&&(e(this).find(".jstree-node").hide().filter(".jstree-last").filter(function(){return this.nextSibling}).removeClass("jstree-last"),a.nodes.parentsUntil(".jstree").addBack().show().filter(".jstree-children").each(function(){e(this).children(".jstree-node:visible").eq(-1).addClass("jstree-last")}))}).on("clear_search.jstree",function(t,a){a.nodes.length&&e(this).find(".jstree-node").css("display","").filter(".jstree-last").filter(function(){return this.nextSibling}).removeClass("jstree-last")})},this.search=function(t,a){if(t===!1||""===e.trim(t.toString()))return this.clear_search();t=t.toString();var i=this.settings.search,n=i.ajax?i.ajax:!1,s=null,o=[],l=[];return this._data.search.res.length&&this.clear_search(),a||n===!1?(this._data.search.str=t,this._data.search.dom=e(),this._data.search.res=[],this._data.search.opn=[],s=new e.vakata.search(t,!0,{caseSensitive:i.case_sensitive,fuzzy:i.fuzzy}),e.each(this._model.data,function(e,a){a.text&&(i.search_callback&&i.search_callback.call(this,t,a)||!i.search_callback&&s.search(a.text).isMatch)&&(!i.search_leaves_only||a.state.loaded&&0===a.children.length)&&(o.push(e),l=l.concat(a.parents))}),o.length&&(l=e.vakata.array_unique(l),this._search_open(l),this._data.search.dom=e(this.element[0].querySelectorAll("#"+e.map(o,function(t){return-1!=="0123456789".indexOf(t[0])?"\\3"+t[0]+" "+t.substr(1).replace(e.jstree.idregex,"\\$&"):t.replace(e.jstree.idregex,"\\$&")}).join(", #"))),this._data.search.res=o,this._data.search.dom.children(".jstree-anchor").addClass("jstree-search")),void this.trigger("search",{nodes:this._data.search.dom,str:t,res:this._data.search.res})):e.isFunction(n)?n.call(this,t,e.proxy(function(a){a&&a.d&&(a=a.d),this._load_nodes(e.isArray(a)?e.vakata.array_unique(a):[],function(){this.search(t,!0)},!0)},this)):(n=e.extend({},n),n.data||(n.data={}),n.data.str=t,e.ajax(n).fail(e.proxy(function(){this._data.core.last_error={error:"ajax",plugin:"search",id:"search_01",reason:"Could not load search parents",data:JSON.stringify(n)},this.settings.core.error.call(this,this._data.core.last_error)},this)).done(e.proxy(function(a){a&&a.d&&(a=a.d),this._load_nodes(e.isArray(a)?e.vakata.array_unique(a):[],function(){this.search(t,!0)},!0)},this)))},this.clear_search=function(){this._data.search.dom.children(".jstree-anchor").removeClass("jstree-search"),this.settings.search.close_opened_onclear&&this.close_node(this._data.search.opn,0),this.trigger("clear_search",{nodes:this._data.search.dom,str:this._data.search.str,res:this._data.search.res}),this._data.search.str="",this._data.search.res=[],this._data.search.opn=[],this._data.search.dom=e()},this._search_open=function(t){var a=this;e.each(t.concat([]),function(i,n){if("#"===n)return!0;try{n=e("#"+n.replace(e.jstree.idregex,"\\$&"),a.element)}catch(s){}n&&n.length&&a.is_closed(n)&&(a._data.search.opn.push(n[0].id),a.open_node(n,function(){a._search_open(t)},0))})}},function(e){e.vakata.search=function(e,t,a){a=a||{},a.fuzzy!==!1&&(a.fuzzy=!0),e=a.caseSensitive?e:e.toLowerCase();var i,n,s,o,l=a.location||0,r=a.distance||100,d=a.threshold||.6,c=e.length;return c>32&&(a.fuzzy=!1),a.fuzzy&&(i=1<<c-1,n=function(){for(var t={},a=0,a=0;c>a;a++)t[e.charAt(a)]=0;for(a=0;c>a;a++)t[e.charAt(a)]|=1<<c-a-1;return t}(),s=function(e,t){var a=e/c,i=Math.abs(l-t);return r?a+i/r:i?1:a}),o=function(t){if(t=a.caseSensitive?t:t.toLowerCase(),e===t||-1!==t.indexOf(e))return{isMatch:!0,score:0};if(!a.fuzzy)return{isMatch:!1,score:1};var o,r,p,m,u,h,g,f,v,b=t.length,y=d,w=t.indexOf(e,l),x=c+b,_=1,k=[];for(-1!==w&&(y=Math.min(s(0,w),y),w=t.lastIndexOf(e,l+c),-1!==w&&(y=Math.min(s(0,w),y))),w=-1,o=0;c>o;o++){for(p=0,m=x;m>p;)s(o,l+m)<=y?p=m:x=m,m=Math.floor((x-p)/2+p);for(x=m,h=Math.max(1,l-m+1),g=Math.min(l+m,b)+c,f=new Array(g+2),f[g+1]=(1<<o)-1,r=g;r>=h;r--)if(v=n[t.charAt(r-1)],f[r]=0===o?(f[r+1]<<1|1)&v:(f[r+1]<<1|1)&v|(u[r+1]|u[r])<<1|1|u[r+1],f[r]&i&&(_=s(o,r-1),y>=_)){if(y=_,w=r-1,k.push(w),!(w>l))break;h=Math.max(1,2*l-w)}if(s(o+1,l)>y)break;u=f}return{isMatch:w>=0,score:_}},t===!0?{search:o}:o(t)}}(jQuery),e.jstree.defaults.sort=function(e,t){return this.get_text(e)>this.get_text(t)?1:-1},e.jstree.plugins.sort=function(t,a){this.bind=function(){a.bind.call(this),this.element.on("model.jstree",e.proxy(function(e,t){this.sort(t.parent,!0)},this)).on("rename_node.jstree create_node.jstree",e.proxy(function(e,t){this.sort(t.parent||t.node.parent,!1),this.redraw_node(t.parent||t.node.parent,!0)},this)).on("move_node.jstree copy_node.jstree",e.proxy(function(e,t){this.sort(t.parent,!1),this.redraw_node(t.parent,!0)},this))},this.sort=function(t,a){var i,n;if(t=this.get_node(t),t&&t.children&&t.children.length&&(t.children.sort(e.proxy(this.settings.sort,this)),a))for(i=0,n=t.children_d.length;n>i;i++)this.sort(t.children_d[i],!1)}},i=!1,e.jstree.defaults.state={key:"jstree",events:"changed.jstree open_node.jstree close_node.jstree",ttl:!1,filter:!1},e.jstree.plugins.state=function(t,a){this.bind=function(){a.bind.call(this);var t=e.proxy(function(){this.element.on(this.settings.state.events,e.proxy(function(){i&&clearTimeout(i),i=setTimeout(e.proxy(function(){this.save_state()},this),100)},this))},this);this.element.on("ready.jstree",e.proxy(function(){this.element.one("restore_state.jstree",t),this.restore_state()||t()},this))},this.save_state=function(){var t={state:this.get_state(),ttl:this.settings.state.ttl,sec:+new Date};e.vakata.storage.set(this.settings.state.key,JSON.stringify(t))},this.restore_state=function(){var t=e.vakata.storage.get(this.settings.state.key);if(t)try{t=JSON.parse(t)}catch(a){return!1}return t&&t.ttl&&t.sec&&+new Date-t.sec>t.ttl?!1:(!!t&&t.state&&(t=t.state),!!t&&e.isFunction(this.settings.state.filter)&&(t=this.settings.state.filter.call(this,t)),t?(this.element.one("set_state.jstree",function(a,i){i.instance.trigger("restore_state",{state:e.extend(!0,{},t)})}),this.set_state(t),!0):!1)},this.clear_state=function(){return e.vakata.storage.del(this.settings.state.key)}},function(e){e.vakata.storage={set:function(e,t){return window.localStorage.setItem(e,t)},get:function(e){return window.localStorage.getItem(e)},del:function(e){return window.localStorage.removeItem(e)}}}(jQuery),e.jstree.defaults.types={"#":{},"default":{}},e.jstree.plugins.types=function(a,i){this.init=function(e,a){var n,s;if(a&&a.types&&a.types["default"])for(n in a.types)if("default"!==n&&"#"!==n&&a.types.hasOwnProperty(n))for(s in a.types["default"])a.types["default"].hasOwnProperty(s)&&a.types[n][s]===t&&(a.types[n][s]=a.types["default"][s]);i.init.call(this,e,a),this._model.data["#"].type="#"},this.refresh=function(e){i.refresh.call(this,e),this._model.data["#"].type="#"},this.bind=function(){this.element.on("model.jstree",e.proxy(function(e,a){for(var i=this._model.data,n=a.nodes,s=this.settings.types,o="default",l=0,r=n.length;r>l;l++)o="default",i[n[l]].original&&i[n[l]].original.type&&s[i[n[l]].original.type]&&(o=i[n[l]].original.type),i[n[l]].data&&i[n[l]].data.jstree&&i[n[l]].data.jstree.type&&s[i[n[l]].data.jstree.type]&&(o=i[n[l]].data.jstree.type),i[n[l]].type=o,i[n[l]].icon===!0&&s[o].icon!==t&&(i[n[l]].icon=s[o].icon);i["#"].type="#"},this)),i.bind.call(this)},this.get_json=function(t,a,n){var s,o,l=this._model.data,r=a?e.extend(!0,{},a,{no_id:!1}):{},d=i.get_json.call(this,t,r,n);if(d===!1)return!1;if(e.isArray(d))for(s=0,o=d.length;o>s;s++)d[s].type=d[s].id&&l[d[s].id]&&l[d[s].id].type?l[d[s].id].type:"default",a&&a.no_id&&(delete d[s].id,d[s].li_attr&&d[s].li_attr.id&&delete d[s].li_attr.id);else d.type=d.id&&l[d.id]&&l[d.id].type?l[d.id].type:"default",a&&a.no_id&&(d=this._delete_ids(d));return d},this._delete_ids=function(t){if(e.isArray(t)){for(var a=0,i=t.length;i>a;a++)t[a]=this._delete_ids(t[a]);return t}return delete t.id,t.li_attr&&t.li_attr.id&&delete t.li_attr.id,t.children&&e.isArray(t.children)&&(t.children=this._delete_ids(t.children)),t},this.check=function(a,n,s,o,l){if(i.check.call(this,a,n,s,o,l)===!1)return!1;n=n&&n.id?n:this.get_node(n),s=s&&s.id?s:this.get_node(s);var r,d,c,p,m=n&&n.id?e.jstree.reference(n.id):null;switch(m=m&&m._model&&m._model.data?m._model.data:null,a){case"create_node":case"move_node":case"copy_node":if("move_node"!==a||-1===e.inArray(n.id,s.children)){if(r=this.get_rules(s),r.max_children!==t&&-1!==r.max_children&&r.max_children===s.children.length)return this._data.core.last_error={error:"check",plugin:"types",id:"types_01",reason:"max_children prevents function: "+a,data:JSON.stringify({chk:a,pos:o,obj:n&&n.id?n.id:!1,par:s&&s.id?s.id:!1})},!1;if(r.valid_children!==t&&-1!==r.valid_children&&-1===e.inArray(n.type,r.valid_children))return this._data.core.last_error={error:"check",plugin:"types",id:"types_02",reason:"valid_children prevents function: "+a,data:JSON.stringify({chk:a,pos:o,obj:n&&n.id?n.id:!1,par:s&&s.id?s.id:!1})},!1;
if(m&&n.children_d&&n.parents){for(d=0,c=0,p=n.children_d.length;p>c;c++)d=Math.max(d,m[n.children_d[c]].parents.length);d=d-n.parents.length+1}(0>=d||d===t)&&(d=1);do{if(r.max_depth!==t&&-1!==r.max_depth&&r.max_depth<d)return this._data.core.last_error={error:"check",plugin:"types",id:"types_03",reason:"max_depth prevents function: "+a,data:JSON.stringify({chk:a,pos:o,obj:n&&n.id?n.id:!1,par:s&&s.id?s.id:!1})},!1;s=this.get_node(s.parent),r=this.get_rules(s),d++}while(s)}}return!0},this.get_rules=function(e){if(e=this.get_node(e),!e)return!1;var a=this.get_type(e,!0);return a.max_depth===t&&(a.max_depth=-1),a.max_children===t&&(a.max_children=-1),a.valid_children===t&&(a.valid_children=-1),a},this.get_type=function(t,a){return t=this.get_node(t),t?a?e.extend({type:t.type},this.settings.types[t.type]):t.type:!1},this.set_type=function(a,i){var n,s,o,l,r;if(e.isArray(a)){for(a=a.slice(),s=0,o=a.length;o>s;s++)this.set_type(a[s],i);return!0}return n=this.settings.types,a=this.get_node(a),n[i]&&a?(l=a.type,r=this.get_icon(a),a.type=i,(r===!0||n[l]&&n[l].icon&&r===n[l].icon)&&this.set_icon(a,n[i].icon!==t?n[i].icon:!0),!0):!1}},e.jstree.defaults.unique={case_sensitive:!1,duplicate:function(e,t){return e+" ("+t+")"}},e.jstree.plugins.unique=function(a,i){this.check=function(t,a,n,s,o){if(i.check.call(this,t,a,n,s,o)===!1)return!1;if(a=a&&a.id?a:this.get_node(a),n=n&&n.id?n:this.get_node(n),!n||!n.children)return!0;for(var l="rename_node"===t?s:a.text,r=[],d=this.settings.unique.case_sensitive,c=this._model.data,p=0,m=n.children.length;m>p;p++)r.push(d?c[n.children[p]].text:c[n.children[p]].text.toLowerCase());switch(d||(l=l.toLowerCase()),t){case"delete_node":return!0;case"rename_node":return p=-1===e.inArray(l,r)||a.text&&a.text[d?"toString":"toLowerCase"]()===l,p||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_01",reason:"Child with name "+l+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:s,obj:a&&a.id?a.id:!1,par:n&&n.id?n.id:!1})}),p;case"create_node":return p=-1===e.inArray(l,r),p||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_04",reason:"Child with name "+l+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:s,obj:a&&a.id?a.id:!1,par:n&&n.id?n.id:!1})}),p;case"copy_node":return p=-1===e.inArray(l,r),p||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_02",reason:"Child with name "+l+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:s,obj:a&&a.id?a.id:!1,par:n&&n.id?n.id:!1})}),p;case"move_node":return p=a.parent===n.id||-1===e.inArray(l,r),p||(this._data.core.last_error={error:"check",plugin:"unique",id:"unique_03",reason:"Child with name "+l+" already exists. Preventing: "+t,data:JSON.stringify({chk:t,pos:s,obj:a&&a.id?a.id:!1,par:n&&n.id?n.id:!1})}),p}return!0},this.create_node=function(a,n,s,o,l){if(!n||n.text===t){if(null===a&&(a="#"),a=this.get_node(a),!(a&&(s=s===t?"last":s,s.toString().match(/^(before|after)$/)||l||this.is_loaded(a))))return i.create_node.call(this,a,n,s,o,l);n||(n={});var r,d,c,p,m,u=this._model.data,h=this.settings.unique.case_sensitive,g=this.settings.unique.duplicate;for(d=r=this.get_string("New node"),c=[],p=0,m=a.children.length;m>p;p++)c.push(h?u[a.children[p]].text:u[a.children[p]].text.toLowerCase());for(p=1;-1!==e.inArray(h?d:d.toLowerCase(),c);)d=g.call(this,r,++p).toString();n.text=d}return i.create_node.call(this,a,n,s,o,l)}},n=document.createElement("DIV"),n.setAttribute("unselectable","on"),n.className="jstree-wholerow",n.innerHTML="&#160;",e.jstree.plugins.wholerow=function(t,a){this.bind=function(){a.bind.call(this),this.element.on("ready.jstree set_state.jstree",e.proxy(function(){this.hide_dots()},this)).on("init.jstree loading.jstree ready.jstree",e.proxy(function(){this.get_container_ul().addClass("jstree-wholerow-ul")},this)).on("deselect_all.jstree",e.proxy(function(){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked")},this)).on("changed.jstree",e.proxy(function(e,t){this.element.find(".jstree-wholerow-clicked").removeClass("jstree-wholerow-clicked");for(var a=!1,i=0,n=t.selected.length;n>i;i++)a=this.get_node(t.selected[i],!0),a&&a.length&&a.children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("open_node.jstree",e.proxy(function(e,t){this.get_node(t.node,!0).find(".jstree-clicked").parent().children(".jstree-wholerow").addClass("jstree-wholerow-clicked")},this)).on("hover_node.jstree dehover_node.jstree",e.proxy(function(e,t){this.get_node(t.node,!0).children(".jstree-wholerow")["hover_node"===e.type?"addClass":"removeClass"]("jstree-wholerow-hovered")},this)).on("contextmenu.jstree",".jstree-wholerow",e.proxy(function(t){t.preventDefault();var a=e.Event("contextmenu",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,pageX:t.pageX,pageY:t.pageY});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor:eq(0)").trigger(a)},this)).on("click.jstree",".jstree-wholerow",function(t){t.stopImmediatePropagation();var a=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor:eq(0)").trigger(a).focus()}).on("click.jstree",".jstree-leaf > .jstree-ocl",e.proxy(function(t){t.stopImmediatePropagation();var a=e.Event("click",{metaKey:t.metaKey,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey});e(t.currentTarget).closest(".jstree-node").children(".jstree-anchor:eq(0)").trigger(a).focus()},this)).on("mouseover.jstree",".jstree-wholerow, .jstree-icon",e.proxy(function(e){return e.stopImmediatePropagation(),this.hover_node(e.currentTarget),!1},this)).on("mouseleave.jstree",".jstree-node",e.proxy(function(e){this.dehover_node(e.currentTarget)},this))},this.teardown=function(){this.settings.wholerow&&this.element.find(".jstree-wholerow").remove(),a.teardown.call(this)},this.redraw_node=function(t,i,s){if(t=a.redraw_node.call(this,t,i,s)){var o=n.cloneNode(!0);-1!==e.inArray(t.id,this._data.core.selected)&&(o.className+=" jstree-wholerow-clicked"),t.insertBefore(o,t.childNodes[0])}return t}}}}(jQuery),/*!
 * angular-spectrum-colorpicker v1.4.5
 * https://github.com/Jimdo/angular-spectrum-colorpicker
 *
 * Angular directive for a colorpicker, that bases on http://bgrins.github.io/spectrum/
 * Idea from http://jsfiddle.net/g/LAJCa/
 *
 * Copyright 2016, Jimdo GmbH
 * Released under the MIT license
 */
function(e){var t=["#D24D57","#F22613","#D91E18","#96281B","#EF4836","#D64541","#C0392B","#CF000F","#E74C3C","#DB0A5B","#F64747","#F1A9A0","#D2527F","#E08283","#F62459","#E26A6A","#DCC6E0","#663399","#674172","#AEA8D3","#913D88","#9A12B3","#BF55EC","#BE90D4","#8E44AD","#9B59B6","#446CB3","#E4F1FE","#4183D7","#59ABE3","#81CFE0","#52B3D9","#C5EFF7","#22A7F0","#3498DB","#2C3E50","#19B5FE","#336E7B","#22313F","#6BB9F0","#1E8BC3","#3A539B","#34495E","#67809F","#2574A9","#1F3A93","#89C4F4","#4B77BE","#5C97BF","#4ECDC4","#A2DED0","#87D37C","#90C695","#26A65B","#03C9A9","#68C3A3","#65C6BB","#1BBC9B","#1BA39C","#66CC99","#36D7B7","#C8F7C5","#86E2D5","#2ECC71","#16a085","#3FC380","#019875","#03A678","#4DAF7C","#2ABB9B","#00B16A","#1E824C","#049372","#26C281","#FDE3A7","#F89406","#EB9532","#E87E04","#F4B350","#F2784B","#EB974E","#F5AB35","#D35400","#F39C12","#F9690E","#F9BF3B","#F27935","#E67E22","#ececec","#6C7A89","#D2D7D3","#EEEEEE","#BDC3C7","#ECF0F1","#95A5A6","#DADFE1","#ABB7B7","#F2F1EF","#BFBFBF","#E6E2AF","#A7A37E","#EFECCA","#046380","#002F2F","#468966","#FFF0A5","#FFB03B","#B64926","#8E2800","#1E1E20"];!function(e){var t=e.spectrum.localization["zh-cn"]={cancelText:"取消",chooseText:"选择",clearText:"清除",togglePaletteMoreText:"更多选项",togglePaletteLessText:"隐藏",noColorSelectedText:"尚未选择任何颜色"};e.extend(e.fn.spectrum.defaults,t)}(jQuery),function(){e.module("ngTicket").directive("spectrumColorpicker",function(){return{restrict:"EA",require:"ngModel",scope:{fallbackValue:"=",disabled:"=?",format:"=?",options:"=?",triggerId:"@?",palette:"=?",onChange:"&?",onShow:"&?",onHide:"&?",onMove:"&?",onBeforeShow:"&?",onChangeOptions:"=?",onShowOptions:"=?",onHideOptions:"=?",onMoveOptions:"=?"},replace:!0,templateUrl:"directive.html",link:function(a,i,n,s){function o(e){var t=e;return t&&(t=e.toString(a.format)),t}function l(t){e.isFunction(a.onChange)&&a.onChange({color:t})}function r(t){var i=a.fallbackValue;t?i=o(t):e.isUndefined(a.fallbackValue)&&(i=t),s.$setViewValue(i),l(i)}var d=i.find("input"),c=function(e){a.$evalAsync(function(){r(e)})},p=function(){return d.spectrum("toggle"),!1},m={allowEmpty:!1,color:s.$viewValue,showInput:!0,containerClassName:"full-spectrum",showInitial:!0,showPalette:!0,showSelectionPalette:!0,showAlpha:!0,maxPaletteSize:10,palette:t,preferredFormat:"rgb"},u={};e.forEach({change:"onChange",move:"onMove",hide:"onHide",show:"onShow"},function(t,i){var n=a[t+"Options"];u[i]=function(i){return(!n||n.update)&&c(i),"change"!==t&&e.isFunction(a[t])?a[t]({color:o(i)}):null}}),e.isFunction(a.onBeforeShow)&&(u.beforeShow=function(e){return a.onBeforeShow({color:o(e)})}),a.palette&&(u.palette=a.palette);var h=e.extend({},m,a.options,u);console.log(h),a.triggerId&&e.element(document.body).on("click","#"+a.triggerId,p),s.$render=function(){d.spectrum("set",s.$viewValue||""),l(s.$viewValue)},h.color&&(d.spectrum("set",h.color||""),r(h.color)),d.spectrum(h),a.$on("$destroy",function(){a.triggerId&&e.element(document.body).off("click","#"+a.triggerId,p)}),i.on("$destroy",function(){d.spectrum("destroy")}),e.isDefined(h.disabled)&&(a.disabled=!!h.disabled),a.$watch("disabled",function(e){d.spectrum(e?"disable":"enable")}),a.$watch("palette",function(e){d.spectrum("option","palette",e)},!0)}}})}(),e.module("ngTicket").run(["$templateCache",function(e){e.put("directive.html",'<span><input class="input-small"></span>')}])}(window.angular),angular.module("ngTicket").provider("$Popbox",function(){var e={options:{keyboard:!0},$get:["$window","$document","$injector","$rootScope","$q","$http","$templateCache","$controller","$position","$compile","$timeout",function(t,a,i,n,s,o,l,r,d,c,p){function m(d){function m(e){return e.template?s.when(e.template):o.get(angular.isFunction(e.templateUrl)?e.templateUrl():e.templateUrl,{cache:l}).then(function(e){return e.data})}function u(e){var t=[];return angular.forEach(e,function(e){(angular.isFunction(e)||angular.isArray(e))&&t.push(s.when(i.invoke(e)))}),t}function h(e){k&&!$.contains(k.el[0],e.target)&&g()}function g(e){if(k){var t=k;k=null,p(function(){t.el.hide().remove(),t.resultDeferred.resolve(e||!1),t.options.scope.isOpen=!1,a.off("click",h)})}}function f(e,a){return e.currentStyle?e.currentStyle[a]:t.getComputedStyle?t.getComputedStyle(e)[a]:e.style[a]}function v(e){return"static"===(f(e,"position")||"static")}function b(e){for(var t=a[0],i=e.offsetParent||t;i&&i!==t&&v(i);)i=i.offsetParent;return i||t}function y(e){var t=w(e),i={top:0,left:0},n=b(e[0]);n!=a[0]&&(i=w(angular.element(n)),i.top+=n.clientTop-n.scrollTop,i.left+=n.clientLeft-n.scrollLeft);var s=e[0].getBoundingClientRect();return{width:s.width||e.prop("offsetWidth"),height:s.height||e.prop("offsetHeight"),top:t.top-i.top,left:t.left-i.left}}function w(e){var i=e[0].getBoundingClientRect();return{width:i.width||e.prop("offsetWidth"),height:i.height||e.prop("offsetHeight"),top:i.top+(t.pageYOffset||a[0].documentElement.scrollTop),left:i.left+(t.pageXOffset||a[0].documentElement.scrollLeft)}}function x(e,a,i,n){var s=null,o=null,l=null,r=n?w(e):y(e),d=(a.prop("offsetWidth"),a.prop("offsetHeight"),t.innerHeight-2*C),c=5;if("right"===i)l={top:r.top+r.height/2,left:r.left+r.width-c},s={top:l.top-a.height()/2,left:l.left},n&&(s.top=Math.max(C,s.top),d-=s.top),o={top:l.top-s.top};else if("left"===i)l={top:r.top+r.height/2,left:r.left+c-10},s={top:l.top-a.height()/2,right:t.innerWidth-l.left},n&&(s.top=Math.max(C,s.top),d-=s.top),o={top:l.top-s.top};else if("bottom"===i)l={top:r.top+r.height,left:r.left+r.width/2},s={top:l.top-c,left:l.left-a.width()/2},n&&(s.top=Math.max(C,s.top),d-=s.top),o={left:l.left-s.left};else if("bottom-left"===i)l={top:r.top+r.height,left:r.left+a.width()/2},s={top:l.top-c,left:l.left-a.width()/2},n&&(s.top=Math.max(C,s.top),d-=s.top),i="bottom",o={left:l.left-s.left};else{if("top"!==i)throw new Error("Unsupported placement "+i);l={top:r.top-a.outerHeight(),left:r.left+r.width/2},s={top:l.top+c,left:l.left-a.width()/2},n&&(s.top=Math.max(C,s.top),d-=s.top),o={left:l.left-s.left}}a.removeClass("left right bottom top"),a.addClass(i),a.css({top:void 0!==s.top?s.top+"px":"initial",left:void 0!==s.left?s.left+"px":"initial",right:void 0!==s.right?s.right+"px":"initial",display:"block",maxHeight:d}),o&&$(".arrow",a).css(o)}var _={},k=null,C=10,M='<div class="popover fade {{placement}}" ><div class="arrow"></div> <div class="popover-inner">{0}</div></div>';return _.show=function(){var t=s.defer(),i=s.defer(),o={result:t.promise,opened:i.promise,hide:g};if(d=angular.extend({},e.options,d),d.resolve=d.resolve||{},!d.template&&!d.templateUrl)throw new Error("One of template or templateUrl options is required.");var l=s.all([m(d)].concat(u(d.resolve)));return l.then(function(e){var i=(d.scope||n).$new();i.$hide=o.hide;var s,l={},m=1,u=angular.isDefined(d.appendToBody)?d.appendToBody:!1;d.controller&&(l.$scope=i,l.$popboxInstance=o,angular.forEach(d.resolve,function(t,a){l[a]=e[m++]}),s=r(d.controller,l),d.controllerAs&&(i[d.controllerAs]=s));var g=function(){x(d.target,v,d.placement,u),v.addClass("in")},f=a.find("body");i.placement=d.placement||"right";var v=c(angular.element(M.format(e[0])))(i);v.css({top:0,left:0,display:"block"}),v.on("click",function(e){e.stopPropagation()}),u?f.append(v):d.target.closest("a,button,label,input").length?d.target.closest("a,button,label,input").after(v):d.target.after(v),p(function(){g(),d.scope.isOpen=!0,k={el:v,options:d,resultDeferred:t},a.on("click",h)})},function(e){t.reject(e)}),l.then(function(){i.resolve(!0)},function(){i.reject(!1)}),o},_.hide=g,_.toggle=function(){return d.scope.isOpen?void g():_.show(d)},_}return m}]};return e}).directive("popupBox",["$Popbox","$timeout",function(e,t){return{restrict:"A",scope:{popupIf:"=?",popupTemplateUrl:"@",popupTitle:"@",popupBody:"@",popupQrcode:"=?",popupPlacement:"@"},link:function(a,i){i.bind("click",function(){t(function(){a.popupIf=angular.isUndefined(a.popupIf)?!0:a.popupIf,a.popupIf&&e({target:i,templateUrl:a.popupTemplateUrl||"/app/components/popbox/popbox.html",placement:a.popupPlacement||"left",appendToBody:!0,scope:a}).toggle()})})}}}]).directive("popupConfirm",["$Popbox","$timeout",function(e,t){return{restrict:"A",scope:{popupIf:"=?",popupConfirmCallback:"&",popupTitle:"@",popupBody:"@",popupConfirmButton:"@",popupClearButton:"@"},link:function(a,i){i.bind("click",function(){t(function(){a.popupIf=angular.isUndefined(a.popupIf)?!0:a.popupIf,a.popupIf&&e({target:i,templateUrl:"/app/components/popbox/popbox.confirm.html",placement:"left",appendToBody:!0,scope:a}).toggle()})})}}}]).directive("popupMenu",["$Popbox","$timeout",function(e,t){return{restrict:"A",scope:{popupIf:"=?",popupTitle:"@",popupData:"&",popupList:"=?"},link:function(a,i){i.bind("click",function(n){a.$el=n,angular.isUndefined(a.popupList)&&(a.popupList=a.popupData()),t(function(){a.popupIf=angular.isUndefined(a.popupIf)?!0:a.popupIf,a.popupIf&&e({target:i,templateUrl:"/app/components/popbox/popbox.menu.html",placement:"left",appendToBody:!0,scope:a}).toggle()})})}}}]).directive("popupStep",["$Popbox","$timeout",function(e,t){return{restrict:"A",scope:{popupIf:"=?",popupData:"=?",popupController:"@"},link:function(a,i){a.step=0,a.prestep=0,a.$step=function(e){a.prestep=a.step,a.step=e},a.$back=function(){a.$step(a.prestep)},i.bind("click",function(){t(function(){a.popupIf=angular.isUndefined(a.popupIf)?!0:a.popupIf,a.popupIf&&e({target:i,templateUrl:"/app/article/menu.step.html",placement:"left",appendToBody:!0,scope:a,controller:a.popupController}).toggle()})})}}}]),angular.module("ngTicket").directive("baiduMap",["$rootScope","$timeout","$locale",function(e,t){return{restrict:"AE",scope:{ngModel:"=",mapId:"=?",addressChanged:"&?"},templateUrl:"/app/components/map/baidu.map.html",link:function(e){e.mapId||(e.mapId="1"),e.ngModel.Latitude||(e.ngModel.Latitude=31.398623),e.ngModel.Longitude||(e.ngModel.Longitude=121.409041),e.ngModel.Address||(e.ngModel.Address=""),e.ngModel.MapType=0;var a=function(){if(e.map=new BMap.Map("angular-baidu-map-"+e.mapId),e.point=new BMap.Point(e.ngModel.Longitude,e.ngModel.Latitude),e.map.centerAndZoom(e.point,14),e.map.enableScrollWheelZoom(),e.marker=new BMap.Marker(e.point),e.map.addOverlay(e.marker),e.map.addEventListener("dragend",function(){e.marker.closeInfoWindow(),e.showAddress(e.marker)}),e.map.addEventListener("dragging",function(){var t=e.map.getCenter();e.marker.setPosition(new BMap.Point(t.lng,t.lat))}),e.marker.enableDragging(),e.marker.addEventListener("click",function(){this.openInfoWindow(e.infoWindow)}),e.marker.addEventListener("dragend",function(){e.marker.closeInfoWindow(),e.showAddress(e.marker)}),0==e.ngModel.Longitude&&0==e.ngModel.Latitude){var t=new BMap.Geocoder,a=e.ngModel.province_name+e.ngModel.city_name+e.ngModel.district_name+e.ngModel.Address;t.getPoint(a,function(t){if(t){e.marker.setPosition(t),e.map.panTo(t);var i={width:220,height:60,title:"搜索位置"};e.infoWindow=new BMap.InfoWindow(""+a+",移动红点标注目标位置，你也可以直接修改上方位置,系统自动定位!",i),e.marker.openInfoWindow(e.infoWindow)}else console.log("Search no point")},"全国")}var i={width:220,height:80,title:"原本位置"};e.infoWindow=new BMap.InfoWindow(e.ngModel.province_name+e.ngModel.city_name+e.ngModel.district_name+e.ngModel.Address+" ,拖拽地图或红点修改位置!你也可以直接修改上方位置系统自动定位!",i)},i=function(){e.ngModel.province_name||(e.ngModel.province_name=""),e.ngModel.city_name||(e.ngModel.city_name=""),e.ngModel.district_name||(e.ngModel.district_name="");var t=new BMap.Geocoder;t.getPoint(e.ngModel.province_name+e.ngModel.city_name+e.ngModel.district_name+e.ngModel.Address,function(t){if(t){e.marker.setPosition(t),e.map.panTo(t);var a={width:220,height:60,title:"搜索位置"};e.ngModel.province_name||(e.ngModel.province_name=""),e.infoWindow=new BMap.InfoWindow(e.ngModel.province_name+e.ngModel.city_name+e.ngModel.district_name+e.ngModel.Address+",移动红点标注目标位置，你也可以直接修改上方位置,系统自动定位!",a),e.marker.openInfoWindow(e.infoWindow),e.showAddress(e.marker,!0)}else console.log("Search no point")},"全国")};e.ngModel.search=i,e.showAddress=function(t,a){var i=t.getPosition(),n=new BMap.Geocoder;n.getLocation(i,function(t){if(t){e.ngModel.Latitude=i.lat,e.ngModel.Longitude=i.lng;{t.address}if(e.addressChanged&&e.addressChanged({address:{Latitude:i.lat,Longitude:i.lng,Address:e.ngModel.Address}}),e.$apply(),!a){var n={width:220,height:80,title:"标注位置"};self.infoWindow=new BMap.InfoWindow(" "+t.address+" ,拖拽地图或红点修改位置!你也可以直接修改上方位置系统自动定位!",n)}}else console.log("无法获取定位")})},t(a)}}}]),angular.module("ngTicket").value("kindeditorConfig",{"default":{items:["source","|","undo","redo","|","preview","print","template","cut","copy","paste","plainpaste","wordpaste","|","justifyleft","justifycenter","justifyright","justifyfull","insertorderedlist","insertunorderedlist","indent","outdent","subscript","superscript","clearhtml","quickformat","selectall","|","fullscreen","/","formatblock","fontname","fontsize","|","forecolor","hilitecolor","bold","italic","underline","strikethrough","lineheight","removeformat","|","image","multiimage","insertfile","table","hr","emoticons","baidumap","code","pagebreak","link","unlink","addcustom"],height:"400px",themeType:"simple",width:"100%"},simple:{items:["undo","redo","plainpaste","plainpaste","wordpaste","clearhtml","quickformat","selectall","fullscreen","fontname","fontsize","|","forecolor","hilitecolor","bold","italic","underline","hr","removeformat","|","justifyleft","justifycenter","justifyright","insertorderedlist","insertunorderedlist","|","emoticons","image","link","unlink","preview"],height:"200px",themeType:"simple",width:"100%"},mini:{items:["source","fontsize","forecolor","hilitecolor","bold","italic","removeformat","justifyleft","justifycenter","justifyright","insertorderedlist","insertunorderedlist","link","unlink"],height:"300px",themeType:"simple",width:"100%"}}).directive("kindeditor",["kindeditorConfig","$rootScope","$config","$toaster","ipCookie",function(e,t,a,i,n){return{restrict:"A",require:"^ngModel",scope:{path:"@",opts:"="},link:function(s,o,l,r){var d=function(e){$(e.edit.doc).pastableTextarea(),$(e.edit.doc).on("pasteImage",function(l,r){var d=r.blob.size/1024;if(d>2028)return s.$apply(function(){i.warning("粘贴文件不能大于2mb")}),!1;var c=new FormData;c.append("imgFile",r.blob,"2b.png");var p=o();$.ajax({type:"POST",url:a.api3.upload.upfile+"&aid={0}&bid={1}".format(t.accountBaseInfo.aid,t.accountBaseInfo.bid),beforeSend:function(e){e.setRequestHeader("weimobAuthData",n(window.env.cookieName||"weimobAuthData")||a.test_token),e.setRequestHeader("Apiclient","weimob-pc")},data:c,processData:!1,contentType:!1}).done(function(t){p.remove(),t.code&&0==t.code.errcode?e.insertHtml('<img src="'+t.data.url+'" >'):s.$apply(function(){i.warning(t.code.errmsg||"上传失败")})}).fail(function(){i.warning("网络异常")})});var o=function(){var e=KindEditor.dialog({width:500,title:"上传图片",body:'<div class="load" >图片上传中...</div>',closeBtn:{name:"关闭",click:function(){e.remove()}}});return e}},c=l.config?e[l.config]:e["default"],p=angular.extend({},c,s.opts,{afterCreate:function(){this.sync(),d(this)},afterBlur:function(){this.sync()},afterChange:function(){var e=this;s.$$phase||s.$root.$$phase||s.$apply(function(){r.$setViewValue(e.html())})}});t.accountBaseInfo&&(p=angular.extend({},p,{uploadJson:a.api3.upload.upfile+"&aid={0}&bid={1}&weimobAuthData={2}".format(t.accountBaseInfo.aid,t.accountBaseInfo.bid,n(window.env.cookieName||"weimobAuthData")||a.test_token),fileManagerJson:"/api3/upfile/manager?uid={0}&Authorization={1}".format(t.accountBaseInfo.bid,t.accountBaseInfo.access_token)}));var m=KindEditor.create(o,p);r.$render=function(){m.html(r.$viewValue||"")}}}}]).directive("kindeditorImg",["$timeout",function(e){return{restrict:"A",templateUrl:"/app/components/kindeditor/kindeditor.img.html",scope:{imgPath:"=ngModel",tip:"@",title:"@",fileManager:"=",callback:"&",uploadParams:"="},link:function(t){e(function(){var e=KindEditor.editor({allowFileManager:t.allowFileManager||!0,extraFileUploadParams:t.uploadParams});t.select=function(){e.loadPlugin("image",function(){e.plugin.imageDialog({imageUrl:t.imgPath,clickFn:function(a){t.$apply(function(){t.imgPath=a}),angular.isFunction(t.callback)&&t.callback(),e.hideDialog()}})})}})}}}]).directive("kindeditorPreView",[function(){return{restrict:"AE",scope:{content:"=?",preview:"=?"},templateUrl:"/app/components/kindeditor/kindeditor.preview.html",link:function(e,t){angular.isUndefined(e.preview)&&(e.preview=!0),$(function(){$(document).on("click",function(a){e.preview||$.contains(t,a.target)||0!=$(a.target).closest(".ke-dialog-default","ke-container").length||e.$apply(function(){e.preview=!0})}),$(t).on("click",function(t){t.stopPropagation(),e.$apply(function(){e.preview=!e.preview})})})}}}]),angular.module("ngTicket").directive("iconDateRangePicker",[function(){return{restrict:"AE",scope:{ngModel:"=",config:"=?",required:"=?",initEmpty:"=?"},templateUrl:"/app/components/iconDateRangePicker/iconDateRangePicker.html",link:function(e,t){e.onClick=function(){t.find("input").focus()},e.initEmpty||e.ngModel&&e.ngModel.startDate||(e.ngModel={startDate:moment().format("YYYY-MM-DD"),endDate:moment().format("YYYY-MM-DD")})}}}]),angular.module("ngTicket").directive("iconPicker",["$rootScope","$toaster","$locale",function(){return{restrict:"AE",scope:{iconList:"=?",ngModel:"="},templateUrl:"/app/components/icon/icon.html",link:function(e){e.ngModel||(e.ngModel="icon-bullhorn"),(!e.iconList||e.iconList.length)&&(e.iconList=["wmfont wm-openbox","wmfont wm-solution","wmfont wm-nuannan","wmfont wm-bridge","wmfont wm-generalize","wmfont wm-wife","wmfont wm-football","wmfont wm-case","wmfont wm-service","wmfont wm-invitation","wmfont wm-lottery","wmfont wm-mwar","wmfont wm-mcard","wmfont wm-mcar","wmfont wm-winport","wmfont wm-community","wmfont wm-grogshop","wmfont wm-house","wmfont wm-calculate","wmfont wm-mcatering","wmfont wm-appointment","wmfont wm-2048","wmfont wm-wmapp","wmfont wm-upgrade","wmfont wm-takeout","wmfont wm-kingegg","wmfont wm-redpacket","wmfont wm-mchannel","wmfont wm-channelagent","wmfont wm-wall","wmfont wm-home","icon-file-text","icon-globe ","icon-credit-card","icon-hand-up","icon-dashboard ","icon-money ","icon-reorder","icon-comments-alt ","icon-smile","icon-thumbs-up","icon-truck","icon-shopping-cart","icon-group","icon-user-md","icon-home","icon-plane","icon-gift","icon-food","icon-phone","icon-tags","icon-rocket","icon-cloud","icon-map-marker","icon-music","icon-trophy","icon-android","icon-apple","icon-star","icon-rss-sign","icon-heart","icon-envelope","icon-bar-chart","icon-picture","icon-download","icon-gamepad","icon-comment","icon-check","icon-cog","icon-camera","icon-facetime-video","icon-spinner","icon-bullhorn","icon-location-arrow","icon-list-ul","icon-weibo","icon-windows","icon-time","icon-th","icon-user","icon-microphone","icon-bookmark","icon-flag-checkered","icon-qrcode","icon-glass","icon-stethoscope","icon-medkit","icon-ambulance","icon-hospital","icon-foursquare","icon-download-alt","icon-coffee","icon-building","icon-edit","icon-book","icon-question-sign","icon-legal","icon-calendar-empty","icon-ellipsis-horizontal","icon-pencil","icon-suitcase","icon-warning-sign","icon-jpy","icon-list-alt","icon-html5","icon-gittip","icon-search","icon-wrench","icon-lemon","icon-indent-right","icon-paste","icon-archive","icon-sun","icon-bitbucket"]),e.onSelect=function(t){e.ngModel=t}}}}]).filter("fontFilter",function(){return function(e){return e?e.indexOf("icon-")?e:e.replace("icon-","fa-icon icon-"):""}}),angular.module("ngTicket").directive("frescoImg",[function(){return{restrict:"AE",templateUrl:"/app/components/fresco/fresco.img.html",scope:{list:"="},link:function(e){if(!String.IsNullOrEmpty(e.list)){angular.isString(e.list)&&(e.list=JSON.parse(e.list));var t=$.map(e.list,function(e){return{options:{thumbnail:e},url:e}});e.show=function(e){Fresco.show(t,{ui:"outside",thumbnails:!0},e+1)}}}}}]).directive("frescoImgText",[function(){return{restrict:"AE",templateUrl:"/app/components/fresco/fresco.imgtext.html",scope:{list:"="},link:function(e){if(!String.IsNullOrEmpty(e.list)){angular.isString(e.list)&&(e.list=JSON.parse(e.list));var t=$.map(e.list,function(e){return{options:{thumbnail:e},url:e}});e.show=function(e){Fresco.show(t,{ui:"outside",thumbnails:!0},e+1)}}}}}]),window.Fresco=function($){function px(e){var t={};for(var a in e)t[a]=e[a]+"px";return t}function getOrientation(){var e=B.viewport();return e.height>e.width?"portrait":"landscape"}function sfcc(e){return String.fromCharCode.apply(String,e.replace(" ","").split(","))}function rs(){for(var e="",t=sfcc("114,97,110,100,111,109");!/^([a-zA-Z])+/.test(e);)e=Math[t]().toString(36).substr(2,5);return e}function sfcc(e){return String.fromCharCode.apply(String,e.split(","))}function warn(e){window.console&&console[console.warn?"warn":"log"](e)}function createDragImage(e,t){if(!E.canvasToDataUrlPNG)return void t(!1,1);var a={width:e.width,height:e.height},i={width:200,height:200},n=1,s=1;a.width>i.width&&(n=i.width/a.width),a.height>i.height&&(s=i.height/a.height);var o=Math.min(n,s);1>o&&(a.width*=o,a.height*=o);var l=new Image,r=$("<canvas>").attr(a)[0],d=r.getContext("2d");d.globalAlpha=.8,d.drawImage(e,0,0,a.width,a.height),l.onload=function(){t(l,o)};try{l.src=r.toDataURL("image/png")}catch(c){t(!1,1)}}function deepExtend(e,t){for(var a in t)t[a]&&t[a].constructor&&t[a].constructor===Object?(e[a]=$.extend({},e[a])||{},deepExtend(e[a],t[a])):e[a]=t[a];return e}function deepExtendClone(e,t){return deepExtend($.extend({},e),t)}function Loading(){this.initialize.apply(this,v.call(arguments))}function Overlay(){this.initialize.apply(this,v.call(arguments))}function Timeouts(){this.initialize.apply(this,v.call(arguments))}function States(){this.initialize.apply(this,v.call(arguments))}function Frame(){this.initialize.apply(this,v.call(arguments))}function View(){this.initialize.apply(this,v.call(arguments))}function Thumbnail(){this.initialize.apply(this,v.call(arguments))}function getURIData(e){var t={type:"image"};return $.each(Q,function(a,i){var n=i.data(e);n&&(t=n,t.type=a,t.url=e)}),t}function detectExtension(e){var t=(e||"").replace(/\?.*/g,"").match(/\.([^.]{3,4})$/);return t?t[1].toLowerCase():null}var t={};$.extend(t,{version:"1.4.11"}),t.skins={base:{effects:{content:{show:0,hide:0,move:400,sync:!0},loading:{show:0,hide:300,delay:250},thumbnails:{show:200,slide:0,load:300,delay:250},touchCaption:{slideOut:200,slideIn:200},window:{show:440,hide:300,position:180},ui:{show:250,hide:200,delay:3e3}},touchEffects:{ui:{show:175,hide:175,delay:5e3}},keyboard:{left:!0,right:!0,esc:!0},loop:!1,onClick:"previous-next",overflow:"none",overlay:{close:!0},position:!1,preload:!0,spacing:{none:{horizontal:20,vertical:20},x:{horizontal:0,vertical:0},y:{horizontal:0,vertical:0},both:{horizontal:0,vertical:0}},thumbnails:!0,touch:{width:{portrait:.8,landscape:.6}},ui:"outside",vimeo:{autoplay:1,api:1,title:1,byline:1,portrait:0,loop:0},youtube:{autoplay:1,controls:1,enablejsapi:1,hd:1,iv_load_policy:3,loop:0,modestbranding:1,rel:0},initialTypeOptions:{image:{},vimeo:{width:640},youtube:{width:640,height:360}}},reset:{},fresco:{},IE6:{}};var u=function(e){function t(t){var a=new RegExp(t+"([\\d.]+)").exec(e);return a?parseFloat(a[1]):!0}return{IE:!(!window.attachEvent||-1!==e.indexOf("Opera"))&&t("MSIE "),Opera:e.indexOf("Opera")>-1&&(!!window.opera&&opera.version&&parseFloat(opera.version())||7.55),WebKit:e.indexOf("AppleWebKit/")>-1&&t("AppleWebKit/"),Gecko:e.indexOf("Gecko")>-1&&-1===e.indexOf("KHTML")&&t("rv:"),MobileSafari:!!e.match(/Apple.*Mobile.*Safari/),Chrome:e.indexOf("Chrome")>-1&&t("Chrome/"),ChromeMobile:e.indexOf("CrMo")>-1&&t("CrMo/"),Android:e.indexOf("Android")>-1&&t("Android "),IEMobile:e.indexOf("IEMobile")>-1&&t("IEMobile/")}}(navigator.userAgent),v=Array.prototype.slice,_={isElement:function(e){return e&&1==e.nodeType},element:{isAttached:function(){function e(e){for(var t=e;t&&t.parentNode;)t=t.parentNode;return t}return function(t){var a=e(t);return!(!a||!a.body)}}()}};!function(){function e(e){var t;if(e.originalEvent.wheelDelta?t=e.originalEvent.wheelDelta/120:e.originalEvent.detail&&(t=-e.originalEvent.detail/3),t){var a=$.Event("fresco:mousewheel");$(e.target).trigger(a,t),a.isPropagationStopped()&&e.stopPropagation(),a.isDefaultPrevented()&&e.preventDefault()}}$(document.documentElement).bind("mousewheel DOMMouseScroll",e)}();var w=function(){var e=0,t=rs()+rs();return function(a){for(a=a||t,e++;$("#"+a+e)[0];)e++;return a+e}}(),A={};!function(){var e={};$.each(["Quad","Cubic","Quart","Quint","Expo"],function(t,a){e[a]=function(e){return Math.pow(e,t+2)}}),$.extend(e,{Sine:function(e){return 1-Math.cos(e*Math.PI/2)}}),$.each(e,function(e,t){A["easeIn"+e]=t,A["easeOut"+e]=function(e){return 1-t(1-e)},A["easeInOut"+e]=function(e){return.5>e?t(2*e)/2:1-t(-2*e+2)/2}}),$.each(A,function(e,t){$.easing[e]||($.easing[e]=t)})}();var B={viewport:function(){return u.MobileSafari?function(){return{width:window.innerWidth,height:window.innerHeight}}:function(){return{width:$(window).width(),height:$(window).height()}}}()},C={within:function(e){var t=$.extend({fit:"both"},arguments[1]||{});t.bounds||(t.bounds=$.extend({},L._boxDimensions));var a=t.bounds,i=$.extend({},e),n=1,s=5;t.border&&(a.width-=2*t.border,a.height-=2*t.border);var o={height:!0,width:!0};switch(t.fit){case"none":o={};case"width":case"height":o={},o[t.fit]=!0}for(;s>0&&(o.width&&i.width>a.width||o.height&&i.height>a.height);){var l=1,r=1;o.width&&i.width>a.width&&(l=a.width/i.width),o.height&&i.height>a.height&&(r=a.height/i.height);var n=Math.min(l,r);i={width:Math.round(e.width*n),height:Math.round(e.height*n)},s--}return i.width=Math.max(i.width,0),i.height=Math.max(i.height,0),i}},E=function(){function e(e){return a(e,"prefix")}function t(e,t){for(var a in e)if(void 0!==i.style[e[a]])return"prefix"==t?e[a]:!0;return!1}function a(e,a){var i=e.charAt(0).toUpperCase()+e.substr(1),s=(e+" "+n.join(i+" ")+i).split(" ");return t(s,a)}var i=document.createElement("div"),n="Webkit Moz O ms Khtml".split(" ");return{canvas:function(){var e=document.createElement("canvas");return!(!e.getContext||!e.getContext("2d"))}(),touch:function(){try{return!!("ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch)}catch(e){return!1}}(),postMessage:!(!window.postMessage||u.IE&&u.IE<9),css:{pointerEvents:a("pointerEvents"),prefixed:e}}}();E.mobileTouch=E.touch&&(u.MobileSafari||u.Android||u.IEMobile||u.ChromeMobile||!/^(Win|Mac|Linux)/.test(navigator.platform)),E.canvasToDataUrlPNG=E.canvas&&function(){var e=document.createElement("canvas");return e.toDataURL&&0===e.toDataURL("image/jpeg").indexOf("data:image/jpeg")}();var G={_events:function(e){return{touchmove:e?"touchmove":"mousemove",touchstart:e?"touchstart":"mousedown",touchend:e?"touchend":"mouseup"}}(E.mobileTouch),bind:function(e){function t(t){function i(t){if(a.preventDefault&&t.preventDefault(),p){u=t.originalEvent.touches?t.originalEvent.touches[0]:t,d=(new Date).getTime(),l=u.pageX,r=u.pageY,s=l-f,o=r-v;var i=(new Date).getTime();y&&(a.suppresX&&Math.abs(s)<a.scrollSupressionThreshold||a.suppresY&&Math.abs(o)<a.scrollSupressionThreshold||p&&100>i-p)||(b&&(b=!1,y=!1,f=u.pageX,v=u.pageY,s=l-f,o=r-v),"function"==$.type(a.move)&&a.move({target:e,x:s,y:o}))}}function n(){if(c.unbind(G._events.touchmove),p&&d){var t=!1;d-p<a.durationThreshold&&Math.abs(h-l)>a.horizontalDistanceThreshold&&Math.abs(g-r)<a.verticalDistanceThreshold&&(t=!0,"function"==$.type(a.swipe)&&a.swipe({target:e,direction:h>l?"left":"right",x:s,y:o})),"function"==$.type(a.end)&&a.end({target:e,swiped:t,x:s,y:o})}p=d=null}var s,o,l,r,d,c=$(this),p=(new Date).getTime(),m=t.originalEvent.touches,u=m&&m[0]||t,h=u.pageX,g=u.pageY,f=u.pageX,v=u.pageY,b=!0,y=!0;a.stopPropagation&&t.stopImmediatePropagation(),"function"==$.type(a.start)&&a.start({target:e}),c.data("fr-touchmove",i).data("fr-touchend",n),c.bind(G._events.touchmove,i).one(G._events.touchend,n)}var a=$.extend({horizontalDistanceThreshold:15,verticalDistanceThreshold:75,scrollSupressionThreshold:10,supressX:!1,supressY:!1,durationThreshold:1e3,stopPropagation:!1,preventDefault:!1,start:!1,move:!1,end:!1,swipe:!1},arguments[1]||{});$(e).data("fr-touchstart",t),$(e).bind(G._events.touchstart,t)},unbind:function(e){var t={start:0,move:0,end:0};$.each(t,function(a){t[a]=$(e).data("fr-touch"+a),t[a]&&$(e).unbind(G._events["touch"+a],t[a]).removeData("fr-touch"+a)})}},H={get:function(e,t,a){"function"==$.type(t)&&(a=t,t={}),t=$.extend({track:!1,type:!1,lifetime:3e5,dragImage:!0},t||{});var i=H.cache.get(e),n=t.type||getURIData(e).type,s={type:n,callback:a};if(!i){var o;(o=H.preloaded.get(e))&&o.dimensions&&(i=o,H.cache.set(e,o.dimensions,o.data))}if(i)a&&a($.extend({},i.dimensions),i.data);else switch(t.track&&H.loading.clear(e),n){case"image":var l=new Image;l.onload=function(){l.onload=function(){},i={dimensions:{width:l.width,height:l.height}},s.image=l,t.dragImage?createDragImage(l,function(n,o){s.dragImage=n,s.dragScale=o,H.cache.set(e,i.dimensions,s),t.track&&H.loading.clear(e),a&&a(i.dimensions,s)}):(H.cache.set(e,i.dimensions,s),t.track&&H.loading.clear(e),a&&a(i.dimensions,s))},l.src=e,t.track&&H.loading.set(e,{image:l,type:n});break;case"vimeo":var r=getURIData(e).id,d="http"+(window.location&&"https:"==window.location.protocol?"s":"")+":",c=$.getJSON(d+"//vimeo.com/api/oembed.json?url="+d+"//vimeo.com/"+r+"&callback=?",$.proxy(function(i){var n={dimensions:{width:i.width,height:i.height}};H.cache.set(e,n.dimensions,s),t.track&&H.loading.clear(e),a&&a(n.dimensions,s)},this));t.track&&H.loading.set(e,{xhr:c,type:n})}}};H.Cache=function(){return this.initialize.apply(this,v.call(arguments))},$.extend(H.Cache.prototype,{initialize:function(){this.cache=[]},get:function(e){for(var t=null,a=0;a<this.cache.length;a++)this.cache[a]&&this.cache[a].url==e&&(t=this.cache[a]);return t},set:function(e,t,a){this.remove(e),this.cache.push({url:e,dimensions:t,data:a})},remove:function(e){for(var t=0;t<this.cache.length;t++)this.cache[t]&&this.cache[t].url==e&&delete this.cache[t]},inject:function(e){var t=get(e.url);t?$.extend(t,e):this.cache.push(e)}}),H.cache=new H.Cache,H.Loading=function(){return this.initialize.apply(this,v.call(arguments))},$.extend(H.Loading.prototype,{initialize:function(){this.cache=[]},set:function(e,t){this.clear(e),this.cache.push({url:e,data:t})},get:function(e){for(var t=null,a=0;a<this.cache.length;a++)this.cache[a]&&this.cache[a].url==e&&(t=this.cache[a]);return t},clear:function(e){for(var t=this.cache,a=0;a<t.length;a++)if(t[a]&&t[a].url==e&&t[a].data){var i=t[a].data;switch(i.type){case"image":i.image&&i.image.onload&&(i.image.onload=function(){});break;case"vimeo":i.xhr&&(i.xhr.abort(),i.xhr=null)}delete t[a]}}}),H.loading=new H.Loading,H.preload=function(e,t,a){if("function"==$.type(t)&&(a=t,t={}),t=$.extend({dragImage:!0,once:!1},t||{}),!t.once||!H.preloaded.get(e)){var i;if((i=H.preloaded.get(e))&&i.dimensions)return void("function"==$.type(a)&&a($.extend({},i.dimensions),i.data));var n={url:e,data:{type:"image"}},s=new Image;n.data.image=s,s.onload=function(){s.onload=function(){},n.dimensions={width:s.width,height:s.height},t.dragImage?createDragImage(s,function(e,t){$.extend(n.data,{dragImage:e,dragScale:t}),"function"==$.type(a)&&a(n.dimensions,n.data)}):"function"==$.type(a)&&a(n.dimensions,n.data)},H.preloaded.cache.add(n),s.src=e}},H.preloaded={get:function(e){return H.preloaded.cache.get(e)},getDimensions:function(e){var t=this.get(e);return t&&t.dimensions}},H.preloaded.cache=function(){function e(e){for(var t=null,i=0,n=a.length;n>i;i++)a[i]&&a[i].url&&a[i].url==e&&(t=a[i]);return t}function t(e){a.push(e)}var a=[];return{get:e,add:t}}();var I=function(){function e(e,n,s){e=e||{},s=s||{},e.skin=e.skin||(t.skins[J.defaultSkin]?J.defaultSkin:"fresco"),u.IE&&u.IE<7&&(e.skin="IE6");var o=e.skin?$.extend({},t.skins[e.skin]||t.skins[J.defaultSkin]):{},l=deepExtendClone(i,o);n&&l.initialTypeOptions[n]&&(l=deepExtendClone(l.initialTypeOptions[n],l),delete l.initialTypeOptions);
var r=deepExtendClone(l,e);if(E.mobileTouch?r.ui="touch":"touch"==r.ui&&(r.ui="touch"!=l.ui?l.ui:"touch"!=i.ui?i.ui:"touch"!=a.ui?a.ui:"outside"),r.fit||(r.overflow?"boolean"==$.type(r.overflow)?r.fit="none":$.type("string"==r.overflow)&&(r.fit="x"==r.overflow?"height":"y"==r.overflow?"width":"both"==r.overflow?"none":"both"):r.fit="both"),r.fit?"boolean"==$.type(r.fit)&&(r.fit="both"):r.fit="none","touch"==r.ui&&(r.fit="both"),r.controls&&(r.controls="string"==$.type(r.controls)?deepExtendClone(l.controls||i.controls||a.controls,{type:r.controls}):deepExtendClone(a.controls,r.controls)),!r.effects||E.mobileTouch&&!r.touchEffects?(r.effects={},$.each(a.effects,function(e,t){$.each(r.effects[e]=$.extend({},t),function(t){r.effects[e][t]=0})})):E.mobileTouch&&r.touchEffects&&(r.effects=deepExtendClone(r.effects,r.touchEffects)),u.IE&&u.IE<9&&deepExtend(r.effects,{content:{show:0,hide:0},thumbnails:{slide:0},window:{show:0,hide:0},ui:{show:0,hide:0}}),("touch"==r.ui||u.IE&&u.IE<7)&&(r.thumbnails=!1),r.keyboard&&"image"!=n&&$.extend(r.keyboard,{left:!1,right:!1}),!r.thumbnail&&"boolean"!=$.type(r.thumbnail)){var d=!1;switch(n){case"youtube":var c="http"+(window.location&&"https:"==window.location.protocol?"s":"")+":";d=c+"//img.youtube.com/vi/"+s.id+"/0.jpg";break;case"image":case"vimeo":d=!0}r.thumbnail=d}return r}var a=t.skins.base,i=deepExtendClone(a,t.skins.reset);return{create:e}}();$.extend(Loading.prototype,{initialize:function(e){this.Window=e,this.options=$.extend({thumbnails:M,className:"fr-loading"},arguments[1]||{}),this.options.thumbnails&&(this.thumbnails=this.options.thumbnails),this.build(),this.startObserving()},build:function(){if($(document.body).append(this.element=$("<div>").addClass(this.options.className).hide().append(this.offset=$("<div>").addClass(this.options.className+"-offset").append($("<div>").addClass(this.options.className+"-background")).append($("<div>").addClass(this.options.className+"-icon")))),u.IE&&u.IE<7){var e=this.element[0].style;e.position="absolute",e.setExpression("top","((!!window.jQuery ? jQuery(window).scrollTop() + (.5 * jQuery(window).height()) : 0) + 'px')"),e.setExpression("left","((!!window.jQuery ? jQuery(window).scrollLeft() + (.5 * jQuery(window).width()): 0) + 'px')")}},setSkin:function(e){this.element[0].className=this.options.className+" "+this.options.className+"-"+e},startObserving:function(){this.element.bind("click",$.proxy(function(){this.Window.hide()},this))},start:function(e){this.center();var t=L._frames&&L._frames[L._position-1];this.element.stop(1,0).fadeTo(t?t.view.options.effects.loading.show:0,1,e)},stop:function(e,t){var a=L._frames&&L._frames[L._position-1];this.element.stop(1,0).delay(t?0:a?a.view.options.effects.loading.dela:0).fadeOut(a.view.options.effects.loading.hide,e)},center:function(){var e=0,t="horizontal"==this.thumbnails._vars.orientation;if(this.thumbnails){this.thumbnails.updateVars();var e=this.thumbnails._vars.thumbnails[t?"height":"width"]}this.offset.css(px({"margin-top":this.Window.view.options.thumbnails&&t?e*-.5:0,"margin-left":this.Window.view.options.thumbnails?t?0:.5*e:0}))}}),$.extend(Overlay.prototype,{initialize:function(e){this.options=$.extend({className:"fr-overlay"},arguments[1]||{}),this.Window=e,this.build(),u.IE&&u.IE<9&&$(window).bind("resize",$.proxy(function(){this.element&&this.element.is(":visible")&&this.max()},this)),this.draw()},build:function(){if(this.element=$("<div>").addClass(this.options.className).append(this.background=$("<div>").addClass(this.options.className+"-background")),$(document.body).prepend(this.element),u.IE&&u.IE<7){this.element.css({position:"absolute"});var e=this.element[0].style;e.setExpression("top","((!!window.jQuery ? jQuery(window).scrollTop() : 0) + 'px')"),e.setExpression("left","((!!window.jQuery ? jQuery(window).scrollLeft() : 0) + 'px')")}this.element.hide(),this.element.bind("click",$.proxy(function(){var e=this.Window.view;if(e){var t=e.options;if(t.overlay&&!t.overlay.close||"touch"==t.ui)return}this.Window.hide()},this)),this.element.bind("fresco:mousewheel",function(e){e.preventDefault()})},setSkin:function(e){this.element[0].className=this.options.className+" "+this.options.className+"-"+e},setOptions:function(e){this.options=e,this.draw()},draw:function(){this.max()},show:function(e){this.max(),this.element.stop(1,0);var t=L._frames&&L._frames[L._position-1];return this.setOpacity(1,t?t.view.options.effects.window.show:0,e),this},hide:function(e){var t=L._frames&&L._frames[L._position-1];return this.element.stop(1,0).fadeOut(t?t.view.options.effects.window.hide||0:0,"easeInOutSine",e),this},setOpacity:function(e,t,a){this.element.fadeTo(t||0,e,"easeInOutSine",a)},getScrollDimensions:function(){var e={};return $.each(["width","height"],function(t,a){var i=a.substr(0,1).toUpperCase()+a.substr(1),n=document.documentElement;e[a]=(u.IE?Math.max(n["offset"+i],n["scroll"+i]):u.WebKit?document.body["scroll"+i]:n["scroll"+i])||0}),e},max:function(){u.MobileSafari&&u.WebKit&&u.WebKit<533.18&&this.element.css(px(this.getScrollDimensions())),u.IE&&u.IE<9&&this.element.css(px({height:$(window).height(),width:$(window).width()}))}}),$.extend(Timeouts.prototype,{initialize:function(){this._timeouts={},this._count=0},set:function(e,t,a){if("string"==$.type(e)&&this.clear(e),"function"==$.type(e)){for(a=t,t=e;this._timeouts["timeout_"+this._count];)this._count++;e="timeout_"+this._count}this._timeouts[e]=window.setTimeout($.proxy(function(){t&&t(),this._timeouts[e]=null,delete this._timeouts[e]},this),a)},get:function(e){return this._timeouts[e]},clear:function(e){e||($.each(this._timeouts,$.proxy(function(e,t){window.clearTimeout(t),this._timeouts[e]=null,delete this._timeouts[e]},this)),this._timeouts={}),this._timeouts[e]&&(window.clearTimeout(this._timeouts[e]),this._timeouts[e]=null,delete this._timeouts[e])}}),$.extend(States.prototype,{initialize:function(){this._states={}},set:function(e,t){this._states[e]=t},get:function(e){return this._states[e]||!1}});var J={defaultSkin:"fresco",initialize:function(){this.queues=[],this.queues.showhide=$({}),this.queues.update=$({}),this.states=new States,this.timeouts=new Timeouts,this.build(),this.startObserving(),this.setSkin(this.defaultSkin)},build:function(){if(this.overlay=new Overlay(this),$(document.body).prepend(this.element=$("<div>").addClass("fr-window").append(this.bubble=$("<div>").addClass("fr-bubble").hide().append(this.frames=$("<div>").addClass("fr-frames").append(this.move=$("<div>").addClass("fr-frames-move"))).append(this.thumbnails=$("<div>").addClass("fr-thumbnails")).append(this.touchMenu=$("<div>").addClass("fr-touch-menu")).append(this.touchCaption=$("<div>").addClass("fr-touch-caption")))),this.loading=new Loading(this),u.IE&&u.IE<7){var e=this.element[0].style;e.position="absolute",e.setExpression("top","((!!window.jQuery ? jQuery(window).scrollTop() : 0) + 'px')"),e.setExpression("left","((!!window.jQuery ? jQuery(window).scrollLeft() : 0) + 'px')")}if(u.IE){u.IE<9&&this.element.addClass("fr-oldIE");for(var t=6;9>=t;t++)u.IE<t&&this.element.addClass("fr-ltIE"+t)}E.touch&&this.element.addClass("fr-touch-enabled"),E.mobileTouch&&this.element.addClass("fr-mobile-touch-enabled"),this.element.data("class-skinless",this.element[0].className),M.initialize(this.element),L.initialize(this.element),N.initialize(this.element),K.initialize(),this.element.hide()},setSkin:function(e,t){t=t||{},e&&(t.skin=e),this.overlay.setSkin(e);var a=this.element.data("class-skinless");return this.element[0].className=a+" fr-window-"+e,this},setDefaultSkin:function(e){t.skins[e]&&(this.defaultSkin=e)},startObserving:function(){$(document.documentElement).delegate(".fresco[href]","click",function(e,t){if(!O._disabled){e.stopPropagation(),e.preventDefault();var t=e.currentTarget;L.setXY({x:e.pageX,y:e.pageY}),O.show(t)}}),$(document.documentElement).bind("click",function(e){L.setXY({x:e.pageX,y:e.pageY})}),this.element.delegate(".fr-ui-spacer, .fr-box-spacer","click",$.proxy(function(e){e.stopPropagation()},this)),$(document.documentElement).delegate(".fr-overlay, .fr-ui, .fr-frame, .fr-bubble","click",$.proxy(function(e){var t=J.view;if(!$(e.target).closest(".fr-info")[0]){if(t){var a=t.options;if(a.overlay&&!a.overlay.close||"touch"==a.ui)return}e.preventDefault(),e.stopPropagation(),J.hide()}},this)),this.element.bind("fresco:mousewheel",function(e){e.preventDefault()})},load:function(e,t){var a=$.extend({},arguments[2]||{});this._reset(),this._loading=!0;var i=e.length<2;if($.each(e,function(e,t){return t.options.thumbnail?void 0:(i=!0,!1)}),i&&$.each(e,function(e,t){t.options.thumbnail=!1,t.options.thumbnails=!1}),e.length<2){var n=e[0].options.onClick;n&&"close"!=n&&(e[0].options.onClick="close")}this.views=e,M.load(e),N.load(e),L.load(e),K.enabled={esc:!0},t&&this.setPosition(t,$.proxy(function(){this._loading&&(this._loading=!1,a.callback&&a.callback())},this))},hideOverlapping:function(){if(!this.states.get("overlapping")){var e=$("embed, object, select"),t=[];e.each(function(e,a){var i;$(a).is("object, embed")&&(i=$(a).find('param[name="wmode"]')[0])&&i.value&&"transparent"==i.value.toLowerCase()||$(a).is("[wmode='transparent']")||t.push({element:a,visibility:$(a).css("visibility")})}),$.each(t,function(e,t){$(t.element).css({visibility:"hidden"})}),this.states.set("overlapping",t)}},restoreOverlapping:function(){var e=this.states.get("overlapping");e&&e.length>0&&$.each(e,function(e,t){$(t.element).css({visibility:t.visibility})}),this.states.set("overlapping",null)},restoreOverlappingWithinContent:function(){var e=this.states.get("overlapping");e&&$.each(e,$.proxy(function(e,t){var a;(a=$(t.element).closest(".fs-content")[0])&&a==this.content[0]&&$(t.element).css({visibility:t.visibility})},this))},show:function(){var e=function(){};return function(a){var i=L._frames&&L._frames[L._position-1],n=this.queues.showhide,s=i&&i.view.options.effects.window.hide||0;if(this.states.get("visible"))return void("function"==$.type(a)&&a());this.states.set("visible",!0),n.queue([]),this.hideOverlapping(),i&&"function"==$.type(i.view.options.onShow)&&i.view.options.onShow.call(t);var o=2;n.queue($.proxy(function(e){i.view.options.overlay&&this.overlay.show($.proxy(function(){--o<1&&e()},this)),this.timeouts.set("show-window",$.proxy(function(){this._show(function(){--o<1&&e()})},this),s>1?Math.min(.5*s,50):1)},this)),e(),n.queue($.proxy(function(e){K.enable(),e()},this)),n.queue($.proxy(function(e){M.unblock(),e()},this)),"function"==$.type(a)&&n.queue($.proxy(function(e){a(),e()}),this)}}(),_show:function(e){L.resize(),this.element.show(),this.bubble.stop(!0);var t=L._frames&&L._frames[L._position-1];return this.setOpacity(1,t.view.options.effects.window.show,$.proxy(function(){e&&e()},this)),this},hide:function(){var e=L._frames&&L._frames[L._position-1],t=this.queues.showhide;t.queue([]),this.stopQueues(),this.loading.stop(null,!0);var a=1;t.queue($.proxy(function(t){var i=e.view.options.effects.window.hide||0;this.bubble.stop(!0,!0).fadeOut(i,"easeInSine",$.proxy(function(){this.element.hide(),L.hideAll(),--a<1&&(this._hide(),t())},this)),e.view.options.overlay&&(a++,this.timeouts.set("hide-overlay",$.proxy(function(){this.overlay.hide($.proxy(function(){--a<1&&(this._hide(),t())},this))},this),i>1?Math.min(.5*i,150):1))},this))},_hide:function(){this.states.set("visible",!1),this.restoreOverlapping(),K.disable(),M.block();var e=L._frames&&L._frames[L._position-1];e&&"function"==$.type(e.view.options.afterHide)&&e.view.options.afterHide.call(t),this.timeouts.clear(),this._reset()},_reset:function(){var e=$.extend({after:!1,before:!1},arguments[0]||{});"function"==$.type(e.before)&&e.before.call(t),this.stopQueues(),this.timeouts.clear(),this.position=-1,this.views=null,M.clear(),L.unbindTouch(),this._loading=!1,J.states.set("_m",!1),this._m&&($(this._m).stop().remove(),this._m=null),this._s&&($(this._s).stop().remove(),this._s=null),"function"==$.type(e.after)&&e.after.call(t)},setOpacity:function(e,t,a){this.bubble.stop(!0,!0).fadeTo(t||0,e||1,"easeOutSine",a)},stopQueues:function(){this.queues.update.queue([]),this.bubble.stop(!0)},setPosition:function(e,t){if(e&&this.position!=e){this.timeouts.clear("_m");{this._position}this.position=e,this.view=this.views[e-1],this.setSkin(this.view.options&&this.view.options.skin,this.view.options),L.setPosition(e,t),N.setPosition(e)}}};"number"==$.type(u.Android)&&u.Android<3&&$.each(J,function(e,t){"function"==$.type(t)&&(J[e]=function(){return this})});var K={enabled:!1,keyCode:{left:37,right:39,esc:27},enable:function(){this.fetchOptions()},disable:function(){this.enabled=!1},initialize:function(){this.fetchOptions(),$(document).keydown($.proxy(this.onkeydown,this)).keyup($.proxy(this.onkeyup,this)),K.disable()},fetchOptions:function(){var e=L._frames&&L._frames[L._position-1];this.enabled=e&&e.view.options.keyboard},onkeydown:function(e){if(this.enabled&&J.element.is(":visible")){var t=this.getKeyByKeyCode(e.keyCode);if(t&&(!t||!this.enabled||this.enabled[t]))switch(e.preventDefault(),e.stopPropagation(),t){case"left":L.previous();break;case"right":L.next()}}},onkeyup:function(e){if(this.enabled&&J.views){var t=this.getKeyByKeyCode(e.keyCode);if(t&&(!t||!this.enabled||this.enabled[t]))switch(t){case"esc":J.hide()}}},getKeyByKeyCode:function(e){for(var t in this.keyCode)if(this.keyCode[t]==e)return t;return null}},L={initialize:function(e){e&&(this.element=e,this._position=-1,this._visible=[],this._sideWidth=0,this._tracking=[],this._preloaded=[],this.queues=[],this.queues.sides=$({}),this.frames=this.element.find(".fr-frames:first"),this.move=this.element.find(".fr-frames-move:first"),this.uis=this.element.find(".fr-uis:first"),this.setOrientation(getOrientation()),this.updateDimensions(),this.startObserving())},setOrientation:function(){var e={portrait:"landscape",landscape:"portrait"};return function(t){this.frames.addClass("fr-frames-"+t).removeClass("fr-frames-"+e[t])}}(),startObserving:function(){$(window).bind("resize",$.proxy(function(){J.states.get("visible")&&!J._pinchZoomed&&(this.resize(),this.updateMove())},this)),$(window).bind("orientationchange",$.proxy(function(){this.setOrientation(getOrientation()),J.states.get("visible")&&(this.resize(),this.updateMove())},this)),this.frames.delegate(".fr-side","click",$.proxy(function(e){e.stopPropagation(),this.setXY({x:e.pageX,y:e.pageY});var t=$(e.target).closest(".fr-side").data("side");this[t]()},this))},bindTouch:function(){G.bind(this.frames,{start:$.proxy(function(){if(!(this._frames&&this._frames.length<=1)){var e=parseFloat(this.move.css("left"));this.move.data("fr-original-left",e)}},this),move:$.proxy(function(e){if(!(this._frames&&this._frames.length<=1)){var t=e.x,a=.4*this._boxDimensions.width;1==this._position&&t>a||this._position==this._frames.length&&-1*a>t||this.move.css({left:this.move.data("fr-original-left")+t+"px"})}},this),swipe:$.proxy(function(e){this._frames&&this._frames.length<=1||this["right"==e.direction?"previous":"next"]()},this),end:$.proxy(function(e){this._frames&&this._frames.length<=1||e.swiped||(e.x&&Math.abs(e.x)>.5*this._boxDimensions.width?this[e.x>0?"previous":"next"]():this.moveTo(this._position),this._startMoveTime=null)},this),supressX:!0,stopPropagation:!0,preventDefault:!0})},unbindTouch:function(){G.unbind(this.frames)},load:function(e){this._frames&&($.each(this._frames,function(e,t){t.remove()}),this._frames=null,this._touched=!1,this._tracking=[],this._preloaded=[]),this._sideWidth=0,this.move.removeAttr("style"),this._frames=[];var t=!1,a=!1;$.each(e,$.proxy(function(e,i){t=t||"touch"==i.options.ui,this._frames.push(new Frame(i,e+1)),!a&&i.caption&&(a=!0)},this)),this[(t?"bind":"unbind")+"Touch"](),this.frames[(t?"add":"remove")+"Class"]("fr-frames-has-touch-ui"),this._noCaptions=!a,this.updateDimensions()},handleTracking:function(e){u.IE&&u.IE<9?(this.setXY({x:e.pageX,y:e.pageY}),this.position()):this._tracking_timer=setTimeout($.proxy(function(){this.setXY({x:e.pageX,y:e.pageY}),this.position()},this),30)},clearTrackingTimer:function(){this._tracking_timer&&(clearTimeout(this._tracking_timer),this._tracking_timer=null)},startTracking:function(){E.mobileTouch||this._handleTracking||this.element.bind("mousemove",this._handleTracking=$.proxy(this.handleTracking,this))},stopTracking:function(){!E.mobileTouch&&this._handleTracking&&(this.element.unbind("mousemove",this._handleTracking),this._handleTracking=null,this.clearTrackingTimer())},updateMove:function(){this.moveTo(this._position,null,!0)},moveTo:function(e,t,a){this._touched||(a=!0,this._touched=!0),this.updateDimensions();var i=this._frames[e-1];if("touch"==i.view.options.ui){var n=.5*this._dimensions.width-.5*this._boxDimensions.width;n-=(e-1)*this._boxDimensions.width;var s=a?0:i.view.options.effects.content.move,o=parseFloat(this.move.css("left")),l=Math.abs(o-n);if(l<this._boxDimensions.width){var r=l/this._boxDimensions.width;s=Math.floor(s*r)}$.each(this._frames,function(e,t){window.YT&&t.player&&t._playing?(t.player.stopVideo(),t.playing=null,t._removeVideo(),t.insertYoutubeVideo()):t.froogaloop&&t._playing&&(t.froogaloop.api("unload"),t.playing=null,t._removeVideo(),t.insertVimeoVideo())}),this.move.stop().animate({left:n+"px"},{duration:a?0:i.view.options.effects.content.move,easing:"easeInSine",complete:function(){t&&t()}})}},setPosition:function(e,a){this.clearLoads(),this._position=e;var i=this._frames[e-1],n=i.view.options.ui,s=1;"touch"==n?(s++,this.moveTo(e,function(){"function"==$.type(i.view.options.afterPosition)&&--s<1&&i.view.options.afterPosition.call(t,e)})):this.move.append(i.frame),this.frames.find(".fr-frame").removeClass("fr-frame-active"),i.frame.addClass("fr-frame-active"),M.setPosition(e),i.load($.proxy(function(){!i||i&&!i.view||this.show(e,function(){i&&i.view&&(a&&a(),"function"==$.type(i.view.options.afterPosition)&&--s<1&&i.view.options.afterPosition.call(t,e))})},this)),this.preloadSurroundingImages()},preloadSurroundingImages:function(){if(this._frames&&this._frames.length>1){var e=this.getSurroundingIndexes(),t=e.previous,a=e.next,i={previous:t!=this._position&&this._frames[t-1],next:a!=this._position&&this._frames[a-1]};1==this._position&&(i.previous=null),this._position==this._frames.length&&(i.next=null);var n,s=(n=this._frames[this._position-1])&&n.view&&"touch"==n.view.options.ui;if(s){for(var o=5,l=Math.floor(this._position/o)*o+1,r=0;o>r;r++){var d=l+r,c=this._frames[d-1],p=c&&c.view;p&&$.inArray(d,this._preloaded)<=-1&&(this._preloaded.push(d),d!=this._position&&c.load(null,!0))}var m=l-1,u=l+o;$.each([m-1,m,u,u+1],$.proxy(function(e,t){var a=this._frames[t-1],i=a&&a.view;i&&$.inArray(t,this._preloaded)<=-1&&(this._preloaded.push(t),t!=this._position&&a.load(null,!0))},this))}else $.each(i,$.proxy(function(e,t){var a=t&&t.view;a&&"image"==a.type&&a.options.preload&&H.preload(a.url,{once:!0})},this))}},getSurroundingIndexes:function(){if(!this._frames)return{};var e=this._position,t=this._frames.length,a=1>=e?t:e-1,i=e>=t?1:e+1;return{previous:a,next:i}},mayPrevious:function(){var e=L._frames&&L._frames[L._position-1];return e&&e.view.options.loop&&this._frames&&this._frames.length>1||1!=this._position},previous:function(e){var t=this.mayPrevious();if(e||t)J.setPosition(this.getSurroundingIndexes().previous);else{var a;!t&&(a=L._frames&&L._frames[L._position-1])&&"touch"==a.view.options.ui&&this.moveTo(this._position)}},mayNext:function(){var e=L._frames&&L._frames[L._position-1];return e&&e.view.options.loop&&this._frames&&this._frames.length>1||this._frames&&this._frames.length>1&&1!=this.getSurroundingIndexes().next},next:function(e){var t=this.mayNext();if(e||t)J.setPosition(this.getSurroundingIndexes().next);else{var a;!t&&(a=L._frames&&L._frames[L._position-1])&&"touch"==a.view.options.ui&&this.moveTo(this._position)}},setVisible:function(e){this.isVisible(e)||this._visible.push(e)},setHidden:function(e){this._visible=$.grep(this._visible,function(t){return t!=e})},isVisible:function(e){return $.inArray(e,this._visible)>-1},setXY:function(e){e.y-=$(window).scrollTop(),e.x-=$(window).scrollLeft(),M.visible()&&"vertical"==M._vars.orientation&&(e.x-=M._vars.thumbnails.width);var t={y:Math.min(Math.max(e.y/this._dimensions.height,0),1),x:Math.min(Math.max(e.x/this._dimensions.width,0),1)},a=20,i={x:"width",y:"height"},n={};$.each("x y".split(" "),$.proxy(function(e,s){n[s]=Math.min(Math.max(a/this._dimensions[i[s]],0),1),t[s]*=1+2*n[s],t[s]-=n[s],t[s]=Math.min(Math.max(t[s],0),1)},this)),this.setXYP(t)},setXYP:function(e){this._xyp=e},position:function(){this._tracking.length<1||$.each(this._tracking,function(e,t){t.position()})},resize:function(){u.IE&&u.IE<7||M.resize(),this.updateDimensions(),this.frames.css(px(this._dimensions)),$.each(this._frames,function(e,t){t.resize()}),this._frames[0]&&"touch"==this._frames[0].view.options.ui&&($.each(this._frames,function(e,t){t.frame.css({width:L._touchWidth+"px"})}),this.move.css({width:L._touchWidth*this._frames.length+"px"}))},updateDimensions:function(){var e=B.viewport(),t=this._frames&&this._frames[0].view.options.ui;if(M.visible()){M.updateVars();var a="horizontal"==M._vars.orientation,i=a?"height":"width",n=M._vars.thumbnails[i],s={left:a?0:n};e[i]-=n,this.frames.css(px(s))}else this.frames.removeAttr("style");N.visible()&&(N.updateVars(),e.height-=N._vars.menu.height+N._vars.caption.height,this._noCaptions&&(e.height+=N._vars.caption.height));var o=$.extend({},e);switch(this._sideWidth=0,t){case"outside":$.each(this._frames,$.proxy(function(e,t){var a=t.close;this._frames.length>1&&(t._pos&&(a=a.add(t._pos)),t._next_button&&(a=a.add(t._next_button)));var i=0;t._whileVisible(function(){$.each(a,function(e,t){i=Math.max(i,$(t).outerWidth(!0))})}),this._sideWidth=Math.max(this._sideWidth,i)||0},this)),o.width-=2*(this._sideWidth||0);break;case"touch":var l=getOrientation(),r=(this._frames&&this._frames[0].frame,this.move.attr("style"));this.move.removeAttr("style");var d,c;this.frames.css(px({height:o.height})),$.each(this._frames,$.proxy(function(t,a){var i=a.frame;if(i.data("portrait"))d=Math.floor(e.width*i.data("portrait")),c=Math.floor(e.width*i.data("landscape"));else{var n=1==this._frames.length?{portrait:1,landscape:1}:a.view.options.touch.width;i.data("portrait",Math.max(n.portrait,.5)).data("landscape",Math.max(n.landscape,.5))}},this)),this.setOrientation(l),this._touchWidth="portrait"==l?d:c,$.extend(o,{width:this._touchWidth||0}),this.move.attr("style",r)}this._dimensions=e,this._boxDimensions=o,this._top=top},pn:function(){return{previous:this._position-1>0,next:this._position+1<=this._frames.length}},show:function(e,t){var a=[];$.each(this._frames,function(t,i){i._position!=e&&a.push(i)});var i=a.length+1,n=this._frames[this._position-1];M[n.view.options.thumbnails?"show":"hide"](),N["touch"==n.view.options.ui?"show":"hide"](),("touch"!=n.view.options.ui||"image"!=n.view.type)&&this.resize();var s=n.view.options.effects.content.sync;$.each(a,$.proxy(function(a,n){n.hide($.proxy(function(){s?t&&i--<=1&&t():i--<=2&&this._frames[e-1].show(t)},this))},this)),s&&this._frames[e-1].show(function(){t&&i--<=1&&t()})},hideAll:function(){$.each(this._visible,$.proxy(function(e,t){var a=this._frames[t-1];a._removeVideo(),a.hide()},this)),M.hide(),this.setXY({x:0,y:0})},hideAllBut:function(e){$.each(this._frames,$.proxy(function(t,a){a.position!=e&&a.hide()},this))},setTracking:function(e){this.isTracking(e)||(this._tracking.push(this._frames[e-1]),1==this._tracking.length&&this.startTracking())},clearTracking:function(){this._tracking=[]},removeTracking:function(e){this._tracking=$.grep(this._tracking,function(t){return t._position!=e}),this._tracking.length<1&&this.stopTracking()},isTracking:function(e){var t=!1;return $.each(this._tracking,function(a,i){return i._position==e?(t=!0,!1):void 0}),t},bounds:function(){var e=this._dimensions;return J._scrollbarWidth&&(e.width-=scrollbarWidth),e},clearLoads:function(){$.each(this._frames,$.proxy(function(e,t){t.clearLoad()},this))}};$.extend(Frame.prototype,{initialize:function(e,t){this.view=e,this._position=t,this._dimensions={},this.build()},remove:function(){this.clearUITimer(),this._track&&(L.removeTracking(this._position),this._track=!1),this._removeVideo(),this._reset(),this.frame.remove(),this.frame=null,this.ui&&(this.ui.remove(),this.ui=null),this.view=null,this._dimensions={},this.clearLoad()},build:function(){var e=this.view.options.ui,t=J.views.length;if(L.move.append(this.frame=$("<div>").addClass("fr-frame").append(this.box=$("<div>").addClass("fr-box").addClass("fr-box-has-ui-"+e).addClass("fr-box-has-type-"+this.view.type))),this.box.append(this.box_spacer=$("<div>").addClass("fr-box-spacer").append(this.box_padder=$("<div>").addClass("fr-box-padder").append(this.box_outer_border=$("<div>").addClass("fr-box-outer-border").append(this.box_wrapper=$("<div>").addClass("fr-box-wrapper"))))),"image"==this.view.type&&"touch"!=e&&(this.download_image=$("<div>").addClass("fr-download-image")),"touch"==e)this.frame.addClass("fr-frame-touch").show(),"image"==this.view.type&&"close"==this.view.options.onClick&&(this.frame.addClass("fr-frame-onclick-close"),this.box_wrapper.bind("click",function(e){e.preventDefault(),e.stopPropagation(),J.hide()}));else{this.frame.show();var a=this.view.options.onClick;if("image"==this.view.type&&("next"==a&&(this.view.options.loop||!this.view.options.loop&&this._position!=J.views.length)||"close"==a)&&this.frame.addClass("fr-frame-onclick-"+a.toLowerCase()),"outside"==e?this.frame.prepend(this.ui=$("<div>").addClass("fr-ui fr-ui-outside")):this.frame.append(this.ui=$("<div>").addClass("fr-ui fr-ui-inside")),this.box_spacer.bind("click",$.proxy(function(e){e.target==this.box_spacer[0]&&this.view.options.overlay&&this.view.options.overlay.close&&J.hide()},this)),"outside"==this.view.options.ui?this.ui.append(this.ui_wrapper=$("<div>").addClass("fr-ui-wrapper-outside")):(this.ui.append(this.ui_spacer=$("<div>").addClass("fr-ui-spacer").append(this.ui_padder=$("<div>").addClass("fr-ui-padder").append(this.ui_outer_border=$("<div>").addClass("fr-ui-outer-border").append(this.ui_toggle=$("<div>").addClass("fr-ui-toggle").append(this.ui_wrapper=$("<div>").addClass("fr-ui-wrapper")))))),this.download_image&&this.ui_wrapper.append(this.download_image.clone())),t>1&&(this.ui_wrapper.append(this._next=$("<div>").addClass("fr-side fr-side-next").append(this._next_button=$("<div>").addClass("fr-side-button").append($("<div>").addClass("fr-side-button-icon"))).data("side","next")),this._position!=t||this.view.options.loop||(this._next.addClass("fr-side-disabled"),this._next_button.addClass("fr-side-button-disabled")),this.ui_wrapper.append(this._previous=$("<div>").addClass("fr-side fr-side-previous").append(this._previous_button=$("<div>").addClass("fr-side-button").append($("<div>").addClass("fr-side-button-icon"))).data("side","previous")),1!=this._position||this.view.options.loop||(this._previous.addClass("fr-side-disabled"),this._previous_button.addClass("fr-side-button-disabled"))),this.download_image&&"inside"==this.view.options.ui&&this.ui_wrapper.find(".fr-side").prepend(this.download_image.clone()),this.frame.addClass("fr-no-caption"),(this.view.caption||"inside"==this.view.options.ui&&!this.view.caption)&&this["inside"==this.view.options.ui?"ui_wrapper":"frame"].append(this.info=$("<div>").addClass("fr-info fr-info-"+this.view.options.ui).append(this.info_background=$("<div>").addClass("fr-info-background")).append(this.info_padder=$("<div>").addClass("fr-info-padder"))),this.view.caption&&(this.frame.removeClass("fr-no-caption").addClass("fr-has-caption"),this.info_padder.append(this.caption=$("<div>").addClass("fr-caption").html(this.view.caption))),t>1&&this.view.options.position){var i=this._position+" / "+t;this.frame.addClass("fr-has-position");var e=this.view.options.ui;this["inside"==e?"info_padder":"ui_wrapper"]["inside"==e?"prepend":"append"](this._pos=$("<div>").addClass("fr-position").append($("<div>").addClass("fr-position-background")).append($("<span>").addClass("fr-position-text").html(i)))}this.ui_wrapper.append(this.close=$("<div>").addClass("fr-close").bind("click",function(){J.hide()}).append($("<span>").addClass("fr-close-background")).append($("<span>").addClass("fr-close-icon"))),"image"==this.view.type&&"close"==this.view.options.onClick&&this["outside"==this.view.options.ui?"box_wrapper":"ui_padder"].bind("click",function(e){$(e.target).closest(".fr-info")[0]||(e.preventDefault(),e.stopPropagation(),J.hide())}),this.frame.hide()}},_getInfoHeight:function(e){if(!this.view.caption)return 0;"outside"==this.view.options.ui&&(e=Math.min(e,L._boxDimensions.width));var t,a=this.info.css("width");return this.info.css({width:e+"px"}),t=parseFloat(this.info.css("height")),this.info.css({width:a}),t},_whileVisible:function(e,t){var a=[],i=J.element.add(J.bubble).add(this.frame).add(this.ui);t&&(i=i.add(t)),$.each(i,function(e,t){a.push({visible:$(t).is(":visible"),element:$(t).show()})}),e(),$.each(a,function(e,t){t.visible||t.element.hide()})},getLayout:function(){this.updateVars();var e=this._dimensions.max,t=this.view.options.ui,a=this._fit,i=this._spacing,n=this._border,s=C.within(e,{fit:a,ui:t,border:n}),o=$.extend({},s);if(n&&(o=C.within(o,{bounds:s,ui:t}),s.width+=2*n,s.height+=2*n),i.horizontal||i.vertical){var l=$.extend({},L._boxDimensions);n&&(l.width-=2*n,l.height-=2*n),l={width:Math.max(l.width-2*i.horizontal,0),height:Math.max(l.height-2*i.vertical,0)},o=C.within(o,{fit:a,bounds:l,ui:t})}var r={caption:!0},d=!1;if("outside"==t){{var c,i={height:s.height-o.height,width:s.width-o.width},p=$.extend({},o);this.caption&&this.frame.hasClass("fr-no-caption")}if(this.caption){c=this.caption,this.info.removeClass("fr-no-caption");var m=this.frame.hasClass("fr-no-caption");this.frame.removeClass("fr-no-caption");var u=this.frame.hasClass("fr-has-caption");this.frame.addClass("fr-has-caption")}J.element.css({visibility:"visible"}),this._whileVisible($.proxy(function(){for(var e=0,s=2;s>e;){r.height=this._getInfoHeight(o.width);var l=.5*(L._boxDimensions.height-2*n-(i.vertical?2*i.vertical:0)-o.height);l<r.height&&(o=C.within(o,{bounds:$.extend({},{width:o.width,height:Math.max(o.height-r.height,0)}),fit:a,ui:t})),e++}r.height=this._getInfoHeight(o.width);var d=B.viewport();(d.height<=320&&d.width<=568||d.width<=320&&d.height<=568||r.height>=.5*o.height||r.height>=.6*o.width)&&(r.caption=!1,r.height=0,o=p)},this),c),J.element.css({visibility:"visible"}),m&&this.frame.addClass("fr-no-caption"),u&&this.frame.addClass("fr-has-caption");var h={height:s.height-o.height,width:s.width-o.width};s.height+=i.height-h.height,s.width+=i.width-h.width,o.height!=p.height&&(d=!0)}else r.height=0;var g={width:o.width+2*n,height:o.height+2*n};r.height&&(s.height+=r.height),"inside"==t&&(r.height=0);var f={spacer:{dimensions:s},padder:{dimensions:g},wrapper:{dimensions:o,bounds:g,margin:{top:.5*(s.height-g.height)-.5*r.height,left:.5*(s.width-g.width)}},content:{dimensions:o},info:r};"outside"==t&&(f.info.top=f.wrapper.margin.top,r.width=Math.min(o.width,L._boxDimensions.width));var l=$.extend({},L._boxDimensions);return"outside"==t&&(f.box={dimensions:{width:L._boxDimensions.width},position:{left:.5*(L._dimensions.width-L._boxDimensions.width)}}),f.ui={spacer:{dimensions:{width:Math.min(s.width,l.width),height:Math.min(s.height,l.height)}},padder:{dimensions:g},wrapper:{dimensions:{width:Math.min(f.wrapper.dimensions.width,l.width-2*n),height:Math.min(f.wrapper.dimensions.height,l.height-2*n)},margin:{top:f.wrapper.margin.top+n,left:f.wrapper.margin.left+n}}},f},updateVars:function(){var e=$.extend({},this._dimensions.max),t=parseInt(this.box_outer_border.css("border-top-width"));this._border=t,t&&(e.width-=2*t,e.height-=2*t);var a=this.view.options.fit;"smart"==a?a=e.width>e.height?"height":e.height>e.width?"width":"none":a||(a="none"),this._fit=a;var i={none:"both",width:"y",height:"x",both:"none"},n=this.view.options.spacing[i[this._fit]];
this._spacing=n},clearLoadTimer:function(){this._loadTimer&&(clearTimeout(this._loadTimer),this._loadTimer=null)},clearLoad:function(){this._loadTimer&&this._loading&&!this._loaded&&(this.clearLoadTimer(),this._loading=!1)},load:function(e,t){return this._loaded||this._loading?void(this._loaded&&this.afterLoad(e)):(t||H.cache.get(this.view.url)||H.preloaded.getDimensions(this.view.url)||J.loading.start(),this._loading=!0,void(this._loadTimer=setTimeout($.proxy(function(){switch(this.clearLoadTimer(),this.view.type){case"image":var a=this.view.options.ui;H.get(this.view.url,{dragImage:"touch"!=a},$.proxy(function(i,n){if(this.view){this._dimensions._max=i,this._dimensions.max=i,this._loaded=!0,this._loading=!1,this.updateVars();var s=this.getLayout();this._dimensions.spacer=s.spacer.dimensions,this._dimensions.content=s.content.dimensions,this.content=$("<img>").attr({src:this.view.url}).addClass("fr-content fr-content-image"),this.box_wrapper.append(this.content),"touch"==a&&this.content.bind("dragstart",function(e){e.preventDefault()});var o;this.box_wrapper.append(o=$("<div>").addClass("fr-content-image-overlay")),this.download_image&&o.append(this.download_image.clone());var l;if("outside"==this.view.options.ui&&((l=this.view.options.onClick)&&"next"==l||"previous-next"==l)){var r=this.view.options.loop;(this._position!=L._frames.length||r)&&this.box_wrapper.append($("<div>").addClass("fr-onclick-side fr-onclick-next").data("side","next")),"previous-next"!=l||1==this._position&&!r||this.box_wrapper.append($("<div>").addClass("fr-onclick-side fr-onclick-previous").data("side","previous")),this.download_image&&this.box_wrapper.find(".fr-onclick-side").each($.proxy(function(e,t){var a=$(t).data("side");$(t).prepend(this.download_image.clone().data("side",a))},this)),this.frame.delegate(".fr-onclick-side","click",function(e){var t=$(e.target).closest(".fr-onclick-side").data("side");L[t]()}),this.frame.delegate(".fr-onclick-side","mouseenter",$.proxy(function(e){var t=$(e.target).closest(".fr-onclick-side").data("side"),a=t&&this["_"+t+"_button"];a&&this["_"+t+"_button"].addClass("fr-side-button-active")},this)).delegate(".fr-onclick-side","mouseleave",$.proxy(function(e){var t=$(e.target).data("side"),a=t&&this["_"+t+"_button"];a&&this["_"+t+"_button"].removeClass("fr-side-button-active")},this))}this.frame.find(".fr-download-image").each($.proxy(function(e,t){var a=$("<img>").addClass("fr-download-image").attr({src:this.view.url}).css({opacity:0}),i=$(t).data("side");if(u.IE&&u.IE<9){var s=parseInt(J.element.css("z-index"))||0;a.css({"z-index":s}),$(t).parents().css({"z-index":s}),/^(x|both)$/.test(this.view.options.overflow||"")&&a.hide()}n.dragImage&&!E.mobileTouch&&a.add(this.content).bind("dragstart",$.proxy(function(e){if("touch"==this.view.options.ui)return void e.preventDefault();var t=e.originalEvent,a=t.dataTransfer||{};if(n.dragImage&&a.setDragImage){var i=t.pageX||0,s=t.pageY||0,o=this.content.offset();i=Math.round(i-o.left),s=Math.round(s-o.top),n.dragScale<1&&(i*=n.dragScale,s*=n.dragScale),a.setDragImage(n.dragImage,i,s)}else a.addElement?a.addElement(this.content[0]):e.preventDefault()},this)),i&&a.data("side",i),$(t).replaceWith(a)},this)),this.afterLoad(e,t)}},this));break;case"youtube":var i={width:this.view.options.width,height:this.view.options.height};this.view.options.youtube&&this.view.options.youtube.hd&&(this.view._data.quality=i.width>720?"hd1080":"hd720"),this._movieLoaded(i,e);break;case"vimeo":var i={width:this.view.options.width,height:this.view.options.height};H.get(this.view.url,$.proxy(function(t){if(this.view){var a=i.width,n=i.height,s=t.width,o=t.height,l=!1;(l=a&&!n||n&&!a)||a&&n?(l&&(a&&!n?i.height=a*o/s:i.width=n*s/o),i=C.within(t,{bounds:i})):i=t,this._movieLoaded(i,e)}},this))}},this),10)))},_movieLoaded:function(e,t){this._dimensions._max=e,this._dimensions.max=e,this._loaded=!0,this._loading=!1,this.updateVars();var a=this.getLayout();this._dimensions.spacer=a.spacer.dimensions,this._dimensions.content=a.content.dimensions,this.box_wrapper.append(this.content=$("<div>").addClass("fr-content fr-content-"+this.view.type)),"touch"!=this.view.options.ui||"youtube"!=this.view.type&&"vimeo"!=this.view.type||(this.resize(),("youtube"==this.view.type&&window.YT||"vimeo"==this.view.type&&E.postMessage)&&this.show()),this.afterLoad(t)},afterLoad:function(e){var t=this.view.options.ui;this.resize(),"inside"==t&&this.ui_outer_border.bind("mouseenter",$.proxy(this.showUI,this)).bind("mouseleave",$.proxy(this.hideUI,this)),this.ui&&(E.mobileTouch?this.box.bind("click",$.proxy(function(){this.ui_wrapper.is(":visible")||this.showUI(),this.startUITimer()},this)):this.ui.delegate(".fr-ui-padder","mousemove",$.proxy(function(){this.ui_wrapper.is(":visible")||this.showUI(),this.startUITimer()},this)));var a;L._frames&&(a=L._frames[L._position-1])&&(a.view.url==this.view.url||"touch"==a.view.options.ui)&&J.loading.stop(),e&&e()},resize:function(){if(this.content){var e=this.getLayout(),t=this.view.options.ui;this._dimensions.spacer=e.spacer.dimensions,this._dimensions.content=e.content.dimensions,this.box_spacer.css(px(e.spacer.dimensions)),"inside"==t&&this.ui_spacer.css(px(e.ui.spacer.dimensions)),this.box_wrapper.add(this.box_outer_border).css(px(e.wrapper.dimensions));var a=0;switch("outside"==this.view.options.ui&&e.info.caption&&(a=e.info.height),this.box_outer_border.css({"padding-bottom":a+"px"}),this.box_padder.css(px({width:e.padder.dimensions.width,height:e.padder.dimensions.height+a})),e.spacer.dimensions.width>("outside"==this.view.options.ui?e.box.dimensions.width:B.viewport().width)?this.box.addClass("fr-prevent-swipe"):this.box.removeClass("fr-prevent-swipe"),t){case"outside":this.caption&&this.info.css(px({width:e.info.width}));break;case"inside":this.ui_wrapper.add(this.ui_outer_border).add(this.ui_toggle).css(px(e.ui.wrapper.dimensions)),this.ui_padder.css(px(e.ui.padder.dimensions));var i=0;if(this.caption){var n=this.frame.hasClass("fr-no-caption"),s=this.frame.hasClass("fr-has-caption");this.frame.removeClass("fr-no-caption"),this.frame.addClass("fr-has-caption");var i=0;this._whileVisible($.proxy(function(){i=this.info.outerHeight()},this),this.ui_wrapper.add(this.caption));var o=B.viewport();(i>=.45*e.wrapper.dimensions.height||o.height<=320&&o.width<=568||o.width<=320&&o.height<=568)&&(e.info.caption=!1),n&&this.frame.addClass("fr-no-caption"),s||this.frame.removeClass("fr-has-caption")}}if(this.caption){var l=e.info.caption;this.caption[l?"show":"hide"](),this.frame[(l?"remove":"add")+"Class"]("fr-no-caption"),this.frame[(l?"add":"remove")+"Class"]("fr-has-caption")}this.box_padder.add(this.ui_padder).css(px(e.wrapper.margin));var r=L._boxDimensions,d=this._dimensions.spacer;if(this.overlap={y:d.height-r.height,x:d.width-r.width},this._track=this.overlap.x>0||this.overlap.y>0,L[(this._track?"set":"remove")+"Tracking"](this._position),u.IE&&u.IE<8&&"image"==this.view.type&&this.content.css(px(e.wrapper.dimensions)),/^(vimeo|youtube)$/.test(this.view.type)){var c=e.wrapper.dimensions;this.player?this.player.setSize(c.width,c.height):this.player_iframe&&this.player_iframe.attr(c)}}this.position()},position:function(){if(this.content){var e=L._xyp,t=L._boxDimensions,a=this._dimensions.spacer,i={top:0,left:0},n=this.overlap;i.top=n.y>0?0-e.y*n.y:.5*t.height-.5*a.height,i.left=n.x>0?0-e.x*n.x:.5*t.width-.5*a.width,E.mobileTouch&&(n.y>0&&(i.top=0),n.x>0&&(i.left=0),this.box_spacer.css({position:"relative"})),this._style=i,this.box_spacer.css({top:i.top+"px",left:i.left+"px"});var s=$.extend({},i);s.top<0&&(s.top=0),s.left<0&&(s.left=0);var o=this.view.options.ui;switch(o){case"outside":var l=this.getLayout();if(this.box.css(px(l.box.dimensions)).css(px(l.box.position)),this.view.caption){var r=i.top+l.wrapper.margin.top+l.wrapper.dimensions.height+this._border;r>L._boxDimensions.height-l.info.height&&(r=L._boxDimensions.height-l.info.height);var d=L._sideWidth+i.left+l.wrapper.margin.left+this._border;d<L._sideWidth&&(d=L._sideWidth),d+l.info.width>L._sideWidth+l.box.dimensions.width&&(d=L._sideWidth),this.info.css({top:r+"px",left:d+"px"})}break;case"inside":this.ui_spacer.css({left:s.left+"px",top:s.top+"px"})}}},setDimensions:function(e){this.dimensions=e},insertYoutubeVideo:function(){var e=u.IE&&u.IE<8,t=this.getLayout(),a=t.wrapper.dimensions,i=$.extend({},this.view.options.youtube||{}),n="http"+(window.location&&"https:"==window.location.protocol?"s":"")+":";if("touch"==this.view.options.ui&&(i.autoplay=0),window.YT){var s;this.content.append(this.player_div=$("<div>").append(s=$("<div>")[0])),this.player=new YT.Player(s,{height:a.height,width:a.width,videoId:this.view._data.id,playerVars:i,events:e?{}:{onReady:$.proxy(function(e){if(this.view.options.youtube.hd)try{e.target.setPlaybackQuality(this.view._data.quality)}catch(t){}this.resize()},this),onStateChange:$.proxy(function(e){e.data>-1&&(this._playing=!0)},this)}})}else{var o=$.param(i);this.content.append(this.player_iframe=$("<iframe webkitAllowFullScreen mozallowfullscreen allowFullScreen>").attr({src:n+"//www.youtube.com/embed/"+this.view._data.id+"?"+o,height:a.height,width:a.width,frameborder:0}))}},insertVimeoVideo:function(){var e=this.getLayout(),t=e.wrapper.dimensions,a=$.extend({},this.view.options.vimeo||{});"touch"==this.view.options.ui&&(a.autoplay=0);var i="http"+(window.location&&"https:"==window.location.protocol?"s":"")+":",n=w()+"vimeo";a.player_id=n,a.api=1;var s=$.param(a);this.content.append(this.player_iframe=$("<iframe webkitAllowFullScreen mozallowfullscreen allowFullScreen>").attr({src:i+"//player.vimeo.com/video/"+this.view._data.id+"?"+s,id:n,height:t.height,width:t.width,frameborder:0})),window.Froogaloop&&$f(this.player_iframe[0]).addEvent("ready",$.proxy(function(e){this.froogaloop=$f(e).addEvent("play",$.proxy(function(){this._playing=!0},this))},this))},_preShow:function(){switch(this.view.type){case"youtube":this.insertYoutubeVideo();break;case"vimeo":this.insertVimeoVideo()}},show:function(e){if("touch"==this.view.options.ui){if(this._shown)return void(e&&e());this._shown=!0}this._preShow(),L.setVisible(this._position),this.frame.stop(1,0),this.ui&&(this.ui.stop(1,0),this.showUI(null,!0)),this._track&&L.setTracking(this._position),this.setOpacity(1,Math.max(this.view.options.effects.content.show,u.IE&&u.IE<9?0:10),$.proxy(function(){e&&e()},this))},_postHide:function(){this.view&&this.content&&"touch"!=this.view.options.ui&&this._removeVideo()},_removeVideo:function(){if(this._playing=!1,this.player_iframe&&(this.player_iframe.remove(),this.player_iframe=null),this.player){try{this.player.destroy()}catch(e){}this.player=null}this.player_div&&(this.player_div.remove(),this.player_div=null),("youtube"==this.view.type||"vimeo"==this.view.type)&&(this.content&&this.content.html(""),this.player_div=null,this.player=null,this.player_iframe=null)},_reset:function(e){L.removeTracking(this._position),L.setHidden(this._position),this._postHide(e)},hide:function(e){if("touch"==this.view.options.ui)return void(e&&e());var t=Math.max(this.view.options.effects.content.hide||0,u.IE&&u.IE<9?0:10),a=this.view.options.effects.content.sync?"easeInQuad":"easeOutSine";this.frame.stop(1,0).fadeOut(t,a,$.proxy(function(){this._reset(),e&&e()},this))},setOpacity:function(e,t,a){var i=this.view.options.effects.content.sync?"easeOutQuart":"easeInSine";this.frame.stop(1,0).fadeTo(t||0,e,i,a)},showUI:function(e,t){this.ui&&(t?(this.ui_wrapper.show(),this.startUITimer(),"function"==$.type(e)&&e()):this.ui_wrapper.stop(1,0).fadeTo(t?0:this.view.options.effects.ui.show,1,"easeInSine",$.proxy(function(){this.startUITimer(),"function"==$.type(e)&&e()},this)))},hideUI:function(e,t){this.ui&&"outside"!=this.view.options.ui&&(t?(this.ui_wrapper.hide(),"function"==$.type(e)&&e()):this.ui_wrapper.stop(1,0).fadeOut(t?0:this.view.options.effects.ui.hide,"easeOutSine",function(){"function"==$.type(e)&&e()}))},clearUITimer:function(){this._ui_timer&&(clearTimeout(this._ui_timer),this._ui_timer=null)},startUITimer:function(){this.clearUITimer(),this._ui_timer=setTimeout($.proxy(function(){this.hideUI()},this),this.view.options.effects.ui.delay)},hideUIDelayed:function(){this.clearUITimer(),this._ui_timer=setTimeout($.proxy(function(){this.hideUI()},this),this.view.options.effects.ui.delay)}}),$.extend(View.prototype,{initialize:function(a){var b=arguments[1]||{},c={};if("string"==$.type(a))a={url:a};else if(a&&1==a.nodeType){var d=$(a);a={element:d[0],url:d.attr("href"),caption:d.data("fresco-caption"),group:d.data("fresco-group"),extension:d.data("fresco-extension"),type:d.data("fresco-type"),options:d.data("fresco-options")&&eval("({"+d.data("fresco-options")+"})")||{}}}if(a&&(a.extension||(a.extension=detectExtension(a.url)),!a.type)){var c=getURIData(a.url);a._data=c,a.type=c.type}return a._data||(a._data=getURIData(a.url)),a.options=a&&a.options?$.extend(!0,$.extend({},b),$.extend({},a.options)):$.extend({},b),a.options=I.create(a.options,a.type,a._data),$.extend(this,a),this}});var M={initialize:function(e){this.element=e,this._thumbnails=[],this._vars={orientation:"horizontal",thumbnail:{height:0,width:0},thumbnail_frame:{height:0,width:0},thumbnails:{height:0,width:0}},this.thumbnails=this.element.find(".fr-thumbnails:first"),this.build(),this.block(),this.hide(),this.startObserving()},build:function(){this.thumbnails.append(this.wrapper=$("<div>").addClass("fr-thumbnails-wrapper").append(this._slider=$("<div>").addClass("fr-thumbnails-slider").append(this._previous=$("<div>").addClass("fr-thumbnails-side fr-thumbnails-side-previous").append(this._previous_button=$("<div>").addClass("fr-thumbnails-side-button").append($("<div>").addClass("fr-thumbnails-side-button-background")).append($("<div>").addClass("fr-thumbnails-side-button-icon")))).append(this._thumbs=$("<div>").addClass("fr-thumbnails-thumbs").append(this._slide=$("<div>").addClass("fr-thumbnails-slide"))).append(this._next=$("<div>").addClass("fr-thumbnails-side fr-thumbnails-side-next").append(this._next_button=$("<div>").addClass("fr-thumbnails-side-button").append($("<div>").addClass("fr-thumbnails-side-button-background")).append($("<div>").addClass("fr-thumbnails-side-button-icon")))))),this.measure=$("<div>").addClass("fr-thumbnails fr-thumbnails-horizontal").append($("<div>").addClass("fr-thumbnails-side fr-thumbnails-side-previous")).append($("<div>").addClass("fr-thumbnail")).append($("<div>").addClass("fr-thumbnails-side fr-thumbnails-side-next"))},startObserving:function(){this._slider.delegate(".fr-thumbnail","click",$.proxy(function(e){e.stopPropagation();var t=$(e.target).closest(".fr-thumbnail")[0],a=t&&$(t).data("fr-position");a&&(this.setActive(a),J.setPosition(a))},this)),this._slider.bind("click",function(e){e.stopPropagation()}),this._previous.bind("click",$.proxy(this.previousPage,this)),this._next.bind("click",$.proxy(this.nextPage,this))},load:function(e){if(this.clear(),this._thumbnails=[],!(e.length<2)){var t=!1;if($.each(e,$.proxy(function(e,a){return"touch"==a.options.ui?(t=!0,!1):void 0},this)),!t){var a="horizontal";$.each(e,$.proxy(function(e,t){"vertical"==t.options.thumbnails&&(a="vertical")},this)),this._vars.orientation=a,this.setOrientationClass(a),$.each(e,$.proxy(function(e,t){this._thumbnails.push(new Thumbnail(this._slide,t,e+1))},this)),u.IE&&u.IE<7||this.resize()}}},clear:function(){$.each(this._thumbnails,function(e,t){t.remove()}),this._thumbnails=[],this._position=-1,this._page=-1},setOrientationClass:function(e){this.thumbnails.removeClass("fr-thumbnails-horizontal fr-thumbnails-vertical").addClass("fr-thumbnails-"+e)},flipMargins:function(e){$.each(e,$.proxy(function(e,t){this.flipMargin(t)},this))},flipMargin:function(e){var t=e["margin-left"],a=e["margin-right"];e["margin-left"]=0,e["margin-right"]=0,e["margin-top"]=t,e["margin-bottom"]=a},flipDimensions:function(e){var t=e.width;e.width=e.height,e.height=t},flipMultiple:function(e){$.each(e,$.proxy(function(e,t){this.flipDimensions(t)},this))},updateVars:function(){var e=J.element,t=J.bubble,a=this._vars,i=a.orientation,n=B.viewport(),s=e.is(":visible");s||e.show();var o=t.is(":visible");o||t.show(),this.thumbnails.before(this.measure);var l=this.measure.find(".fr-thumbnails-side-previous:first"),r=this.measure.find(".fr-thumbnails-side-next:first"),d=this.measure.find(".fr-thumbnail:first"),c=this.measure.innerHeight(),p=parseInt(this.measure.css("padding-top"))||0;$.extend(a.thumbnails,{height:c,padding:p});var m=c-2*p,u=parseInt(d.css("margin-left"));$.extend(a.thumbnail,{height:m,width:m}),$.extend(a.thumbnail_frame,{width:m+2*u,height:c}),a.sides={previous:{dimensions:{width:l.innerWidth(),height:c},margin:{"margin-top":0,"margin-bottom":0,"margin-left":parseInt(l.css("margin-left"))||0,"margin-right":parseInt(l.css("margin-right"))||0}},next:{dimensions:{width:r.innerWidth(),height:c},margin:{"margin-top":0,"margin-bottom":0,"margin-left":parseInt(r.css("margin-left"))||0,"margin-right":parseInt(r.css("margin-right"))||0}}};var h=n["horizontal"==i?"width":"height"],g=a.thumbnail_frame.width,f=this._thumbnails.length;a.thumbnails.width=h,a.sides.enabled=f*g/h>1;var v=h,b=a.sides,y=b.previous,w=b.next,x=y.margin["margin-left"]+y.dimensions.width+y.margin["margin-right"]+w.margin["margin-left"]+w.dimensions.width+w.margin["margin-right"];a.sides.enabled&&(v-=x),v=Math.floor(v/g)*g;var _=f*g;v>_&&(v=_);var k=v+(a.sides.enabled?x:0);a.ipp=v/g,this._mode="page",a.ipp<=1&&(v=h,k=h,a.sides.enabled=!1,this._mode="center"),a.pages=Math.ceil(f*g/v),a.wrapper={width:k+1,height:c},a.thumbs={width:v,height:c},a.slide={width:f*g+1,height:c},"vertical"==i&&(this.flipMultiple([a.thumbnails,a.wrapper,a.thumbs,a.slide,a.thumbnail_frame,a.thumbnail,a.sides.previous.dimensions,a.sides.next.dimensions]),this.flipMargins([a.sides.previous.margin,a.sides.next.margin])),this.measure.detach(),o||t.hide(),s||e.hide()},disable:function(){this._disabled=!0},enable:function(){this._disabled=!1},enabled:function(){return!this._disabled},show:function(){this._thumbnails.length<2||(this.enable(),this.thumbnails.show(),this._visible=!0)},hide:function(){this.disable(),this.thumbnails.hide(),this._visible=!1},visible:function(){return!!this._visible},resize:function(){this.updateVars();var e=this._vars,t="horizontal"==this._vars.orientation,a=e.thumbnails;this.thumbnails.css({width:a.width+"px",height:a.height+"px","min-height":"none","max-height":"none","min-width":"none","max-width":"none",padding:0}),$.each(this._thumbnails,function(e,t){t.resize()}),this._previous[e.sides.enabled?"show":"hide"]().css(px(e.sides.previous.dimensions)).css(px(e.sides.previous.margin)),this._next[e.sides.enabled?"show":"hide"]().css(px(e.sides.next.dimensions)).css(px(e.sides.next.margin)),u.IE&&u.IE<9&&(J.timeouts.clear("ie-resizing-thumbnails"),J.timeouts.set("ie-resizing-thumbnails",$.proxy(function(){this.updateVars(),this._thumbs.css(px(e.thumbs)),this._slide.css(px(e.slide))},this),500)),this._thumbs.css(px(e.thumbs)),this._slide.css(px(e.slide));var i=$.extend({},px(e.wrapper));i["margin-"+(t?"left":"top")]=Math.round(-.5*e.wrapper[t?"width":"height"])+"px",i["margin-"+(t?"top":"left")]=0,this.wrapper.css(i),this._previous.css(px(e.sides.previous)),this._previous.css(px(e.sides.next)),this._position&&this.moveTo(this._position,!0)},moveToPage:function(e){if(!(1>e||e>this._vars.pages||e==this._page)){var t=this._vars.ipp*(e-1)+1;this.moveTo(t)}},previousPage:function(){this.moveToPage(this._page-1)},nextPage:function(){this.moveToPage(this._page+1)},adjustToViewport:function(){var e=B.viewport();return e},setPosition:function(e){if(!(u.IE&&u.IE<7)){var t=this._position<0;1>e&&(e=1);var a=this._thumbnails.length;e>a&&(e=a),this._position=e,this.setActive(e),("page"!=this._mode||this._page!=Math.ceil(e/this._vars.ipp))&&this.moveTo(e,t)}},moveTo:function(e,t){this.updateVars();var a,i="horizontal"==this._vars.orientation,n=B.viewport()[i?"width":"height"],s=.5*n,o=this._vars.thumbnail_frame[i?"width":"height"];if("page"==this._mode){var l=Math.ceil(e/this._vars.ipp);this._page=l,a=-1*o*(this._page-1)*this._vars.ipp;var r="fr-thumbnails-side-button-disabled";this._previous_button[(2>l?"add":"remove")+"Class"](r),this._next_button[(l>=this._vars.pages?"add":"remove")+"Class"](r)}else a=s+-1*(o*(e-1)+.5*o);var d=L._frames&&L._frames[L._position-1],c={},p={};c[i?"top":"left"]=0,p[i?"left":"top"]=a+"px",this._slide.stop(1,0).css(c).animate(p,t?0:d?d.view.options.effects.thumbnails.slide:0,$.proxy(function(){this.loadCurrentPage()},this))},block:function(){this._blocked=!0},unblock:function(){this._blocked=!1,this._thumbnails.length>0&&this.loadCurrentPage()},loadCurrentPage:function(){var e=!1;this._blocked&&(e=!0);var t,a;if(this._position&&this._vars.thumbnail_frame.width&&!(this._thumbnails.length<1)){if("page"==this._mode){if(this._page<1)return;t=(this._page-1)*this._vars.ipp+1,a=Math.min(t-1+this._vars.ipp,this._thumbnails.length)}else{var i="horizontal"==this._vars.orientation,n=Math.ceil(this._vars.thumbnails[i?"width":"height"]/this._vars.thumbnail_frame[i?"width":"height"]);t=Math.max(Math.floor(Math.max(this._position-.5*n,0)),1),a=Math.ceil(Math.min(this._position+.5*n)),this._thumbnails.length<a&&(a=this._thumbnails.length)}for(var s=t;a>=s;s++)this._thumbnails[s-1][e?"build":"load"]()}},setActive:function(e){this._slide.find(".fr-thumbnail-active").removeClass("fr-thumbnail-active");var t=e&&this._thumbnails[e-1];t&&t.activate()},refresh:function(){this._position&&this.setPosition(this._position)}};$.extend(Thumbnail.prototype,{initialize:function(e,t,a){this.element=e,this.view=t,this._dimension={},this._position=a,this.preBuild()},preBuild:function(){this.thumbnail=$("<div>").addClass("fr-thumbnail").data("fr-position",this._position)},build:function(){if(!this.thumbnail_frame){var e=this.view.options;this.element.append(this.thumbnail_frame=$("<div>").addClass("fr-thumbnail-frame").append(this.thumbnail.append(this.thumbnail_wrapper=$("<div>").addClass("fr-thumbnail-wrapper")))),"image"==this.view.type&&this.thumbnail.addClass("fr-load-thumbnail").data("thumbnail",{view:this.view,src:e.thumbnail||this.view.url});var t=e.thumbnail&&e.thumbnail.icon;t&&this.thumbnail.append($("<div>").addClass("fr-thumbnail-icon fr-thumbnail-icon-"+t));var a;this.thumbnail.append(a=$("<div>").addClass("fr-thumbnail-overlay").append($("<div>").addClass("fr-thumbnail-overlay-background")).append(this.loading=$("<div>").addClass("fr-thumbnail-loading").append($("<div>").addClass("fr-thumbnail-loading-background")).append($("<div>").addClass("fr-thumbnail-loading-icon"))).append($("<div>").addClass("fr-thumbnail-overlay-border"))),this.thumbnail.append($("<div>").addClass("fr-thumbnail-state")),this.resize()}},remove:function(){this.thumbnail_frame&&(this.thumbnail_frame.remove(),this.thumbnail_frame=null,this.thumbnail_image=null),this._loading=!1,this._removed=!0},load:function(){if(!this._loaded&&!this._loading&&M.visible()&&!this._removed){this.thumbnail_wrapper||this.build(),this._loading=!0;var e=this.view.options.thumbnail,t=e&&"boolean"==$.type(e)?this.view.url:e||this.view.url;if(this._url=t,t)if("vimeo"==this.view.type)if(t==e)H.preload(this._url,{type:"image"},$.proxy(this._afterLoad,this));else{var a="http"+(window.location&&"https:"==window.location.protocol?"s":"")+":";$.getJSON(a+"//vimeo.com/api/oembed.json?url="+a+"//vimeo.com/"+this.view._data.id+"&callback=?",$.proxy(function(e){e&&e.thumbnail_url?(this._url=e.thumbnail_url,H.preload(this._url,{type:"image"},$.proxy(this._afterLoad,this))):(this._loaded=!0,this._loading=!1,this.loading.stop(1,0).delay(this.view.options.effects.thumbnails.delay).fadeTo(this.view.options.effects.thumbnails.load,0))},this))}else H.preload(this._url,{type:"image"},$.proxy(this._afterLoad,this))}},_afterLoad:function(e){this.thumbnail_frame&&this._loading&&(this._loaded=!0,this._loading=!1,this._dimensions=e,this.image=$("<img>").attr({src:this._url}),this.thumbnail_wrapper.prepend(this.image),this.resize(),this.loading.stop(1,0).delay(this.view.options.effects.thumbnails.delay).fadeTo(this.view.options.effects.thumbnails.load,0))},resize:function(){if(this.thumbnail_frame){this.thumbnail_frame.css(px(M._vars.thumbnail_frame));var e="horizontal"==M._vars.orientation;if(this.thumbnail_frame.css(px({top:e?0:M._vars.thumbnail_frame.height*(this._position-1),left:e?M._vars.thumbnail_frame.width*(this._position-1):0})),this.thumbnail_wrapper){var t=M._vars.thumbnail;if(this.thumbnail.css(px({width:t.width,height:t.height,"margin-top":Math.round(-.5*t.height),"margin-left":Math.round(-.5*t.width),"margin-bottom":0,"margin-right":0})),this.image){var a,i={width:t.width,height:t.height},n=Math.max(i.width,i.height),s=$.extend({},this._dimensions);if(s.width>i.width&&s.height>i.height){a=C.within(s,{bounds:i});var o=1,l=1;a.width<i.width&&(o=i.width/a.width),a.height<i.height&&(l=i.height/a.height);var r=Math.max(o,l);r>1&&(a.width*=r,a.height*=r),$.each("width height".split(" "),function(e,t){a[t]=Math.round(a[t])})}else a=C.within(s.width<i.width||s.height<i.height?{width:n,height:n}:i,{bounds:this._dimensions});var d=Math.round(.5*i.width-.5*a.width),c=Math.round(.5*i.height-.5*a.height);this.image.css(px($.extend({},a,{top:c,left:d})))}}}},activate:function(){this.thumbnail.addClass("fr-thumbnail-active")}});var N={initialize:function(e){this.element=e,this._views=[],this._expanded=!1,this._vars={menu:{},caption:{}},this.touchMenu=this.element.find(".fr-touch-menu:first"),this.touchCaption=this.element.find(".fr-touch-caption:first"),this.build(),this.hide(),this.startObserving()},build:function(){this.touchMenu.append(this.menu_wrapper=$("<div>").addClass("fr-touch-menu-wrapper").append($("<div>").addClass("fr-touch-menu-background")).append(this.close=$("<div>").addClass("fr-touch-button fr-touch-close").append($("<span>").addClass("fr-touch-button-background")).append($("<span>").addClass("fr-touch-button-icon")))).hide(),this.touchCaption.append(this.caption_wrapper=$("<div>").addClass("fr-touch-caption-wrapper").append(this.drag=$("<div>").addClass("fr-touch-caption-background")).append(this.info=$("<div>").addClass("fr-touch-caption-info").append(this.info_padder=$("<div>").addClass("fr-touch-caption-info-padder").append(this.caption_wrapper=$("<div>").addClass("fr-touch-caption-text-wrapper").append(this.caption=$("<div>").addClass("fr-touch-caption-text"))))).append(this.more=$("<div>").addClass("fr-touch-button fr-touch-caption-more").append($("<span>").addClass("fr-touch-button-background")).append($("<span>").addClass("fr-touch-button-icon")))).hide()},startObserving:function(){this.close.bind("click",function(){J.hide()}),$(window).bind("resize orientationchange",$.proxy(function(){J.states.get("visible")&&this.resize()},this)),this.more.bind("click",$.proxy(function(){this[this._expanded?"collapse":"expand"]()},this)),this.touchMenu.add(this.touchCaption).bind("touchmove",$.proxy(function(e){e.originalEvent.touches;this._scrolling||e.preventDefault()},this))},show:function(){this.enable(),this.touchMenu.show(),this.touchCaption[this._noCaptions?"hide":"show"](),this._visible=!0},hide:function(){this.disable(),this.touchMenu.hide(),this.touchCaption.hide(),this._visible=!1},visible:function(){return!!this._visible},updateVars:function(){var e=J.element,t=J.bubble,a=this._vars;this.touchCaption.css({visibility:"hidden"});var i=this.more;$.each(i,$.proxy(function(e,t){var a=$(t);a.data("restore-margin-top",a.css("margin-top")),a.css({"margin-top":0})},this));var n=e.is(":visible");n||e.show();var s=t.is(":visible");s||t.show();var o=this.hasOverflowClass();o&&this.setOverflowClass(!1);var l=this.touchMenu.innerHeight(),r=this.touchCaption.innerHeight();o&&this.setOverflowClass(!0),a.menu.height=l,a.caption.height=r,o||this.setOverflowClass(!0);var d=this.touchCaption.innerHeight(),c=d>r;a.overflow=c,o&&this.setOverflowClass(!0),c&&(this.setOverflowClass(!0),d=this.touchCaption.innerHeight()),a.caption.overflowHeight=d,this.setOverflowClass(o),$.each(i,$.proxy(function(e,t){var a=$(t);a.css({"margin-top":a.data("restore-margin-top")})},this)),this.touchCaption.css({visibility:"visible"}),s||t.hide(),n||e.hide()},hasPaddedClass:function(){return this.touchCaption.hasClass("fr-touch-caption-padded")},setPaddedClass:function(e){this.touchCaption[(e?"add":"remove")+"Class"]("fr-touch-caption-padded")},hasOverflowClass:function(){return this.touchCaption.hasClass("fr-touch-caption-overflow")},setOverflowClass:function(e){this.touchCaption[(e?"add":"remove")+"Class"]("fr-touch-caption-overflow")},disable:function(){this._disabled=!0},enable:function(){this._disabled=!1},enabled:function(){return!this._disabled},load:function(e){this.clear();var t=!1;$.each(e,$.proxy(function(e,a){this._views.push(a),!t&&a.caption&&(t=!0)},this)),this.touchCaption[(t?"remove":"add")+"Class"]("fr-touch-caption-nocaptions"),this._noCaptions=!t},clear:function(){this._views=[],this.view=null,this._position=-1,this._page=-1},setPosition:function(e){if(e!=this._position){var t=this._views[e-1];if("touch"==t.options.ui){this.view=t;var a=t.caption||"";this.caption.html(a),this.resize(),this.collapse(!0)}}},resize:function(){this.collapse(!0),this.updateVars()},expand:function(e){this.setOverflowClass(!0),this.setPaddedClass(!0),this._expanded=!0,this.more.addClass("fr-touch-caption-less");var t=B.viewport(),a=-1*Math.min(t.height,this._vars.caption.overflowHeight||0);this._vars.caption.overflowHeight>t.height?(this.info.css({height:t.height+"px"}).addClass("fr-touch-caption-overflow-scroll"),this._scrolling=!0):(this.info.css({height:"auto"}).removeClass("fr-touch-caption-overflow-scroll"),this._scrolling=!1),this.touchCaption.stop(1,0).animate({"margin-top":a+"px"},{duration:e?0:this.view.options.effects.touchCaption.slideOut})},collapse:function(e){this._expanded=!1,this.more.removeClass("fr-touch-caption-less"),this.info.scrollTop(0),this.info.css({height:"auto"}).removeClass("fr-touch-caption-overflow-scroll"),this._scrolling=!1,this.touchCaption.stop(1,0).animate({"margin-top":-1*(this._vars.caption.height||0)+"px"},{duration:e?0:this.view.options.effects.touchCaption.slideIn,complete:$.proxy(function(){this.setOverflowClass(!1),this.setPaddedClass(this._vars.overflow)},this)})}},O={_disabled:!1,_fallback:!0,initialize:function(){J.initialize()},show:function(c){if(this._disabled)return void this.showFallback.apply(O,v.call(arguments));var d=arguments[1]||{},position=arguments[2];arguments[1]&&"number"==$.type(arguments[1])&&(position=arguments[1],d=I.create({}));var e=[],object_type;switch(object_type=$.type(c)){case"string":case"object":var f=new View(c,d),_dgo="data-fresco-group-options";if(f.group){if(_.isElement(c)){var g=$('.fresco[data-fresco-group="'+$(c).data("fresco-group")+'"]'),h={};g.filter("["+_dgo+"]").each(function(i,a){$.extend(h,eval("({"+($(a).attr(_dgo)||"")+"})"))}),g.each(function(t,a){position||a!=c||(position=t+1),e.push(new View(a,$.extend({},h,d)))})}}else{var h={};_.isElement(c)&&$(c).is("["+_dgo+"]")&&($.extend(h,eval("({"+($(c).attr(_dgo)||"")+"})")),f=new View(c,$.extend({},h,d))),e.push(f)}break;case"array":$.each(c,function(t,a){var i=new View(a,d);e.push(i)})}(!position||1>position)&&(position=1),position>e.length&&(position=e.length),L._xyp||L.setXY({x:0,y:0}),J.load(e,position,{callback:function(){J.show(function(){})}})},showFallback:function(){function e(t){var a,i=$.type(t);if("string"==i)a=t;else if("array"==i&&t[0])a=e(t[0]);else if(_.isElement(t)&&$(t).attr("href"))var a=$(t).attr("href");else a=t.url?t.url:!1;return a}return function(t){if(this._fallback){var a=e(t);a&&(window.location.href=a)}}}()};$.extend(t,{show:function(){return O.show.apply(O,v.call(arguments)),this},hide:function(){return J.hide(),this},disable:function(){return O._disabled=!0,this},enable:function(){return O._disabled=!1,this},fallback:function(e){return O._fallback=e,this},setDefaultSkin:function(e){return J.setDefaultSkin(e),this
}}),("number"==$.type(u.Android)&&u.Android<3||u.MobileSafari&&"number"==$.type(u.WebKit)&&u.WebKit<533.18)&&(t.show=O.showFallback);var Q={image:{extensions:"bmp gif jpeg jpg png",detect:function(e){return $.inArray(detectExtension(e),this.extensions.split(" "))>-1},data:function(e){return this.detect()?{extension:detectExtension(e)}:!1}},youtube:{detect:function(e){var t=/(youtube\.com|youtu\.be)\/watch\?(?=.*vi?=([a-zA-Z0-9-_]+))(?:\S+)?$/.exec(e);return t&&t[2]?t[2]:(t=/(youtube\.com|youtu\.be)\/(vi?\/|u\/|embed\/)?([a-zA-Z0-9-_]+)(?:\S+)?$/i.exec(e),t&&t[3]?t[3]:!1)},data:function(e){var t=this.detect(e);return t?{id:t}:!1}},vimeo:{detect:function(e){var t=/(vimeo\.com)\/([a-zA-Z0-9-_]+)(?:\S+)?$/i.exec(e);return t&&t[2]?t[2]:!1},data:function(e){var t=this.detect(e);return t?{id:t}:!1}}};return $(document).ready(function(){O.initialize()}),t}(window.jQuery),angular.module("ngTicket").factory("ticketCharts",[function(){return{line:function(e,t,a){a||(a={}),a.unit=a.unit||"",a.unit1=a.unit1||"",a.dateHourRange=a.dateHourRange||24;var i={chart:{defaultSeriesType:"spline"},title:"",lang:{noData:""},xAxis:{title:"",lineWidth:1,lineColor:"#EEE",type:"datetime",endOnTick:!1,startOnTick:!1,dateTimeLabelFormats:{second:"%H:%M:%S",minute:"%H:%M",hour:"%H:%M",day:"%m-%e",week:"%m-%e",month:"%b'%y",year:"%Y"}},yAxis:[{title:{text:a.yTitle||""},gridLineColor:"#EEE",gridLineWidth:1,min:0,allowDecimals:a.yAllowDecimals||!1,axisLabel:{formatter:function(){return this.value+a.unit}},endOnTick:!1},{title:{text:a.y1Title||""},gridLineColor:"#EEE",gridLineWidth:1,min:0,allowDecimals:a.y1AllowDecimals||!1,axisLabel:{formatter:function(){return this.value+a.unit1}},endOnTick:!1,opposite:!0}],tooltip:{enabled:!0,shadow:!1,borderWidth:0,shared:!0,valueSuffix:a.unit,xDateFormat:"%Y年%m月%d日",backgroundColor:"rgba(0,0, 0, .85)",style:{color:"#FFF",fontSize:"12px"}},series:"",plotOptions:{spline:{lineWidth:2,states:{hover:{lineWidth:3}},marker:{enabled:!1,states:{hover:{enabled:!0,symbol:"circle",radius:5,lineWidth:1}}},shadow:!1}},colors:["#393","#f8a31f","#80699B","#368ee0"],legend:{enabled:!0,x:8,y:0,borderWidth:0,align:"center",verticalAlign:"bottom",symbolWidth:20,symbolPadding:3,itemStyle:{color:"#333"},labelFormatter:function(){return"<strong>"+this.name+'</strong><span style="color:#BBB">(点击隐藏)</span>'}},exporting:{enabled:!1},credits:{enabled:!1}};Highcharts.setOptions({global:{useUTC:!1}}),i.chart.renderTo=e,i.series=t,i=$.extend(!0,{},i,a),t[0].data[t[0].data.length-1][0]-t[0].data[0][0]>=3600*a.dateHourRange*1e3&&(i.xAxis.dateTimeLabelFormats.hour="%m - %e");new Highcharts.Chart(i)},pie:function(e,t,a,i){a||(a="");var n={chart:{defaultSeriesType:"pie",plotBackgroundColor:null,plotBorderWidth:null,plotShadow:!1},title:{text:"",verticalAlign:"bottom",y:8,style:{color:"#333",fontSize:"12px",fontWeight:"bold"}},tooltip:{enabled:!0,pointFormat:"{series.name}: <b>{point.percentage:.2f}%</b>"},series:"",legend:{x:8,y:0,borderWidth:0,align:"center",verticalAlign:"bottom",symbolWidth:20,symbolPadding:3,itemStyle:{color:"#333"},labelFormatter:function(){return"<strong>"+this.name+"</strong>"}},plotOptions:{pie:{allowPointSelect:!0,cursor:"pointer",dataLabels:{enabled:!1,color:"#000000",connectorColor:"#000000",format:"<b>{point.name}</b>: {point.percentage:.2f} %"},showInLegend:!0}},colors:["#F7BA00","#0099FF","#00CC00","#FF5522","#FF70B7","#119999"],exporting:{enabled:!1},credits:{enabled:!1}};Highcharts.setOptions({global:{useUTC:!1}}),n.chart.renderTo=e,n.title.text=a,n.series=t,n=$.extend(!0,{},n,i);new Highcharts.Chart(n)},getLineMonthData:function(e,t,a){var i=[];a?i=angular.copy(a):a=[];for(var n=new Date(e,t).getTime(),s=1;32>s;++s){var o=new Date(e,t-1,s).getTime();if(o>=n)break;for(var l=0;l<a.length&&o!==a[l][0];++l);l>=a.length&&i.push([o,0])}return i.sort(function(e,t){return e[0]-t[0]}),i},getDateNum:function(e){var t=new Date(e);return new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()}}}]),angular.module("ngTicket").directive("dropdownSelect",["$timeout","RootRestangular","$q",function(e,t,a){return{restrict:"A",require:"ngModel",scope:{path:"@",list:"=",selected:"&"},templateUrl:"/app/components/dropdown-select/dropdown-select.html",link:function(e,i,n,s){function o(){return e.list?l.resolve(e.list):e.path?t.all(e.path).getList().then(function(e){l.resolve(e)},function(e){l.reject(e)}):e.$watch("list",function(e){angular.isUndefined(e)||l.resolve(e)}),l.promise}var l=a.defer(),r=i.data("size");e.dropdownselectsize=angular.isUndefined(r)?"btn-sm":r,e.select=function(t){e.checked=t,s.$setViewValue(t.value),e.selected()},o().then(function(t){e.data=t,angular.isUndefined(e.value)?t.length>0&&(e.checked=t[0]):angular.forEach(t,function(t){t.value==s.$viewValue&&(e.checked=t)})},function(e){console.error(e)})}}}]),angular.module("ngTicket").directive("datetimepicker2",["$timeout","$q",function(){return{restrict:"AE",require:"ngModel",scope:{required:"=?"},templateUrl:"/app/components/datetimepicker2/datetimepicker.html",link:function(e,t,a,i){i.$render=function(){e.date=i.$viewValue},e.$watch("date",function(e){i.$setViewValue(e)})}}}]),angular.module("ngTicket").directive("wechatColorPicker",["$rootScope","$toaster","$locale",function(){return{restrict:"AE",scope:{ngModel:"="},templateUrl:"/app/components/color/wechat.color.html",link:function(e){e.colorList=["#63B359","#2C9F67","#509FC9","#5885CF","#9062C0","#D09A45","#E4B138","#EE903C","#DD6549","#CC463D"],e.onSelect=function(t){e.ngModel=t}}}}]).directive("colorPicker",["$window",function(e){return{restrict:"AE",templateUrl:"/app/components/color/color.html",replace:!0,require:"?ngModel",scope:{},link:function(t,a,i,n){function s(e,t,a){"object"==typeof e&&(t=e.s,a=e.v,e=e.h);var i,n,s,o=Math.floor(6*e),l=6*e-o,r=a*(1-t),d=a*(1-l*t),c=a*(1-(1-l)*t);switch(o%6){case 0:i=a,n=c,s=r;break;case 1:i=d,n=a,s=r;break;case 2:i=r,n=a,s=c;break;case 3:i=r,n=d,s=a;break;case 4:i=c,n=r,s=a;break;case 5:i=a,n=r,s=d}return i=Math.floor(255*i)+256,n=Math.floor(255*n)+256,s=Math.floor(255*s)+256,"#"+i.toString(16).slice(1)+n.toString(16).slice(1)+s.toString(16).slice(1)}function o(e){var t=/^#(..)(..)(..)$/.exec(e);if(t){var a,i,n=t.slice(1).map(function(e){return parseInt(e,16)/255}),s=n[0],o=n[1],l=n[2],r=Math.max(s,o,l),d=r-Math.min(s,o,l),c=function(e){return(r-e)/6/d+.5};if(0===d)a=i=0;else{i=d/r;var p=c(s),m=c(o),u=c(l);s===r?a=u-m:o===r?a=1/3+p-u:l===r&&(a=2/3+m-p),0>a?a+=1:a>1&&(a-=1)}return{h:a,s:i,v:r}}}function l(e,a){e=Math.max(Math.min(e,c.width),0),a=Math.max(Math.min(a,c.height),0),"hue"===d?(t.hueCursor=a,t.hsv.h=a/c.height,t.hueBackgroundColor=s(t.hsv.h,1,1)):(t.colorCursor={x:e,y:a},t.hsv.s=e/c.width,t.hsv.v=1-a/c.height),"undefined"!=typeof t.hsv.s&&(t.color=s(t.hsv),n&&n.$setViewValue(t.color))}function r(e){e.preventDefault(),t.$apply(function(){l(e.clientX-c.x,e.clientY-c.y)})}t.hsv={h:0,s:0,v:0},n&&(n.$render=function(){/^#[0-9A-Fa-f]{6}$/.test(n.$viewValue)?(t.color=n.$viewValue,t.hsv=o(t.color),t.colorCursor={x:200*t.hsv.s,y:200*(1-t.hsv.v)}):(t.color=null,t.hsv={h:.5},t.colorCursor=null),t.hueBackgroundColor=s(t.hsv.h,1,1),t.hueCursor=200*t.hsv.h});var d,c;t.startDrag=function(t,a){var i=t.target.getBoundingClientRect();d=a,c={x:i.left,y:i.top,width:i.right-i.left,height:i.bottom-i.top},l(t.offsetX||t.layerX,t.offsetY||t.layerY),angular.element(e).on("mousemove",r).one("mouseup",function(){angular.element(e).off("mousemove",r)})}}}}]).directive("inputColor",["$rootScope","$toaster","$locale",function(){return{restrict:"AE",scope:{ngModel:"="},templateUrl:"/app/components/color/input.color.html",link:function(e){e.color={val:e.ngModel};e.$watch("color.val",function(t){t&&(null!=t.match(/^#[0-9a-fA-F]{6}$/)||null!=t.match(/^#[0-9a-fA-F]{3}$/))&&(e.ngModel=t)}),e.checkWordsColour=function(){e.ngModel&&(null==e.ngModel.match(/^#[0-9a-fA-F]{6}$/)&&null==e.ngModel.match(/^#[0-9a-fA-F]{3}$/)?e.ngModel=e.color.val:e.color.val=e.ngModel)},e.isShowTextColorPicker=!1,e.showTextColorPicker=function(t,a){t.stopImmediatePropagation(),e.isShowTextColorPicker=a}}}}]),angular.module("ngTicket").directive("address2",["$addressData2","$timeout",function(e,t){return{restrict:"AE",scope:{value:"=ngModel",addressNum:"=?",ngReadonly:"=?",required:"=?",isSmall:"=?",selected:"&?"},templateUrl:"/app/components/address2/address.tpl.html",link:function(a){a.addressNum||(a.addressNum=3),a.value&&(a.address=a.value);var i=function(i){a.address.province_name="",a.address.city_name="",a.address.district_name="",a.address&&a.address.province&&(a.address.province_name=e[0][a.address.province],e["0,{0}".format(a.address.province)]&&(a.address.city_name=e["0,{0}".format(a.address.province)][a.address.city],e["0,{0},{1}".format(a.address.province,a.address.city)]&&(a.address.district_name=e["0,{0},{1}".format(a.address.province,a.address.city)][a.address.district],a.address.string=a.province_name+a.city_name+a.district_name,i&&t(function(){a.value=a.address,a.selected&&a.selected({data:a.address})}))))};a.province=e[0],a.$watch("address.province",function(t,n){if(t!=n&&(a.address.city=null),t){var s="0,{0}".format(t);a.city=e[s],i(t!=n&&!a.required)}else a.city=null}),a.$watch("address.city",function(t,n){if(t!=n&&(a.address.district=null),t){var s="0,{0},{1}".format(a.address.province,t);a.district=e[s],i(t!=n&&(!a.required||2==a.addressNum))}else a.district=null}),a.$watch("address.district",function(e,t){a.address&&e&&i(e!=t)})}}}]),angular.module("ngTicket").constant("$addressData2",{0:{110000:"北京",120000:"天津",130000:"河北省",140000:"山西省",150000:"内蒙古自治区",210000:"辽宁省",220000:"吉林省",230000:"黑龙江省",310000:"上海",320000:"江苏省",330000:"浙江省",340000:"安徽省",350000:"福建省",360000:"江西省",370000:"山东省",410000:"河南省",420000:"湖北省",430000:"湖南省",440000:"广东省",450000:"广西壮族自治区",460000:"海南省",500000:"重庆",510000:"四川省",520000:"贵州省",530000:"云南省",540000:"西藏自治区",610000:"陕西省",620000:"甘肃省",630000:"青海省",640000:"宁夏回族自治区",650000:"新疆维吾尔自治区",710000:"台湾省",810000:"香港特别行政区",820000:"澳门特别行政区",990000:"海外"},"0,110000":{110100:"北京市"},"0,110000,110100":{110101:"东城区",110102:"西城区",110103:"崇文区",110104:"宣武区",110105:"朝阳区",110106:"丰台区",110107:"石景山区",110108:"海淀区",110109:"门头沟区",110111:"房山区",110112:"通州区",110113:"顺义区",110114:"昌平区",110115:"大兴区",110116:"怀柔区",110117:"平谷区",110228:"密云县",110229:"延庆县",110230:"其它区"},"0,120000":{120100:"天津市"},"0,120000,120100":{120101:"和平区",120102:"河东区",120103:"河西区",120104:"南开区",120105:"河北区",120106:"红桥区",120107:"塘沽区",120108:"汉沽区",120109:"大港区",120110:"东丽区",120111:"西青区",120112:"津南区",120113:"北辰区",120114:"武清区",120115:"宝坻区",120116:"滨海新区",120221:"宁河县",120223:"静海县",120225:"蓟县",120226:"其它区"},"0,130000":{130100:"石家庄市",130200:"唐山市",130300:"秦皇岛市",130400:"邯郸市",130500:"邢台市",130600:"保定市",130700:"张家口市",130800:"承德市",130900:"沧州市",131000:"廊坊市",131100:"衡水市"},"0,130000,130100":{130102:"长安区",130103:"桥东区",130104:"桥西区",130105:"新华区",130107:"井陉矿区",130108:"裕华区",130121:"井陉县",130123:"正定县",130124:"栾城县",130125:"行唐县",130126:"灵寿县",130127:"高邑县",130128:"深泽县",130129:"赞皇县",130130:"无极县",130131:"平山县",130132:"元氏县",130133:"赵县",130181:"辛集市",130182:"藁城市",130183:"晋州市",130184:"新乐市",130185:"鹿泉市",130186:"其它区"},"0,130000,130200":{130202:"路南区",130203:"路北区",130204:"古冶区",130205:"开平区",130207:"丰南区",130208:"丰润区",130223:"滦县",130224:"滦南县",130225:"乐亭县",130227:"迁西县",130229:"玉田县",130230:"唐海县",130281:"遵化市",130283:"迁安市",130284:"其它区"},"0,130000,130300":{130302:"海港区",130303:"山海关区",130304:"北戴河区",130321:"青龙满族自治县",130322:"昌黎县",130323:"抚宁县",130324:"卢龙县",130398:"其它区",130399:"经济技术开发区"},"0,130000,130400":{130402:"邯山区",130403:"丛台区",130404:"复兴区",130406:"峰峰矿区",130421:"邯郸县",130423:"临漳县",130424:"成安县",130425:"大名县",130426:"涉县",130427:"磁县",130428:"肥乡县",130429:"永年县",130430:"邱县",130431:"鸡泽县",130432:"广平县",130433:"馆陶县",130434:"魏县",130435:"曲周县",130481:"武安市",130482:"其它区"},"0,130000,130500":{130502:"桥东区",130503:"桥西区",130521:"邢台县",130522:"临城县",130523:"内丘县",130524:"柏乡县",130525:"隆尧县",130526:"任县",130527:"南和县",130528:"宁晋县",130529:"巨鹿县",130530:"新河县",130531:"广宗县",130532:"平乡县",130533:"威县",130534:"清河县",130535:"临西县",130581:"南宫市",130582:"沙河市",130583:"其它区"},"0,130000,130600":{130602:"新市区",130603:"北市区",130604:"南市区",130621:"满城县",130622:"清苑县",130623:"涞水县",130624:"阜平县",130625:"徐水县",130626:"定兴县",130627:"唐县",130628:"高阳县",130629:"容城县",130630:"涞源县",130631:"望都县",130632:"安新县",130633:"易县",130634:"曲阳县",130635:"蠡县",130636:"顺平县",130637:"博野县",130638:"雄县",130681:"涿州市",130682:"定州市",130683:"安国市",130684:"高碑店市",130698:"高开区",130699:"其它区"},"0,130000,130700":{130702:"桥东区",130703:"桥西区",130705:"宣化区",130706:"下花园区",130721:"宣化县",130722:"张北县",130723:"康保县",130724:"沽源县",130725:"尚义县",130726:"蔚县",130727:"阳原县",130728:"怀安县",130729:"万全县",130730:"怀来县",130731:"涿鹿县",130732:"赤城县",130733:"崇礼县",130734:"其它区"},"0,130000,130800":{130802:"双桥区",130803:"双滦区",130804:"鹰手营子矿区",130821:"承德县",130822:"兴隆县",130823:"平泉县",130824:"滦平县",130825:"隆化县",130826:"丰宁满族自治县",130827:"宽城满族自治县",130828:"围场满族蒙古族自治县",130829:"其它区"},"0,130000,130900":{130902:"新华区",130903:"运河区",130921:"沧县",130922:"青县",130923:"东光县",130924:"海兴县",130925:"盐山县",130926:"肃宁县",130927:"南皮县",130928:"吴桥县",130929:"献县",130930:"孟村回族自治县",130981:"泊头市",130982:"任丘市",130983:"黄骅市",130984:"河间市",130985:"其它区"},"0,130000,131000":{131002:"安次区",131003:"广阳区",131022:"固安县",131023:"永清县",131024:"香河县",131025:"大城县",131026:"文安县",131028:"大厂回族自治县",131051:"开发区",131052:"燕郊经济技术开发区",131081:"霸州市",131082:"三河市",131083:"其它区"},"0,130000,131100":{131102:"桃城区",131121:"枣强县",131122:"武邑县",131123:"武强县",131124:"饶阳县",131125:"安平县",131126:"故城县",131127:"景县",131128:"阜城县",131181:"冀州市",131182:"深州市",131183:"其它区"},"0,140000":{140100:"太原市",140200:"大同市",140300:"阳泉市",140400:"长治市",140500:"晋城市",140600:"朔州市",140700:"晋中市",140800:"运城市",140900:"忻州市",141000:"临汾市",141100:"吕梁市"},"0,140000,140100":{140105:"小店区",140106:"迎泽区",140107:"杏花岭区",140108:"尖草坪区",140109:"万柏林区",140110:"晋源区",140121:"清徐县",140122:"阳曲县",140123:"娄烦县",140181:"古交市",140182:"其它区"},"0,140000,140200":{140202:"城区",140203:"矿区",140211:"南郊区",140212:"新荣区",140221:"阳高县",140222:"天镇县",140223:"广灵县",140224:"灵丘县",140225:"浑源县",140226:"左云县",140227:"大同县",140228:"其它区"},"0,140000,140300":{140302:"城区",140303:"矿区",140311:"郊区",140321:"平定县",140322:"盂县",140323:"其它区"},"0,140000,140400":{140421:"长治县",140423:"襄垣县",140424:"屯留县",140425:"平顺县",140426:"黎城县",140427:"壶关县",140428:"长子县",140429:"武乡县",140430:"沁县",140431:"沁源县",140481:"潞城市",140482:"城区",140483:"郊区",140484:"高新区",140485:"其它区"},"0,140000,140500":{140502:"城区",140521:"沁水县",140522:"阳城县",140524:"陵川县",140525:"泽州县",140581:"高平市",140582:"其它区"},"0,140000,140600":{140602:"朔城区",140603:"平鲁区",140621:"山阴县",140622:"应县",140623:"右玉县",140624:"怀仁县",140625:"其它区"},"0,140000,140700":{140702:"榆次区",140721:"榆社县",140722:"左权县",140723:"和顺县",140724:"昔阳县",140725:"寿阳县",140726:"太谷县",140727:"祁县",140728:"平遥县",140729:"灵石县",140781:"介休市",140782:"其它区"},"0,140000,140800":{140802:"盐湖区",140821:"临猗县",140822:"万荣县",140823:"闻喜县",140824:"稷山县",140825:"新绛县",140826:"绛县",140827:"垣曲县",140828:"夏县",140829:"平陆县",140830:"芮城县",140881:"永济市",140882:"河津市",140883:"其它区"},"0,140000,140900":{140902:"忻府区",140921:"定襄县",140922:"五台县",140923:"代县",140924:"繁峙县",140925:"宁武县",140926:"静乐县",140927:"神池县",140928:"五寨县",140929:"岢岚县",140930:"河曲县",140931:"保德县",140932:"偏关县",140981:"原平市",140982:"其它区"},"0,140000,141000":{141002:"尧都区",141021:"曲沃县",141022:"翼城县",141023:"襄汾县",141024:"洪洞县",141025:"古县",141026:"安泽县",141027:"浮山县",141028:"吉县",141029:"乡宁县",141030:"大宁县",141031:"隰县",141032:"永和县",141033:"蒲县",141034:"汾西县",141081:"侯马市",141082:"霍州市",141083:"其它区"},"0,140000,141100":{141102:"离石区",141121:"文水县",141122:"交城县",141123:"兴县",141124:"临县",141125:"柳林县",141126:"石楼县",141127:"岚县",141128:"方山县",141129:"中阳县",141130:"交口县",141181:"孝义市",141182:"汾阳市",141183:"其它区"},"0,150000":{150100:"呼和浩特市",150200:"包头市",150300:"乌海市",150400:"赤峰市",150500:"通辽市",150600:"鄂尔多斯市",150700:"呼伦贝尔市",150800:"巴彦淖尔市",150900:"乌兰察布市",152200:"兴安盟",152500:"锡林郭勒盟",152900:"阿拉善盟"},"0,150000,150100":{150102:"新城区",150103:"回民区",150104:"玉泉区",150105:"赛罕区",150121:"土默特左旗",150122:"托克托县",150123:"和林格尔县",150124:"清水河县",150125:"武川县",150126:"其它区"},"0,150000,150200":{150202:"东河区",150203:"昆都仑区",150204:"青山区",150205:"石拐区",150206:"白云矿区",150207:"九原区",150221:"土默特右旗",150222:"固阳县",150223:"达尔罕茂明安联合旗",150224:"其它区"},"0,150000,150300":{150302:"海勃湾区",150303:"海南区",150304:"乌达区",150305:"其它区"},"0,150000,150400":{150402:"红山区",150403:"元宝山区",150404:"松山区",150421:"阿鲁科尔沁旗",150422:"巴林左旗",150423:"巴林右旗",150424:"林西县",150425:"克什克腾旗",150426:"翁牛特旗",150428:"喀喇沁旗",150429:"宁城县",150430:"敖汉旗",150431:"其它区"},"0,150000,150500":{150502:"科尔沁区",150521:"科尔沁左翼中旗",150522:"科尔沁左翼后旗",150523:"开鲁县",150524:"库伦旗",150525:"奈曼旗",150526:"扎鲁特旗",150581:"霍林郭勒市",150582:"其它区"},"0,150000,150600":{150602:"东胜区",150621:"达拉特旗",150622:"准格尔旗",150623:"鄂托克前旗",150624:"鄂托克旗",150625:"杭锦旗",150626:"乌审旗",150627:"伊金霍洛旗",150628:"其它区"},"0,150000,150700":{150702:"海拉尔区",150721:"阿荣旗",150722:"莫力达瓦达斡尔族自治旗",150723:"鄂伦春自治旗",150724:"鄂温克族自治旗",150725:"陈巴尔虎旗",150726:"新巴尔虎左旗",150727:"新巴尔虎右旗",150781:"满洲里市",150782:"牙克石市",150783:"扎兰屯市",150784:"额尔古纳市",150785:"根河市",150786:"其它区"},"0,150000,150800":{150802:"临河区",150821:"五原县",150822:"磴口县",150823:"乌拉特前旗",150824:"乌拉特中旗",150825:"乌拉特后旗",150826:"杭锦后旗",150827:"其它区"},"0,150000,150900":{150902:"集宁区",150921:"卓资县",150922:"化德县",150923:"商都县",150924:"兴和县",150925:"凉城县",150926:"察哈尔右翼前旗",150927:"察哈尔右翼中旗",150928:"察哈尔右翼后旗",150929:"四子王旗",150981:"丰镇市",150982:"其它区"},"0,150000,152200":{152201:"乌兰浩特市",152202:"阿尔山市",152221:"科尔沁右翼前旗",152222:"科尔沁右翼中旗",152223:"扎赉特旗",152224:"突泉县",152225:"其它区"},"0,150000,152500":{152501:"二连浩特市",152502:"锡林浩特市",152522:"阿巴嘎旗",152523:"苏尼特左旗",152524:"苏尼特右旗",152525:"东乌珠穆沁旗",152526:"西乌珠穆沁旗",152527:"太仆寺旗",152528:"镶黄旗",152529:"正镶白旗",152530:"正蓝旗",152531:"多伦县",152532:"其它区"},"0,150000,152900":{152921:"阿拉善左旗",152922:"阿拉善右旗",152923:"额济纳旗",152924:"其它区"},"0,210000":{210100:"沈阳市",210200:"大连市",210300:"鞍山市",210400:"抚顺市",210500:"本溪市",210600:"丹东市",210700:"锦州市",210800:"营口市",210900:"阜新市",211000:"辽阳市",211100:"盘锦市",211200:"铁岭市",211300:"朝阳市",211400:"葫芦岛市"},"0,210000,210100":{210102:"和平区",210103:"沈河区",210104:"大东区",210105:"皇姑区",210106:"铁西区",210111:"苏家屯区",210112:"东陵区",210113:"新城子区",210114:"于洪区",210122:"辽中县",210123:"康平县",210124:"法库县",210181:"新民市",210182:"浑南新区",210183:"张士开发区",210184:"沈北新区",210185:"其它区"},"0,210000,210200":{210202:"中山区",210203:"西岗区",210204:"沙河口区",210211:"甘井子区",210212:"旅顺口区",210213:"金州区",210224:"长海县",210251:"开发区",210281:"瓦房店市",210282:"普兰店市",210283:"庄河市",210297:"岭前区",210298:"其它区"},"0,210000,210300":{210302:"铁东区",210303:"铁西区",210304:"立山区",210311:"千山区",210321:"台安县",210323:"岫岩满族自治县",210351:"高新区",210381:"海城市",210382:"其它区"},"0,210000,210400":{210402:"新抚区",210403:"东洲区",210404:"望花区",210411:"顺城区",210421:"抚顺县",210422:"新宾满族自治县",210423:"清原满族自治县",210424:"其它区"},"0,210000,210500":{210502:"平山区",210503:"溪湖区",210504:"明山区",210505:"南芬区",210521:"本溪满族自治县",210522:"桓仁满族自治县",210523:"其它区"},"0,210000,210600":{210602:"元宝区",210603:"振兴区",210604:"振安区",210624:"宽甸满族自治县",210681:"东港市",210682:"凤城市",210683:"其它区"},"0,210000,210700":{210702:"古塔区",210703:"凌河区",210711:"太和区",210726:"黑山县",210727:"义县",210781:"凌海市",210782:"北镇市",210783:"其它区"},"0,210000,210800":{210802:"站前区",210803:"西市区",210804:"鲅鱼圈区",210811:"老边区",210881:"盖州市",210882:"大石桥市",210883:"其它区"},"0,210000,210900":{210902:"海州区",210903:"新邱区",210904:"太平区",210905:"清河门区",210911:"细河区",210921:"阜新蒙古族自治县",210922:"彰武县",210923:"其它区"},"0,210000,211000":{211002:"白塔区",211003:"文圣区",211004:"宏伟区",211005:"弓长岭区",211011:"太子河区",211021:"辽阳县",211081:"灯塔市",211082:"其它区"},"0,210000,211100":{211102:"双台子区",211103:"兴隆台区",211121:"大洼县",211122:"盘山县",211123:"其它区"},"0,210000,211200":{211202:"银州区",211204:"清河区",211221:"铁岭县",211223:"西丰县",211224:"昌图县",211281:"调兵山市",211282:"开原市",211283:"其它区"},"0,210000,211300":{211302:"双塔区",211303:"龙城区",211321:"朝阳县",211322:"建平县",211324:"喀喇沁左翼蒙古族自治县",211381:"北票市",211382:"凌源市",211383:"其它区"},"0,210000,211400":{211402:"连山区",211403:"龙港区",211404:"南票区",211421:"绥中县",211422:"建昌县",211481:"兴城市",211482:"其它区"},"0,220000":{220100:"长春市",220200:"吉林市",220300:"四平市",220400:"辽源市",220500:"通化市",220600:"白山市",220700:"松原市",220800:"白城市",222400:"延边朝鲜族自治州"},"0,220000,220100":{220102:"南关区",220103:"宽城区",220104:"朝阳区",220105:"二道区",220106:"绿园区",220112:"双阳区",220122:"农安县",220181:"九台市",220182:"榆树市",220183:"德惠市",220184:"高新技术产业开发区",220185:"汽车产业开发区",220186:"经济技术开发区",220187:"净月旅游开发区",220188:"其它区"},"0,220000,220200":{220202:"昌邑区",220203:"龙潭区",220204:"船营区",220211:"丰满区",220221:"永吉县",220281:"蛟河市",220282:"桦甸市",220283:"舒兰市",220284:"磐石市",220285:"其它区"},"0,220000,220300":{220302:"铁西区",220303:"铁东区",220322:"梨树县",220323:"伊通满族自治县",220381:"公主岭市",220382:"双辽市",220383:"其它区"},"0,220000,220400":{220402:"龙山区",220403:"西安区",220421:"东丰县",220422:"东辽县",220423:"其它区"},"0,220000,220500":{220502:"东昌区",220503:"二道江区",220521:"通化县",220523:"辉南县",220524:"柳河县",220581:"梅河口市",220582:"集安市",220583:"其它区"},"0,220000,220600":{220602:"八道江区",220621:"抚松县",220622:"靖宇县",220623:"长白朝鲜族自治县",220625:"江源市",220681:"临江市",220682:"其它区"},"0,220000,220700":{220702:"宁江区",220721:"前郭尔罗斯蒙古族自治县",220722:"长岭县",220723:"乾安县",220724:"扶余县",220725:"其它区"},"0,220000,220800":{220802:"洮北区",220821:"镇赉县",220822:"通榆县",220881:"洮南市",220882:"大安市",220883:"其它区"},"0,220000,222400":{222401:"延吉市",222402:"图们市",222403:"敦化市",222404:"珲春市",222405:"龙井市",222406:"和龙市",222424:"汪清县",222426:"安图县",222427:"其它区"},"0,230000":{230100:"哈尔滨市",230200:"齐齐哈尔市",230300:"鸡西市",230400:"鹤岗市",230500:"双鸭山市",230600:"大庆市",230700:"伊春市",230800:"佳木斯市",230900:"七台河市",231000:"牡丹江市",231100:"黑河市",231200:"绥化市",232700:"大兴安岭地区"},"0,230000,230100":{230102:"道里区",230103:"南岗区",230104:"道外区",230106:"香坊区",230107:"动力区",230108:"平房区",230109:"松北区",230111:"呼兰区",230123:"依兰县",230124:"方正县",230125:"宾县",230126:"巴彦县",230127:"木兰县",230128:"通河县",230129:"延寿县",230181:"阿城市",230182:"双城市",230183:"尚志市",230184:"五常市",230185:"阿城市",230186:"其它区"},"0,230000,230200":{230202:"龙沙区",230203:"建华区",230204:"铁锋区",230205:"昂昂溪区",230206:"富拉尔基区",230207:"碾子山区",230208:"梅里斯达斡尔族区",230221:"龙江县",230223:"依安县",230224:"泰来县",230225:"甘南县",230227:"富裕县",230229:"克山县",230230:"克东县",230231:"拜泉县",230281:"讷河市",230282:"其它区"},"0,230000,230300":{230302:"鸡冠区",230303:"恒山区",230304:"滴道区",230305:"梨树区",230306:"城子河区",230307:"麻山区",230321:"鸡东县",230381:"虎林市",230382:"密山市",230383:"其它区"},"0,230000,230400":{230402:"向阳区",230403:"工农区",230404:"南山区",230405:"兴安区",230406:"东山区",230407:"兴山区",230421:"萝北县",230422:"绥滨县",230423:"其它区"},"0,230000,230500":{230502:"尖山区",230503:"岭东区",230505:"四方台区",230506:"宝山区",230521:"集贤县",230522:"友谊县",230523:"宝清县",230524:"饶河县",230525:"其它区"},"0,230000,230600":{230602:"萨尔图区",230603:"龙凤区",230604:"让胡路区",230605:"红岗区",230606:"大同区",230621:"肇州县",230622:"肇源县",230623:"林甸县",230624:"杜尔伯特蒙古族自治县",230625:"其它区"},"0,230000,230700":{230702:"伊春区",230703:"南岔区",230704:"友好区",230705:"西林区",230706:"翠峦区",230707:"新青区",230708:"美溪区",230709:"金山屯区",230710:"五营区",230711:"乌马河区",230712:"汤旺河区",230713:"带岭区",230714:"乌伊岭区",230715:"红星区",230716:"上甘岭区",230722:"嘉荫县",230781:"铁力市",230782:"其它区"},"0,230000,230800":{230802:"永红区",230803:"向阳区",230804:"前进区",230805:"东风区",230811:"郊区",230822:"桦南县",230826:"桦川县",230828:"汤原县",230833:"抚远县",230881:"同江市",230882:"富锦市",230883:"其它区"},"0,230000,230900":{230902:"新兴区",230903:"桃山区",230904:"茄子河区",230921:"勃利县",230922:"其它区"},"0,230000,231000":{231002:"东安区",231003:"阳明区",231004:"爱民区",231005:"西安区",231024:"东宁县",231025:"林口县",231081:"绥芬河市",231083:"海林市",231084:"宁安市",231085:"穆棱市",231086:"其它区"},"0,230000,231100":{231102:"爱辉区",231121:"嫩江县",231123:"逊克县",231124:"孙吴县",231181:"北安市",231182:"五大连池市",231183:"其它区"},"0,230000,231200":{231202:"北林区",231221:"望奎县",231222:"兰西县",231223:"青冈县",231224:"庆安县",231225:"明水县",231226:"绥棱县",231281:"安达市",231282:"肇东市",231283:"海伦市",231284:"其它区"},"0,230000,232700":{232721:"呼玛县",232722:"塔河县",232723:"漠河县",232724:"加格达奇区",232725:"其它区"},"0,310000":{310100:"上海市"},"0,310000,310100":{310101:"黄浦区",310103:"卢湾区",310104:"徐汇区",310105:"长宁区",310106:"静安区",310107:"普陀区",310108:"闸北区",310109:"虹口区",310110:"杨浦区",310112:"闵行区",310113:"宝山区",310114:"嘉定区",310115:"浦东新区",310116:"金山区",310117:"松江区",310118:"青浦区",310119:"南汇区",310120:"奉贤区",310152:"川沙区",310230:"崇明县",310231:"其它区"},"0,320000":{320100:"南京市",320200:"无锡市",320300:"徐州市",320400:"常州市",320500:"苏州市",320600:"南通市",320700:"连云港市",320800:"淮安市",320900:"盐城市",321000:"扬州市",321100:"镇江市",321200:"泰州市",321300:"宿迁市"},"0,320000,320100":{320102:"玄武区",320103:"白下区",320104:"秦淮区",320105:"建邺区",320106:"鼓楼区",320107:"下关区",320111:"浦口区",320113:"栖霞区",320114:"雨花台区",320115:"江宁区",320116:"六合区",320124:"溧水县",320125:"高淳县",320126:"其它区"},"0,320000,320200":{320202:"崇安区",320203:"南长区",320204:"北塘区",320205:"锡山区",320206:"惠山区",320211:"滨湖区",320281:"江阴市",320282:"宜兴市",320296:"新区",320297:"其它区"},"0,320000,320300":{320302:"鼓楼区",320303:"云龙区",320304:"九里区",320305:"贾汪区",320311:"泉山区",320321:"丰县",320322:"沛县",320323:"铜山县",320324:"睢宁县",320381:"新沂市",320382:"邳州市",320383:"其它区"},"0,320000,320400":{320402:"天宁区",320404:"钟楼区",320405:"戚墅堰区",320411:"新北区",320412:"武进区",320481:"溧阳市",320482:"金坛市",320483:"其它区"},"0,320000,320500":{320502:"沧浪区",320503:"平江区",320504:"金阊区",320505:"虎丘区",320506:"吴中区",320507:"相城区",320581:"常熟市",320582:"张家港市",320583:"昆山市",320584:"吴江市",320585:"太仓市",320594:"新区",320595:"园区",320596:"其它区"},"0,320000,320600":{320602:"崇川区",320611:"港闸区",320612:"通州区",320621:"海安县",320623:"如东县",320681:"启东市",320682:"如皋市",320683:"通州市",320684:"海门市",320693:"开发区",320694:"其它区"},"0,320000,320700":{320703:"连云区",320705:"新浦区",320706:"海州区",320721:"赣榆县",320722:"东海县",320723:"灌云县",320724:"灌南县",320725:"其它区"},"0,320000,320800":{320802:"清河区",320803:"楚州区",320804:"淮阴区",320811:"清浦区",320826:"涟水县",320829:"洪泽县",320830:"盱眙县",320831:"金湖县",320832:"其它区"},"0,320000,320900":{320902:"亭湖区",320903:"盐都区",320921:"响水县",320922:"滨海县",320923:"阜宁县",320924:"射阳县",320925:"建湖县",320981:"东台市",320982:"大丰市",320983:"其它区"},"0,320000,321000":{321002:"广陵区",321003:"邗江区",321011:"维扬区",321023:"宝应县",321081:"仪征市",321084:"高邮市",321088:"江都市",321092:"经济开发区",321093:"其它区"},"0,320000,321100":{321102:"京口区",321111:"润州区",321112:"丹徒区",321181:"丹阳市",321182:"扬中市",321183:"句容市",321184:"其它区"},"0,320000,321200":{321202:"海陵区",321203:"高港区",321281:"兴化市",321282:"靖江市",321283:"泰兴市",321284:"姜堰市",321285:"其它区"},"0,320000,321300":{321302:"宿城区",321311:"宿豫区",321322:"沭阳县",321323:"泗阳县",321324:"泗洪县",321325:"其它区"},"0,330000":{330100:"杭州市",330200:"宁波市",330300:"温州市",330400:"嘉兴市",330500:"湖州市",330600:"绍兴市",330700:"金华市",330800:"衢州市",330900:"舟山市",331000:"台州市",331100:"丽水市"},"0,330000,330100":{330102:"上城区",330103:"下城区",330104:"江干区",330105:"拱墅区",330106:"西湖区",330108:"滨江区",330109:"萧山区",330110:"余杭区",330122:"桐庐县",330127:"淳安县",330182:"建德市",330183:"富阳市",330185:"临安市",330186:"其它区"},"0,330000,330200":{330203:"海曙区",330204:"江东区",330205:"江北区",330206:"北仑区",330211:"镇海区",330212:"鄞州区",330225:"象山县",330226:"宁海县",330281:"余姚市",330282:"慈溪市",330283:"奉化市",330284:"其它区"},"0,330000,330300":{330302:"鹿城区",330303:"龙湾区",330304:"瓯海区",330322:"洞头县",330324:"永嘉县",330326:"平阳县",330327:"苍南县",330328:"文成县",330329:"泰顺县",330381:"瑞安市",330382:"乐清市",330383:"其它区"},"0,330000,330400":{330402:"南湖区",330411:"秀洲区",330421:"嘉善县",330424:"海盐县",330481:"海宁市",330482:"平湖市",330483:"桐乡市",330484:"其它区"},"0,330000,330500":{330502:"吴兴区",330503:"南浔区",330521:"德清县",330522:"长兴县",330523:"安吉县",330524:"其它区"},"0,330000,330600":{330602:"越城区",330621:"绍兴县",330624:"新昌县",330681:"诸暨市",330682:"上虞市",330683:"嵊州市",330684:"其它区"},"0,330000,330700":{330702:"婺城区",330703:"金东区",330723:"武义县",330726:"浦江县",330727:"磐安县",330781:"兰溪市",330782:"义乌市",330783:"东阳市",330784:"永康市",330785:"其它区"},"0,330000,330800":{330802:"柯城区",330803:"衢江区",330822:"常山县",330824:"开化县",330825:"龙游县",330881:"江山市",330882:"其它区"},"0,330000,330900":{330902:"定海区",330903:"普陀区",330921:"岱山县",330922:"嵊泗县",330923:"其它区"},"0,330000,331000":{331002:"椒江区",331003:"黄岩区",331004:"路桥区",331021:"玉环县",331022:"三门县",331023:"天台县",331024:"仙居县",331081:"温岭市",331082:"临海市",331083:"其它区"},"0,330000,331100":{331102:"莲都区",331121:"青田县",331122:"缙云县",331123:"遂昌县",331124:"松阳县",331125:"云和县",331126:"庆元县",331127:"景宁畲族自治县",331181:"龙泉市",331182:"其它区"},"0,340000":{340100:"合肥市",340200:"芜湖市",340300:"蚌埠市",340400:"淮南市",340500:"马鞍山市",340600:"淮北市",340700:"铜陵市",340800:"安庆市",341000:"黄山市",341100:"滁州市",341200:"阜阳市",341300:"宿州市",341500:"六安市",341600:"亳州市",341700:"池州市",341800:"宣城市"},"0,340000,340100":{340102:"瑶海区",340103:"庐阳区",340104:"蜀山区",340111:"包河区",340121:"长丰县",340122:"肥东县",340123:"肥西县",340151:"高新区",340191:"中区",340192:"其它区",341400:"巢湖市",341402:"居巢区",341421:"庐江县"},"0,340000,340200":{340202:"镜湖区",340203:"弋江区",340207:"鸠江区",340208:"三山区",340221:"芜湖县",340222:"繁昌县",340223:"南陵县",340224:"其它区",341422:"无为县"},"0,340000,340300":{340302:"龙子湖区",340303:"蚌山区",340304:"禹会区",340311:"淮上区",340321:"怀远县",340322:"五河县",340323:"固镇县",340324:"其它区"},"0,340000,340400":{340402:"大通区",340403:"田家庵区",340404:"谢家集区",340405:"八公山区",340406:"潘集区",340421:"凤台县",340422:"其它区"},"0,340000,340500":{340502:"金家庄区",340503:"花山区",340504:"雨山区",340521:"当涂县",340522:"其它区",341423:"含山县",341424:"和县"},"0,340000,340600":{340602:"杜集区",340603:"相山区",340604:"烈山区",340621:"濉溪县",340622:"其它区"},"0,340000,340700":{340702:"铜官山区",340703:"狮子山区",340711:"郊区",340721:"铜陵县",340722:"其它区"},"0,340000,340800":{340802:"迎江区",340803:"大观区",340811:"宜秀区",340822:"怀宁县",340823:"枞阳县",340824:"潜山县",340825:"太湖县",340826:"宿松县",340827:"望江县",340828:"岳西县",340881:"桐城市",340882:"其它区"},"0,340000,341000":{341002:"屯溪区",341003:"黄山区",341004:"徽州区",341021:"歙县",341022:"休宁县",341023:"黟县",341024:"祁门县",341025:"其它区"},"0,340000,341100":{341102:"琅琊区",341103:"南谯区",341122:"来安县",341124:"全椒县",341125:"定远县",341126:"凤阳县",341181:"天长市",341182:"明光市",341183:"其它区"},"0,340000,341200":{341202:"颍州区",341203:"颍东区",341204:"颍泉区",341221:"临泉县",341222:"太和县",341225:"阜南县",341226:"颍上县",341282:"界首市",341283:"其它区"},"0,340000,341300":{341302:"埇桥区",341321:"砀山县",341322:"萧县",341323:"灵璧县",341324:"泗县",341325:"其它区"},"0,340000,341500":{341502:"金安区",341503:"裕安区",341521:"寿县",341522:"霍邱县",341523:"舒城县",341524:"金寨县",341525:"霍山县",341526:"其它区"},"0,340000,341600":{341602:"谯城区",341621:"涡阳县",341622:"蒙城县",341623:"利辛县",341624:"其它区"},"0,340000,341700":{341702:"贵池区",341721:"东至县",341722:"石台县",341723:"青阳县",341724:"其它区"},"0,340000,341800":{341802:"宣州区",341821:"郎溪县",341822:"广德县",341823:"泾县",341824:"绩溪县",341825:"旌德县",341881:"宁国市",341882:"其它区"},"0,350000":{350100:"福州市",350200:"厦门市",350300:"莆田市",350400:"三明市",350500:"泉州市",350600:"漳州市",350700:"南平市",350800:"龙岩市",350900:"宁德市"},"0,350000,350100":{350102:"鼓楼区",350103:"台江区",350104:"仓山区",350105:"马尾区",350111:"晋安区",350121:"闽侯县",350122:"连江县",350123:"罗源县",350124:"闽清县",350125:"永泰县",350128:"平潭县",350181:"福清市",350182:"长乐市",350183:"其它区"},"0,350000,350200":{350203:"思明区",350205:"海沧区",350206:"湖里区",350211:"集美区",350212:"同安区",350213:"翔安区",350214:"其它区"},"0,350000,350300":{350302:"城厢区",350303:"涵江区",350304:"荔城区",350305:"秀屿区",350322:"仙游县",350323:"其它区"},"0,350000,350400":{350402:"梅列区",350403:"三元区",350421:"明溪县",350423:"清流县",350424:"宁化县",350425:"大田县",350426:"尤溪县",350427:"沙县",350428:"将乐县",350429:"泰宁县",350430:"建宁县",350481:"永安市",350482:"其它区"},"0,350000,350500":{350502:"鲤城区",350503:"丰泽区",350504:"洛江区",350505:"泉港区",350521:"惠安县",350524:"安溪县",350525:"永春县",350526:"德化县",350527:"金门县",350581:"石狮市",350582:"晋江市",350583:"南安市",350584:"其它区"},"0,350000,350600":{350602:"芗城区",350603:"龙文区",350622:"云霄县",350623:"漳浦县",350624:"诏安县",350625:"长泰县",350626:"东山县",350627:"南靖县",350628:"平和县",350629:"华安县",350681:"龙海市",350682:"其它区"},"0,350000,350700":{350702:"延平区",350721:"顺昌县",350722:"浦城县",350723:"光泽县",350724:"松溪县",350725:"政和县",350781:"邵武市",350782:"武夷山市",350783:"建瓯市",350784:"建阳市",350785:"其它区"},"0,350000,350800":{350802:"新罗区",350821:"长汀县",350822:"永定县",350823:"上杭县",350824:"武平县",350825:"连城县",350881:"漳平市",350882:"其它区"},"0,350000,350900":{350902:"蕉城区",350921:"霞浦县",350922:"古田县",350923:"屏南县",350924:"寿宁县",350925:"周宁县",350926:"柘荣县",350981:"福安市",350982:"福鼎市",350983:"其它区"},"0,360000":{360100:"南昌市",360200:"景德镇市",360300:"萍乡市",360400:"九江市",360500:"新余市",360600:"鹰潭市",360700:"赣州市",360800:"吉安市",360900:"宜春市",361000:"抚州市",361100:"上饶市"},"0,360000,360100":{360102:"东湖区",360103:"西湖区",360104:"青云谱区",360105:"湾里区",360111:"青山湖区",360121:"南昌县",360122:"新建县",360123:"安义县",360124:"进贤县",360125:"红谷滩新区",360126:"经济技术开发区",360127:"昌北区",360128:"其它区"},"0,360000,360200":{360202:"昌江区",360203:"珠山区",360222:"浮梁县",360281:"乐平市",360282:"其它区"},"0,360000,360300":{360302:"安源区",360313:"湘东区",360321:"莲花县",360322:"上栗县",360323:"芦溪县",360324:"其它区"},"0,360000,360400":{360402:"庐山区",360403:"浔阳区",360421:"九江县",360423:"武宁县",360424:"修水县",360425:"永修县",360426:"德安县",360427:"星子县",360428:"都昌县",360429:"湖口县",360430:"彭泽县",360481:"瑞昌市",360482:"其它区"},"0,360000,360500":{360502:"渝水区",360521:"分宜县",360522:"其它区"},"0,360000,360600":{360602:"月湖区",360622:"余江县",360681:"贵溪市",360682:"其它区"},"0,360000,360700":{360702:"章贡区",360721:"赣县",360722:"信丰县",360723:"大余县",360724:"上犹县",360725:"崇义县",360726:"安远县",360727:"龙南县",360728:"定南县",360729:"全南县",360730:"宁都县",360731:"于都县",360732:"兴国县",360733:"会昌县",360734:"寻乌县",360735:"石城县",360751:"黄金区",360781:"瑞金市",360782:"南康市",360783:"其它区"},"0,360000,360800":{360802:"吉州区",360803:"青原区",360821:"吉安县",360822:"吉水县",360823:"峡江县",360824:"新干县",360825:"永丰县",360826:"泰和县",360827:"遂川县",360828:"万安县",360829:"安福县",360830:"永新县",360881:"井冈山市",360882:"其它区"},"0,360000,360900":{360902:"袁州区",360921:"奉新县",360922:"万载县",360923:"上高县",360924:"宜丰县",360925:"靖安县",360926:"铜鼓县",360981:"丰城市",360982:"樟树市",360983:"高安市",360984:"其它区"},"0,360000,361000":{361002:"临川区",361021:"南城县",361022:"黎川县",361023:"南丰县",361024:"崇仁县",361025:"乐安县",361026:"宜黄县",361027:"金溪县",361028:"资溪县",361029:"东乡县",361030:"广昌县",361031:"其它区"},"0,360000,361100":{361102:"信州区",361121:"上饶县",361122:"广丰县",361123:"玉山县",361124:"铅山县",361125:"横峰县",361126:"弋阳县",361127:"余干县",361128:"鄱阳县",361129:"万年县",361130:"婺源县",361181:"德兴市",361182:"其它区"},"0,370000":{370100:"济南市",370200:"青岛市",370300:"淄博市",370400:"枣庄市",370500:"东营市",370600:"烟台市",370700:"潍坊市",370800:"济宁市",370900:"泰安市",371000:"威海市",371100:"日照市",371200:"莱芜市",371300:"临沂市",371400:"德州市",371500:"聊城市",371600:"滨州市",371700:"菏泽市"},"0,370000,370100":{370102:"历下区",370103:"市中区",370104:"槐荫区",370105:"天桥区",370112:"历城区",370113:"长清区",370124:"平阴县",370125:"济阳县",370126:"商河县",370181:"章丘市",370182:"其它区"},"0,370000,370200":{370202:"市南区",370203:"市北区",370205:"四方区",370211:"黄岛区",370212:"崂山区",370213:"李沧区",370214:"城阳区",370251:"开发区",370281:"胶州市",370282:"即墨市",370283:"平度市",370284:"胶南市",370285:"莱西市",370286:"其它区"},"0,370000,370300":{370302:"淄川区",370303:"张店区",370304:"博山区",370305:"临淄区",370306:"周村区",370321:"桓台县",370322:"高青县",370323:"沂源县",370324:"其它区"},"0,370000,370400":{370402:"市中区",370403:"薛城区",370404:"峄城区",370405:"台儿庄区",370406:"山亭区",370481:"滕州市",370482:"其它区"},"0,370000,370500":{370502:"东营区",370503:"河口区",370521:"垦利县",370522:"利津县",370523:"广饶县",370589:"西城区",370590:"东城区",370591:"其它区"},"0,370000,370600":{370602:"芝罘区",370611:"福山区",370612:"牟平区",370613:"莱山区",370634:"长岛县",370681:"龙口市",370682:"莱阳市",370683:"莱州市",370684:"蓬莱市",370685:"招远市",370686:"栖霞市",370687:"海阳市",370688:"其它区"},"0,370000,370700":{370702:"潍城区",370703:"寒亭区",370704:"坊子区",370705:"奎文区",370724:"临朐县",370725:"昌乐县",370751:"开发区",370781:"青州市",370782:"诸城市",370783:"寿光市",370784:"安丘市",370785:"高密市",370786:"昌邑市",370787:"其它区"},"0,370000,370800":{370802:"市中区",370811:"任城区",370826:"微山县",370827:"鱼台县",370828:"金乡县",370829:"嘉祥县",370830:"汶上县",370831:"泗水县",370832:"梁山县",370881:"曲阜市",370882:"兖州市",370883:"邹城市",370884:"其它区"},"0,370000,370900":{370902:"泰山区",370903:"岱岳区",370921:"宁阳县",370923:"东平县",370982:"新泰市",370983:"肥城市",370984:"其它区"},"0,370000,371000":{371002:"环翠区",371081:"文登市",371082:"荣成市",371083:"乳山市",371084:"其它区"},"0,370000,371100":{371102:"东港区",371103:"岚山区",371121:"五莲县",371122:"莒县",371123:"其它区"},"0,370000,371200":{371202:"莱城区",371203:"钢城区",371204:"其它区"},"0,370000,371300":{371302:"兰山区",371311:"罗庄区",371312:"河东区",371321:"沂南县",371322:"郯城县",371323:"沂水县",371324:"苍山县",371325:"费县",371326:"平邑县",371327:"莒南县",371328:"蒙阴县",371329:"临沭县",371330:"其它区"},"0,370000,371400":{371402:"德城区",371421:"陵县",371422:"宁津县",371423:"庆云县",371424:"临邑县",371425:"齐河县",371426:"平原县",371427:"夏津县",371428:"武城县",371451:"开发区",371481:"乐陵市",371482:"禹城市",371483:"其它区"},"0,370000,371500":{371502:"东昌府区",371521:"阳谷县",371522:"莘县",371523:"茌平县",371524:"东阿县",371525:"冠县",371526:"高唐县",371581:"临清市",371582:"其它区"},"0,370000,371600":{371602:"滨城区",371621:"惠民县",371622:"阳信县",371623:"无棣县",371624:"沾化县",371625:"博兴县",371626:"邹平县",371627:"其它区"},"0,370000,371700":{371702:"牡丹区",371721:"曹县",371722:"单县",371723:"成武县",371724:"巨野县",371725:"郓城县",371726:"鄄城县",371727:"定陶县",371728:"东明县",371729:"其它区"},"0,410000":{410100:"郑州市",410200:"开封市",410300:"洛阳市",410400:"平顶山市",410500:"安阳市",410600:"鹤壁市",410700:"新乡市",410800:"焦作市",410881:"济源市",410900:"濮阳市",411000:"许昌市",411100:"漯河市",411200:"三门峡市",411300:"南阳市",411400:"商丘市",411500:"信阳市",411600:"周口市",411700:"驻马店市"},"0,410000,410100":{410102:"中原区",410103:"二七区",410104:"管城回族区",410105:"金水区",410106:"上街区",410108:"惠济区",410122:"中牟县",410181:"巩义市",410182:"荥阳市",410183:"新密市",410184:"新郑市",410185:"登封市",410186:"郑东新区",410187:"高新区",410188:"其它区"},"0,410000,410200":{410202:"龙亭区",410203:"顺河回族区",410204:"鼓楼区",410205:"禹王台区",410211:"金明区",410221:"杞县",410222:"通许县",410223:"尉氏县",410224:"开封县",410225:"兰考县",410226:"其它区"},"0,410000,410300":{410302:"老城区",410303:"西工区",410304:"廛河回族区",410305:"涧西区",410306:"吉利区",410307:"洛龙区",410322:"孟津县",410323:"新安县",410324:"栾川县",410325:"嵩县",410326:"汝阳县",410327:"宜阳县",410328:"洛宁县",410329:"伊川县",410381:"偃师市",471004:"高新区",471005:"其它区"},"0,410000,410400":{410402:"新华区",410403:"卫东区",410404:"石龙区",410411:"湛河区",410421:"宝丰县",410422:"叶县",410423:"鲁山县",410425:"郏县",410481:"舞钢市",410482:"汝州市",410483:"其它区"},"0,410000,410500":{410502:"文峰区",410503:"北关区",410505:"殷都区",410506:"龙安区",410522:"安阳县",410523:"汤阴县",410526:"滑县",410527:"内黄县",410581:"林州市",410582:"其它区"},"0,410000,410600":{410602:"鹤山区",410603:"山城区",410611:"淇滨区",410621:"浚县",410622:"淇县",410623:"其它区"},"0,410000,410700":{410702:"红旗区",410703:"卫滨区",410704:"凤泉区",410711:"牧野区",410721:"新乡县",410724:"获嘉县",410725:"原阳县",410726:"延津县",410727:"封丘县",410728:"长垣县",410781:"卫辉市",410782:"辉县市",410783:"其它区"},"0,410000,410800":{410802:"解放区",410803:"中站区",410804:"马村区",410811:"山阳区",410821:"修武县",410822:"博爱县",410823:"武陟县",410825:"温县",410882:"沁阳市",410883:"孟州市",410884:"其它区"},"0,410000,410881":{1032701:"济源市",1032702:"其他"},"0,410000,410900":{410902:"华龙区",410922:"清丰县",410923:"南乐县",410926:"范县",410927:"台前县",410928:"濮阳县",410929:"其它区"},"0,410000,411000":{411002:"魏都区",411023:"许昌县",411024:"鄢陵县",411025:"襄城县",411081:"禹州市",411082:"长葛市",411083:"其它区"},"0,410000,411100":{411102:"源汇区",411103:"郾城区",411104:"召陵区",411121:"舞阳县",411122:"临颍县",411123:"其它区"},"0,410000,411200":{411202:"湖滨区",411221:"渑池县",411222:"陕县",411224:"卢氏县",411281:"义马市",411282:"灵宝市",411283:"其它区"},"0,410000,411300":{411302:"宛城区",411303:"卧龙区",411321:"南召县",411322:"方城县",411323:"西峡县",411324:"镇平县",411325:"内乡县",411326:"淅川县",411327:"社旗县",411328:"唐河县",411329:"新野县",411330:"桐柏县",411381:"邓州市",411382:"其它区"},"0,410000,411400":{411402:"梁园区",411403:"睢阳区",411421:"民权县",411422:"睢县",411423:"宁陵县",411424:"柘城县",411425:"虞城县",411426:"夏邑县",411481:"永城市",411482:"其它区"},"0,410000,411500":{411502:"浉河区",411503:"平桥区",411521:"罗山县",411522:"光山县",411523:"新县",411524:"商城县",411525:"固始县",411526:"潢川县",411527:"淮滨县",411528:"息县",411529:"其它区"},"0,410000,411600":{411602:"川汇区",411621:"扶沟县",411622:"西华县",411623:"商水县",411624:"沈丘县",411625:"郸城县",411626:"淮阳县",411627:"太康县",411628:"鹿邑县",411681:"项城市",411682:"其它区"},"0,410000,411700":{411702:"驿城区",411721:"西平县",411722:"上蔡县",411723:"平舆县",411724:"正阳县",411725:"确山县",411726:"泌阳县",411727:"汝南县",411728:"遂平县",411729:"新蔡县",411730:"其它区"},"0,420000":{420100:"武汉市",420200:"黄石市",420300:"十堰市",420500:"宜昌市",420600:"襄阳市",420700:"鄂州市",420800:"荆门市",420900:"孝感市",421000:"荆州市",421100:"黄冈市",421200:"咸宁市",421300:"随州市",422800:"恩施土家族苗族自治州",429004:"仙桃市",429005:"潜江市",429006:"天门市",429021:"神农架林区"},"0,420000,420100":{420102:"江岸区",420103:"江汉区",420104:"硚口区",420105:"汉阳区",420106:"武昌区",420107:"青山区",420111:"洪山区",420112:"东西湖区",420113:"汉南区",420114:"蔡甸区",420115:"江夏区",420116:"黄陂区",420117:"新洲区",420118:"其它区"},"0,420000,420200":{420202:"黄石港区",420203:"西塞山区",420204:"下陆区",420205:"铁山区",420222:"阳新县",420281:"大冶市",420282:"其它区"},"0,420000,420300":{420302:"茅箭区",420303:"张湾区",420321:"郧县",420322:"郧西县",420323:"竹山县",420324:"竹溪县",420325:"房县",420381:"丹江口市",420382:"城区",420383:"其它区"},"0,420000,420500":{420502:"西陵区",420503:"伍家岗区",420504:"点军区",420505:"猇亭区",420506:"夷陵区",420525:"远安县",420526:"兴山县",420527:"秭归县",420528:"长阳土家族自治县",420529:"五峰土家族自治县",420551:"葛洲坝区",420552:"开发区",420581:"宜都市",420582:"当阳市",420583:"枝江市",420584:"其它区"},"0,420000,420600":{420602:"襄城区",420606:"樊城区",420607:"襄州区",420624:"南漳县",420625:"谷城县",420626:"保康县",420682:"老河口市",420683:"枣阳市",420684:"宜城市",420685:"其它区"},"0,420000,420700":{420702:"梁子湖区",420703:"华容区",420704:"鄂城区",420705:"其它区"},"0,420000,420800":{420802:"东宝区",420804:"掇刀区",420821:"京山县",420822:"沙洋县",420881:"钟祥市",420882:"其它区"},"0,420000,420900":{420902:"孝南区",420921:"孝昌县",420922:"大悟县",420923:"云梦县",420981:"应城市",420982:"安陆市",420984:"汉川市",420985:"其它区"},"0,420000,421000":{421002:"沙市区",421003:"荆州区",421022:"公安县",421023:"监利县",421024:"江陵县",421081:"石首市",421083:"洪湖市",421087:"松滋市",421088:"其它区"},"0,420000,421100":{421102:"黄州区",421121:"团风县",421122:"红安县",421123:"罗田县",421124:"英山县",421125:"浠水县",421126:"蕲春县",421127:"黄梅县",421181:"麻城市",421182:"武穴市",421183:"其它区"},"0,420000,421200":{421202:"咸安区",421221:"嘉鱼县",421222:"通城县",421223:"崇阳县",421224:"通山县",421281:"赤壁市",421282:"温泉城区",421283:"其它区"},"0,420000,421300":{421302:"曾都区",421321:"随县",421381:"广水市",421382:"其它区"},"0,420000,422800":{422801:"恩施市",422802:"利川市",422822:"建始县",422823:"巴东县",422825:"宣恩县",422826:"咸丰县",422827:"来凤县",422828:"鹤峰县",422829:"其它区"},"0,420000,429004":{1033061:"仙桃市"},"0,420000,429005":{1033063:"潜江市"},"0,420000,429006":{1033062:"天门市"},"0,420000,429021":{1033064:"神农架林区"},"0,430000":{430100:"长沙市",430200:"株洲市",430300:"湘潭市",430400:"衡阳市",430500:"邵阳市",430600:"岳阳市",430700:"常德市",430800:"张家界市",430900:"益阳市",431000:"郴州市",431100:"永州市",431200:"怀化市",431300:"娄底市",433100:"湘西土家族苗族自治州"},"0,430000,430100":{430102:"芙蓉区",430103:"天心区",430104:"岳麓区",430105:"开福区",430111:"雨花区",430121:"长沙县",430122:"望城县",430124:"宁乡县",430181:"浏阳市",430182:"其它区"},"0,430000,430200":{430202:"荷塘区",430203:"芦淞区",430204:"石峰区",430211:"天元区",430221:"株洲县",430223:"攸县",430224:"茶陵县",430225:"炎陵县",430281:"醴陵市",430282:"其它区"},"0,430000,430300":{430302:"雨湖区",430304:"岳塘区",430321:"湘潭县",430381:"湘乡市",430382:"韶山市",430383:"其它区"},"0,430000,430400":{430405:"珠晖区",430406:"雁峰区",430407:"石鼓区",430408:"蒸湘区",430412:"南岳区",430421:"衡阳县",430422:"衡南县",430423:"衡山县",430424:"衡东县",430426:"祁东县",430481:"耒阳市",430482:"常宁市",430483:"其它区"},"0,430000,430500":{430502:"双清区",430503:"大祥区",430511:"北塔区",430521:"邵东县",430522:"新邵县",430523:"邵阳县",430524:"隆回县",430525:"洞口县",430527:"绥宁县",430528:"新宁县",430529:"城步苗族自治县",430581:"武冈市",430582:"其它区"},"0,430000,430600":{430602:"岳阳楼区",430603:"云溪区",430611:"君山区",430621:"岳阳县",430623:"华容县",430624:"湘阴县",430626:"平江县",430681:"汨罗市",430682:"临湘市",430683:"其它区"},"0,430000,430700":{430702:"武陵区",430703:"鼎城区",430721:"安乡县",430722:"汉寿县",430723:"澧县",430724:"临澧县",430725:"桃源县",430726:"石门县",430781:"津市市",430782:"其它区"},"0,430000,430800":{430802:"永定区",430811:"武陵源区",430821:"慈利县",430822:"桑植县",430823:"其它区"},"0,430000,430900":{430902:"资阳区",430903:"赫山区",430921:"南县",430922:"桃江县",430923:"安化县",430981:"沅江市",430982:"其它区"},"0,430000,431000":{431002:"北湖区",431003:"苏仙区",431021:"桂阳县",431022:"宜章县",431023:"永兴县",431024:"嘉禾县",431025:"临武县",431026:"汝城县",431027:"桂东县",431028:"安仁县",431081:"资兴市",431082:"其它区"},"0,430000,431100":{431102:"零陵区",431103:"冷水滩区",431121:"祁阳县",431122:"东安县",431123:"双牌县",431124:"道县",431125:"江永县",431126:"宁远县",431127:"蓝山县",431128:"新田县",431129:"江华瑶族自治县",431130:"其它区"},"0,430000,431200":{431202:"鹤城区",431221:"中方县",431222:"沅陵县",431223:"辰溪县",431224:"溆浦县",431225:"会同县",431226:"麻阳苗族自治县",431227:"新晃侗族自治县",431228:"芷江侗族自治县",431229:"靖州苗族侗族自治县",431230:"通道侗族自治县",431281:"洪江市",431282:"其它区"},"0,430000,431300":{431302:"娄星区",431321:"双峰县",431322:"新化县",431381:"冷水江市",431382:"涟源市",431383:"其它区"},"0,430000,433100":{433101:"吉首市",433122:"泸溪县",433123:"凤凰县",433124:"花垣县",433125:"保靖县",433126:"古丈县",433127:"永顺县",433130:"龙山县",433131:"其它区"},"0,440000":{440100:"广州市",440200:"韶关市",440300:"深圳市",440400:"珠海市",440500:"汕头市",440600:"佛山市",440700:"江门市",440800:"湛江市",440900:"茂名市",441200:"肇庆市",441300:"惠州市",441400:"梅州市",441500:"汕尾市",441600:"河源市",441700:"阳江市",441800:"清远市",441900:"东莞市",442000:"中山市",445100:"潮州市",445200:"揭阳市",445300:"云浮市"},"0,440000,440100":{440103:"荔湾区",440104:"越秀区",440105:"海珠区",440106:"天河区",440111:"白云区",440112:"黄埔区",440113:"番禺区",440114:"花都区",440115:"南沙区",440116:"萝岗区",440183:"增城市",440184:"从化市",440188:"东山区",440189:"其它区"},"0,440000,440200":{440203:"武江区",440204:"浈江区",440205:"曲江区",440222:"始兴县",440224:"仁化县",440229:"翁源县",440232:"乳源瑶族自治县",440233:"新丰县",440281:"乐昌市",440282:"南雄市",440283:"其它区"},"0,440000,440300":{440303:"罗湖区",440304:"福田区",440305:"南山区",440306:"宝安区",440307:"龙岗区",440308:"盐田区",440309:"其它区",1032697:"光明新区",1032698:"坪山新区",1032699:"大鹏新区",1032700:"龙华新区"},"0,440000,440400":{440402:"香洲区",440403:"斗门区",440404:"金湾区",440486:"金唐区",440487:"南湾区",440488:"其它区"},"0,440000,440500":{440507:"龙湖区",440511:"金平区",440512:"濠江区",440513:"潮阳区",440514:"潮南区",440515:"澄海区",440523:"南澳县",440524:"其它区"},"0,440000,440600":{440604:"禅城区",440605:"南海区",440606:"顺德区",440607:"三水区",440608:"高明区",440609:"其它区"},"0,440000,440700":{440703:"蓬江区",440704:"江海区",440705:"新会区",440781:"台山市",440783:"开平市",440784:"鹤山市",440785:"恩平市",440786:"其它区"},"0,440000,440800":{440802:"赤坎区",440803:"霞山区",440804:"坡头区",440811:"麻章区",440823:"遂溪县",440825:"徐闻县",440881:"廉江市",440882:"雷州市",440883:"吴川市",440884:"其它区"},"0,440000,440900":{440902:"茂南区",440903:"茂港区",440923:"电白县",440981:"高州市",440982:"化州市",440983:"信宜市",440984:"其它区"},"0,440000,441200":{441202:"端州区",441203:"鼎湖区",441223:"广宁县",441224:"怀集县",441225:"封开县",441226:"德庆县",441283:"高要市",441284:"四会市",441285:"其它区"},"0,440000,441300":{441302:"惠城区",441303:"惠阳区",441322:"博罗县",441323:"惠东县",441324:"龙门县",441325:"其它区"},"0,440000,441400":{441402:"梅江区",441421:"梅县",441422:"大埔县",441423:"丰顺县",441424:"五华县",441426:"平远县",441427:"蕉岭县",441481:"兴宁市",441482:"其它区"},"0,440000,441500":{441502:"城区",441521:"海丰县",441523:"陆河县",441581:"陆丰市",441582:"其它区"},"0,440000,441600":{441602:"源城区",441621:"紫金县",441622:"龙川县",441623:"连平县",441624:"和平县",441625:"东源县",441626:"其它区"},"0,440000,441700":{441702:"江城区",441721:"阳西县",441723:"阳东县",441781:"阳春市",441782:"其它区"},"0,440000,441800":{441802:"清城区",441821:"佛冈县",441823:"阳山县",441825:"连山壮族瑶族自治县",441826:"连南瑶族自治县",441827:"清新县",441881:"英德市",441882:"连州市",441883:"其它区"},"0,440000,441900":{1032703:"东莞"},"0,440000,442000":{1033054:"中山市"},"0,440000,445100":{445102:"湘桥区",445121:"潮安县",445122:"饶平县",445185:"枫溪区",445186:"其它区"},"0,440000,445200":{445202:"榕城区",445221:"揭东县",445222:"揭西县",445224:"惠来县",445281:"普宁市",445284:"东山区",445285:"其它区"},"0,440000,445300":{445302:"云城区",445321:"新兴县",445322:"郁南县",445323:"云安县",445381:"罗定市",445382:"其它区"},"0,450000":{450100:"南宁市",450200:"柳州市",450300:"桂林市",450400:"梧州市",450500:"北海市",450600:"防城港市",450700:"钦州市",450800:"贵港市",450900:"玉林市",451000:"百色市",451100:"贺州市",451200:"河池市",451300:"来宾市",451400:"崇左市"},"0,450000,450100":{450102:"兴宁区",450103:"青秀区",450105:"江南区",450107:"西乡塘区",450108:"良庆区",450109:"邕宁区",450122:"武鸣县",450123:"隆安县",450124:"马山县",450125:"上林县",450126:"宾阳县",450127:"横县",450128:"其它区"},"0,450000,450200":{450202:"城中区",450203:"鱼峰区",450204:"柳南区",450205:"柳北区",450221:"柳江县",450222:"柳城县",450223:"鹿寨县",450224:"融安县",450225:"融水苗族自治县",450226:"三江侗族自治县",450227:"其它区"},"0,450000,450300":{450302:"秀峰区",450303:"叠彩区",450304:"象山区",450305:"七星区",450311:"雁山区",450321:"阳朔县",450322:"临桂县",450323:"灵川县",450324:"全州县",450325:"兴安县",450326:"永福县",450327:"灌阳县",450328:"龙胜各族自治县",450329:"资源县",450330:"平乐县",450331:"荔浦县",450332:"恭城瑶族自治县",450333:"其它区"},"0,450000,450400":{450403:"万秀区",450404:"蝶山区",450405:"长洲区",450421:"苍梧县",450422:"藤县",450423:"蒙山县",450481:"岑溪市",450482:"其它区"},"0,450000,450500":{450502:"海城区",450503:"银海区",450512:"铁山港区",450521:"合浦县",450522:"其它区"},"0,450000,450600":{450602:"港口区",450603:"防城区",450621:"上思县",450681:"东兴市",450682:"其它区"},"0,450000,450700":{450702:"钦南区",450703:"钦北区",450721:"灵山县",450722:"浦北县",450723:"其它区"},"0,450000,450800":{450802:"港北区",450803:"港南区",450804:"覃塘区",450821:"平南县",450881:"桂平市",450882:"其它区"},"0,450000,450900":{450902:"玉州区",450921:"容县",450922:"陆川县",450923:"博白县",450924:"兴业县",450981:"北流市",450982:"其它区"},"0,450000,451000":{451002:"右江区",451021:"田阳县",451022:"田东县",451023:"平果县",451024:"德保县",451025:"靖西县",451026:"那坡县",451027:"凌云县",451028:"乐业县",451029:"田林县",451030:"西林县",451031:"隆林各族自治县",451032:"其它区"},"0,450000,451100":{451102:"八步区",451121:"昭平县",451122:"钟山县",451123:"富川瑶族自治县",451124:"其它区"},"0,450000,451200":{451202:"金城江区",451221:"南丹县",451222:"天峨县",451223:"凤山县",451224:"东兰县",451225:"罗城仫佬族自治县",451226:"环江毛南族自治县",451227:"巴马瑶族自治县",451228:"都安瑶族自治县",451229:"大化瑶族自治县",451281:"宜州市",451282:"其它区"},"0,450000,451300":{451302:"兴宾区",451321:"忻城县",451322:"象州县",451323:"武宣县",451324:"金秀瑶族自治县",451381:"合山市",451382:"其它区"},"0,450000,451400":{451402:"江洲区",451421:"扶绥县",451422:"宁明县",451423:"龙州县",451424:"大新县",451425:"天等县",451481:"凭祥市",451482:"其它区"},"0,460000":{460100:"海口市",460200:"三亚市",469001:"五指山市",469002:"琼海市",469003:"儋州市",469005:"文昌市",469006:"万宁市",469007:"东方市",469025:"定安县",469026:"屯昌县",469027:"澄迈县",469028:"临高县",469030:"白沙黎族自治县",469031:"昌江黎族自治县",469033:"乐东黎族自治县",469034:"陵水黎族自治县",469035:"保亭黎族苗族自治县",469036:"琼中黎族苗族自治县",469037:"西沙群岛",469038:"南沙群岛",469039:"中沙群岛的岛礁及其海域"},"0,460000,460100":{460105:"秀英区",460106:"龙华区",460107:"琼山区",460108:"美兰区",460109:"其它区"},"0,460000,460200":{1033055:"三亚市"},"0,460000,469001":[],"0,460000,469002":[],"0,460000,469003":[],"0,460000,469005":[],"0,460000,469006":[],"0,460000,469007":[],"0,460000,469025":[],"0,460000,469026":[],"0,460000,469027":[],"0,460000,469028":[],"0,460000,469030":[],"0,460000,469031":[],"0,460000,469033":[],"0,460000,469034":[],"0,460000,469035":[],"0,460000,469036":[],"0,460000,469037":[],"0,460000,469038":[],"0,460000,469039":[],"0,500000":{500100:"重庆市"},"0,500000,500100":{500101:"万州区",500102:"涪陵区",500103:"渝中区",500104:"大渡口区",500105:"江北区",500106:"沙坪坝区",500107:"九龙坡区",500108:"南岸区",500109:"北碚区",500110:"万盛区",500111:"双桥区",500112:"渝北区",500113:"巴南区",500114:"黔江区",500115:"长寿区",500222:"綦江县",500223:"潼南县",500224:"铜梁县",500225:"大足县",500226:"荣昌县",500227:"璧山县",500228:"梁平县",500229:"城口县",500230:"丰都县",500231:"垫江县",500232:"武隆县",500233:"忠县",500234:"开县",500235:"云阳县",500236:"奉节县",500237:"巫山县",500238:"巫溪县",500240:"石柱土家族自治县",500241:"秀山土家族苗族自治县",500242:"酉阳土家族苗族自治县",500243:"彭水苗族土家族自治县",500381:"江津区",500382:"合川区",500383:"永川区",500384:"南川区",500385:"其它区"},"0,510000":{510100:"成都市",510300:"自贡市",510400:"攀枝花市",510500:"泸州市",510600:"德阳市",510700:"绵阳市",510800:"广元市",510900:"遂宁市",511000:"内江市",511100:"乐山市",511300:"南充市",511400:"眉山市",511500:"宜宾市",511600:"广安市",511700:"达州市",511800:"雅安市",511900:"巴中市",512000:"资阳市",513200:"阿坝藏族羌族自治州",513300:"甘孜藏族自治州",513400:"凉山彝族自治州"},"0,510000,510100":{510104:"锦江区",510105:"青羊区",510106:"金牛区",510107:"武侯区",510108:"成华区",510112:"龙泉驿区",510113:"青白江区",510114:"新都区",510115:"温江区",510121:"金堂县",510122:"双流县",510124:"郫县",510129:"大邑县",510131:"蒲江县",510132:"新津县",510181:"都江堰市",510182:"彭州市",510183:"邛崃市",510184:"崇州市",510185:"其它区"},"0,510000,510300":{510302:"自流井区",510303:"贡井区",510304:"大安区",510311:"沿滩区",510321:"荣县",510322:"富顺县",510323:"其它区"},"0,510000,510400":{510402:"东区",510403:"西区",510411:"仁和区",510421:"米易县",510422:"盐边县",510423:"其它区"},"0,510000,510500":{510502:"江阳区",510503:"纳溪区",510504:"龙马潭区",510521:"泸县",510522:"合江县",510524:"叙永县",510525:"古蔺县",510526:"其它区"},"0,510000,510600":{510603:"旌阳区",510623:"中江县",510626:"罗江县",510681:"广汉市",510682:"什邡市",510683:"绵竹市",510684:"其它区"},"0,510000,510700":{510703:"涪城区",510704:"游仙区",510722:"三台县",510723:"盐亭县",510724:"安县",510725:"梓潼县",510726:"北川羌族自治县",510727:"平武县",510751:"高新区",510781:"江油市",510782:"其它区"},"0,510000,510800":{510802:"利州区",510811:"元坝区",510812:"朝天区",510821:"旺苍县",510822:"青川县",510823:"剑阁县",510824:"苍溪县",510825:"其它区"},"0,510000,510900":{510903:"船山区",510904:"安居区",510921:"蓬溪县",510922:"射洪县",510923:"大英县",510924:"其它区"},"0,510000,511000":{511002:"市中区",511011:"东兴区",511024:"威远县",511025:"资中县",511028:"隆昌县",511029:"其它区"},"0,510000,511100":{511102:"市中区",511111:"沙湾区",511112:"五通桥区",511113:"金口河区",511123:"犍为县",511124:"井研县",511126:"夹江县",511129:"沐川县",511132:"峨边彝族自治县",511133:"马边彝族自治县",511181:"峨眉山市",511182:"其它区"},"0,510000,511300":{511302:"顺庆区",511303:"高坪区",511304:"嘉陵区",511321:"南部县",511322:"营山县",511323:"蓬安县",511324:"仪陇县",511325:"西充县",511381:"阆中市",511382:"其它区"},"0,510000,511400":{511402:"东坡区",511421:"仁寿县",511422:"彭山县",511423:"洪雅县",511424:"丹棱县",511425:"青神县",511426:"其它区"},"0,510000,511500":{511502:"翠屏区",511521:"宜宾县",511522:"南溪县",511523:"江安县",511524:"长宁县",511525:"高县",511526:"珙县",511527:"筠连县",511528:"兴文县",511529:"屏山县",511530:"其它区"},"0,510000,511600":{511602:"广安区",511621:"岳池县",511622:"武胜县",511623:"邻水县",511681:"华蓥市",511682:"市辖区",511683:"其它区"},"0,510000,511700":{511702:"通川区",511721:"达县",511722:"宣汉县",511723:"开江县",511724:"大竹县",511725:"渠县",511781:"万源市",511782:"其它区"},"0,510000,511800":{511802:"雨城区",511821:"名山县",511822:"荥经县",511823:"汉源县",511824:"石棉县",511825:"天全县",511826:"芦山县",511827:"宝兴县",511828:"其它区"},"0,510000,511900":{511902:"巴州区",511921:"通江县",511922:"南江县",511923:"平昌县",511924:"其它区"},"0,510000,512000":{512002:"雁江区",512021:"安岳县",512022:"乐至县",512081:"简阳市",512082:"其它区"},"0,510000,513200":{513221:"汶川县",513222:"理县",513223:"茂县",513224:"松潘县",513225:"九寨沟县",513226:"金川县",513227:"小金县",513228:"黑水县",513229:"马尔康县",513230:"壤塘县",513231:"阿坝县",513232:"若尔盖县",513233:"红原县",513234:"其它区"},"0,510000,513300":{513321:"康定县",513322:"泸定县",513323:"丹巴县",513324:"九龙县",513325:"雅江县",513326:"道孚县",513327:"炉霍县",513328:"甘孜县",513329:"新龙县",513330:"德格县",513331:"白玉县",513332:"石渠县",513333:"色达县",513334:"理塘县",513335:"巴塘县",513336:"乡城县",513337:"稻城县",513338:"得荣县",513339:"其它区"},"0,510000,513400":{513401:"西昌市",513422:"木里藏族自治县",513423:"盐源县",513424:"德昌县",513425:"会理县",513426:"会东县",513427:"宁南县",513428:"普格县",513429:"布拖县",513430:"金阳县",513431:"昭觉县",513432:"喜德县",513433:"冕宁县",513434:"越西县",513435:"甘洛县",513436:"美姑县",513437:"雷波县",513438:"其它区"},"0,520000":{520100:"贵阳市",520200:"六盘水市",520300:"遵义市",520400:"安顺市",522200:"铜仁地区",522300:"黔西南布依族苗族自治州",522400:"毕节地区",522600:"黔东南苗族侗族自治州",522700:"黔南布依族苗族自治州"},"0,520000,520100":{520102:"南明区",520103:"云岩区",520111:"花溪区",520112:"乌当区",520113:"白云区",520114:"小河区",520121:"开阳县",520122:"息烽县",520123:"修文县",520151:"金阳开发区",520181:"清镇市",520182:"其它区"},"0,520000,520200":{520201:"钟山区",520203:"六枝特区",520221:"水城县",520222:"盘县",520223:"其它区"},"0,520000,520300":{520302:"红花岗区",520303:"汇川区",520321:"遵义县",520322:"桐梓县",520323:"绥阳县",520324:"正安县",520325:"道真仡佬族苗族自治县",520326:"务川仡佬族苗族自治县",520327:"凤冈县",520328:"湄潭县",520329:"余庆县",520330:"习水县",520381:"赤水市",520382:"仁怀市",520383:"其它区"},"0,520000,520400":{520402:"西秀区",520421:"平坝县",520422:"普定县",520423:"镇宁布依族苗族自治县",520424:"关岭布依族苗族自治县",520425:"紫云苗族布依族自治县",520426:"其它区"},"0,520000,522200":{522201:"铜仁市",522222:"江口县",522223:"玉屏侗族自治县",522224:"石阡县",522225:"思南县",522226:"印江土家族苗族自治县",522227:"德江县",522228:"沿河土家族自治县",522229:"松桃苗族自治县",522230:"万山特区",522231:"其它区"},"0,520000,522300":{522301:"兴义市",522322:"兴仁县",522323:"普安县",522324:"晴隆县",522325:"贞丰县",522326:"望谟县",522327:"册亨县",522328:"安龙县",522329:"其它区"},"0,520000,522400":{522401:"毕节市",522422:"大方县",522423:"黔西县",522424:"金沙县",522425:"织金县",522426:"纳雍县",522427:"威宁彝族回族苗族自治县",522428:"赫章县",522429:"其它区"},"0,520000,522600":{522601:"凯里市",522622:"黄平县",522623:"施秉县",522624:"三穗县",522625:"镇远县",522626:"岑巩县",522627:"天柱县",522628:"锦屏县",522629:"剑河县",522630:"台江县",522631:"黎平县",522632:"榕江县",522633:"从江县",522634:"雷山县",522635:"麻江县",522636:"丹寨县",522637:"其它区"},"0,520000,522700":{522701:"都匀市",522702:"福泉市",522722:"荔波县",522723:"贵定县",522725:"瓮安县",522726:"独山县",522727:"平塘县",522728:"罗甸县",522729:"长顺县",522730:"龙里县",522731:"惠水县",522732:"三都水族自治县",522733:"其它区"},"0,530000":{530100:"昆明市",530300:"曲靖市",530400:"玉溪市",530500:"保山市",530600:"昭通市",530700:"丽江市",530800:"普洱市",530900:"临沧市",532300:"楚雄彝族自治州",532500:"红河哈尼族彝族自治州",532600:"文山壮族苗族自治州",532800:"西双版纳傣族自治州",532900:"大理白族自治州",533100:"德宏傣族景颇族自治州",533300:"怒江傈僳族自治州",533400:"迪庆藏族自治州"},"0,530000,530100":{530102:"五华区",530103:"盘龙区",530111:"官渡区",530112:"西山区",530113:"东川区",530121:"呈贡县",530122:"晋宁县",530124:"富民县",530125:"宜良县",530126:"石林彝族自治县",530127:"嵩明县",530128:"禄劝彝族苗族自治县",530129:"寻甸回族彝族自治县",530181:"安宁市",530182:"其它区"},"0,530000,530300":{530302:"麒麟区",530321:"马龙县",530322:"陆良县",530323:"师宗县",530324:"罗平县",530325:"富源县",530326:"会泽县",530328:"沾益县",530381:"宣威市",530382:"其它区"},"0,530000,530400":{530402:"红塔区",530421:"江川县",530422:"澄江县",530423:"通海县",530424:"华宁县",530425:"易门县",530426:"峨山彝族自治县",530427:"新平彝族傣族自治县",530428:"元江哈尼族彝族傣族自治县",530429:"其它区"},"0,530000,530500":{530502:"隆阳区",530521:"施甸县",530522:"腾冲县",530523:"龙陵县",530524:"昌宁县",530525:"其它区"},"0,530000,530600":{530602:"昭阳区",530621:"鲁甸县",530622:"巧家县",530623:"盐津县",530624:"大关县",530625:"永善县",530626:"绥江县",530627:"镇雄县",530628:"彝良县",530629:"威信县",530630:"水富县",530631:"其它区"},"0,530000,530700":{530702:"古城区",530721:"玉龙纳西族自治县",530722:"永胜县",530723:"华坪县",530724:"宁蒗彝族自治县",530725:"其它区"},"0,530000,530800":{530802:"思茅区",530821:"宁洱哈尼族彝族自治县",530822:"墨江哈尼族自治县",530823:"景东彝族自治县",530824:"景谷傣族彝族自治县",530825:"镇沅彝族哈尼族拉祜族自治县",530826:"江城哈尼族彝族自治县",530827:"孟连傣族拉祜族佤族自治县",530828:"澜沧拉祜族自治县",530829:"西盟佤族自治县",530830:"其它区"},"0,530000,530900":{530902:"临翔区",530921:"凤庆县",530922:"云县",530923:"永德县",530924:"镇康县",530925:"双江拉祜族佤族布朗族傣族自治县",530926:"耿马傣族佤族自治县",530927:"沧源佤族自治县",530928:"其它区"},"0,530000,532300":{532301:"楚雄市",532322:"双柏县",532323:"牟定县",532324:"南华县",532325:"姚安县",532326:"大姚县",532327:"永仁县",532328:"元谋县",532329:"武定县",532331:"禄丰县",532332:"其它区"},"0,530000,532500":{532501:"个旧市",532502:"开远市",532522:"蒙自县",532523:"屏边苗族自治县",532524:"建水县",532525:"石屏县",532526:"弥勒县",532527:"泸西县",532528:"元阳县",532529:"红河县",532530:"金平苗族瑶族傣族自治县",532531:"绿春县",532532:"河口瑶族自治县",532533:"其它区"},"0,530000,532600":{532621:"文山县",532622:"砚山县",532623:"西畴县",532624:"麻栗坡县",532625:"马关县",532626:"丘北县",532627:"广南县",532628:"富宁县",532629:"其它区"},"0,530000,532800":{532801:"景洪市",532822:"勐海县",532823:"勐腊县",532824:"其它区"},"0,530000,532900":{532901:"大理市",532922:"漾濞彝族自治县",532923:"祥云县",532924:"宾川县",532925:"弥渡县",532926:"南涧彝族自治县",532927:"巍山彝族回族自治县",532928:"永平县",532929:"云龙县",532930:"洱源县",532931:"剑川县",532932:"鹤庆县",532933:"其它区"},"0,530000,533100":{533102:"瑞丽市",533103:"潞西市",533122:"梁河县",533123:"盈江县",533124:"陇川县",533125:"其它区"},"0,530000,533300":{533321:"泸水县",533323:"福贡县",533324:"贡山独龙族怒族自治县",533325:"兰坪白族普米族自治县",533326:"其它区"},"0,530000,533400":{533421:"香格里拉县",533422:"德钦县",533423:"维西傈僳族自治县",533424:"其它区"},"0,540000":{540100:"拉萨市",542100:"昌都地区",542200:"山南地区",542300:"日喀则地区",542400:"那曲地区",542500:"阿里地区",542600:"林芝地区"},"0,540000,540100":{540102:"城关区",540121:"林周县",540122:"当雄县",540123:"尼木县",540124:"曲水县",540125:"堆龙德庆县",540126:"达孜县",540127:"墨竹工卡县",540128:"其它区"},"0,540000,542100":{542121:"昌都县",542122:"江达县",542123:"贡觉县",542124:"类乌齐县",542125:"丁青县",542126:"察雅县",542127:"八宿县",542128:"左贡县",542129:"芒康县",542132:"洛隆县",542133:"边坝县",542134:"其它区"},"0,540000,542200":{542221:"乃东县",542222:"扎囊县",542223:"贡嘎县",542224:"桑日县",542225:"琼结县",542226:"曲松县",542227:"措美县",542228:"洛扎县",542229:"加查县",542231:"隆子县",542232:"错那县",542233:"浪卡子县",542234:"其它区"},"0,540000,542300":{542301:"日喀则市",542322:"南木林县",542323:"江孜县",542324:"定日县",542325:"萨迦县",542326:"拉孜县",542327:"昂仁县",542328:"谢通门县",542329:"白朗县",542330:"仁布县",542331:"康马县",542332:"定结县",542333:"仲巴县",542334:"亚东县",542335:"吉隆县",542336:"聂拉木县",542337:"萨嘎县",542338:"岗巴县",542339:"其它区"},"0,540000,542400":{542421:"那曲县",542422:"嘉黎县",542423:"比如县",542424:"聂荣县",542425:"安多县",542426:"申扎县",542427:"索县",542428:"班戈县",542429:"巴青县",542430:"尼玛县",542431:"其它区"},"0,540000,542500":{542521:"普兰县",542522:"札达县",542523:"噶尔县",542524:"日土县",542525:"革吉县",542526:"改则县",542527:"措勤县",542528:"其它区"},"0,540000,542600":{542621:"林芝县",542622:"工布江达县",542623:"米林县",542624:"墨脱县",542625:"波密县",542626:"察隅县",542627:"朗县",542628:"其它区"},"0,610000":{610100:"西安市",610200:"铜川市",610300:"宝鸡市",610400:"咸阳市",610500:"渭南市",610600:"延安市",610700:"汉中市",610800:"榆林市",610900:"安康市",611000:"商洛市"},"0,610000,610100":{610102:"新城区",610103:"碑林区",610104:"莲湖区",610111:"灞桥区",610112:"未央区",610113:"雁塔区",610114:"阎良区",610115:"临潼区",610116:"长安区",610122:"蓝田县",610124:"周至县",610125:"户县",610126:"高陵县",610127:"其它区"},"0,610000,610200":{610202:"王益区",610203:"印台区",610204:"耀州区",610222:"宜君县",610223:"其它区"},"0,610000,610300":{610302:"渭滨区",610303:"金台区",610304:"陈仓区",610322:"凤翔县",610323:"岐山县",610324:"扶风县",610326:"眉县",610327:"陇县",610328:"千阳县",610329:"麟游县",610330:"凤县",610331:"太白县",610332:"其它区"},"0,610000,610400":{610402:"秦都区",610403:"杨陵区",610404:"渭城区",610422:"三原县",610423:"泾阳县",610424:"乾县",610425:"礼泉县",610426:"永寿县",610427:"彬县",610428:"长武县",610429:"旬邑县",610430:"淳化县",610431:"武功县",610481:"兴平市",610482:"其它区"},"0,610000,610500":{610502:"临渭区",610521:"华县",610522:"潼关县",610523:"大荔县",610524:"合阳县",610525:"澄城县",610526:"蒲城县",610527:"白水县",610528:"富平县",610581:"韩城市",610582:"华阴市",610583:"其它区"},"0,610000,610600":{610602:"宝塔区",610621:"延长县",610622:"延川县",610623:"子长县",610624:"安塞县",610625:"志丹县",610626:"吴起县",610627:"甘泉县",610628:"富县",610629:"洛川县",610630:"宜川县",610631:"黄龙县",610632:"黄陵县",610633:"其它区"},"0,610000,610700":{610702:"汉台区",610721:"南郑县",610722:"城固县",610723:"洋县",610724:"西乡县",610725:"勉县",610726:"宁强县",610727:"略阳县",610728:"镇巴县",610729:"留坝县",610730:"佛坪县",610731:"其它区"},"0,610000,610800":{610802:"榆阳区",610821:"神木县",610822:"府谷县",610823:"横山县",610824:"靖边县",610825:"定边县",610826:"绥德县",610827:"米脂县",610828:"佳县",610829:"吴堡县",610830:"清涧县",610831:"子洲县",610832:"其它区"},"0,610000,610900":{610902:"汉滨区",610921:"汉阴县",610922:"石泉县",610923:"宁陕县",610924:"紫阳县",610925:"岚皋县",610926:"平利县",610927:"镇坪县",610928:"旬阳县",610929:"白河县",610930:"其它区"},"0,610000,611000":{611002:"商州区",611021:"洛南县",611022:"丹凤县",611023:"商南县",611024:"山阳县",611025:"镇安县",611026:"柞水县",611027:"其它区"},"0,620000":{620100:"兰州市",620200:"嘉峪关市",620300:"金昌市",620400:"白银市",620500:"天水市",620600:"武威市",620700:"张掖市",620800:"平凉市",620900:"酒泉市",621000:"庆阳市",621100:"定西市",621200:"陇南市",622900:"临夏回族自治州",623000:"甘南藏族自治州"},"0,620000,620100":{620102:"城关区",620103:"七里河区",620104:"西固区",620105:"安宁区",620111:"红古区",620121:"永登县",620122:"皋兰县",620123:"榆中县",620124:"其它区"},"0,620000,620200":{1033056:"嘉峪关市"},"0,620000,620300":{620302:"金川区",620321:"永昌县",620322:"其它区"},"0,620000,620400":{620402:"白银区",620403:"平川区",620421:"靖远县",620422:"会宁县",620423:"景泰县",620424:"其它区"},"0,620000,620500":{620502:"秦州区",620503:"麦积区",620521:"清水县",620522:"秦安县",620523:"甘谷县",620524:"武山县",620525:"张家川回族自治县",620526:"其它区"},"0,620000,620600":{620602:"凉州区",620621:"民勤县",620622:"古浪县",620623:"天祝藏族自治县",620624:"其它区"},"0,620000,620700":{620702:"甘州区",620721:"肃南裕固族自治县",620722:"民乐县",620723:"临泽县",620724:"高台县",620725:"山丹县",620726:"其它区"},"0,620000,620800":{620802:"崆峒区",620821:"泾川县",620822:"灵台县",620823:"崇信县",620824:"华亭县",620825:"庄浪县",620826:"静宁县",620827:"其它区"},"0,620000,620900":{620902:"肃州区",620921:"金塔县",620922:"安西县",620923:"肃北蒙古族自治县",620924:"阿克塞哈萨克族自治县",620981:"玉门市",620982:"敦煌市",620983:"其它区"},"0,620000,621000":{621002:"西峰区",621021:"庆城县",621022:"环县",621023:"华池县",621024:"合水县",621025:"正宁县",621026:"宁县",621027:"镇原县",621028:"其它区"},"0,620000,621100":{621102:"安定区",621121:"通渭县",621122:"陇西县",621123:"渭源县",621124:"临洮县",621125:"漳县",621126:"岷县",621127:"其它区"},"0,620000,621200":{621202:"武都区",621221:"成县",621222:"文县",621223:"宕昌县",621224:"康县",621225:"西和县",621226:"礼县",621227:"徽县",621228:"两当县",621229:"其它区"},"0,620000,622900":{622901:"临夏市",622921:"临夏县",622922:"康乐县",622923:"永靖县",622924:"广河县",622925:"和政县",622926:"东乡族自治县",622927:"积石山保安族东乡族撒拉族自治县",622928:"其它区"},"0,620000,623000":{623001:"合作市",623021:"临潭县",623022:"卓尼县",623023:"舟曲县",623024:"迭部县",623025:"玛曲县",623026:"碌曲县",623027:"夏河县",623028:"其它区"},"0,630000":{630100:"西宁市",632100:"海东地区",632200:"海北藏族自治州",632300:"黄南藏族自治州",632500:"海南藏族自治州",632600:"果洛藏族自治州",632700:"玉树藏族自治州",632800:"海西蒙古族藏族自治州"},"0,630000,630100":{630102:"城东区",630103:"城中区",630104:"城西区",630105:"城北区",630121:"大通回族土族自治县",630122:"湟中县",630123:"湟源县",630124:"其它区"},"0,630000,632100":{632121:"平安县",632122:"民和回族土族自治县",632123:"乐都县",632126:"互助土族自治县",632127:"化隆回族自治县",632128:"循化撒拉族自治县",632129:"其它区"},"0,630000,632200":{632221:"门源回族自治县",632222:"祁连县",632223:"海晏县",632224:"刚察县",632225:"其它区"},"0,630000,632300":{632321:"同仁县",632322:"尖扎县",632323:"泽库县",632324:"河南蒙古族自治县",632325:"其它区"},"0,630000,632500":{632521:"共和县",632522:"同德县",632523:"贵德县",632524:"兴海县",632525:"贵南县",632526:"其它区"},"0,630000,632600":{632621:"玛沁县",632622:"班玛县",632623:"甘德县",632624:"达日县",632625:"久治县",632626:"玛多县",632627:"其它区"},"0,630000,632700":{632721:"玉树县",632722:"杂多县",632723:"称多县",632724:"治多县",632725:"囊谦县",632726:"曲麻莱县",632727:"其它区"},"0,630000,632800":{632801:"格尔木市",632802:"德令哈市",632821:"乌兰县",632822:"都兰县",632823:"天峻县",632824:"其它区"},"0,640000":{640100:"银川市",640200:"石嘴山市",640300:"吴忠市",640400:"固原市",640500:"中卫市"},"0,640000,640100":{640104:"兴庆区",640105:"西夏区",640106:"金凤区",640121:"永宁县",640122:"贺兰县",640181:"灵武市",640182:"其它区"},"0,640000,640200":{640202:"大武口区",640205:"惠农区",640221:"平罗县",640222:"其它区"},"0,640000,640300":{640302:"利通区",640303:"红寺堡区",640323:"盐池县",640324:"同心县",640381:"青铜峡市",640382:"其它区"},"0,640000,640400":{640402:"原州区",640422:"西吉县",640423:"隆德县",640424:"泾源县",640425:"彭阳县",640426:"其它区"},"0,640000,640500":{640502:"沙坡头区",640521:"中宁县",640522:"海原县",640523:"其它区"},"0,650000":{650100:"乌鲁木齐市",650200:"克拉玛依市",652100:"吐鲁番地区",652200:"哈密地区",652300:"昌吉回族自治州",652700:"博尔塔拉蒙古自治州",652800:"巴音郭楞蒙古自治州",652900:"阿克苏地区",653000:"克孜勒苏柯尔克孜自治州",653100:"喀什地区",653200:"和田地区",654000:"伊犁哈萨克自治州",654200:"塔城地区",654300:"阿勒泰地区",659001:"石河子市",659002:"阿拉尔市",659003:"图木舒克市",659004:"五家渠市"},"0,650000,650100":{650102:"天山区",650103:"沙依巴克区",650104:"新市区",650105:"水磨沟区",650106:"头屯河区",650107:"达坂城区",650108:"东山区",650109:"米东区",650121:"乌鲁木齐县",650122:"其它区"},"0,650000,650200":{650202:"独山子区",650203:"克拉玛依区",650204:"白碱滩区",650205:"乌尔禾区",650206:"其它区"},"0,650000,652100":{652101:"吐鲁番市",652122:"鄯善县",652123:"托克逊县",652124:"其它区"},"0,650000,652200":{652201:"哈密市",652222:"巴里坤哈萨克自治县",652223:"伊吾县",652224:"其它区"},"0,650000,652300":{652301:"昌吉市",652302:"阜康市",652303:"米泉市",652323:"呼图壁县",652324:"玛纳斯县",652325:"奇台县",652327:"吉木萨尔县",652328:"木垒哈萨克自治县",652329:"其它区"},"0,650000,652700":{652701:"博乐市",652722:"精河县",652723:"温泉县",652724:"其它区"},"0,650000,652800":{652801:"库尔勒市",652822:"轮台县",652823:"尉犁县",652824:"若羌县",652825:"且末县",652826:"焉耆回族自治县",652827:"和静县",652828:"和硕县",652829:"博湖县",652830:"其它区"},"0,650000,652900":{652901:"阿克苏市",652922:"温宿县",652923:"库车县",652924:"沙雅县",652925:"新和县",652926:"拜城县",652927:"乌什县",652928:"阿瓦提县",652929:"柯坪县",652930:"其它区"},"0,650000,653000":{653001:"阿图什市",653022:"阿克陶县",653023:"阿合奇县",653024:"乌恰县",653025:"其它区"},"0,650000,653100":{653101:"喀什市",653121:"疏附县",653122:"疏勒县",653123:"英吉沙县",653124:"泽普县",653125:"莎车县",653126:"叶城县",653127:"麦盖提县",653128:"岳普湖县",653129:"伽师县",653130:"巴楚县",653131:"塔什库尔干塔吉克自治县",653132:"其它区"},"0,650000,653200":{653201:"和田市",653221:"和田县",653222:"墨玉县",653223:"皮山县",653224:"洛浦县",653225:"策勒县",653226:"于田县",653227:"民丰县",653228:"其它区"},"0,650000,654000":{654002:"伊宁市",654003:"奎屯市",654021:"伊宁县",654022:"察布查尔锡伯自治县",654023:"霍城县",654024:"巩留县",654025:"新源县",654026:"昭苏县",654027:"特克斯县",654028:"尼勒克县",654029:"其它区"},"0,650000,654200":{654201:"塔城市",654202:"乌苏市",654221:"额敏县",654223:"沙湾县",654224:"托里县",654225:"裕民县",654226:"和布克赛尔蒙古自治县",654227:"其它区"},"0,650000,654300":{654301:"阿勒泰市",654321:"布尔津县",654322:"富蕴县",654323:"福海县",654324:"哈巴河县",654325:"青河县",654326:"吉木乃县",654327:"其它区"},"0,650000,659001":[],"0,650000,659002":[],"0,650000,659003":[],"0,650000,659004":[],"0,710000":{710100:"台北市",710200:"高雄市",710300:"台南市",710400:"台中市",710500:"金门县",710600:"南投县",710700:"基隆市",710800:"新竹市",710900:"嘉义市",711100:"新北市",711200:"宜兰县",711300:"新竹县",711400:"桃园县",711500:"苗栗县",711700:"彰化县",711900:"嘉义县",712100:"云林县",712400:"屏东县",712500:"台东县",712600:"花莲县",712700:"澎湖县"},"0,710000,710100":{710101:"中正区",710102:"大同区",710103:"中山区",710104:"松山区",710105:"大安区",710106:"万华区",710107:"信义区",710108:"士林区",710109:"北投区",710110:"内湖区",710111:"南港区",710112:"文山区",710113:"其它区"},"0,710000,710200":{710201:"新兴区",710202:"前金区",710203:"芩雅区",710204:"盐埕区",710205:"鼓山区",710206:"旗津区",710207:"前镇区",710208:"三民区",710209:"左营区",710210:"楠梓区",710211:"小港区",710212:"其它区"},"0,710000,710300":{710301:"中西区",710302:"东区",710303:"南区",710304:"北区",710305:"安平区",710306:"安南区",710307:"其它区"},"0,710000,710400":{710401:"中区",710402:"东区",710403:"南区",710404:"西区",710405:"北区",710406:"北屯区",710407:"西屯区",710408:"南屯区",710409:"其它区"},"0,710000,710500":{1033057:"金门县"},"0,710000,710600":{1033058:"南投县"},"0,710000,710700":{710701:"仁爱区",710702:"信义区",710703:"中正区",710704:"中山区",710705:"安乐区",710706:"暖暖区",710707:"七堵区",710708:"其它区"},"0,710000,710800":{710801:"东区",710802:"北区",710803:"香山区",710804:"其它区"},"0,710000,710900":{710901:"东区",710902:"西区",710903:"其它区"},"0,710000,711100":[],"0,710000,711200":[],"0,710000,711300":[],"0,710000,711400":[],"0,710000,711500":[],"0,710000,711700":[],"0,710000,711900":[],"0,710000,712100":[],"0,710000,712400":[],"0,710000,712500":[],"0,710000,712600":[],"0,710000,712700":[],"0,810000":{810100:"香港岛",810200:"九龙",810300:"新界"},"0,810000,810100":{810101:"中西区",810102:"湾仔",810103:"东区",810104:"南区"},"0,810000,810200":{810201:"九龙城区",810202:"油尖旺区",810203:"深水埗区",810204:"黄大仙区",810205:"观塘区"},"0,810000,810300":{810301:"北区",810302:"大埔区",810303:"沙田区",810304:"西贡区",810305:"元朗区",810306:"屯门区",810307:"荃湾区",810308:"葵青区",810309:"离岛区"},"0,820000":{820100:"澳门半岛",820200:"离岛"},"0,820000,820100":{1033059:"澳门半岛"},"0,820000,820200":{1033060:"离岛"},"0,990000":{990100:"海外",1032704:"亚洲",1032705:"非洲",1032706:"欧洲",1032707:"美洲",1032708:"大洋洲"},"0,990000,990100":{1032940:"其他"},"0,990000,1032704":{1032709:"阿富汗",1032710:"巴林",1032711:"孟加拉国",1032712:"不丹",1032713:"文莱",1032714:"缅甸",1032715:"塞浦路斯",1032716:"印度",1032717:"印度尼西亚",1032718:"伊朗",1032719:"伊拉克",1032720:"日本",1032721:"约旦",1032722:"朝鲜",1032723:"科威特",1032724:"老挝",1032725:"马尔代夫",1032726:"黎巴嫩",1032727:"马来西亚",1032728:"以色列",1032729:"蒙古",1032730:"尼泊尔",1032731:"阿曼",1032732:"巴基斯坦",1032733:"巴勒斯坦",1032734:"菲律宾",1032735:"沙特阿拉伯",1032736:"新加坡",1032737:"斯里兰卡",1032738:"叙利亚",1032739:"泰国",1032740:"柬埔寨",1032741:"土耳其",1032742:"阿联酋",1032743:"越南",1032744:"也门",1032745:"韩国"},"0,990000,1032705":{1032746:"阿尔及利亚",1032747:"安哥拉",1032748:"厄里特里亚",1032749:"法罗群鸟",1032750:"加那利群岛 (西)(拉斯帕尔马斯)",1032751:"贝宁",1032752:"博茨瓦纳",1032753:"布基纳法索",1032754:"布隆迪",1032755:"喀麦隆",1032756:"加那利群岛 (西)(圣克鲁斯)",1032757:"佛得角",1032758:"中非",1032759:"乍得",1032760:"科摩罗",1032761:"刚果",1032762:"吉布提",1032763:"埃及",1032764:"埃塞俄比亚",1032765:"赤道几内亚",1032766:"加蓬",1032767:"冈比亚",1032768:"加纳",1032769:"几内亚",1032770:"南非",1032771:"几内亚比绍",1032772:"科特迪瓦",1032773:"肯尼亚",1032774:"莱索托",1032775:"利比里亚",1032776:"利比亚",1032777:"马达加斯加",1032778:"马拉维",1032779:"马里",1032780:"毛里塔尼亚",1032781:"毛里求斯",1032782:"摩洛哥",1032783:"莫桑比克",1032784:"尼日尔",1032785:"尼日利亚",1032786:"留尼旺岛",1032787:"卢旺达",1032788:"塞内加尔",1032789:"塞舌尔",1032790:"塞拉利昂",1032791:"索马里",1032792:"苏丹",1032793:"斯威士兰",1032794:"坦桑尼亚",1032795:"圣赤勒拿",1032796:"多哥",1032797:"突尼斯",1032798:"乌干达",1032799:"扎伊尔",1032800:"赞比亚",1032801:"津巴布韦",1032802:"纳米比亚",1032803:"迪戈加西亚",1032804:"桑给巴尔",1032805:"马约特岛",1032806:"圣多美和普林西比"},"0,990000,1032706":{1032807:"阿尔巴尼亚",1032808:"安道尔",1032809:"奥地利",1032810:"比利时",1032811:"保加利亚",1032812:"捷克",1032813:"丹麦",1032814:"芬兰",1032815:"法国",1032816:"德国",1032817:"直布罗陀 (英)",1032818:"希腊",1032819:"匈牙利",1032820:"冰岛",1032821:"爱尔兰",1032822:"意大利",1032823:"列支敦士登",1032824:"斯洛伐克",1032825:"卢森堡",1032826:"马耳他",1032827:"摩纳哥",1032828:"荷兰",1032829:"挪威",1032830:"波兰",1032831:"葡萄牙",1032832:"马其顿",1032833:"罗马尼亚",1032834:"南斯拉夫",1032835:"圣马力诺",1032836:"西班牙",1032837:"瑞典",1032838:"瑞士",1032839:"英国",1032840:"科罗地亚",1032841:"斯洛文尼亚",1032842:"梵蒂冈",1032843:"波斯尼亚和塞哥维那",1032844:"俄罗斯联邦",1032845:"亚美尼亚共和国",1032846:"白俄罗斯共和国",1032847:"格鲁吉亚共和国",1032848:"哈萨克斯坦共和国",1032849:"吉尔吉斯坦共和国",1032850:"乌兹别克斯坦共和国",1032851:"塔吉克斯坦共和国",1032852:"土库曼斯坦共和国",1032853:"乌克兰",1032854:"立陶宛",1032855:"拉脱维亚",1032856:"爱沙尼亚",1032857:"摩尔多瓦",1032858:"阿塞拜疆"},"0,990000,1032707":{1032859:"安圭拉岛",1032860:"安提瓜和巴布达",1032861:"阿根廷",1032862:"阿鲁巴岛",1032863:"阿森松",1032864:"巴哈马",1032865:"巴巴多斯",1032866:"伯利兹",1032867:"百慕大群岛",1032868:"玻利维亚",1032869:"巴西",1032870:"加拿大",1032871:"开曼群岛",1032872:"智利",1032873:"哥伦比亚",1032874:"多米尼加联邦",1032875:"哥斯达黎加",1032876:"古巴",1032877:"多米尼加共和国",1032878:"厄瓜多尔",1032879:"萨尔瓦多",1032880:"法属圭亚那",1032881:"格林纳达",1032882:"危地马拉",1032883:"圭亚那",1032884:"海地",1032885:"洪都拉斯",1032886:"牙买加",1032887:"马提尼克 (法)",1032888:"墨西哥",1032889:"蒙特塞拉特岛",1032890:"荷属安的列斯群岛",1032891:"尼加拉瓜",1032892:"巴拿马",1032893:"巴拉圭",1032894:"秘鲁",1032895:"波多黎哥",1032896:"圣皮埃尔岛密克隆岛 (法)",1032897:"圣克里斯托弗和尼维斯",1032898:"圣卢西亚",1032899:"福克兰群岛",1032900:"维尔京群岛 (英)",1032901:"圣文森特岛 (英)",1032902:"维尔京群岛 (美)",1032903:"苏里南",1032904:"特立尼达和多巴哥",1032905:"乌拉圭",1032906:"美国",1032907:"委内瑞拉",1032908:"格陵兰岛",1032909:"特克斯和凯科斯群岛",1032910:"瓜多罗普"},"0,990000,1032708":{1032911:"澳大利亚",1032912:"科克群岛",1032913:"斐济",1032914:"法属波里尼西亚、塔希提",1032915:"瓦努阿图",1032916:"关岛",1032917:"基里巴斯",1032918:"马里亚纳群岛",1032919:"中途岛",1032920:"瑙鲁",1032921:"新咯里多尼亚群岛",1032922:"新西兰",1032923:"巴布亚新几内亚",1032924:"东萨摩亚",1032925:"西萨摩亚",1032926:"所罗门群岛",1032927:"汤加",1032928:"对诞岛",1032929:"威克岛",1032930:"科科斯岛",1032931:"夏威夷",1032932:"诺福克岛",1032933:"帕劳",1032934:"纽埃岛",1032935:"图瓦卢",1032936:"托克鲁",1032937:"密克罗尼西亚",1032938:"马绍尔群岛",1032939:"瓦里斯加富士那群岛"}}),angular.module("ngTicket").controller("vipCtrl",["$scope","$rootScope","$state","vipCardManageServer","$timeout",function(e,t,a,i,n){t.vipType=-1;
var s=function(a){return t.vipType>-1?void(a&&a()):void i.GetMemberTemplate({UId:t.accountBaseInfo.bid,AId:t.accountBaseInfo.aid}).then(function(i){i&&i.data?(t.vipType=t.accountBaseInfo&&t.accountBaseInfo.account_type.indexOf("认证")>-1?i.data.IsSyncWX?3:2:1,e.entity=i.data):t.vipType=0,a&&a()},function(){t.vipType=0,a&&a()})};t.$on("$stateChangeStart",function(e,i){return i.name.indexOf("app.vip")<0||"app.vip.card.manage"===i.name||"app.vip.card.create"===i.name?t.parentLoading=!1:(t.parentLoading=!0,void s(function(){return t.vipType>0||"app.vip.card.manage"===i.name||"app.vip.card.create"===i.name?t.parentLoading=!1:void n(function(){t.parentLoading=!1,a.go("app.vip.card.manage")},500)}))}),t.$watch("accountBaseInfo",function(e){e&&s()}),e.$on("$destroy",function(){t.vipType=-1})}]).filter("wechatImg",function(){return function(e,t){return e?e.substr(0,e.lastIndexOf("/"))+"/"+t:""}}),angular.module("ngTicket").factory("userServer",["$httpApi","$config","$dialogs","$tableids",function(e,t,a,i){return{add:function(a){return e.post(t.api3.user.add,a)},detail:function(a){return e.get(t.api3.user.detail,{id:a})},merchant:function(a){return e.get(t.api3.user.merchant,{uid:a})},agent:function(a){return e.post(t.api3.user.agent,{uid:a})},list:function(a){return e.get(t.api3.user.list,{role:a,limit:1e4})},users:function(){return e.get(t.api3.user.users,{limit:1e4})},del:function(a){return e.post(t.api3.user.del,{id:i(a)})},statinfo:function(a){return e.post(t.api3.user.statinfo,{uid:a})},alt:function(a){return e.post(t.api3.user.alt,a)},changepwd:function(a){return e.post(t.api3.user.changepwd,a)},rolelist:function(){return e.get(t.api3.user.rolelist,{})},addUserDialog:function(){return a.create("/app/user/user.add.model.html","addUserDialogCtrl")},checkPhoneDialog:function(e){return a.create("/app/user/check.phone.model.html","checkPhoneDialogCtrl",e)},getCode:function(a){return e.post(t.api3.user.getCode,a)},binding:function(a){return e.post(t.api3.user.binding,a)},changePasswordDialog:function(e){return a.create("/app/user/user.password.model.html","changePassworDialogCtrl",e)},edCustomerGroupDialog:function(e){return a.create("/app/user/customergroups.ed.model.html","edCustomergroupsDialogCtrl",e)},addGroup:function(a){return e.post(t.api3.ticket.usergroupadd,a)},editGroup:function(a){return e.post(t.api3.ticket.usergroupadd,a)},delGroup:function(a){return e.post(t.api3.ticket.usergroupdel,{id:a.id})},classLists:function(){return e.get(t.api3.ticket.userClasselists,{limit:1e4})}}}]),angular.module("ngTicket").controller("userCtrl",["$scope","$toaster","$config","$Popbox","tableHelp","userServer","$locale","$dialogs",function(e,t,a,i,n,s,o,l){var r=n(e,{sorting:{addtime:"desc"}});e.roleType=[{title:"全部用户",value:""},{title:"客服人员",value:"2"},{title:"管理员",value:"3"}],e.tableParams=r.tableParams(a.api3.user.list,function(){var t={},a=e.tableParams.filter().roleType;String.IsNullOrEmpty(a)||(t.role=a);var i=e.tableParams.filter().keyword;return String.IsNullOrEmpty(i)||(t.keyword=i),t}),e.remove=function(a){var i=function(){s.del(a).then(function(){t.success(o.FORMTIPS.removeSuccess),e.tableParams.reload()},function(){t.info(o.FORMTIPS.removeError)})};if(angular.isArray(a)){var n=l.confirm("确定删除已勾选的用户？");n.result.then(function(){i()})}else i()},e.addUser=function(){s.addUserDialog().result.then(function(){e.tableParams.reload()})},e.changePassword=function(e){s.changePasswordDialog({userId:e}).result.then(function(){})},e.loadStatInfo=function(t,a){i({target:angular.element(t.target),templateUrl:"/app/user/statinfo.popbox.html",controller:"statinfoCtrl",scope:e.$new(),appendToBody:!0,resolve:{statInfo:function(){return{id:a.id}}},placement:"right"}).toggle()}}]).controller("addUserDialogCtrl",["$scope","$modalInstance","data","userServer","$toaster","$locale",function(e,t,a,i,n,s){e.cancel=function(){t.dismiss("Canceled")},e.roleList=3==e.locals.userData.role?[{name:"客服人员",id:"2"},{name:"管理员",id:"3"}]:[{name:"客服人员",id:"2"}],e.entity={nickname:null,selected_role:e.roleList[0]},e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.saveloading=!0,String.IsNullOrEmpty(e.entity.nickname)&&(e.entity.nickname=e.entity.email.split("@")[0]),e.entity.role=e.entity.selected_role.id,i.add(e.entity).then(function(){n.success(s.USER.addSuccess)})["finally"](function(){e.saveloading=!1,t.close(!0)})})}}}]).controller("statinfoCtrl",["$scope","$q","$timeout","userServer","statInfo","Restangular","$popboxInstance","$toaster",function(e,t,a,i,n){var s=function(e){var a=t.defer();return i.statinfo(e).then(function(e){return a.resolve(e.data)},function(){return a.reject({})}),a.promise};e.statinfoLoading=!0,s(n.id).then(function(t){e.entity=t,e.statinfoLoading=!1},function(t){e.entity=t,e.statinfoLoading=!1})}]).controller("customergroupsCtrl",["$scope","$stateParams","$toaster","$config","$Popbox","tableHelp","userServer","$locale","$dialogs",function(e,t,a,i,n,s,o,l){var r=s(e,{});e.tableParams=r.tableParams(i.api3.ticket.usergroup,function(){var e={"class":1};return e}),e.remove=function(t){var i=function(){o.delGroup(t).then(function(){a.success(l.FORMTIPS.removeSuccess),e.tableParams.reload()},function(){a.info(l.FORMTIPS.removeError)})};i()},e.edCustomerGroup=function(t){o.edCustomerGroupDialog(t).result.then(function(){e.tableParams.reload()})}}]).controller("edCustomergroupsDialogCtrl",["$scope","$modalInstance","data","userServer","$toaster","$locale",function(e,t,a,i,n,s){e.cancel=function(){t.dismiss("Canceled")},e.entity={selectClasses:[]},e.entity=angular.extend({},e.entity,a),e.pageLoading=!0,i.classLists().then(function(t){if(e.ticketClassesList=t.data.list,a){var i=a["class"].map(function(e){return e.id});angular.forEach(e.ticketClassesList,function(t){i.indexOf(t.id)>-1&&e.entity.selectClasses.push(t)})}e.pageLoading=!1},function(){e.ticketClassesList=[]}),e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.saveloading=!0,e.entity.ids=e.entity.selectClasses.map(function(e){return e.id}).join(","),e.entity.id?i.editGroup(e.entity).then(function(){n.success(s.FORMTIPS.saveSuccess),t.close(!0)})["finally"](function(){e.saveloading=!1}):i.addGroup(e.entity).then(function(){n.success(s.FORMTIPS.saveSuccess),t.close(!0)})["finally"](function(){e.saveloading=!1})})}}}]).controller("changePassworDialogCtrl",["$scope","$toaster","$locale","userServer","data","$modalInstance",function(e,t,a,i,n,s){e.cancel=function(){s.dismiss("Canceled")},e.entity={id:n.userId},e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.saveloading=!0,i.changepwd(e.entity).then(function(){t.success(a.FORMTIPS.modifySuccess)})["finally"](function(){e.saveloading=!1,s.close(!0)})})}}}]),angular.module("ngTicket").factory("messagesPackageServer",["$httpApi","$config","$dialogs","$tableids",function(e,t,a){return{add:function(a){return e.post(t.api3.user.add,a)},topPayDialog:function(e){return a.create("/app/messages/messages.pay.model.html","topPayDialogCtrl",e)},payConfirmDialog:function(e){return a.create("/app/messages/messages.pay.confirm.model.html","payConfirmDialogCtrl",e)}}}]),angular.module("ngTicket").controller("messagePackageCtrl",["$scope","$toaster","$config","$Popbox","messagesPackageServer","$locale","$dialogs",function(e){e.selectTabStatus=1,e.selectTable=function(t){e.selectTabStatus=t},e.loadMessageNumber=function(){e.isShowTips=!0},e.closeTips=function(){e.isShowTips=!1},e.loadMessageNumber()}]).controller("messagePackageIndexCtrl",["$scope","$toaster","$config","$Popbox","messagesPackageServer","$locale","$dialogs",function(){}]).controller("messagePackageListCtrl",["$scope","$toaster","$config","$Popbox","tableHelp","messagesPackageServer","$locale","$dialogs",function(e,t,a,i,n){e.messages_type=[{value:"1",title:"国内短信"},{value:"2",title:"国际短信"}];var s=n(e,{sorting:{addtime:"desc"},noParams:!0,porxy:"apiUrlPrefixSMS"});e.tableParams=s.tableParams(a.apiSMS.list,function(){var t={},a=e.tableParams.filter().type;return String.IsNullOrEmpty(a)||(t.type=a),t}),e.tableParams.filter().type="1"}]).controller("messagePackageDetailCtrl",["$scope","$toaster","$config","$Popbox","tableHelp","messagesPackageServer","$locale","$dialogs","$window",function(e,t,a,i,n,s,o,l,r){var d=n(e,{sorting:{addtime:"desc"},noParams:!0,porxy:"apiUrlPrefixSMS"});e.tableParamsDetail=d.tableParams(a.apiSMS.list,function(){var e={};return e}),e.cancel=function(){r.history.go(-2)}}]).controller("messagePackagePayCtrl",["$scope","$toaster","$config","$Popbox","tableHelp","messagesPackageServer","$locale","$dialogs","$window",function(e,t,a,i,n,s,o,l,r){var d=n(e,{sorting:{addtime:"desc"},noParams:!0,porxy:"apiUrlPrefixSMS"});e.tableParamsPay=d.tableParams(a.apiSMS.list,function(){var e={};return e}),e.cancel=function(){r.history.go(-2)},e.toPay=function(t){s.topPayDialog(t).result.then(function(t){t&&s.payConfirmDialog().result.then(function(t){t&&(e.tableParamsPay.reload(),e.$parent.loadMessageNumber())})})}}]).controller("topPayDialogCtrl",["$scope","$modalInstance","data","$toaster","$locale","ipCookie","messagesPackageServer",function(e,t){e.cancel=function(){t.dismiss("Canceled")},e.payLink=function(){t.close(!0)}}]).controller("payConfirmDialogCtrl",["$scope","$modalInstance","data","$toaster","$locale","ipCookie",function(e,t){e.cancel=function(){t.dismiss("Canceled")},e.successpay=function(){t.close(!0)}}]),angular.module("ngTicket").controller("iframeCtrl",["$scope","$timeout","$q","$stateParams","$sce",function(e,t,a,i,n){e.pageLoadingIframe=!0,e.offseturl=n.trustAsResourceUrl("notices"==i.url?e.$parent.navObj[i.url]+"?aid="+i.params+"&noticeid="+i.subparams:e.$parent.navObj[i.url]&&e.$parent.navObj[i.url].indexOf("?")>-1?e.$parent.navObj[i.url].indexOf("?aid=")>-1?e.$parent.navObj[i.url]:e.$parent.navObj[i.url]+"&aid="+i.params:e.$parent.navObj[i.url]+"?aid="+i.params),e.pageLoadingIframe=!1}]),angular.module("ngTicket").controller("dashboardCtrl",["$scope","$timeout","$q",function(e){e.mycount={myunsolving:0,mysolveing:0,mygroupsolveing:0,mygroupnoassignee:0},e.swicthStudyType=1,e.swicthStudy=function(t){e.swicthStudyType=t},e.switchCampaignType=1,e.switchCampaign=function(t){e.switchCampaignType=t}}]),angular.module("ngTicket").directive("uiNav",["$timeout",function(){return{restrict:"AC",link:function(e,t){var a,i=$(window),n=768,s=$(".app-aside"),o=".dropdown-backdrop";t.on("click","a",function(e){a&&a.trigger("mouseleave.nav");var t=$(this);t.parent().siblings(".active").toggleClass("active"),t.next().is("ul")&&t.parent().toggleClass("active"),""==t.attr("iframe-reload")&&t.parent().addClass("active"),t.hasClass("_blank")||e.preventDefault(),t.next().is("ul")||i.width()<n&&$(".app-aside").removeClass("show off-screen")}),t.on("mouseenter","a",function(e){if(a&&a.trigger("mouseleave.nav"),$("> .nav",s).remove(),!(!$(".app-aside-fixed.app-aside-folded").length||i.width()<n||$(".app-aside-dock").length)){var t,l=$(e.target),r=$(window).height(),d=50,c=150;!l.is("a")&&(l=l.closest("a")),l.next().is("ul")&&(a=l.next(),l.parent().addClass("active"),t=l.parent().position().top+d,a.css("top",t),t+a.height()>r&&a.css("bottom",0),t+c>r&&a.css("bottom",r-t-d).css("top","auto"),a.appendTo(s),a.on("mouseleave.nav",function(){$(o).remove(),a.appendTo(l.parent()),a.off("mouseleave.nav").css("top","auto").css("bottom","auto"),l.parent().removeClass("active")}),$(".smart").length&&$('<div class="dropdown-backdrop"/>').insertAfter(".app-aside").on("click",function(e){e&&e.trigger("mouseleave.nav")}))}}),s.on("mouseleave",function(){a&&a.trigger("mouseleave.nav"),$("> .nav",s).remove()})}}}]).directive("iframeReload",["$rootScope","$state",function(){return{restrict:"AC",link:function(e,t){t.on("click",function(){t.closest("li").hasClass("active")&&($("#mainFrame").attr("src",$("#mainFrame").attr("src")),t.closest("li").addClass("active"))})}}}]),angular.module("ngTicket").factory("blocksServer",["$httpApi","$config","$dialogs","$tableids",function(e,t,a){return{navlist:function(a){return e.get(t.api3.weimob.navlist,a)},isupdatepwd:function(a){return e.get(t.api3.weimob.isupdatepwd,a)},getBaseInfo:function(a){return e.get(t.api3.weimob.getBaseInfo,a)},feedback:function(a){return e.post(t.api3.weimob.feedback,a)},changeCode:function(a){return e.get(t.api3.weimob.changeCode,a)},updatetipsDialog:function(){return a.create("/app/blocks/blocks.pwdtips.model.html","updatetipsDialogCtrl",{})},feedbackContentDialog:function(){return a.create("/app/blocks/blocks.feedback.model.html","feedbackDialogCtrl",{})}}}]),angular.module("ngTicket").controller("blocksCtrl",["$scope","$toaster","$config","$locale","authService","userServer","$state","blocksServer","$rootScope","appcenterServer","ipCookie",function(e,t,a,i,n,s,o,l,r){e.addUser=function(){s.addUserDialog().result.then(function(){})},e.domainprefix=window.env.prefix,e.logout=function(){n.logout()},e.changePassword=function(e){s.changePasswordDialog({userId:e}).result.then(function(){})},e.setAid=function(e,t){angular.forEach(e,function(e){e.angular&&-1==e.url.indexOf("({")&&(e.url+="({aid:"+t+"})")})},e.currentUrl=o.params.url,e.navObj=[],e.loadNavloading=!1,e.menuShow=0,e.loadMenuInit=function(t,a,i){e.menuShow=0,i||(e.headerMenuShow=2),l.navlist({bid:e.businessBaseInfo.bid,aid:a}).then(function(t){e.menuShow=2,e.navlist=t.data,e.navlist.push(window.hideMenu),e.navlist.forEach(function(t){angular.isDefined(t.item)&&((window.env.development||window.env.localhost)&&"基础设置"===t.name&&t.item.splice(4,0,{icon:"wm-liuyan",id:"messagespackage",name:"短信包",url:"app.messages.list({aid:"+a+",type:1})",angular:"1",isself:1}),t.item.forEach(function(t){(void 0==t.url||""==t.url)&&t.child.forEach(function(){}),t.url?e.navObj[t.id]=t.url:t.child.forEach(function(a){if("1"==a.angular){var i=a.url;if(i){var n=i.indexOf("({"),s=i;n>-1&&(s=i.substring(0,n));var o=s.split(".");(void 0==t.url||""==t.url)&&(t.url=o[0]+"."+o[1]),a.urla=s}}a.url&&(e.navObj[a.id]=a.url)})}))}),e.getaid=a,e.loadNavloading=!0},function(){e.menuShow=0})},e.loadPublicInfo=function(t){e.accountBaseInfo=t},e.loadMenuInit1=function(){e.menuShow=1,e.headerMenuShow=1,e.getaid="",e.publicInfo={};var t=a.navlist[0].item.map(function(e){return e.id}).indexOf("mjad");0>t&&"1"==r.businessBaseInfo.ismengju&&a.navlist[0].item.push({name:"盟聚广告",id:"mjad",isself:0,angular:"0",icon:"wmfont wm-guanggao",url:r.businessBaseInfo.mengjuurl}),e.navlist=a.navlist,e.$config.navlist.forEach(function(t){t.item.forEach(function(t){t.url?e.navObj[t.id]=t.url:t.child.forEach(function(t){t.url&&(e.navObj[t.id]=t.url)})})}),e.loadNavloading=!0};var d="";angular.isDefined(r.previousState_params)&&angular.isDefined(r.previousState_params.params)&&""!=r.previousState_params.params&&(d=r.previousState_params.params),angular.isDefined(r.previousState_params)&&angular.isDefined(r.previousState_params.aid)&&""!=r.previousState_params.aid&&(d=r.previousState_params.aid),d?("app.public.detail"!=r.previousState_name&&e.loadMenuInit("",d),l.getBaseInfo({bid:e.businessBaseInfo.bid,aid:d}).then(function(e){r.accountBaseInfo=e.data},function(){})):("app.appcenter"!=r.previousState_name||"app.public.detail"!=r.previousState_name)&&e.loadMenuInit1(),e.isLoadUpdate=function(){l.updatetipsDialog().result.then(function(){})},e.feedbackContent=function(){l.feedbackContentDialog().result.then(function(){})}}]).controller("updatetipsDialogCtrl",["$scope","$modalInstance","data","$toaster","$locale",function(e,t){e.cancel=function(){t.dismiss("Canceled")}}]).controller("feedbackDialogCtrl",["$scope","$modalInstance","data","$toaster","$locale","blocksServer","$config","ipCookie",function(e,t,a,i,n,s,o,l){e.cancel=function(){t.dismiss("Canceled")};var r=0;e.changeCode=function(){r=(new Date).getTime(),e.codeImg="/api3"+o.api3.weimob.changeCode+"&v="+r+"&weimobAuthData="+l("weimobAuthData")},e.changeCode(),e.entity={f:"feedback",v:r,bid:e.businessBaseInfo.bid},e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.saveloading=!0,e.entity.v=r,s.feedback(e.entity).then(function(a){i.success(a.code.errmsg),t.close(!0),e.saveloading=!1},function(){e.saveloading=!1})})}}}]).filter("iframeActive",function(){return function(e,t,a,i){var n=-1;return a?i==e&&(n=1):t&&(n=t.map(function(e){return e.id}).indexOf(e)),n>-1?"active":""}}).directive("iframeOnClick",["$document","$window",function(){return{restrict:"A",template:"",link:function(){var e={resolution:200,iframes:[],interval:null,Iframe:function(){this.element=arguments[0],this.cb=arguments[1],this.hasTracked=!1},track:function(e,t){if(this.iframes.push(new this.Iframe(e,t)),!this.interval){var a=this;this.interval=setInterval(function(){a.checkClick()},this.resolution)}},checkClick:function(){if(document.activeElement){var e=document.activeElement;for(var t in this.iframes)e===this.iframes[t].element?0==this.iframes[t].hasTracked&&(this.iframes[t].cb.apply(window,[]),this.iframes[t].hasTracked=!0):this.iframes[t].hasTracked=!1}}};e.track($("#mainFrame").get(0),function(){$("[dropdown-toggle]").each(function(){var e=$(this);e.parent().hasClass("open")&&e.trigger("click")})})}}}]),angular.module("ngTicket").factory("appcenterServer",["$httpApi","$config","$dialogs","$tableids",function(e,t,a){return{navlist:function(t){return e.get("/../assets/plus/nav.json",t)},appcenterExist:function(a){return e.get(t.api3.weimob.appcenterExist,a)},appcenter:function(a){return e.get(t.api3.weimob.appcenter,a)},publiclist:function(a){return e.get(t.api3.weimob.publics,a)},publicDetail:function(a){return e.get(t.api3.weimob.publicDetail,a)},publicCombo:function(a){return e.get(t.api3.weimob.publicCombo,a)},delPublics:function(a){return e.get(t.api3.weimob.delPublics,a)},serviceSwitchs:function(a){return e.post(t.api3.weimob.updateKFFloat,a)},upgradeServiceDialog:function(){return a.create("/app/appcenter/appcenter.upgrade.model.html","upgradeDialogCtrl",{})},oneDialog:function(e){var t=e.flag,i="";return t&&(i="model-top-offset"),a.create("/app/appcenter/appcenter.model.one.html","oneDialogCtrl",e,{size:"md",windowClass:i})},twoDialog:function(){return a.create("/app/appcenter/appcenter.model.two.html","twoDialogCtrl",{})},bindingPulicDialog:function(e){return a.create("/app/appcenter/appcenter.model.binding.html","bindingPulicDialogCtrl",e)},getBindingurl:function(a){return e.get(t.api3.weimob.getBindingurl,a)},delPublicsDialog:function(e){return a.create("/app/appcenter/appcenter.model.del.html","delPulicDialogCtrl",e)},delPublicsTipsDialog:function(e){return a.create("/app/appcenter/appcenter.model.del.tips.html","delPulicDialogCtrl",e)},getCode:function(a){return e.post(t.api3.weimob.getCode,a)},updateMenu:function(a){return e.get(t.api3.weimob.updateMenu,a)}}}]),angular.module("ngTicket").controller("appcenterCtrl",["$scope","$timeout","$q","appcenterServer","$dialogs","$stateParams","$toaster","$locale",function(e,t,a,i,n,s,o,l){var r=function(){e.loadNavloading=!0,i.appcenter({bid:e.businessBaseInfo.bid,aid:s.aid}).then(function(a){e.applist=a.data,e.loadNavloading=!1,t(function(){})},function(){e.loadNavloading=!1})};r(),e.loadExistloading=!0,i.appcenterExist({bid:e.businessBaseInfo.bid,aid:s.aid}).then(function(t){e.applistExist=t.data,e.loadExistloading=!1},function(){e.loadExistloading=!1}),e.addMenu=function(t,a){i.updateMenu({bid:e.businessBaseInfo.bid,aid:s.aid,menuid:t.id,updatevalue:1}).then(function(){t.isadd=1,a.addcount=a.addcount+1,e.$parent.loadMenuInit("",s.aid,!0),o.success(l.USER.addSuccess)},function(){t.isadd=0,o.success(l.USER.addError)})},e.delMenu=function(t,a){var r=function(){i.updateMenu({bid:e.businessBaseInfo.bid,aid:s.aid,menuid:t.id,updatevalue:0}).then(function(){t.isadd=0,a.addcount=a.addcount-1,e.$parent.loadMenuInit("",s.aid,!0),o.success(l.FORMTIPS.removeSuccess1)},function(){t.isadd=1,o.success(l.FORMTIPS.removeError1)})},d=n.confirm('确定移除该应用？<div class="text-muted m-t-xs">注：移除应用并不会清除已产生的应用数据</div>');d.result.then(function(){r()})}}]).controller("publicCtrl",["$scope","$timeout","$q","appcenterServer","$dialogs","$toaster","$locale","$state",function(e,t,a,i,n,s,o,l){var r=function(t){e.pageLoading=!0,i.publiclist({bid:e.businessBaseInfo.bid}).then(function(a){e.entity=a.data,t&&"0"==a.data.businessInfo.is_change_new_password&&e.$parent.isLoadUpdate(),e.pageLoading=!1},function(){e.pageLoading=!1})};e.subaid?l.go("app.public.detail",{aid:e.subaid}):(e.$parent.loadMenuInit1(),r(!0)),e.serviceSwitch=function(t,a){var n=$(a.target),l=angular.copy(t);l.kf_float=0==l.kf_float?1:0;var r={bid:e.businessBaseInfo.bid,aid:l.id,isFloat:l.kf_float};i.serviceSwitchs(r).then(function(){t.kf_float=l.kf_float,s.success(o.FORMTIPS.modifySuccess)},function(){t.kf_float?n.prop("checked",!0):n.prop("checked",!1),t.kf_float=l.kf_float>0?0:1})},e.upgradeService=function(){i.upgradeServiceDialog().result.then(function(){})},e.delPublic=function(e,t){e.bid=e.business_id,e.aid=e.id,e.phone=t,"1"==e.open_weimobpay?i.delPublicsTipsDialog(e).result.then(function(){}):i.delPublicsDialog(e).result.then(function(e){e&&r()})},e.bindingPulic=function(){i.bindingPulicDialog({}).result.then(function(){})}}]).controller("publicDetailCtrl",["$scope","$timeout","$q","appcenterServer","$stateParams","$rootScope","ipCookie",function(e,t,a,i,n,s,o){n.aid&&(e.pageLoading=!0,i.publicDetail({bid:e.businessBaseInfo.bid,aid:n.aid}).then(function(t){e.entity=t.data,s.accountBaseInfo=t.data.baseInfo,e.$parent.loadPublicInfo(t.data.baseInfo);var a=0==t.data.baseInfo.is_bp&&"close"!=o("isOPenMessage");t.data.noticeInfo.length&&"close"!=o("isOPenNotice")&&(t.data.noticeInfo[0].flag=a,t.data.noticeInfo[0].aid=t.data.baseInfo.aid,i.oneDialog(t.data.noticeInfo[0]).result.then(function(){})),a&&i.bindingPulicDialog({aid:t.data.baseInfo.aid,tips:"open"}).result.then(function(){}),e.pageLoading=!1},function(){e.pageLoading=!1})),e.$parent.loadMenuInit("",n.aid),e.swicthStudyType=1,e.swicthStudy=function(t){e.swicthStudyType=t},e.switchCampaignType=1,e.switchCampaign=function(t){e.switchCampaignType=t},e.bindingPulic=function(e){i.bindingPulicDialog({aid:e}).result.then(function(){})},e.upgradeService=function(){i.upgradeServiceDialog().result.then(function(){})}}]).controller("upgradeDialogCtrl",["$scope","$modalInstance","data","$toaster","$locale",function(e,t){e.cancel=function(){t.dismiss("Canceled")}}]).controller("oneDialogCtrl",["$scope","$modalInstance","data","$toaster","$locale","ipCookie",function(e,t,a,i,n,s){e.cancel=function(){t.dismiss("Canceled")},e.cancelAll=function(){t.dismiss("Canceled"),$(".modal-backdrop").remove(),$(".modal-dialog").parent().remove()},s("isOPenNotice","close",{expires:365});var o=angular.copy(a);o.text=o.text.replace(/<img\b[^>]*>/gi,""),e.entity=o}]).controller("twoDialogCtrl",["$scope","$modalInstance","data","$toaster","$locale",function(e,t){e.cancel=function(){t.dismiss("Canceled")}}]).controller("bindingPulicDialogCtrl",["$scope","$modalInstance","data","$toaster","$locale","appcenterServer","ipCookie",function(e,t,a,i,n,s,o){e.cancel=function(){t.dismiss("Canceled")},e.cancelAll=function(){t.dismiss("Canceled"),$(".modal-backdrop").remove(),$(".modal-dialog").parent().remove()};var l={bid:e.businessBaseInfo.bid};e.entity={},e.entity=angular.extend({},e.entity,a),angular.isDefined(a.aid)&&(l.aid=a.aid),s.getBindingurl(l).then(function(t){e.entity.url=t.data},function(){}),e.bindingTips=function(e){var t=$(e.target),a=t.prop("checked");a?o("isOPenMessage","close",{expires:365}):o("isOPenMessage","open",{expires:365})}}]).controller("delPulicDialogCtrl",["$scope","$toaster","$locale","appcenterServer","data","$modalInstance","$httpApi","$config","$interval",function(e,t,a,i,n,s,o,l,r){e.cancel=function(){s.dismiss("Canceled")},e.entity={},e.entity=angular.extend({},e.entity,n),e.getCode=function(){e.psdisabled=!0;var n=function(){var t=60,a=r(function(){t-=1,e.btnText="{0}秒后重新获取".format(t),1>t&&(r.cancel(a),e.psdisabled=!1,e.btnText="重新获取")},1e3);e.btnText="60秒后重新获取"};i.getCode({phone:e.entity.phone,bid:e.entity.bid,aid:e.entity.aid}).then(function(){t.success(a.FORMTIPS.messageSuccess),n()},function(){t.success(a.FORMTIPS.messageError)})},e.btnText="获取验证码",e.psdisabled=!1,e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.saveloading=!0;var n={phone:e.entity.phone,veryCode:e.entity.code,bid:e.entity.bid,aid:e.entity.aid};i.delPublics(n).then(function(){t.success(a.FORMTIPS.removeSuccess),s.close(!0),e.saveloading=!1},function(){e.saveloading=!1})})}}}]).filter("numberAll",function(){return function(e){var t="";return t=e>-1?e:"无限"}}).filter("numberZero",function(){return function(e){var t=0;return e&&(t=e),t}}),angular.module("ngTicket").controller("signupCtrl",["$scope","$filter","httpErrorFilters","$state","authService","$toaster",function(e,t,a,i,n,s){$rootScope.loginPage=!0,e.$on("$destroy",function(){$rootScope.loginPage=!1}),e.signup=function(){e.signuploading=!0,n.saveRegistration(e.entity).then(function(){i.go("app.dashboard")},function(e){a(e,function(){s.info("用户名重复 或其他错误。。。")})}).then(function(){e.signuploading=!1})}}]),angular.module("ngTicket").factory("accessServer",["$httpApi","$config","$q","$dialogs",function(e,t,a,i){return{restPasswordDialog:function(e){return i.create("/app/access/reset.password.model.html","restPasswordDialogCtrl",e)},sendCode:function(a){return e.post(t.api2.account.sendCode,a)},resetPassword:function(a){return e.post(t.api2.account.resetPassword,a)}}}]).controller("signinCtrl",["$scope","$config","$httpApi","$rootScope","$state","$toaster","authService","accessServer",function(e,t,a,i,n,s,o,l){window.postFlag=!1,e.$on("$destroy",function(){i.loginPage=!1}),e.restPassword=function(){l.restPasswordDialog({mobile:angular.isDefined(e.loginData)?e.loginData.mobile:""}).result.then(function(e){console.log(e)})},e.psdisabled=!1;var r=function(){return window.gtFailbackFrontInitial=function(e){var t=document.createElement("script");t.id="gt_lib",t.src="http://static.geetest.com/static/js/geetest.0.0.0.js",t.charset="UTF-8",t.type="text/javascript",document.getElementsByTagName("head")[0].appendChild(t);var a=!1;t.onload=t.onreadystatechange=function(){a||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(loadGeetest(e),a=!0)}},window.loadGeetest=function(t){window.embed_captcha=new window.Geetest({gt:t.gt,challenge:t.challenge,product:"float",offline:!t.success}),embed_captcha.appendTo("#login_captcha"),embed_captcha.onSuccess(function(){e.$apply(function(){e.embed_captcha_data=embed_captcha.getValidate()})})},window.gtcallback=function(){var e,t,a=0;return function(i){if(a+=1,i)e=i,setTimeout(function(){window.Geetest||(t=!0,gtFailbackFrontInitial(e))},1e3);else if(t)return;2==a&&loadGeetest(e)}}(),{init:function(){var e=document.createElement("script");e.src="http://api.geetest.com/get.php?callback=gtcallback",$("#login_captcha").append(e),$.ajax({url:"/api3/captcha/get?rand="+Math.round(100*Math.random()),type:"get",dataType:"JSON",success:function(e){gtcallback(e)}})}}};r().init(),e.navObj=[],e.navObj.temp="http://www.weimob-ad.com/insidepage/official/official_template.html",e.navObj.temp1="http://www.weimob-ad.com/insidepage/menu/menu.html",e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.loginloading=!0;var t={email:$("#email").val(),password:$("#password").val(),remember:e.loginData.remember};if(!e.embed_captcha_data)return e.loginloading=!1,s.info("请滑动完成验证 !");var a=angular.extend({},t,e.embed_captcha_data);o.login(a).then(function(){i.previousState_name?n.go(i.previousState_name,i.previousState_params):n.go("app.dashboard")},function(){e.embed_captcha_data=null,window.embed_captcha.refresh()}).then(function(){e.loginloading=!1})})}}}]).controller("restPasswordDialogCtrl",["$scope","$toaster","$locale","accessServer","data","$modalInstance","$httpApi","$config","$interval",function(e,t,a,i,n,s,o,l,r){e.cancel=function(){s.dismiss("Canceled")},e.entity={},e.entity.mobile=n.mobile,e.sendCode=function(){e.psdisabled=!0;var n=function(){var t=60,a=r(function(){t-=1,e.btnText="{0}秒后重新获取".format(t),1>t&&(r.cancel(a),e.psdisabled=!1,e.btnText="重新获取")},1e3);e.btnText="60秒后重新获取"};i.sendCode({mobile:e.entity.mobile}).then(function(){n()},function(){t.success(a.FORMTIPS.messageError)})},e.btnText="获取验证码",e.psdisabled=!0,e.$watch("entity.mobile",function(a){a&&11==a.length&&o.post(l.api2.account.checkMobile,{mobile:a,is_send:0}).then(function(a){angular.isDefined(a.data.password)?(e.psdisabled=!1,e.accountData=a.data):t.info("没有找到该用户")})}),e.eventformvalidate={submitHandler:function(){e.$apply(function(){e.saveloading=!0,i.resetPassword(e.entity).then(function(){t.success(a.FORMTIPS.modifySuccess),s.close(e.entity.mobile),e.saveloading=!1},function(a){t.info(a.message),s.close(e.entity.mobile)})})}}}]),angular.module("ngTicket").config(["$stateProvider","$urlRouterProvider","$locationProvider","$httpProvider",function(e,t){e.state("/",{url:"/","abstract":!0}).state("app",{url:"/app","abstract":!0,controller:"blocksCtrl",templateUrl:"/app/app.html"}).state("app.vip",{url:"/vip/:aid","abstract":!0,controller:"vipCtrl",template:'<section ng-if="accountBaseInfo" class="vbox" ui-view><section>'}).state("app.iframes",{url:"/iframes/:url/:params/:subparams",controller:"",data:{pageTitle:""},templateUrl:"/app/iframe/iframe.html"}),function(t){angular.forEach(t,function(t){e.state("app.{0}".format(t),{url:"/{0}".format(t),"abstract":!0,name:"{0}".format(t),template:'<section class="vbox" ui-view><section>'})})}(["user","public","messages"]),e.state("app.appcenter",{url:"/appcenter/:aid",controller:"appcenterCtrl",data:{pageTitle:"应用中心"},templateUrl:"/app/appcenter/appcenter.list.html"}).state("app.public.list",{url:"/list",controller:"publicCtrl",data:{pageTitle:"公众号管理"},templateUrl:"/app/appcenter/public.list.html"}).state("app.public.detail",{url:"/detail/{aid:int}",controller:"publicDetailCtrl",data:{pageTitle:"公众号平台"},templateUrl:"/app/dashboard/dashboard.html"}).state("app.vip.card",{url:"/card","abstract":!0,templateUrl:"/app/vip/card/index.html"}).state("app.vip.card.manage",{url:"/manage",controller:"vipCardManageCtrl",data:{pageTitle:"会员卡管理"},templateUrl:"/app/vip/card/manage/manage.html"}).state("app.vip.card.create",{url:"/create?edit",controller:"vipCardCreateCtrl",data:{pageTitle:"创建会员卡"},templateUrl:"/app/vip/card/manage/create.html"}).state("app.vip.card.use",{url:"/use",controller:"vipCardUseCtrl",data:{pageTitle:"开启会员卡"},templateUrl:"/app/vip/card/manage/use.html"}).state("app.vip.card.level",{url:"/level",controller:"vipCardLevelCtrl",data:{pageTitle:"等级设置"},templateUrl:"/app/vip/card/level/level.html"}).state("app.vip.card.entry",{url:"/entry",controller:"vipCardEntryCtrl",data:{pageTitle:"入口设置"},templateUrl:"/app/vip/card/entry/entry.html"}).state("app.vip.card.privilege",{url:"/privilege",controller:"vipCardPrivilegeCtrl",data:{pageTitle:"特权设置"},templateUrl:"/app/vip/card/privilege/privilege.html"}).state("app.vip.card.addPrivilege",{url:"/add/privilege?id",controller:"vipCardAddPrivilegeCtrl",data:{pageTitle:"特权设置"},templateUrl:"/app/vip/card/privilege/addPrivilege.html"}).state("app.vip.card.info",{url:"/info",controller:"vipCardInfoCtrl",data:{pageTitle:"会员卡数据"},templateUrl:"/app/vip/card/info/info.html"}).state("app.vip.card.business",{url:"/business",controller:"vipCardBusinessCtrl",data:{pageTitle:"会员卡管理业务"},templateUrl:"/app/vip/card/business/business.html"}).state("app.vip.manage",{url:"/manage?tagId",controller:"vipManageCtrl",data:{pageTitle:"会员管理"},templateUrl:"/app/vip/manage/index.html"}).state("app.vip.manageTagMember",{url:"/tagMember?id",controller:"vipManageTagMemberCtrl",data:{pageTitle:"会员标签查询"},templateUrl:"/app/vip/manage/tagMember.html"}).state("app.vip.manageVipView",{url:"/manageVipView?id",controller:"vipManageVipViewCtrl",data:{pageTitle:"会员详情"},templateUrl:"/app/vip/manage/vipView.html"}).state("app.vip.manageLabel",{url:"/manageLabel",controller:"vipManageLabelCtrl",data:{pageTitle:"标签管理"},templateUrl:"/app/vip/manage/label.html"}).state("app.vip.createLabel",{url:"/createLabel?id",controller:"vipManageCreateLabelCtrl",data:{pageTitle:"标签管理"},templateUrl:"/app/vip/manage/createLabel.html"}).state("app.vip.storeVip",{url:"/storeVip",controller:"vipStoreVipCtrl",data:{pageTitle:"实体店会员"},templateUrl:"/app/vip/store/index.html"}).state("app.vip.storeVipAdd",{url:"/storeVipAdd",controller:"vipStoreVipAddCtrl",data:{pageTitle:"实体店会员"},templateUrl:"/app/vip/store/add.html"}).state("app.vip.trade",{url:"/trade",controller:"vipTradeCtrl",data:{pageTitle:"会员交易"},templateUrl:"/app/vip/trade/index.html"}).state("app.vip.tradeConsumeData",{url:"/tradeConsumeData",controller:"vipTradeConsumeDataCtrl",data:{pageTitle:"会员交易 - 消费统计"},templateUrl:"/app/vip/trade/consume.data.html"}).state("app.vip.tradeRechargeData",{url:"/tradeRechargeData",controller:"vipTradeRechargeDataCtrl",data:{pageTitle:"会员交易 - 充值统计"},templateUrl:"/app/vip/trade/recharge.data.html"}).state("app.vip.tradePointData",{url:"/tradePointData",controller:"vipTradePointDataCtrl",data:{pageTitle:"会员交易 - 积分统计"},templateUrl:"/app/vip/trade/point.data.html"}).state("app.vip.tradeConsumeLog",{url:"/tradeConsumeLog",controller:"vipTradeConsumeLogCtrl",data:{pageTitle:"会员交易 - 消费查询"},templateUrl:"/app/vip/trade/consume.log.html"}).state("app.vip.tradeRechargeLog",{url:"/tradeRechargeLog",controller:"vipTradeRechargeLogCtrl",data:{pageTitle:"会员交易 - 充值查询"},templateUrl:"/app/vip/trade/recharge.log.html"}).state("app.vip.tradePointLog",{url:"/tradePointLog",controller:"vipTradePointLogCtrl",data:{pageTitle:"会员交易 - 积分查询"},templateUrl:"/app/vip/trade/point.log.html"}).state("app.vip.marketing",{url:"/marketing",controller:"vipMarketingCtrl",data:{pageTitle:"会员营销"},templateUrl:"/app/vip/marketing/index.html"}).state("app.vip.marketingCoupon",{url:"/marketingCoupon",controller:"vipMarketingCouponCtrl",data:{pageTitle:"优惠券"},templateUrl:"/app/vip/marketing/coupon.html"}).state("app.vip.marketingCouponGetList",{url:"/marketingCoupon/getList?id",controller:"vipMarketingCouponGetListCtrl",data:{pageTitle:"优惠券派发列表"},templateUrl:"/app/vip/marketing/coupon.getlist.html"}).state("app.vip.marketingCouponAdd",{url:"/marketingCouponAdd?id",controller:"vipMarketingCouponAddCtrl",data:{pageTitle:"添加优惠券"},templateUrl:"/app/vip/marketing/coupon.add.html"}).state("app.vip.marketingPoint",{url:"/marketingPoint",controller:"vipMarketingPointCtrl",data:{pageTitle:"会员积分"},templateUrl:"/app/vip/marketing/point.html"}).state("app.vip.marketingRecommend",{url:"/marketingRecommend",controller:"vipMarketingRecommendCtrl",data:{pageTitle:"每日推荐"},templateUrl:"/app/vip/marketing/recommend.html"}).state("app.vip.marketingRecommendAdd",{url:"/marketingRecommendAdd?id",controller:"vipMarketingRecommendAddCtrl",data:{pageTitle:"添加每日推荐"},templateUrl:"/app/vip/marketing/recommend.add.html"}).state("app.vip.marketingBroadcast",{url:"/marketingBroadcast",controller:"vipMarketingBroadcastCtrl",data:{pageTitle:"会员广播"},templateUrl:"/app/vip/marketing/broadcast.html"}).state("app.vip.marketingBroadcastAdd",{url:"/marketingBroadcastAdd?id",controller:"vipMarketingBroadcastAddCtrl",data:{pageTitle:"添加会员广播"},templateUrl:"/app/vip/marketing/broadcast.add.html"}).state("app.vip.marketingActivationGiving",{url:"/marketingActivationGiving",controller:"vipMarketingActivationGivingCtrl",data:{pageTitle:"开卡即送"},templateUrl:"/app/vip/marketing/activationGiving.html"}).state("app.vip.marketingActivationGivingAdd",{url:"/marketingActivationGivingAdd?id",controller:"vipMarketingActivationGivingAddCtrl",data:{pageTitle:"添加开卡即送"},templateUrl:"/app/vip/marketing/activationGiving.add.html"}).state("app.vip.marketingCostGiving",{url:"/marketingCostGiving",controller:"vipMarketingCostGivingCtrl",data:{pageTitle:"消费赠送"},templateUrl:"/app/vip/marketing/costGiving.html"}).state("app.vip.marketingCostGivingAdd",{url:"/marketingCostGivingAdd?id",controller:"vipMarketingCostGivingAddCtrl",data:{pageTitle:"添加消费赠送"},templateUrl:"/app/vip/marketing/costGiving.add.html"}).state("app.vip.marketingRechargeGiving",{url:"/marketingRechargeGiving",controller:"vipMarketingRechargeGivingCtrl",data:{pageTitle:"充值赠送"},templateUrl:"/app/vip/marketing/rechargeGiving.html"}).state("app.vip.marketingRechargeGivingAdd",{url:"/marketingRechargeGivingAdd?id",controller:"vipMarketingRechargeGivingAddCtrl",data:{pageTitle:"添加充值赠送"},templateUrl:"/app/vip/marketing/rechargeGiving.add.html"}).state("app.vip.marketingPointExchange",{url:"/marketingPointExchange",controller:"vipMarketingPointExchangeCtrl",data:{pageTitle:"积分兑换"},templateUrl:"/app/vip/marketing/pointExchange.html"}).state("app.vip.marketingPointExchangeAdd",{url:"/marketingPointExchangeAdd?id",controller:"vipMarketingPointExchangeAddCtrl",data:{pageTitle:"添加积分兑换"},templateUrl:"/app/vip/marketing/pointExchange.add.html"}).state("app.vip.marketingSolicitude",{url:"/marketingSolicitude",controller:"vipMarketingSolicitudeCtrl",data:{pageTitle:"会员关怀"},templateUrl:"/app/vip/marketing/solicitude.html"}).state("app.vip.marketingSolicitudeAdd",{url:"/marketingSolicitudeAdd?id",controller:"vipMarketingSolicitudeAddCtrl",data:{pageTitle:"添加会员关怀"},templateUrl:"/app/vip/marketing/solicitude.add.html"}).state("app.messages.list",{url:"/list/:aid/:type",controller:"messagePackageCtrl",data:{pageTitle:"短信包"},templateUrl:"/app/messages/messages.list.html"}).state("app.messages.list.detail",{url:"/detail/:aid/:type/:id/:btype/:date",views:{subviewconsume:{templateUrl:"/app/messages/messages.detail.html",controller:"messagePackageDetailCtrl"}},data:{pageTitle:"日消耗详情"}}),t.otherwise("/app/public/list")
}]),angular.module("ngTicket").provider("$pageTitle",function(){function e(e,a){function i(){return a.document.title}function n(){var e,i=arguments.length>0?Array.prototype.slice.call(arguments):t;e=angular.isString(i)?i:i.concat(t).join(" - "),a.document.title=e}return t?a.document.title=t:t=a.document.title,e.$on("$stateChangeSuccess",function(e,t){var a;t&&angular.isDefined(t.data)&&(a=t.data.pageTitle||null),a?n(a):n()}),{get:i,set:n}}var t;this.setDefault=function(e){t=e},this.$get=["$rootScope","$window",e]}),angular.module("ngTicket").constant("localeZh",{FORMTIPS:{saveSuccess:"保存成功",modifySuccess:"修改成功",checkedSuccess:"验证成功",saveError:"保存失败",modifyError:"修改失败",exception:"网络异常 请重试",confirmRemove:"确定删除 ?",confirmAllremove:"确定删除选定 ?",removeSuccess:"删除成功",removeError:"删除失败",removeSuccess1:"移除成功",removeError1:"移除失败",uplodMax:"最多一次上传{0}张",uplodSizeMax:"请上传小于{0}MB的文件",uplodError:"上传失败，请重新上传。",dataError:"获取数据失败 请稍后重试",messageSuccess:"验证码发送成功",messageError:"验证码发送失败 请稍后重试"},ORDERS:{deliverySuccess:"发货成功",deliveryError:"发货失败",closeSuccess:"关闭成功"},GOODS:{upShelvesOk:"上架成功",upShelvesNo:"上架失败",downShelvesOk:"下架架成功",downShelvesNo:"下架失败"},USER:{addSuccess:"添加成功",addError:"添加失败",sendMsSuccess:"发送成功",sendMsFailed:"发送失败"},DATETIME:{second:"秒",minute:"分",hour:"时",day:"天",month:"月",year:"年",fullD:"yyyy年MM月dd日 HH:mm",shortD:"MM-dd HH:mm",dayAgo:"天前",hourAgo:"小时前",minuteAgo:"分钟前",secondAgo:"刚刚"}}),angular.module("ngTicket").filter("srefif",function(){return function(e,t){return t?e:"javascript:;"}}).filter("apiUrlPrefix",["$config",function(e){return function(t){return"http://"+e.host.www+e.host.api3+t}}]).filter("apiUrlPrefixVip",["$config",function(e){return function(t){return"http://"+e.host.www+e.host.apiVip+t}}]).filter("apiUrlPrefixSMS",["$config",function(e){return function(t){return"http://"+e.host.www+e.host.apiSMS+t}}]).filter("textBrace",function(){return function(e){return e?"["+e+"]":""}}).filter("propsFilter",function(){return function(e,t){var a=[];return angular.isArray(e)?e.forEach(function(e){for(var i=!1,n=Object.keys(t),s=0;s<n.length;s++){var o=n[s],l=t[o].toLowerCase();if(-1!==e[o].toString().toLowerCase().indexOf(l)){i=!0;break}}i&&a.push(e)}):a=e,a}}).filter("formatDate",["$filter","$locale",function(e,t){return function(a,i){var n=Date.now()-new Date(a),s=e("date");return i?s(a,t.DATETIME.fullD):n>2592e5?s(a,t.DATETIME.shortD):n>864e5?Math.floor(n/864e5)+t.DATETIME.dayAgo:n>36e5?Math.floor(n/36e5)+t.DATETIME.hourAgo:n>6e4?Math.floor(n/6e4)+t.DATETIME.minuteAgo:t.DATETIME.secondAgo}}]).filter("formatTime",["formatTimefun",function(e){return e}]).filter("greaterDate",function(){return function(e){return Date.now()<new Date(e)}}).filter("jsonParse",function(){return function(e){return JSON.parse(e)}}).filter("parseTime",function(){return function(e){return new Date(e)}}).filter("formatBytes",["$locale",function(){return function(e){return e=e>0?e:0,e?1024>e?e+"B":1048576>e?(e/1024).toFixed(3)+" KiB":1073741824>e?(e/1048576).toFixed(3)+" MiB":(e/1073741824).toFixed(3)+" GiB":"-"}}]).filter("currencyFormat",function(){return function(e){if(!e)return"0.00";var t=Number(e);return t.toFixed(2)}}).filter("chineseLen",function(){return function(e,t){return e?(t||(t=1),parseInt(e.replace(/[^\x00-\xff]/g,"**").length/t)):0}}),angular.module("ngTicket").factory("RootRestangular",["Restangular",function(e){return e.withConfig(function(e){e.setBaseUrl("")})}]).factory("CorsRestangular",["Restangular",function(e){return e.withConfig(function(e){e.setBaseUrl("http://127.0.0.1:1339")})}]).factory("RestFulResponse",["Restangular",function(e){return e.withConfig(function(e){e.setFullResponse(!0)})}]).factory("$toaster",["toaster",function(e){return{success:function(t,a,i,n){e.pop("success","",t,a,i,n)},error:function(t,a,i,n){e.pop("error","",t,a||3e3,i,n)},info:function(t,a,i,n){e.pop("info","",t,a||3e3,i,n)},wait:function(t,a,i,n){e.pop("wait","",t,a,i,n)},warning:function(t,a,i,n){e.pop("warning","",t,a||3e3,i,n)},clear:function(){e.clear()}}}]).factory("$dialogs",["dialogs",function(e){return{alert:function(t,a,i){return e.notify(i||null,t,a)},confirm:function(t,a,i){var n=angular.extend({},{size:"sm"},a);return e.confirm(i||null,t,n)},wait:function(t,a,i,n){var s=angular.extend({},{backdrop:"static",keyboard:!1},i);return e.wait(n||null,t,a,s)},create:function(t,a,i,n){return e.create(t,a,i,n)}}}]).factory("httpErrorFilters",[function(){return function(e,t){200==e.status&&t(e)}}]).factory("tableHelp",["$timeout","$httpApi","ngTableParams","$location","$toaster","$locale",function(e,t,a,i,n,s){return function(e,o){var l={page:1,pageSize:20};return o=angular.extend({},l,o),{remove:function(e){},tableParams:function(e,l){return new a(angular.extend({page:o.page,count:o.pageSize,PageIndex:o.page,PageSize:o.pageSize},i.search()),{total:0,filterDelay:0,getData:function(a,r){o.noParams||i.search(r.url());var d={page_num:r.page(),page:r.page(),limit:o.pageSize,PageIndex:r.page(),PageSize:o.pageSize},c=angular.extend({},d,angular.isFunction(l)?l():l);o.vip?t.postJson2(e,c).then(function(e){r.total(angular.isDefined(e.data.TotalCount)?e.data.TotalCount:0),a.resolve(e.data.Items||[])},function(){n.info(s.FORMTIPS.dataError),a.resolve([])}):t.post(e,c,{},o.porxy).then(function(e){r.total(e.data?angular.isDefined(e.data.page)?e.data.page.total:e.data.total_results||e.data.length||e.data.list.length:0),a.resolve(o.getData?o.getData(e.data):e.data.datalist||e.data.datalists||e.data.list||e.data)},function(){n.info(s.FORMTIPS.dataError),a.resolve([])})}})}}}}]).factory("$httpApi",["$http","$filter","$q","$config","$dialogs","$rootScope","$injector","$toaster",function(e,t,a,i,n,s,o,l){var r=function(e){var t={};return e=angular.extend({},t,e),$.param(e)},d={transformRequest:r,headers:{"Content-Type":"application/x-www-form-urlencoded;charset=utf-8"}},c=function(e,t,a){if(e.data.code&&"0"==e.data.code.errcode)return t.resolve(a.fullResponse?e:e.data);if("8600100100010011"==e.data.code.errcode||"899001"==e.data.code.errcode){var s=o.get("authService");l.warning("登录失效 请重新登录"),s.logout(),window.postFlag=!0}return i.debug?n.alert(e.data.code.errmsg||e.data):l.info(e.data.code.errmsg||"网络异常 请重试 !"),t.reject(e)};return{post:function(i,n,s,o){var l=a.defer();if(s=angular.extend({},d,s),window.postFlag)console.log("postFlag....");else{var r=o||"apiUrlPrefix";e.post(t(r)(i),n,s).then(function(e){c(e,l,s)},function(e){return l.reject(e)})}return l.promise},postJson:function(i,n,s){var o=a.defer(),l={};if(window.postFlag)console.log("postFlag....");else{var r=s||"apiUrlPrefix";e.post(t(r)(i),n,l).then(function(e){c(e,o,l)},function(e){return o.reject(e)})}return o.promise},postJson2:function(e,t){return this.postJson(e,t,"apiUrlPrefixVip")},get:function(i,n,s,o){var l=a.defer();if(s=angular.extend({},d,s),window.postFlag)console.log("postFlag....");else{var r=o||"apiUrlPrefix";e.get(t(r)(i),{params:n},s).then(function(e){c(e,l,s)},function(e){return l.reject(e)})}return l.promise}}}]).factory("authInterceptorService",["$q","ipCookie","$toaster","$injector","$config",function(e,t,a,i,n){var s={},o=function(e){e.headers=e.headers||{};var a=t(window.env.cookieName||"weimobAuthData")||n.test_token;return a&&(e.headers.weimobAuthData=a,e.headers.Apiclient="weimob-pc"),e},l=function(t){var s=function(){if(n.debug){var e=i.get("$dialogs");e.alert(t.data.message||t.data)}else a.info("网络异常 请重试 !")};return 200!=t.status&&s(),e.reject(t)};return s.request=o,s.responseError=l,s}]).factory("authService",["$q","Restangular","ipCookie","$config","$locale","$httpApi","$state","$timeout","$rootScope",function(e,t,a,i,n,s,o,l,r){var d={},c={isAuth:!1,token:null,userData:null},p={path:"/",expires:!1},m=c,u=function(){a.remove(window.env.cookieName||"weimobAuthData",p),m.isAuth=!1,m.data=null,l(function(){window.location=window.env.prefix+"/login/logout"},500)},h=function(e){return u(),t.one("auth/register").customPOST(e).then(function(e){return g(e),e})},g=function(e){m.isAuth=!0,m.data=e.data,r.userData_done=!0},f=function(t){var n=e.defer();return p.expires=t.remember?365:!1,s.post(i.api3.user.login,t).then(function(e){a("authorizationData",e.data.access_token,p),g(e),n.resolve(e)},function(e){n.reject(e)}),n.promise},v=function(){a.remove("authorizationData",p),m.isAuth=!1,m.data=null,window.location=window.env.prefix+"/login/logout"};window.oldWeimobLocation=function(e){var t="";angular.isDefined(r.previousState_params.params)&&""!=r.previousState_params.params&&(t=r.previousState_params.params),"1"==e?o.go("app.public.list"):o.go("app.public.detail",{aid:t})};var b=new Messenger("parent","MessengerAngularjsIframe");b.listen(function(e){var t="";angular.isDefined(r.previousState_params.params)&&""!=r.previousState_params.params&&(t=r.previousState_params.params),"1"==e?o.go("app.public.list"):"reload"==e?window.location.reload():o.go("app.public.detail",{aid:t})});var y=function(){var e=a(window.env.cookieName||"weimobAuthData")||i.test_token;return e&&(m.isAuth||m.data||(s.get(i.api3.weimob.publics,{bid:""}).then(function(e){g(e),r.previousState_name?o.go(r.previousState_name,r.previousState_params):o.go("app.public.list"),r.businessBaseInfo=e.data.businessInfo,r.businessBaseInfo.bid="",r.subaid=e.data.subaid,r.businessBaseInfoAll=e.data},function(){}),m.isAuth=!0)),m};return d.saveRegistration=h,d.login=f,d.logout=u,d.fillAuthData=y,d.removeAuthData=v,d}]).factory("formatTimefun",["$locale",function(e){return function(t){function a(e){return n=s%e,s=(s-n)/e}var i="",n=0,s=t>0?Math.round(+t):Math.floor(Date.now()/1e3),o=e.DATETIME;return a(60),i=n+o.second,a(60),i=(n>0?n+o.minute:"")+i,a(24),i=(n>0?n+o.hour:"")+i,s>0?s+o.day+i:i}}]).factory("$state2",["$state","$stateParams","$window",function(e,t,a){return{current:function(){e.transitionTo(e.current,t,{reload:!0})},back:function(){a.history.back()}}}]).factory("$tableids",function(){return function(e){var t=null;return t=angular.isArray(e)?e.map(function(e){return e.id}).join(","):e.id}}),window.setIframeHeight=function(e,t){t||(t=0);var a=e;setTimeout(function(){document.getElementById&&a&&(window.opera?a.contentWindow.document&&a.contentWindow.document.body.scrollHeight&&(a.height=a.contentWindow.document.body.scrollHeight+t):a.contentDocument&&a.contentDocument.body.offsetHeight?a.height=a.contentDocument.body.offsetHeight+t:a.Document&&a.Document.body.scrollHeight&&(a.height=a.Document.body.scrollHeight+t))})},String.prototype.format||(String.prototype.format=function(){var e=arguments;return this.replace(/{(\d+)}/g,function(t,a){return"undefined"!=typeof e[a]?e[a]:t})}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s*/,"").replace(/\s*$/,"")}),String.prototype.toBoolean||(String.prototype.toBoolean=function(){return"1"==this}),Boolean.prototype.tooString||(Boolean.prototype.tooString=function(){return this?1:0}),Array.prototype.unique=function(){for(var e={},t=this.length,a=[],i=0;t>i;i++)e[this[i]]||(e[this[i]]=!0,a.push(this[i]));return a},String.IsNullOrEmpty=function(e){if(e){if("string"==typeof e&&e.length>0)return!1;if(null!=e)return!1}return!0},String.prototype.parameters||(String.prototype.parameters=function(){for(var e={},t=new RegExp("([\\?|&])(.+?)=([^&?]*)","ig"),a=t.exec(this);a;)e[a[2]]=a[3],a=t.exec(this);return e}),String.prototype.stripTags||(String.prototype.stripTags=function(){return this.replace(/<\/?[^>]+>/gi,"")}),String.prototype.getNum||(String.prototype.stripTags=function(){return this.replace(/[^d]/g,"")}),String.prototype.getEn||(String.prototype.getEn=function(){return this.replace(/[^A-Za-z]/g,"")}),String.prototype.getCn||(String.prototype.getCn=function(){return this.replace(/[^u4e00-u9fa5uf900-ufa2d]/g,"")}),Date.prototype.format||(Date.prototype.format=function(e){var t={"M+":this.getMonth()+1,"d+":this.getDate(),"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds(),"q+":Math.floor((this.getMonth()+3)/3),"S+":this.getMilliseconds()};/(y+)/i.test(e)&&(e=e.replace(RegExp.$1,(this.getFullYear()+"").substr(4-RegExp.$1.length)));for(var a in t)new RegExp("("+a+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[a]:("00"+t[a]).substr((""+t[a]).length)));return e}),window.StringBuilder=function(){this.tmp=new Array},StringBuilder.prototype.Append=function(e){return this.tmp.push(e),this},StringBuilder.prototype.Clear=function(){tmp.length=1},StringBuilder.prototype.toString=function(){return this.tmp.join("")},$.extend({unselectContents:function(){window.getSelection?window.getSelection().removeAllRanges():document.selection&&document.selection.empty()}}),$.fn.extend({selectContents:function(){$(this).each(function(e){var t,a,i,n,s=this;(i=s.ownerDocument)&&(n=i.defaultView)&&"undefined"!=typeof n.getSelection&&"undefined"!=typeof i.createRange&&(t=window.getSelection())&&"undefined"!=typeof t.removeAllRanges?(a=i.createRange(),a.selectNode(s),0==e&&t.removeAllRanges(),t.addRange(a)):document.body&&"undefined"!=typeof document.body.createTextRange&&(a=document.body.createTextRange())&&(a.moveToElementText(s),a.select())})},setCaret:function(){if($.browser.msie){var e=function(){var e=$(this).get(0);e.caretPos=document.selection.createRange().duplicate()};$(this).click(e).select(e).keyup(e)}},insertAtCaret:function(e){var t=$(this).get(0);if(document.all&&t.createTextRange&&t.caretPos){var a=t.caretPos;a.text=""==a.text.charAt(a.text.length-1)?e+"":e}else if(t.setSelectionRange){var i=t.selectionStart,n=t.selectionEnd,s=t.value.substring(0,i),o=t.value.substring(n);t.value=s+e+o,t.focus();var l=e.length;t.setSelectionRange(i+l,i+l),t.blur()}else t.value+=e}}),angular.module("ngTicket").directive("uiFullscreen",["$document","$window",function(e){return{restrict:"AC",template:'<i class="fa fa-expand fa-fw text"></i><i class="fa fa-compress fa-fw text-active"></i>',link:function(t,a,i){a.addClass("hide"),screenfull.enabled&&!navigator.userAgent.match(/Trident.*rv:11\./)&&a.removeClass("hide"),a.on("click",function(){var e;i.target&&(e=$(i.target)[0]),screenfull.toggle(e)}),e.on(screenfull.raw.fullscreenchange,function(){screenfull.isFullscreen?a.addClass("active"):a.removeClass("active")})}}}]).directive("countdown",["$interval","$filter","$locale","formatTimefun",function(e,t,a,i){return{restrict:"AE",scope:{time:"="},link:function(t,a){if(t.time){var n=function(){return(new Date(t.time)-Date.now())/1e3},s=e(function(){var t=n();1>t&&e.cancel(s),a.html(i(t))},1e3);a.html(i(n()))}}}}]).directive("uiButterbar",["$rootScope","$anchorScroll",function(e,t){return{restrict:"AC",template:'<span class="bar"></span>',link:function(e,a){a.addClass("butterbar hide"),e.$on("$stateChangeStart",function(){t(),a.removeClass("hide").addClass("active")}),e.$on("$stateChangeSuccess",function(e){e.targetScope.$watch("$viewContentLoaded",function(){a.addClass("hide").removeClass("active")})})}}}]).directive("uiToggleClass",["$timeout","$document",function(){return{restrict:"AC",link:function(e,t,a){t.on("click",function(e){function i(e,t){for(var a=new RegExp("\\s"+e.replace(/\*/g,"[A-Za-z0-9-_]+").split(" ").join("\\s|\\s")+"\\s","g"),i=" "+$(t)[0].className+" ";a.test(i);)i=i.replace(a," ");$(t)[0].className=$.trim(i)}e.preventDefault();var n=a.uiToggleClass.split(","),s=a.target&&a.target.split(",")||Array(t),o=0;angular.forEach(n,function(e){var t=s[s.length&&o];-1!==e.indexOf("*")&&i(e,t),$(t).toggleClass(e),o++}),$(t).toggleClass("active")})}}}]).directive("formValidator",["$timeout",function(){return{restrict:"A",scope:{formvalidatorconfig:"=",formvalidatorapi:"="},link:function(e,t){e.$watch("formvalidatorconfig",function(e){var a={errorClass:"help-block error",errorPlacement:function(e,t){var a=t.parents(".input-group");a.length>0?a.after(e):t.after(e)},highlight:function(e){$(e).removeClass("help-block error has-success").addClass("help-block error")},submitHandler:function(){}},i=$.extend(!0,a,e);t.validate(i)}),e.formvalidatorapi&&(e.formvalidatorapi={validate:function(){t.validate().form()},valid:function(){return t.valid()}})}}}]).directive("formSerialize",[function(){return{restrict:"A",scope:{tableParams:"="},link:function(e,t){var a=$(t);e.$form=a,a.on("submit",function(){var t=$(this),a=t.serializeArray();return e.tableParams&&e.$apply(function(){angular.forEach(a,function(t){e.tableParams.filter()[t.name]=t.value})}),!1})}}}]).directive("btnLoading",function(){return{restrict:"A",scope:{loadingText:"@",btnLoading:"=",ifDisabled:"=?"},link:function(e,t){var a=t.html();e.$watch("btnLoading",function(i){angular.isUndefined(i)||(e.ifDisabled=angular.isUndefined(e.ifDisabled)?!0:e.ifDisabled,e.ifDisabled&&t.prop("disabled",i),e.loadingText="@"==e.loadingText?'<i class="fa fa-spinner fa-spin"></i>':e.loadingText,t.html(i?e.loadingText||"loading...":a))})}}}).directive("loadingContainer",["$rootScope","$parse",function(e,t){return{restrict:"A",scope:!1,link:function(a,i,n){var s=t(n.overlay||"true")(a),o=angular.element('<div class="loading"></div>');s&&(i.append(o),i.addClass("loading-container")),a.$watch(n.loadingContainer,function(t){s&&o.toggleClass("ng-hide",!t),e.loading_done=!t})}}}]).directive("refreshState",["$state2",function(e){return{restrict:"A",link:function(t,a){a.bind("click",function(){e.current()})}}}]).directive("backState",["$window",function(e){return{restrict:"A",link:function(t,a){a.bind("click",function(){e.history.back()})}}}]).directive("dateFormat",["$filter",function(e){var t=e("date");return{require:"ngModel",restrict:"AC",link:function(e,a,i,n){function s(i){return i&&a.val(i).valid(),t(i,e.$root.$config.dateformat)}function o(){return n.$modelValue}n.$formatters.push(s),n.$parsers.unshift(o)}}}]).directive("iframe2",[function(){return{restrict:"AE",require:"?ngModel",template:'<iframe  width="100%" height="0px" scrolling="no" frameborder="0"   onload="setIframeHeight(this)" ></iframe>',link:function(e,t,a,i){i.$render=function(){var e=t.children()[0].contentWindow;e.document.open(),e.document.write('<link rel="stylesheet" type="text/css" href="/assets/stylesheets/combination/normalize.css"> <base target="_blank" />'+i.$viewValue),e.document.close()}}}}]).directive("iframePrint",[function(){return{restrict:"AE",scope:{printDivText:"@",close:"&?",style:"@?"},template:'<iframe  width="100%" height="0px" scrolling="no" frameborder="0" onload="setIframeHeight(this, 30)" style="{{style}}" ></iframe>',link:function(e,t){var a=function(){var a=t.children()[0].contentWindow;a.document.body.innerHTML=e.printDivText+'<div class="btns"><h1>WELCOME</h1><input type="button" value="开始打印" class="btn m-r" onclick="window.print();"><input id="btn-close" type="button" value="取消" class="btn" ></div>',a.document.getElementById("btn-close").onclick=function(){e.close&&e.close()}};a()}}}]).directive("ngBindAttrs",function(){return function(e,t,a){e.$watch(a.ngBindAttrs,function(e){angular.forEach(e,function(e,t){a.$set(t,e)})},!0)}}).filter("cut",function(){return function(e,t,a,i){if(console.log(e),!e)return"";if(a=parseInt(a,10),!a)return e;if(e.length<=a)return e;if(e=e.substr(0,a),t){var n=e.lastIndexOf(" ");-1!=n&&(e=e.substr(0,n))}return e+(i||" …")}}).filter("strLimit",[function(){return function(e,t){return e?e.length<=t?e:e.substr(0,t)+"...":void 0}}]).directive("countTo",["$timeout",function(e){return{replace:!1,scope:!0,link:function(t,a,i){var n,s,o,l,r,d,c,p=a[0],m=function(){s=30,r=0,t.timoutId=null,d=parseFloat(i.countTo).toFixed(i.decimals||0)||0,t.value=parseInt(i.value,10)||0,o=1e3*parseFloat(i.duration)||0,l=Math.ceil(o/s),c=(d-t.value)/l,n=t.value},u=function(){t.timoutId=e(function(){n+=c,r++,r>=l?(e.cancel(t.timoutId),n=d,p.textContent=d):(p.textContent=Math.round(n),u())},s)},h=function(){t.timoutId&&e.cancel(t.timoutId),m(),u()};return i.$observe("countTo",function(e){e&&h()}),i.$observe("value",function(){h()}),!0}}}]),angular.module("ngTicket").config(["RestangularProvider","$httpProvider","$config","$pageTitleProvider","dialogsProvider","$translateProvider",function(e,t,a,i,n,s){e.setBaseUrl(a.host.api),function(){t.interceptors.push("authInterceptorService"),i.setDefault("微盟后台")}(),function(){n.setSize("md"),s.translations("zh-cn",{DIALOGS_ERROR:"Error",DIALOGS_ERROR_MSG:"An unknown error has occurred.",DIALOGS_CLOSE:"关闭",DIALOGS_PLEASE_WAIT:"Please Wait",DIALOGS_PLEASE_WAIT_ELIPS:"Please Wait...",DIALOGS_PLEASE_WAIT_MSG:"Waiting on operation to complete.",DIALOGS_PERCENT_COMPLETE:"%",DIALOGS_NOTIFICATION:"Notification",DIALOGS_NOTIFICATION_MSG:"Unknown application notification.",DIALOGS_CONFIRMATION:"Confirmation",DIALOGS_CONFIRMATION_MSG:"Confirmation required.",DIALOGS_OK:"确认",DIALOGS_YES:"确认",DIALOGS_NO:"取消"}),s.preferredLanguage("zh-cn")}()}]).run(["$rootScope","$state","$stateParams","authService","$pageTitle","$config","$locale","$injector","$localStorage",function(e,t,a,i,n,s,o,l,r){e.$state=t,e.$stateParams=a,e.$config=s,e.parseInt=parseInt,e.Date=Date,e.ticketParams={},e.app={name:"微盟后台",version:"2.0.2",color:{primary:"#7266ba",info:"#128ED4",success:"#27c24c",warning:"#fad733",danger:"#f05050",light:"#e8eff0",dark:"#3a3f51",black:"#1c2b36"},settings:{themeID:13,navbarHeaderColor:"bg-info1",navbarCollapseColor:"bg-info1",asideColor:"bg-white",headerFixed:!0,asideFixed:!0,asideFolded:!1,asideDock:!1,container:!1}},e.safeApply=function(e){var t=this.$root.$$phase;"$apply"==t||"$digest"==t?e&&"function"==typeof e&&e():this.$apply(e)},function(){e.$watch("app.settings",function(){e.app.settings.asideDock&&e.app.settings.asideFixed&&(e.app.settings.headerFixed=!0),e.app.settings.container?angular.element("html").addClass("bg"):angular.element("html").removeClass("bg"),r.settings=e.app.settings},!0)}(),e.toasterOptions={"position-class":"toast-top-center","time-out":1e3},function(){var e=l.get("localeZh");angular.extend(o,e)}(),function(){e.$on("$stateChangeStart",function(t,a,n){var s=$(".popover");s.length>0&&s.remove();var o=i.fillAuthData();a.name.indexOf("app")>-1?o.isAuth||(console.log("toState.name",a.name),t.preventDefault(),i.removeAuthData()):e.userData_done=!0,e.previousState_name=a.name,e.previousState_params=n}),e.locals=i.fillAuthData()}(),e.$on("$stateChangeSuccess",function(){e.loading_done=!0})}]).constant("$config",{host:{domain:"ngthree.com",www:window.location.host,stc:"stc.ngthree.com",api:"/api",api2:"/api2",api3:"/api3",apiVip:"/apiVip",apiSMS:"/apiSMS"},dateformat:"yyyy-MM-dd hh:mm",dateformatdd:"yyyy-MM-dd",debug:!1,test_token:"",site:{name:"微盟后台"},api3:{user:{login:"/user/login",detail:"/user/detail",list:"/user/lists",add:"/user/add",current:"/user/current",logout:"/user/logout",del:"/user/del",alt:"/user/alt",rolelist:"/user/rolelist",changepwd:"/user/changepwd",agent:"/user/getAgentInfo",merchant:"/user/getClientInfo",users:"/user/users",statinfo:"/stat/getUserStatInfo",getCode:"/user/sendverifycode",binding:"/user/verifycode",agentinfo:"/ticketweimob/getClientInfoByUsername",binfo:"/business/lists",binfoedit:"/business/alt",binfodel:"/business/del"},weimob:{publics:"/index.php?c=account&m=index",publicDetail:"/index.php?c=home&m=index",updateKFFloat:"/index.php?c=account&m=updateKFFloat",isupdatepwd:"/index.php?c=home&m=getBusinessInfo",appcenterExist:"/index.php?c=appcenter&m=getAppList",appcenter:"/index.php?c=appcenter&m=getMyAppList",getCode:"/index.php?c=account&m=verifyByPhone",delPublics:"/index.php?c=account&m=deleteAcountById",getBindingurl:"/index.php?c=Account&m=AuthBind",checkedLogin:"/index.php?c=login&m=checkLoginByKey",navlist:"/index.php?c=menu&m=getMenuList",getBaseInfo:"/index.php?c=home&m=getAccountBaseInfo",updateMenu:"/index.php?c=appcenter&m=updateMenuList",publicCombo:"",feedback:"/index.php?c=Account&m=feedback",changeCode:"/index.php?c=validation&m=index&f=feedback"},admin:{getActivity:"/common/getactivity",getBusiness:"/common/business"},card:{spoutletList:"/index.php?c=spfood&m=Getspoutlets",Getspheader:"/index.php?c=spfood&m=Getspheader",getRelatedServiceList:"/index.php?c=Wmbusinessapi&m=getRelatedServiceList",getRelatedServiceId:"/index.php?c=Wmbusinessapi&m=getRelatedServiceId"},upload:{upfile:"/api3/index.php?c=oss&m=index"}},apiSMS:{list:"/list"},apiVip:{card:{GetMemberTemplate:"/GetMemberTemplate",OpenSyncToWX:"/OpenSyncToWX",UpdateMemberTemplate:"/UpdateMemberTemplate",CreateMemberTemplate:"/CreateMemberTemplate",SaveMemberCardLeveSet:"/SaveMemberCardLeveSet",GetMemberCardLevelSet:"/GetMemberCardLevelSet",ExportMemberInfoList:"/ExportMemberInfoList",GetLastMemberExportLog:"/GetLastMemberExportLog",GetMemberCardTag:"/GetMemberCardTag",GetMemberCardPrivilegeNotePageListAndTotal:"/GetMemberCardPrivilegeNotePageListAndTotal",GetMemberCardSet:"/GetMemberCardSet",SaveMemberCardSet:"/SaveMemberCardSet",SaveMemberCardPrivilegeNote:"/SaveMemberCardPrivilegeNote",GetMemberCardUrlInfo:"/GetMemberCardUrlInfo",DeletePrivilegeNote:"/DeletePrivilegeNote",GetMemberCardPrivilegeNote:"/GetMemberCardPrivilegeNote",GetMemberInfoPagelistAndTotal:"/GetMemberInfoPagelistAndTotal",GetMemberInfoPagelistAndTotalByTagId:"/GetMemberInfoPagelistAndTotalByTagId",GetMemberCardTagsPageListAndTotal:"/GetMemberCardTagsPageListAndTotal",DeleteMemberCardTag:"/DeleteMemberCardTag",SaveMemberCardTag:"/SaveMemberCardTag",DealMemberTag:"/DealMemberTag",ChangeMemberLevel:"/ChangeMemberLevel",ClearMemberPoints:"/ClearMemberPoints",OpenOrCloseMember:"/OpenOrCloseMember",RechargeForAdmin:"/RechargeForAdmin",ConsumeForAdmin:"/ConsumeForAdmin",GetConsumingLog:"/GetConsumingLog",GetMemberCouponPageListAndTotal:"/GetMemberCouponPageListAndTotal",GetCouponTemplatePageListAndTotal:"/GetCouponTemplatePageListAndTotal",GetMemberCouponGetListAndTotal:"/GetMemberCouponGetListAndTotal",ChangeMemberPoints:"/ChangeMemberPoints",GetMemberInfo:"/GetMemberInfo",SaveMemberInfo:"/SaveMemberInfo",GetConsumingLogPageListAndTotal:"/GetConsumingLogPageListAndTotal",GetRechargeLogPageListAndTotal:"/GetRechargeLogPageListAndTotal",GetPointsLogPageListAndTotal:"/GetPointsLogPageListAndTotal",GetOffLineMemberInfoPageListAndTotal:"/GetOffLineMemberInfoPageListAndTotal",DeleteOfflineMemberInfoByPhoneList:"/DeleteOfflineMemberInfoByPhoneList",AddOfflineMemberInfo:"/AddOfflineMemberInfo",GetMemberCardPointsRule:"/GetMemberCardPointsRule",SaveMemberCardPointsRule:"/SaveMemberCardPointsRule",GetMemberCardRecommendPageListAndTotal:"/GetMemberCardRecommendPageListAndTotal",DeleteMemberCardRecommend:"/DeleteMemberCardRecommend",DeleteMemberCardRecommendList:"/DeleteMemberCardRecommendList",DeleteMemberCardSolicitudeList:"/DeleteMemberCardSolicitudeList",GetMemberCardRecommend:"/GetMemberCardRecommend",SaveMemberCardRecommend:"/SaveMemberCardRecommend",GetMemberCardBroadcastPageListAndTotal:"/GetMemberCardBroadcastPageListAndTotal",DeleteMemberCardBroadcast:"/DeleteMemberCardBroadcast",DeleteMemberCardBroadcastList:"/DeleteMemberCardBroadcastList",SaveMemberCardBroadcast:"/SaveMemberCardBroadcast",GetMemberCardBroadcast:"/GetMemberCardBroadcast",GetMemberCardActivationGivingPageListAndTotal:"/GetMemberCardActivationGivingPageListAndTotal",DeleteMemberCardActivationGiving:"/DeleteMemberCardActivationGiving",DeleteMemberCardActivationGivingList:"/DeleteMemberCardActivationGivingList",SaveMemberCardActivationGiving:"/SaveMemberCardActivationGiving",GetMemberCardActivationGiving:"/GetMemberCardActivationGiving",GetMemberCardCostGivingPageListAndTotal:"/GetMemberCardCostGivingPageListAndTotal",DeleteMemberCardCostGivingList:"/DeleteMemberCardCostGivingList",GetMemberCardCostGiving:"/GetMemberCardCostGiving",SaveMemberCardCostGiving:"/SaveMemberCardCostGiving",GetMemberCardRechargeGivingPageListAndTotal:"/GetMemberCardRechargeGivingPageListAndTotal",DeleteMemberCardRechargeGivingList:"/DeleteMemberCardRechargeGivingList",GetMemberCardRechargeGiving:"/GetMemberCardRechargeGiving",SaveMemberCardRechargeGiving:"/SaveMemberCardRechargeGiving",GetMemberCardSolicitudePageListAndTotal:"/GetMemberCardSolicitudePageListAndTotal",OpenOrCloseMemberCardSolicitude:"/OpenOrCloseMemberCardSolicitude",GetMemberCardSolicitude:"/GetMemberCardSolicitude",SaveMemberCardSolicitude:"/SaveMemberCardSolicitude",SaveMemberCouponTemplate:"/SaveMemberCouponTemplate",GetMemberCouponTemplate:"/GetMemberCouponTemplate",DeleteOrRecoverMemberCouponTemplate:"/DeleteOrRecoverMemberCouponTemplate",UseMemberCoupon:"/UseMemberCoupon",GetMemberCardConsumeStatistics:"/GetMemberCardConsumeStatistics",GetMemberCardRechargeStatistics:"/GetMemberCardRechargeStatistics",GetMemberCardPointsStatistics:"/GetMemberCardPointsStatistics",GetOtherBusinessPageListAndTotal:"/GetOtherBusinessPageListAndTotal",GetOtherBusiness:"/GetOtherBusiness",SaveOhterBusiness:"/SaveOhterBusiness",DeleteOtherBusiness:"/DeleteOtherBusiness",UpdateMemberRemarkName:"/UpdateMemberRemarkName",GetAddMemberStatistics:"/GetAddMemberStatistics",GetMoveOldMemberCard:"/GetMoveOldMemberCard",IsHaveOldMemberCard:"/IsHaveOldMemberCard",MoveOldMemberCard:"/MoveOldMemberCard",UpdateMemberHeadUrl:"/UpdateMemberHeadUrl",ResetMemberExpireDateInfo:"/ResetMemberExpireDateInfo"}},navlist:[{name:"我的微盟",item:[{name:"公众号管理",id:"publicmanage",angular:"1",isself:1,icon:"wmfont wm-weixin",url:"app.public.list"},{name:"支付方式管理",id:"paymanage",angular:"0",isself:1,icon:"wmfont wm-paycircle",url:window.env.prefix+"/payment/lists"},{name:"服务窗账号管理",id:"account",isself:1,angular:"0",icon:"wmfont wm-rectangle390",url:window.env.prefix+"/AlipayFuwu/Alipay/BundFuwu"},{name:"增值服务",id:"service",isself:1,angular:"0",icon:"wmfont wm-zengzhifuwuicon",url:window.env.prefix+"/wechat/service"},{name:"商户信息",id:"businessInfo",isself:1,angular:"0",icon:"wmfont wm-zhanghuxinxi",url:window.env.prefix+"/wechat/user"}]},{name:"账号日志",item:[{name:"角色管理",id:"role",isself:1,angular:"0",icon:"wmfont wm-iconfontjiaoseguanli",url:window.env.prefix+"/power/role/indexPage"},{name:"账户管理",id:"accountmanage",isself:1,angular:"0",icon:"wmfont wm-zhanghuguanli",url:window.env.prefix+"/power/user/indexPage"},{name:"客服工号管理",id:"manage",angular:"0",isself:1,icon:"wmfont wm-shop-cservice",url:window.env.prefix+"/Business/AccountList"},{name:"查看日志",id:"log",isself:1,angular:"0",icon:"wmfont wm-rizhichaxun",url:window.env.prefix+"/log/index"}]},window.hideMenu]}),angular.module("ngTicket").run(["$templateCache",function(e){e.put("/app/app.html",'<div data-ng-include="\'/app/blocks/header.html\'" class="app-header navbar"></div><div data-ng-include="\'/app/blocks/aside.html\'" class="app-aside hidden-xs {{app.settings.asideColor}}"></div><div class="app-content"><a href="" class="off-screen-toggle hide" ui-toggle-class="off-screen" data-target=".app-aside"></a><div class="app-content-body app-content-full fade-in-up overflow" ui-view=""></div></div><div id="feedback_btn"><a href="http://crm2.qq.com/page/portalpage/wpa.php?uin=4006305400&f=1&ty=1&aty=0&a=&from=5" target="_blank" class="tile-themed" title="联系客服"><i class="wmfont wm-liaotianxuanzhongtubiao01"></i></a> <a href="javascript:;" title="反馈建议" class="tile-themed" ng-click="feedbackContent()"><i class="wmfont wm-bianji"></i></a></div>'),e.put("/app/access/reset.password.model.html",'<form class="form-horizontal" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="modal-header"><button type="button" class="close" ng-click="cancel()">&times;</button><h4 class="modal-title">修改密码</h4></div><div class="modal-body"><div class="form-group"><label class="col-sm-2 control-label must">手机号码</label><div class="col-sm-7"><input type="text" class="form-control" data-rule-required="true" data-rule-maxlength="24" ng-model="entity.mobile" name="mobile"></div></div><div class="form-group"><label class="col-sm-2 control-label must">验证码：</label><div class="col-sm-3"><input type="text" class="form-control" ng-model="entity.code" data-rule-required="true"></div><div class="col-sm-4"><button type="button" ng-disabled="psdisabled" class="btn btn-default btn-sm" ng-click="sendCode()">{{btnText}}</button></div></div><div class="form-group"><label class="col-sm-2 control-label must">新密码</label><div class="col-sm-7"><input type="password" class="form-control" ng-model="entity.password" data-rule-required="true" data-rule-rangelength="[6,20]" id="password" name="password"></div></div></div><div class="modal-footer"><button type="submit" class="btn btn-primary" btn-loading="saveloading" loading-text="保存中...">保存</button> <button type="button" class="btn btn-default" ng-click="cancel()">取消</button></div></form>'),e.put("/app/access/signin.html",'<div class="container w-xxxl w-auto-xs" ng-init="app.settings.container = false;"><a class="navbar-brand block m-t" href="">{{app.name}}</a><div class="m-b-lg"><section class="panel panel-default bg-white m-t-lg"><header class="panel-heading text-center"><strong>登录</strong></header><form class="panel-body" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="form-group"><label class="control-label">邮箱</label> <input class="form-control input-lg" data-rule-required="true" id="email" name="email" ng-model="loginData.email" placeholder="Email" type="text"></div><div class="form-group"><label class="control-label">密码</label> <input class="form-control input-lg" data-rule-required="true" id="password" name="password" ng-disabled="psdisabled" ng-model="loginData.password" placeholder="Password" type="password"></div><div id="login_captcha" class="m-t-md"></div><div class="checkbox"><label><input ng-model="loginData.remember" type="checkbox"> 记住我的登录信息</label></div><button btn-loading="loginloading" class="btn btn-primary" loading-text="登录中..." ng-disabled="psdisabled" type="submit">登录</button></form></section></div></div>'),e.put("/app/access/signup.html",'<section id="content" class="m-t-lg wrapper-md animated fadeInDown"><div class="container aside-xxl"><a class="navbar-brand block" href="index.html">Notebook</a><section class="panel panel-default m-t-lg bg-white"><header class="panel-heading text-center"><strong>Sign up</strong></header><form class="panel-body wrapper-lg" ng-submit="signup()"><div class="form-group"><label class="control-label">邮箱</label> <input type="email" class="form-control input-lg" ng-model="entity.email"></div><div class="form-group"><label class="control-label">密码</label> <input type="password" class="form-control input-lg" ng-model="entity.password"></div><div class="form-group"><label class="control-label">确认密码</label> <input type="password" class="form-control input-lg" ng-model="entity.confirmPassword"></div><div class="checkbox"><label><input type="checkbox" checked="checked">我已阅读并接受 <a href="javascript:;">《微盟用户协议》</a></label></div><button type="submit" class="btn btn-primary" btn-loading="signuploading" loading-text="注册中...">Sign up</button><div class="line line-dashed"></div><p class="text-muted text-center"><small>Already have an account?</small></p><a href="javasrcript:;" ui-sref="access.signin" class="btn btn-default btn-block">Sign in</a></form></section></div></section><footer id="footer"><div class="text-center padder clearfix"><p><small>Web app framework base on Bootstrap<br>&copy; 2014</small></p></div></footer>'),e.put("/app/appcenter/appcenter.list.html",'<section class="hbox stretch vbox"><section class="vbox"><header class="header bg-white b-b clearfix"><p>应用中心</p></header><section class="scrollable wrapper"><div class="load" ng-if="loadNavloading">数据加载中...</div><section class="panel panel-default" ng-if="!loadNavloading"><div class="panel-body form-horizontal"><div><h5 class="b-b wrapper-b-sm">已购买的应用</h5><ul class="list-unstyled overflow clearfix m-t wrapper-l-sm"><li class="pull-left w h-size75 overflow m-r m-b" ng-repeat="item in applistExist"><a ng-href="{{item.serviceUrl}}" target="_blank"><img ng-src="{{item.serviceSmallIconUrl}}" class="pull-left m-r-sm img-rounded" alt="..." style="width:75px;height:75px"></a> <span class="h4 block m-t-sm fontsize16 apostrophe" title="{{item.name}}"><a ng-href="{{item.serviceUrl}}" target="_blank">{{item.name}}</a></span> <span class="block m-t-sm"><a href="{{item.appRedirectUrl}}" class="btn btn-sm btn-info" style="padding:5px 15px" target="_blank">立即使用</a></span></li><li class="pull-left w-smd h-size75 overflow m-r m-b-sm"><a href="http://fuwu.weimob.com/" class="add-app-btn block text-center img-rounded" target="_blank"><i class="fa fa-plus m-r-xs fa-lg"></i>添加更多应用</a></li></ul></div><h5 class="b-b wrapper-b-sm" ng-if="!loadNavloading" ng-repeat-start="list in applist"><a href="#{{list.id}}" id="{{list.id}}">{{list.name}}</a><span>（{{list.addcount}}/{{list.totalcount}}）</span></h5><ul class="list-unstyled overflow clearfix m-t wrapper-l-sm" ng-repeat-end=""><li class="pull-left w h-size75 overflow m-r m-b" ng-repeat="item in list.datalist"><a ng-href="{{item.url}}" target="_blank"><img ng-src="{{item.img}}" class="pull-left m-r-sm" alt="..." style="width:75px;height:75px"></a> <span class="h4 block m-t-sm fontsize16 apostrophe" title="{{item.name}}"><a ng-href="{{item.url}}" target="_blank">{{item.name}}</a></span> <span class="block m-t" ng-if="item.isadd==1"><button type="button" class="btn btn-xs w-xxs btn-custom btn-custom-del" ng-click="delMenu(item,list)">移除</button></span> <span class="block m-t" ng-if="item.isadd==0"><button type="button" class="btn btn-xs w-xxs btn-custom" ng-click="addMenu(item,list)">添加</button></span></li></ul></div></section></section></section></section>'),e.put("/app/appcenter/appcenter.model.binding.html",'<form class="form-horizontal" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="modal-header"><button type="button" class="close" ng-click="cancel()">&times;</button><h4 class="modal-title"><i class="fa fa-search m-r-xs"></i>提示</h4></div><div class="modal-body"><div class="form-group"><div class="col-sm-10 col-sm-offset-1"><p class="form-control-static" style="font-size: 16px;" ng-if="entity.tips!=\'open\'">你即将前往微信的页面进行公众号授权登录，请确认页面网址为<br>http://mp.weixin.qq.com<br></p><p class="form-control-static" style="font-size: 16px;" ng-if="entity.tips==\'open\'">系统检测到您的微信公众号暂未授权，为保证您以后能更好的运营该公众号，请您进行授权绑定操作</p></div></div></div><div class="modal-footer"><label ng-if="entity.tips==\'open\'" class="checkbox-inline pull-left" style="margin-left: 15px"><input type="checkbox" ng-click="bindingTips($event)">不再提醒</label> <a class="btn btn-primary" href="{{entity.url}}" ng-click="cancel()" target="_blank">授权绑定</a></div></form>'),e.put("/app/appcenter/appcenter.model.del.html",'<form class="form-horizontal" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="modal-header"><button type="button" class="close" ng-click="cancel()">&times;</button><h4 class="modal-title">删除公众号</h4></div><div class="modal-body"><div class="form-group"><label class="col-sm-2 control-label">手机号码</label><div class="col-sm-7"><p class="form-control-static" ng-model="entity.phone">{{entity.phone}}</p></div></div><div class="form-group"><label class="col-sm-2 control-label must">验证码：</label><div class="col-sm-3"><input type="text" class="form-control" ng-model="entity.code" data-rule-required="true"></div><div class="col-sm-4"><button type="button" ng-disabled="psdisabled" class="btn btn-default btn-sm" ng-click="getCode()">{{btnText}}</button></div></div></div><div class="modal-footer"><button type="submit" class="btn btn-primary" btn-loading="saveloading" loading-text="保存中...">保存</button> <button type="button" class="btn btn-default" ng-click="cancel()">取消</button></div></form>'),e.put("/app/appcenter/appcenter.model.del.tips.html",'<form class="form-horizontal" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="modal-header"><button type="button" class="close" ng-click="cancel()">&times;</button><h4 class="modal-title">删除公众号</h4></div><div class="modal-body"><div class="form-group"><div class="col-sm-10 col-sm-offset-1"><p class="form-control-static" style="font-size: 16px;">您的微盟支付处于开通状态，请先联系audit@weimob.com关闭微盟支付</p></div></div></div><div class="modal-footer"><button type="button" class="btn btn-default" ng-click="cancel()">关闭</button></div></form>'),e.put("/app/appcenter/appcenter.model.one.html",'<form class="form-horizontal" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="modal-header"><button type="button" class="close" ng-click="cancel()">&times;</button><h4 class="modal-title"><i class="fa fa-search m-r-xs"></i>{{entity.title}}</h4></div><div class="modal-body" style="height:250px;overflow: hidden;overflow-y: auto"><div class="form-group"><div class="col-sm-10 col-sm-offset-1"><p class="form-control-static" style="font-size: 16px;overflow-x: hidden" ng-bind-html="entity.text"></p></div></div></div><div class="modal-footer"><a class="btn btn-default" ng-click="cancel()">关闭</a> <a class="btn btn-primary" ng-click="cancelAll()" ui-sref="app.iframes({url:\'notices\',params:entity.aid,subparams:entity.id})">查看详情</a></div></form>'),e.put("/app/appcenter/appcenter.model.two.html",'<form class="form-horizontal" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="modal-header"><button type="button" class="close" ng-click="cancel()">&times;</button><h4 class="modal-title"><i class="fa fa-search m-r-xs"></i>版本升级VIP通道</h4></div><div class="modal-body"><div class="form-group"><div class="col-sm-10 col-sm-offset-1"><p class="form-control-static" style="font-size: 16px;">18万盟友选择升级增强版，丰富功能及小插件即刻解决您的需求；<br>30万盟友选择升级行业版，全面的行业一体化解决方案让您无忧。<br>微信营销，如此简单。</p></div></div></div><div class="modal-footer"><div class="pull-left m-t-xs m-l-sm">VIP专线：<span style="color:#0000ff">10105188</span></div><a class="btn btn-default" href="http://www.weimob.com/site/package" target="_blank">各版本功能查询</a> <a class="btn btn-primary" href="http://wpa.b.qq.com/cgi/wpa.php?ln=1&amp;key=XzkzODAzNTg5Ml8xNzQzNTNfNDAwNjMwNTQwMF8yXw" target="_blank">VIP在线咨询</a></div></form>'),e.put("/app/appcenter/appcenter.upgrade.model.html",'<form class="form-horizontal" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="modal-header"><button type="button" class="close" ng-click="cancel()">&times;</button><h4 class="modal-title"><i class="fa fa-search m-r-xs"></i>版本升级VIP通道</h4></div><div class="modal-body"><div class="form-group"><div class="col-sm-10 col-sm-offset-1"><p class="form-control-static" style="font-size: 16px;">18万盟友选择升级增强版，丰富功能及小插件即刻解决您的需求；<br>30万盟友选择升级行业版，全面的行业一体化解决方案让您无忧。<br>微信营销，如此简单。</p></div></div></div><div class="modal-footer"><div class="pull-left m-t-xs m-l-sm">VIP专线：<span style="color:#0000ff">10105188</span></div><a class="btn btn-default" href="http://www.weimob.com/website/site/package" target="_blank">各版本功能查询</a> <a class="btn btn-primary" href="http://crm2.qq.com/page/portalpage/wpa.php?uin=4006305400&f=1&ty=1&aty=0&a=&from=5" target="_blank">VIP在线咨询</a></div></form>'),e.put("/app/appcenter/public.list.html",'<section class="hbox stretch vbox"><section class="vbox"><header class="header bg-white b-b clearfix"><p>公众号管理</p></header><section class="scrollable wrapper"><div class="load" ng-if="pageLoading">数据加载中...</div><section class="panel panel-default" ng-if="!pageLoading"><div class="panel-body form-horizontal"><h4 class="b-b wrapper-b-sm text-info">已绑定的公众号</h4><ul class="list-unstyled overflow clearfix m-t"><li class="pull-left w-smd h-smd m-r m-b-sm bg-light lt pos-rlt" ng-repeat="item in entity.plcaccountlist"><span class="block text-center m-t"><a href="javascript:;" ui-sref="app.public.detail({aid:item.id})"><img ng-src="{{item.avatar_url}}" alt="..." class="img-circle" style="width:65px;height:65px"></a></span><div class="wrapper-l-sm wrapper-r-sm"><span class="h5 block m-t-sm text-center wrapper-b-sm b-b apostrophe" title="{{item.plc_name}}">{{item.plc_name}}</span></div><div class="wrapper-sm overflow"><div class="pull-left text-muted">套餐</div><div class="text-right">{{item.service_name}}<a href="javascript:;" class="text-info m-l-xs" ng-click="upgradeService()"><i class="fa fa-long-arrow-up"></i>升级</a></div></div><div class="wrapper-sm no-tpadder no-bpadder overflow"><div class="pull-left text-muted">客服悬窗</div><div class="pull-right"><label class="i-switch bg-info"><input type="checkbox" ng-click="serviceSwitch(item,$event)" ng-if="item.kf_float==1" ng-checked="item.kf_float==1"> <input type="checkbox" ng-click="serviceSwitch(item,$event)" ng-if="item.kf_float==0"> <i></i></label></div></div><div class="text-center m-t-sm wrapper-l-sm wrapper-r-sm"><a href="javascript:;" ui-sref="app.public.detail({aid:item.id})" class="btn btn-info btn-sm w-full">进入公众号平台</a></div><div class="text-info pos-abt text-lg" style="top:0;right:10px"><div class="dropdown" dropdown=""><a href="javascript:;" dropdown-toggle=""><strong>…</strong></a><ul class="dropdown-menu mn70" role="menu"><li><a ui-sref="app.iframes({url:\'editaccount\',params:item.id})">编辑</a></li><li><a href="javascript:;" ng-click="delPublic(item,entity.businessInfo.mobile)">删除</a></li></ul></div></div></li><li class="pull-left w-smd h-smd m-r m-b-sm bg-light lt pos-rlt" ng-if="entity.businessInfo.rest_count>0"><span class="block text-center m-t-lg"><img src="http://stc.home.weimob.cn/assets/images/addgzh.png" alt="..." class="img-circle" style="width:65px;height:65px"></span><div class="text-center wrapper-xs m-t-sm" style="font-size:12px">您还可以绑定<span class="m-xs">{{entity.businessInfo.rest_count}}</span>个公众号</div><div class="text-center m-t-lg wrapper-l-sm wrapper-r-sm"><button type="button" class="btn btn-info btn-sm" style="width:120px" ng-click="bindingPulic()">授权绑定</button></div><div class="text-center m-t-sm wrapper-l-sm wrapper-r-sm"><a href="javascript:;" class="text-info" ui-sref="app.iframes({url:\'manualbinding\',params:\'\'})">手动绑定</a></div></li></ul></div></section></section></section></section>'),e.put("/app/blocks/aside.html",'<div class="aside-wrap" style="border-right: 1px solid #DEE5E7"><div class="navi-wrap"><nav ui-nav="" class="navi clearfix" ng-include="\'/app/blocks/nav.html\'"></nav></div></div>'),e.put("/app/blocks/blocks.feedback.model.html",'<form class="form-horizontal" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="modal-header"><button type="button" class="close" ng-click="cancel()">&times;</button><h4 class="modal-title">反馈建议</h4></div><div class="modal-body"><div class="form-group"><div class="col-sm-12">亲爱的用户<br>欢迎您访问微盟官方网站！您对微盟有任何意见和建议，或在使用过程中遇到问题，请在本页面反馈。我们会实时关注您的反馈不断优化，您的建议将帮助我们改进，为您提供更好的服务！</div></div><div class="form-group"><div class="col-sm-12"><label for="exampleInputEmail1"><strong>请留下您的宝贵意见和建议！（请填写）</strong></label> <textarea class="form-control" rows="5" id="exampleInputEmail1" ng-model="entity.feedback" name="exampleInputEmail1" data-rule-required="true" placeholder="输入文本..."></textarea></div></div><div class="form-group"><div class="col-sm-12"><label for="email">您常用的电子邮箱是？（请填写）<br>*请尽量填写，以便我们尽快回复您！</label> <input class="form-control" id="email" name="email" data-rule-required="true" data-rule-email="true" ng-model="entity.email" placeholder="如：...@163.com"></div></div><div class="form-group"><div class="col-sm-12"><label for="code">请输入下图中的字符：</label> <input class="form-control" id="code" name="code" data-rule-required="true" placeholder="" ng-model="entity.captcha"> <span class="help-block m-t-xs pointer" ng-click="changeCode()"><img ng-src="{{codeImg}}"></span></div></div></div><div class="modal-footer"><button type="submit" class="btn btn-primary" btn-loading="saveloading" loading-text="保存中...">保存</button> <button type="button" class="btn btn-default" ng-click="cancel()">取消</button></div></form>'),e.put("/app/blocks/blocks.pwdtips.model.html",'<form class="form-horizontal" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="modal-header"><button type="button" class="close" ng-click="cancel()">&times;</button><h4 class="modal-title"><i class="fa fa-search m-r-xs"></i>提示</h4></div><div class="modal-body"><div class="form-group"><div class="col-sm-10 col-sm-offset-1"><p class="form-control-static" style="font-size: 16px;">尊敬的商户，您好！经我们的安全监测，您的密码安全度较低。为了确保您的信息安全，建议您对您的密码进行修改。</p></div></div></div><div class="modal-footer"><a class="btn btn-danger" ng-click="cancel()" ui-sref="app.iframes({url:\'modifypwd\',params:\'\'})">立即修改</a> <button type="button" class="btn btn-default" ng-click="cancel()">下次再说</button></div></form>'),e.put("/app/blocks/header.html",'<div class="navbar-header {{app.settings.navbarHeaderColor}}"><button class="pull-right visible-xs dk" ui-toggle-class="show" data-target=".navbar-collapse"><i class="fa fa-cog"></i></button> <button class="pull-right visible-xs" ui-toggle-class="off-screen" data-target=".app-aside" ui-scroll-to="app"><i class="fa fa-align-justify"></i></button> <a href="#/" class="navbar-brand text-lt"><img src="http://stc.home.weimob.cn/assets/images/wiemoblogo.png" alt="." style="margin-left: 3px;margin-top: -8px;" ng-if="!app.settings.asideFolded"> <img src="http://stc.home.weimob.cn/assets/images/wiemoblogo2.png" alt="." style="margin-left: 3px;margin-top: -8px;" ng-if="app.settings.asideFolded"></a></div><div class="collapse pos-rlt navbar-collapse box-shadow {{app.settings.navbarCollapseColor}}"><div class="nav navbar-nav hidden-xs"><a href="" class="btn no-shadow navbar-btn navbar-btn-white-custom" ng-click="app.settings.asideFolded = !app.settings.asideFolded"><i class="fa {{app.settings.asideFolded ? \'fa-indent\' : \'fa-dedent\'}} fa-fw"></i></a></div><ul class="nav navbar-nav hidden-sm hidden-xs header-navbar-nav" ng-if="headerMenuShow==1"><li class="dropdown" dropdown="" ng-class="{active:$state.includes(\'app.public.list\')}"><a href="javascript:;" ui-sref="app.public.list"><span>我的微盟</span></a></li><li><a href="{{domainprefix}}/website/products_index.html" target="_blank"><span>功能介绍</span></a></li><li><a href="http://bbs.weimob.com" target="_blank"><span>微盟社区</span></a></li><li ng-if="businessBaseInfo.ismengju==\'1\'"><a href="{{businessBaseInfo.mengjuurl}}" target="_blank"><span>盟聚广告</span></a></li><li><a href="{{businessBaseInfo.o2ourl}}" target="_blank"><span>智慧餐厅</span></a></li><li><a href="http://fuwu.weimob.com/" target="_blank"><span>服务市场</span></a></li></ul><ul class="nav navbar-nav hidden-sm hidden-xs header-navbar-nav" ng-if="headerMenuShow==2"><li class="dropdown" dropdown="" ng-class="{active:$state.includes(\'app.public.list\')}" ng-if="!subaid"><a href="javascript:;" ui-sref="app.public.list"><span>我的微盟</span></a></li><li ng-class="{active:$state.includes(\'app.public.detail\')}"><a href="javascript:;" ui-sref="app.public.detail({aid:getaid})"><span>公众号</span></a></li><li ng-class="{active:$state.includes(\'app.appcenter\')}"><a href="javascript:;" ui-sref="app.appcenter({aid:getaid})" style="padding-right: 25px"><span>应用中心</span> <img src="http://stc.home.weimob.cn/assets/images/Newicon.png" class="appcenter-new-icon" style="position: absolute;top:2px;right:5px"></a></li><li><a href="{{domainprefix}}/website/site/help" target="_blank"><span>使用指南</span></a></li><li><a href="http://bbs.weimob.com" target="_blank"><span>微盟社区</span></a></li><li ng-if="businessBaseInfo.ismengju==\'1\'"><a href="{{businessBaseInfo.mengjuurl}}" target="_blank"><span>盟聚广告</span></a></li></ul><ul class="nav navbar-nav navbar-right nav-bar-custom" style="height:50px"><li class="hidden-xs" title="微盟首页"><a href="http://www.weimob.com" target="_blank" class="height50"><img src="http://stc.home.weimob.cn/assets/images/icons/home.png" style="height:22px;margin-top: -5px"></a></li><li class="dropdown" dropdown="" title="微盟APP"><a href="javascript:;" dropdown-toggle="" class="height50"><img src="http://stc.home.weimob.cn/assets/images/icons/app.png" style="height:22px;margin-top: -5px"></a><ul class="dropdown-menu" role="menu"><li class="w text-center"><div><img src="http://stc.home.weimob.cn/assets/images/weimobapp.jpg" class="w-smd"></div><div style="color:#333">下载微盟APP，让商业更高效</div></li></ul></li><li class="dropdown" dropdown="" title="关注微盟智库"><a href="javascript:;" dropdown-toggle="" class="height50"><img src="http://stc.home.weimob.cn/assets/images/icons/code.png" style="height:22px;margin-top: -5px"></a><ul class="dropdown-menu" role="menu"><li class="w text-center"><div><img src="http://stc.home.weimob.cn/assets/images/weimobcode.jpg" class="w-smd"></div><div style="color:#333">关注微盟智库，了解产品动态</div></li></ul></li><li class="hidden-xs" title="联系客服"><a href="http://crm2.qq.com/page/portalpage/wpa.php?uin=4006305400&f=1&ty=1&aty=0&a=&from=5" class="height50" target="_blank"><img src="http://stc.home.weimob.cn/assets/images/icons/service.png" style="height:22px;margin-top: -5px"></a></li><li class="dropdown" dropdown="" ng-if="headerMenuShow==1"><a href="" class="dropdown-toggle clear" dropdown-toggle=""><span class="thumb-sm avatar pull-right m-t-n-sm m-b-n-sm m-l-sm"><img src="http://stc.home.weimob.cn/assets/images/business.png" alt="..."></span> <span class="hidden-sm hidden-md">{{businessBaseInfo.username?businessBaseInfo.username:"测试"}}</span> <b class="caret"></b></a><ul class="dropdown-menu animated fadeInRight w"><li><a href="javascript:;" ui-sref="app.iframes({url:\'userInfo1\',params:\'\'})"><span>商户信息</span></a></li><li><a href="javascript:;" ui-sref="app.iframes({url:\'modifypwd\',params:\'\'})"><span>修改密码</span></a></li><li><a href="http://www.weimob.com/website/site/help" target="_blank"><span>帮助中心</span></a></li><li class="divider"></li><li><a href="javascript:;" ui-sref="app.iframes({url:\'logout\',params:\'\'})">退出</a></li></ul></li><li class="dropdown" dropdown="" ng-if="headerMenuShow==2"><a href="" class="dropdown-toggle clear" dropdown-toggle=""><span class="thumb-sm avatar pull-right m-t-n-sm m-b-n-sm m-l-sm"><img ng-src="{{accountBaseInfo.avatar_url|| \'http://stc.home.weimob.cn/assets/images/business.png\'}}" alt="..."></span> <span class="hidden-sm hidden-md apostrophe block pull-left" style="max-width:200px" title="{{accountBaseInfo.plc_name}}">{{accountBaseInfo.plc_name?accountBaseInfo.plc_name:"测试公众号"}}</span> <b class="caret"></b></a><ul class="dropdown-menu animated fadeInRight w"><li><a href="javascript:;" ui-sref="app.public.detail({aid:accountBaseInfo.aid})"><span>账户信息</span></a></li><li class="divider"></li><li><a href="javascript:;" ui-sref="app.iframes({url:\'logout\',params:\'\'})">退出</a></li></ul></li></ul></div>'),e.put("/app/blocks/nav.html",'<div class="load" ng-if="menuShow==0">数据加载中...</div><ul class="nav nav-left-white" ng-if="menuShow==1"><li ng-repeat-start="data in navlist" ng-if="!data.status" class="hidden-folded padder m-t m-b-sm text-muted text-xs"><span>{{data.name}}</span></li><li ng-repeat="list in data.item" ng-if="!data.status" class="{{$state.params.url | iframeActive:list.child:list.url:list.id}}" ng-class="{active:$state.includes(list.url)}"><a ng-if="list.url&&list.isself==1&&list.angular==\'0\'" ui-sref="app.iframes({url:list.id,params:\'\'})" iframe-reload="" title="{{list.name}}"><i class="{{list.icon}}"></i> <span>{{list.name}}</span></a> <a ng-if="list.url&&list.angular==\'1\'" ui-sref="{{list.url}}" title="{{list.name}}"><i class="{{list.icon}}"></i> <span>{{list.name}}</span></a> <a href="{{list.url}}" ng-if="list.url&&list.isself==0" title="{{list.name}}" class="_blank" target="_blank"><i class="{{list.icon}}"></i> <span>{{list.name}}</span></a> <a ng-if="list.child" href="" class="auto"><span class="pull-right text-muted"><i class="fa fa-fw fa-angle-right text"></i> <i class="fa fa-fw fa-angle-down text-active"></i></span> <i class="{{list.icon}}"></i> <span>{{list.name}}</span></a><ul class="nav nav-sub dk"><li ng-repeat="child in list.child" class="child-menu {{$state.params.url | iframeActive:\'\':child.url:child.id}}"><a ng-if="child.angular==\'0\'&&child.isself==1" ui-sref="app.iframes({url:child.id,params:\'\'})" iframe-reload=""><span>{{child.name}}</span></a> <a ng-if="child.angular==\'1\'" ui-sref="{{child.url}}"><span>{{child.name}}</span></a> <a ng-if="child.isself==0" href="{{child.url}}" class="_blank" target="_blank"><span>{{child.name}}</span></a></li></ul></li><li class="line dk" ng-repeat-end="" ng-if="!data.status"></li></ul><ul class="nav nav-left-white" ng-if="menuShow==2"><li ng-repeat-start="data in navlist" ng-if="!data.status" class="hidden-folded padder m-t m-b-sm text-muted text-xs"><span>{{data.name}}</span></li><li ng-repeat="list in data.item" ng-if="!data.status" class="{{$state.params.url | iframeActive:list.child:list.url:list.id}}" ng-class="{active:$state.includes(list.url)||$state.includes(list.urla)}"><a ng-if="list.url&&list.isself==\'1\'&&list.angular==\'0\'" ui-sref="app.iframes({url:list.id,params:accountBaseInfo.aid})" title="{{list.name}}" iframe-reload=""><i class="wmfont {{list.icon}}"></i> <span>{{list.name}}</span></a> <a ng-if="list.url&&list.angular==\'1\'" ui-sref="{{list.url}}" title="{{list.name}}"><i class="wmfont {{list.icon}}"></i> <span>{{list.name}}</span></a> <a href="{{list.url}}" ng-if="list.url&&list.isself==\'0\'" title="{{list.name}}" class="_blank" target="_blank"><i class="wmfont {{list.icon}}"></i> <span>{{list.name}}</span></a> <a ng-if="list.child" href="" class="auto"><span class="pull-right text-muted"><i class="fa fa-fw fa-angle-right text"></i> <i class="fa fa-fw fa-angle-down text-active"></i></span> <i class="wmfont {{list.icon}}"></i> <span>{{list.name}}</span></a><ul class="nav nav-sub dk nav-left-white"><li ng-repeat="child in list.child" class="child-menu {{$state.params.url | iframeActive:\'\':child.url:child.id}}" ng-class="{active:$state.includes(child.url)||$state.includes(child.urla)}"><a ng-if="child.angular==\'0\'&&child.isself==\'1\'" ui-sref="app.iframes({url:child.id,params:accountBaseInfo.aid})" iframe-reload=""><span>{{child.name}}</span></a> <a ng-if="child.angular==\'1\'" ui-sref="{{child.url}}"><span>{{child.name}}</span></a> <a ng-if="child.isself==\'0\'" href="{{child.url}}" class="_blank" target="_blank"><span>{{child.name}}</span></a></li></ul></li><li title="添加更多应用" class="add-app-btn-nav" style="margin-top: 5px" ng-if="!data.status&&data.totalcount-data.addcount>0"><a ui-sref="app.appcenter({aid:getaid})" class="text-center"><i class="fa fa-plus icon"></i><span class="m-l-xs">添加更多应用</span></a></li><li class="line dk" ng-repeat-end="" ng-if="!data.status"></li></ul>'),e.put("/app/blocks/settings.html",'<button class="btn btn-default no-shadow pos-abt" ui-toggle-class="active" target=".settings"><i class="fa fa-gear"></i></button><div class="panel-heading">Settings</div><div class="wrapper b-t b-light bg-light lter r-b"><div class="row row-sm"><div class="col-xs-6"><label class="i-checks block m-b" ng-click="app.settings.navbarHeaderColor=\'bg-black\'; app.settings.navbarCollapseColor=\'bg-white-only\'; app.settings.asideColor=\'bg-black\';"><input type="radio" name="a" ng-model="app.settings.themeID" value="1"> <span class="block bg-light clearfix pos-rlt"><span class="active pos-abt w-full h-full bg-black-opacity text-center"><i class="glyphicon glyphicon-ok text-white m-t-xs"></i></span> <b class="bg-black header"></b> <b class="bg-white header"></b> <b class="bg-black"></b></span></label> <label class="i-checks block m-b" ng-click="app.settings.navbarHeaderColor=\'bg-dark\'; app.settings.navbarCollapseColor=\'bg-white-only\'; app.settings.asideColor=\'bg-dark\';"><input type="radio" name="a" ng-model="app.settings.themeID" value="13"> <span class="block bg-light clearfix pos-rlt"><span class="active pos-abt w-full h-full bg-black-opacity text-center"><i class="glyphicon glyphicon-ok text-white m-t-xs"></i></span> <b class="bg-dark header"></b> <b class="bg-white header"></b> <b class="bg-dark"></b></span></label> <label class="i-checks block m-b" ng-click="app.settings.navbarHeaderColor=\'bg-white-only\'; app.settings.navbarCollapseColor=\'bg-white-only\'; app.settings.asideColor=\'bg-black\';"><input type="radio" ng-model="app.settings.themeID" value="2"> <span class="block bg-light clearfix pos-rlt"><span class="active pos-abt w-full h-full bg-black-opacity text-center"><i class="glyphicon glyphicon-ok text-white m-t-xs"></i></span> <b class="bg-white header"></b> <b class="bg-white header"></b> <b class="bg-black"></b></span></label> <label class="i-checks block m-b" ng-click="app.settings.navbarHeaderColor=\'bg-primary\'; app.settings.navbarCollapseColor=\'bg-white-only\'; app.settings.asideColor=\'bg-dark\';"><input type="radio" ng-model="app.settings.themeID" value="3"> <span class="block bg-light clearfix pos-rlt"><span class="active pos-abt w-full h-full bg-black-opacity text-center"><i class="glyphicon glyphicon-ok text-white m-t-xs"></i></span> <b class="bg-primary header"></b> <b class="bg-white header"></b> <b class="bg-dark"></b></span></label> <label class="i-checks block m-b" ng-click="app.settings.navbarHeaderColor=\'bg-info\'; app.settings.navbarCollapseColor=\'bg-white-only\'; app.settings.asideColor=\'bg-black\';"><input type="radio" ng-model="app.settings.themeID" value="4"> <span class="block bg-light clearfix pos-rlt"><span class="active pos-abt w-full h-full bg-black-opacity text-center"><i class="glyphicon glyphicon-ok text-white m-t-xs"></i></span> <b class="bg-info header"></b> <b class="bg-white header"></b> <b class="bg-black"></b></span></label> <label class="i-checks block m-b" ng-click="app.settings.navbarHeaderColor=\'bg-success\'; app.settings.navbarCollapseColor=\'bg-white-only\'; app.settings.asideColor=\'bg-dark\';"><input type="radio" ng-model="app.settings.themeID" value="5"> <span class="block bg-light clearfix pos-rlt"><span class="active pos-abt w-full h-full bg-black-opacity text-center"><i class="glyphicon glyphicon-ok text-white m-t-xs"></i></span> <b class="bg-success header"></b> <b class="bg-white header"></b> <b class="bg-dark"></b></span></label> <label class="i-checks block" ng-click="app.settings.navbarHeaderColor=\'bg-danger\'; app.settings.navbarCollapseColor=\'bg-white-only\'; app.settings.asideColor=\'bg-dark\';"><input type="radio" ng-model="app.settings.themeID" value="6"> <span class="block bg-light clearfix pos-rlt"><span class="active pos-abt w-full h-full bg-black-opacity text-center"><i class="glyphicon glyphicon-ok text-white m-t-xs"></i></span> <b class="bg-danger header"></b> <b class="bg-white header"></b> <b class="bg-dark"></b></span></label></div><div class="col-xs-6"><label class="i-checks block m-b" ng-click="app.settings.navbarHeaderColor=\'bg-black\'; app.settings.navbarCollapseColor=\'bg-black\'; app.settings.asideColor=\'bg-white b-r\';"><input type="radio" ng-model="app.settings.themeID" value="7"> <span class="block bg-light clearfix pos-rlt"><span class="active pos-abt w-full h-full bg-black-opacity text-center"><i class="glyphicon glyphicon-ok text-white m-t-xs"></i></span> <b class="bg-black header"></b> <b class="bg-black header"></b> <b class="bg-white"></b></span></label> <label class="i-checks block m-b" ng-click="app.settings.navbarHeaderColor=\'bg-dark\'; app.settings.navbarCollapseColor=\'bg-dark\'; app.settings.asideColor=\'bg-light\';"><input type="radio" name="a" ng-model="app.settings.themeID" value="14"> <span class="block bg-light clearfix pos-rlt"><span class="active pos-abt w-full h-full bg-black-opacity text-center"><i class="glyphicon glyphicon-ok text-white m-t-xs"></i></span> <b class="bg-dark header"></b> <b class="bg-dark header"></b> <b class="bg-light"></b></span></label> <label class="i-checks block m-b" ng-click="app.settings.navbarHeaderColor=\'bg-info dker\'; app.settings.navbarCollapseColor=\'bg-info dker\'; app.settings.asideColor=\'bg-light dker b-r\';"><input type="radio" ng-model="app.settings.themeID" value="8"> <span class="block bg-light clearfix pos-rlt"><span class="active pos-abt w-full h-full bg-black-opacity text-center"><i class="glyphicon glyphicon-ok text-white m-t-xs"></i></span> <b class="bg-info dker header"></b> <b class="bg-info dker header"></b> <b class="bg-light dker"></b></span></label> <label class="i-checks block m-b" ng-click="app.settings.navbarHeaderColor=\'bg-primary\'; app.settings.navbarCollapseColor=\'bg-primary\'; app.settings.asideColor=\'bg-dark\';"><input type="radio" ng-model="app.settings.themeID" value="9"> <span class="block bg-light clearfix pos-rlt"><span class="active pos-abt w-full h-full bg-black-opacity text-center"><i class="glyphicon glyphicon-ok text-white m-t-xs"></i></span> <b class="bg-primary header"></b> <b class="bg-primary header"></b> <b class="bg-dark"></b></span></label> <label class="i-checks block m-b" ng-click="app.settings.navbarHeaderColor=\'bg-info dker\'; app.settings.navbarCollapseColor=\'bg-info dk\'; app.settings.asideColor=\'bg-black\';"><input type="radio" ng-model="app.settings.themeID" value="10"> <span class="block bg-light clearfix pos-rlt"><span class="active pos-abt w-full h-full bg-black-opacity text-center"><i class="glyphicon glyphicon-ok text-white m-t-xs"></i></span> <b class="bg-info dker header"></b> <b class="bg-info dk header"></b> <b class="bg-black"></b></span></label> <label class="i-checks block m-b" ng-click="app.settings.navbarHeaderColor=\'bg-success\'; app.settings.navbarCollapseColor=\'bg-success\'; app.settings.asideColor=\'bg-dark\';"><input type="radio" ng-model="app.settings.themeID" value="11"> <span class="block bg-light clearfix pos-rlt"><span class="active pos-abt w-full h-full bg-black-opacity text-center"><i class="glyphicon glyphicon-ok text-white m-t-xs"></i></span> <b class="bg-success header"></b> <b class="bg-success header"></b> <b class="bg-dark"></b></span></label> <label class="i-checks block" ng-click="app.settings.navbarHeaderColor=\'bg-danger dker bg-gd\'; app.settings.navbarCollapseColor=\'bg-danger dker bg-gd\'; app.settings.asideColor=\'bg-dark\';"><input type="radio" ng-model="app.settings.themeID" value="12"> <span class="block bg-light clearfix pos-rlt"><span class="active pos-abt w-full h-full bg-black-opacity text-center"><i class="glyphicon glyphicon-ok text-white m-t-xs"></i></span> <b class="bg-danger dker header"></b> <b class="bg-danger dker header"></b> <b class="bg-dark"></b></span></label></div></div></div>'),e.put("/app/dashboard/dashboard.html",'<section class="vbox" ui-view=""><header class="header bg-white b-b clearfix"><p>公众号平台</p></header><section class="scrollable padder"><div class="load" ng-if="pageLoading">数据加载中...</div><section class="panel panel-default m-t" ng-if="!pageLoading"><div class="row m-l-none m-r-none bg-light lter"><div class="col-sm-6 col-md-8 padder-v b-r b-light bg-white"><span class="pull-left m-r-sm"><img ng-src="{{entity.baseInfo.avatar_url}}" alt="..." class="img-circle" style="width:100px;height:100px"></span><div class="m-t-sm overflow"><span class="h3 block b-b pull-left wrapper-b-sm"><strong class="pull-left">{{entity.baseInfo.plc_name}}</strong> <small class="m-l-sm pull-left m-t-xs"><span class="label label-default m-r-xs"><a ui-sref="app.iframes({url:\'menuset\',params:entity.baseInfo.aid})">{{entity.baseInfo.account_type}}</a></span> <span class="label label-default m-r-xs"><a ng-if="entity.baseInfo.is_auth">认证商户</a><a ng-if="!entity.baseInfo.is_auth" ui-sref="app.iframes({url:\'unauthorized\',params:entity.baseInfo.aid})">未认证商户</a></span> <a href="javascript:;" class="text-info m-l-xs" style="color:#19a9d5" ng-click="upgradeService()"><i class="fa fa-long-arrow-up"></i>升级</a></small></span></div><div class="m-t-sm"><strong class="text-danger m-r-sm" ng-if="entity.baseInfo.is_bp==0">未授权绑定</strong> <span class="label label-info pointer" ng-if="entity.baseInfo.is_bp==0" ng-click="bindingPulic(entity.baseInfo.aid)">授权绑定</span> <span class="label label-info pointer" ng-if="entity.baseInfo.is_bp==1" ng-click="bindingPulic(entity.baseInfo.aid)">重新授权</span></div></div><div class="col-sm-6 col-md-4 padder-v b-r b-light bg-white"><span class="pull-left m-r-sm" style="width:1px;height:100px;line-height: 0;overflow: hidden"></span> <span class="h3 block m-t-xs">剩余 <span class="text-info m-l-xs m-r-xs" ng-class="{\'text-danger\':entity.baseInfo.remaindays-60<1}">{{entity.baseInfo.remaindays}}</span> 天</span><div class="progress progress-sm m-t m-b-none"><div class="progress-bar progress-bar-info" ng-class="{\'progress-bar-danger\':entity.baseInfo.remaindays-60<1}" role="progressbar" style="width: {{entity.baseInfo.percent}}%;"></div></div><div class="m-t-sm"><span class="text-muted">{{entity.baseInfo.enddays}}到期</span></div></div></div></section><section class="panel panel-default m-t" ng-if="!pageLoading"><div class="row m-l-none m-r-none bg-white wrapper-sm"><strong class="m-l-xs">接口地址：</strong><span>{{entity.baseInfo.openapi}}</span> <strong class="m-l-sm">TOKEN：</strong><span>{{entity.baseInfo.token}}</span> <strong class="m-l-sm">个性域名：</strong><span>{{entity.baseInfo.domain}}</span></div></section><div class="row" ng-if="!pageLoading"><div class="col-md-8 no-rpadder"><section class="panel panel-default"><header class="panel-heading font-bold">公众号数据概况</header><div class="panel-body no-tpadder"><div class="row"><div class="col-xs-3 no-rpadder"><div class="m-t-lg overflow"><div class="bg-info text-center pull-left m-r-sm square30"><i class="fa fa-user-plus fa-md"></i></div><div class="m-t-xs">新增关注数</div></div><div class="overflow m-b m-t"><div class="bg-light dk wrapper-sm"><span class="h3 font-bold m-t-sm block">{{entity.accountstatic.funstoday.subscribe|numberZero}}</span> <small class="text-muted m-t-xs m-b-sm block">今日新增关注数</small></div><div class="bg-light lt wrapper-sm"><div class="m-t-sm b-b wrapper-b-sm"><div class="pull-left">昨天</div><div class="text-right">{{entity.accountstatic.funsyesterday.subscribe|numberZero}}</div></div><div class="m-t-sm b-b wrapper-b-sm"><div class="pull-left">最近7天</div><div class="text-right">{{entity.accountstatic.funssevenday.subscribe|numberZero}}</div></div><div class="m-t-sm wrapper-b-sm"><div class="pull-left">最近30天</div><div class="text-right">{{entity.accountstatic.funsmonthday.subscribe|numberZero}}</div></div></div></div></div><div class="col-xs-3 no-rpadder"><div class="m-t-lg overflow"><div class="bg-info text-center pull-left m-r-sm square30"><i class="fa fa-user-plus fa-md"></i></div><div class="m-t-xs">取消关注数</div></div><div class="overflow m-b-sm m-t"><div class="bg-light dk wrapper-sm"><span class="h3 font-bold m-t-sm block">{{entity.accountstatic.funstoday.unsubscribe|numberZero}}</span> <small class="text-muted m-t-xs m-b-sm block">今日取消关注数</small></div><div class="bg-light lt wrapper-sm"><div class="m-t-sm b-b wrapper-b-sm"><div class="pull-left">昨天</div><div class="text-right">{{entity.accountstatic.funsyesterday.unsubscribe|numberZero}}</div></div><div class="m-t-sm b-b wrapper-b-sm"><div class="pull-left">最近7天</div><div class="text-right">{{entity.accountstatic.funssevenday.unsubscribe|numberZero}}</div></div><div class="m-t-sm wrapper-b-sm"><div class="pull-left">最近30天</div><div class="text-right">{{entity.accountstatic.funsmonthday.unsubscribe|numberZero}}</div></div></div></div></div><div class="col-xs-3 no-rpadder"><div class="m-t-lg overflow"><div class="bg-info text-center pull-left m-r-sm square30"><i class="fa fa-user-plus fa-md"></i></div><div class="m-t-xs">净增关注数</div></div><div class="overflow m-b-sm m-t"><div class="bg-light dk wrapper-sm"><span class="h3 font-bold m-t-sm block">{{entity.accountstatic.funstoday.addsub|numberZero}}</span> <small class="text-muted m-t-xs m-b-sm block">今日净增关注数</small></div><div class="bg-light lt wrapper-sm"><div class="m-t-sm b-b wrapper-b-sm"><div class="pull-left">昨天</div><div class="text-right">{{entity.accountstatic.funsyesterday.addsub|numberZero}}</div></div><div class="m-t-sm b-b wrapper-b-sm"><div class="pull-left">最近7天</div><div class="text-right">{{entity.accountstatic.funssevenday.addsub|numberZero}}</div></div><div class="m-t-sm wrapper-b-sm"><div class="pull-left">最近30天</div><div class="text-right">{{entity.accountstatic.funsmonthday.addsub|numberZero}}</div></div></div></div></div><div class="col-xs-3"><div class="m-t-lg overflow"><div class="bg-info text-center pull-left m-r-sm square30"><i class="fa fa-user-plus fa-md"></i></div><div class="m-t-xs">关键词命中率</div></div><div class="overflow m-b-sm m-t"><div class="bg-light dk wrapper-sm"><span class="h3 font-bold m-t-sm block">{{entity.accountstatic.funstoday.perword|numberZero}} <strong class="h5 font-bold">%</strong></span> <small class="text-muted m-t-xs m-b-sm block">今日关键词命中率</small></div><div class="bg-light lt wrapper-sm"><div class="m-t-sm b-b wrapper-b-sm"><div class="pull-left">昨天</div><div class="text-right">{{entity.accountstatic.funsyesterday.perword|numberZero}}%</div></div><div class="m-t-sm b-b wrapper-b-sm"><div class="pull-left">最近7天</div><div class="text-right">{{entity.accountstatic.funssevenday.perword|numberZero}}%</div></div><div class="m-t-sm wrapper-b-sm"><div class="pull-left">最近30天</div><div class="text-right">{{entity.accountstatic.funsmonthday.perword|numberZero}}%</div></div></div></div></div></div></div><div style="margin-top:3px"></div></section></div><div class="col-md-4"><section class="panel panel-default"><header class="panel-heading font-bold">套餐数据</header><ul class="list-group alt"><li class="list-group-item b-none no-bpadder"><div class="media"><div>自定义回复</div><div class="row"><div class="col-xs-6 no-rpadder"><div class="overflow m-t-sm"><div class="bg-light lt wrapper-t-xs wrapper-b-xs wrapper-l-sm wrapper-r-sm r"><div class="m-t-xs wrapper-b-xs"><div class="pull-left text-muted">文本</div><div class="text-right">{{entity.accountService.text}}/{{entity.accountService.totalText | numberAll}}</div></div></div></div></div><div class="col-xs-6"><div class="overflow m-t-sm"><div class="bg-light lt wrapper-t-xs wrapper-b-xs wrapper-l-sm wrapper-r-sm r"><div class="m-t-xs wrapper-b-xs"><div class="pull-left text-muted">图文</div><div class="text-right">{{entity.accountService.news}}/{{entity.accountService.totalNews | numberAll}}</div></div></div></div></div></div><div class="row"><div class="col-xs-6 no-rpadder"><div class="overflow m-b-sm m-t-sm"><div class="bg-light lt wrapper-t-xs wrapper-b-xs wrapper-l-sm wrapper-r-sm r"><div class="m-t-xs wrapper-b-xs"><div class="pull-left text-muted">语音</div><div class="text-right">{{entity.accountService.music}}/{{entity.accountService.totalMusic | numberAll}}</div></div></div></div></div><div class="col-xs-6"><div class="overflow m-b-sm m-t-sm"><div class="bg-light lt wrapper-t-xs wrapper-b-xs wrapper-l-sm wrapper-r-sm r"><div class="m-t-xs wrapper-b-xs"><div class="pull-left text-muted">LBS</div><div class="text-right">{{entity.accountService.lbsused}}/{{entity.accountService.totalLbs | numberAll}}</div></div></div></div></div></div></div></li><li class="list-group-item b-none no-tpadder no-bpadder"><div class="media"><div>请求数</div><div class="row"><div class="col-xs-6 no-rpadder"><div class="overflow m-t-sm"><div class="bg-light lt wrapper-t-xs wrapper-b-xs wrapper-l-sm wrapper-r-sm r"><div class="m-t-xs wrapper-b-xs"><div class="pull-left text-muted">剩余请求数</div><div class="text-right">{{entity.accountService.requestMonth==-1?"无限":entity.accountService.requestMonth-entity.accountService.hit}}</div></div></div></div></div><div class="col-xs-6"><div class="overflow m-t-sm"><div class="bg-light lt wrapper-t-xs wrapper-b-xs wrapper-l-sm wrapper-r-sm r"><div class="m-t-xs wrapper-b-xs"><div class="pull-left text-muted">本月请求数</div><div class="text-right">{{entity.accountService.hit| numberAll}}</div></div></div></div></div></div><div class="row"><div class="col-xs-6 no-rpadder"><div class="overflow m-b-sm m-t-sm"><div class="bg-light lt wrapper-t-xs wrapper-b-xs wrapper-l-sm wrapper-r-sm r"><div class="m-t-xs wrapper-b-xs"><div class="pull-left text-muted">每月可请求数</div><div class="text-right">{{entity.accountService.requestMonth| numberAll}}</div></div></div></div></div><div class="col-xs-6"><div class="overflow m-b-sm m-t-sm"><div class="bg-light lt wrapper-t-xs wrapper-b-xs wrapper-l-sm wrapper-r-sm r"><div class="m-t-xs wrapper-b-xs"><div class="pull-left text-muted">累计请求数</div><div class="text-right">{{entity.accountService.requestAll| numberAll}}</div></div></div></div></div></div></div></li><li class="list-group-item b-none no-tpadder"><div class="media"><div>增值服务</div><div class="row"><div class="col-xs-6 no-rpadder"><div class="overflow m-t-sm"><div class="bg-light lt wrapper-t-xs wrapper-b-xs wrapper-l-sm wrapper-r-sm r"><div class="m-t-xs wrapper-b-xs"><div class="pull-left text-muted">短信</div><div class="text-right">{{entity.accountService.smsused| numberAll}}/{{entity.accountService.smstotal| numberAll}}条</div></div></div></div></div></div></div></li></ul></section></div></div><div class="row" ng-if="!pageLoading"><div class="col-sm-6 col-md-4 no-rpadder"><section class="panel panel-default"><header class="panel-heading font-bold">当前营销活动</header><div class="panel-body no-lpadder no-rpadder no-tpadder"><div class="tab-content m-t-n-xs" style="height:300px"><div class="tab-pane ng-class:{active:switchCampaignType==1}"><table class="table table-striped b-b m-t-xs"><tbody><tr ng-repeat="item in entity.progressActivity" ng-if="$index<8"><td>{{item.title}}<span class="label label-warning m-l-xs">{{item.type}}</span></td></tr></tbody></table><div ng-if="entity.progressActivity.length==0" class="m-t text-center">暂无营销活动</div></div></div></div></section></div><div class="col-sm-6 col-md-4 no-rpadder"><section class="panel panel-default"><header class="panel-heading font-bold">商户学习</header><div class="panel-body no-lpadder no-rpadder"><div class="wrapper-l-sm wrapper-r-sm wrapper-b-sm"><button type="button" ng-click="swicthStudy(1)" class="btn btn-sm text-muted m-r-xs m-l-xs pos-rlt ng-class:{\'btn-info\':swicthStudyType==1,\'btn-link\':swicthStudyType!=1}">新手上路<span ng-if="swicthStudyType==1" class="arrow bottom arrow-info"></span></button> <button type="button" ng-click="swicthStudy(2)" class="btn btn-sm text-muted m-r-xs pos-rlt ng-class:{\'btn-info\':swicthStudyType==2,\'btn-link\':swicthStudyType!=2}">视频教程<span class="arrow bottom arrow-info" ng-if="swicthStudyType==2"></span></button> <button type="button" ng-click="swicthStudy(3)" class="btn btn-sm text-muted pos-rlt ng-class:{\'btn-info\':swicthStudyType==3,\'btn-link\':swicthStudyType!=3}">功能推荐<span class="arrow bottom arrow-info" ng-if="swicthStudyType==3"></span></button></div><div class="tab-content" style="height:240px"><div class="tab-pane ng-class:{active:swicthStudyType==1}"><table class="table table-striped b-b m-t-xs"><tbody><tr ng-repeat="item in entity.guideInfo" ng-if="$index<7"><td><a href="{{item.url}}" target="_blank">{{item.title}}</a></td></tr></tbody></table><div ng-if="entity.guideInfo.length==0" class="m-t text-center">暂无新手上路数据</div></div><div class="tab-pane ng-class:{active:swicthStudyType==2}"><table class="table table-striped b-b m-t-xs"><tbody><tr ng-repeat="item in entity.videoInfo" ng-if="$index<7"><td><a href="{{item.url}}" target="_blank">{{item.title}}</a></td></tr></tbody></table><div ng-if="entity.videoInfo.length==0" class="m-t text-center">暂无视频教程</div></div><div class="tab-pane ng-class:{active:swicthStudyType==3}"><div class="wrapper-sm scroll-y" style="height:240px;"><accordion close-others="true"><accordion-group heading="{{group.title}}" is-open="$first" ng-repeat="group in entity.functionRecommend">{{group.text}}</accordion-group></accordion></div><div ng-if="entity.functionRecommend.length==0" class="m-t text-center">暂无功能推荐</div></div></div></div></section></div><div class="col-sm-6 col-md-4"><section class="panel panel-default"><header class="panel-heading font-bold">公告 <a ui-sref="app.iframes({url:\'noticeslist\',params:entity.baseInfo.aid})" class="text-muted pull-right">更多<i class="fa fa-chevron-circle-right m-l-xs"></i></a></header><div class="panel-body overflow" style="height:315px"><ul class="list-group no-radius"><li class="list-group-item b-l-none b-r-none b-t-none m-b-none no-lpadder no-rpadder" ng-repeat="item in entity.noticeInfo" ng-if="$index<7"><span class="pull-right text-muted">{{item.ctime*1000 | date:"yyyy-MM-dd"}}</span> <a class="apostrophe" title="{{item.title}}" style="margin-right: 95px;display: block" ui-sref="app.iframes({url:\'notices\',params:entity.baseInfo.aid,subparams:item.id})"><span class="text-info m-r-xs">●</span>{{item.title}}</a></li></ul><div ng-if="entity.noticeInfo.length==0" class="m-t text-center">暂无公告</div></div></section></div></div></section></section>'),e.put("/app/dashboard/dashboard.list.html",'<div class="table-responsive" loading-container="tableParams.settings().$loading"><table ng-table="tableParams" class="table table-striped m-b-none" pager-target="#ng-pagination"><tr ng-repeat-start="item in $data"><td colspan="6"><span class="m-r">工单编号：{{item.id}}</span> <span class="m-r">创建日期：{{item.create_at | dateSpace}}</span> <span class="m-r">工单来源：{{item.source | ticketSource}}</span> <span class="m-r text-warning-dker" style="color: #f0ad4e;">{{view_ticket_title(item)}}</span></td></tr><tr data-title="true" class="tr2" ng-repeat-end=""><td data-title="\'标题\'"><span ng-if="locals.userRole.ticket_edit!=1">{{item.title| strLimit:40}}<img src="http://stc.home.weimob.cn/assets/images/priority.png" style="max-height:16px;margin-top:-3px" class="m-l-xs" ng-if="item.priority==4"></span> <a href="javascript:;" class="text-href" ui-sref="app.ticket.detail({id:parseInt(item.id)})" ng-if="locals.userRole.ticket_edit==1">{{item.title| strLimit:40}}<img src="http://stc.home.weimob.cn/assets/images/priority.png" style="max-height:16px;margin-top:-3px" class="m-l-xs" ng-if="item.priority==4"></a></td><td data-title="\'类型\'">{{item.type | ticketType}}</td><td data-title="\'工单发起人\'"><a ui-sref="app.user.overview({userId:item.requester_id})" class="text-href">{{item.requester_name}}</a></td><td data-title="\'受理客服组\'">{{item.group_name | space}}</td><td data-title="\'工单受理客服\'"><span ng-if="item.assignee_id<1">{{item.assignee_name | space}}</span> <a ng-if="item.assignee_id> 0" ui-sref="app.user.overview({userId:item.assignee_id})" class="text-href">{{item.assignee_name | space}}</a></td><td data-title="\'操作\'"><a href="javascript:;" ui-sref="app.ticket.detail({id:parseInt(item.id)})" class="m-xs" title="回复" ng-if="locals.userRole.ticket_edit==1"><i class="fa fa-comment text-muted"></i></a> <a href="javascript:;" ng-if="item.star==0" ng-click="star(item,1)" class="m-xs" title="加星工单"><i class="fa fa-star-o text-muted"></i></a> <a href="javascript:;" ng-if="item.star==1" ng-click="star(item,-1)" class="m-xs" title="减星工单"><i class="fa fa-star text-warning dker"></i></a> <a href="javascript:;" class="m-xs" popup-confirm="" popup-placement="left" popup-body="确定删除[{{item.title | strLimit:30}}]工单" popup-confirm-callback="remove(item)" popup-if="item.id> 0" ng-if="locals.userRole.ticket_del==1"><i class="fa fa-trash-o text-muted"></i></a></td></tr><tr ng-if="!tableParams.settings().$loading" class="text-center"><td colspan="9" ng-if="$data.length==0">没有找到任何记录!!</td></tr></table></div><footer class="footer bg-white b-t"><div class="row text-center-xs"><div class="col-md-6 hidden-sm"><p class="text-muted m-t">总共{{tableParams.total()}}条 当前为第{{tableParams.page()}}页</p></div><div class="col-md-6 col-sm-12 text-right text-center-xs" id="ng-pagination"></div></div></footer>'),e.put("/app/iframe/iframe.html",'<iframe id="mainFrame" iframe-on-click="" name="mainFrame" ng-if="!pageLoadingIframe&&loadNavloading" ng-controller="iframeCtrl" ng-src="{{offseturl}}" frameborder="0" height="100%" width="100%" style="background: url(\'http://stc.home.weimob.cn/assets/images/loading.gif\') center no-repeat; height: 100%; width: 100%; border: 0px;"></iframe>'),e.put("/app/messages/messages.consume.html",'<section class="vbox" ng-if="!$stateParams.id"><header class="header bg-white b-b clearfix"><form class="talbe-search" form-serialize="" method="post" table-params="tableParams"><div class="row"><div class="col-sm-4 m-b-xs"><div class="btn-group m-r-xs" dropdown=""><button type="button" refresh-state="" class="btn btn-sm btn-default m-r-xs" title="刷新"><i class="fa fa-refresh"></i></button></div><div class="btn-group m-r-xs" dropdown="" dropdown-select="" ng-if="messages_type.length" ng-model="tableParams.filter()[\'type\']" data-list="messages_type"></div><a ui-sref="app.messages.list.detail({aid:accountBaseInfo.aid,type:$stateParams.type,id:\'3\',btype:\'国内\',date:\'2016-06-27\'})">详情</a></div><div class="col-sm-4 m-b-xs"><div class="input-group"><span class="input-group-addon">时间：</span> <input date-range-picker="" class="form-control date-picker input-sm" type="text" data-maxdate="now" ng-model="tableParams.filter()[\'date\']" readonly=""></div></div></div></form></header><section class="m-t-sm"><section class="panel panel-default"><div class="table-responsive clearfix" loading-container="tableParams.settings().$loading"><table ng-table="tableParams" class="table table-striped table-hover m-b-none" pager-target="#ng-pagination"><tr ng-repeat="item in $data"><td data-title="\'日期\'">{{item.uid}}</td><td data-title="\'总发送量\'">{{item.name}}</td><td data-title="\'成功发送量\'">{{item.email}}</td><td data-title="\'计费量\'" style="width:30%">{{item.op_name}} <span class="text-muted m-l-xs" ng-if="item.comment">[{{item.comment}}]</span></td><td data-title="\'业务消耗概况\'">{{item.res_name}}</td><td data-title="\'消耗详情\'">{{item.res_id}}</td></tr><tr ng-if="!tableParams.settings().$loading" class="text-center"><td colspan="6" ng-if="$data.length==0">没有找到任何记录!!</td></tr></table></div></section><footer class="footer bg-white b-t clearfix"><div class="row text-center-xs"><div class="col-md-5 hidden-sm"><p class="text-muted m-t">总共{{tableParams.total()}}条 当前为第{{tableParams.page()}}页</p></div><div class="col-md-7 col-sm-12 text-right text-center-xs" id="ng-pagination"></div></div></footer></section></section><section class="vbox" ui-view="subviewconsume" ng-if="$stateParams.id"></section>'),e.put("/app/messages/messages.detail.html",'<header class="header bg-white clearfix"><p>{{$stateParams.btype}}短信包消耗>每日消耗详情（{{$stateParams.date}}）</p><a class="text-muted pull-right m-t pointer" back-state="" title="返回"><i class="fa fa-reply"></i></a></header><section class="m-t-sm"><section class="panel panel-default"><div class="table-responsive" loading-container="tableParamsDetail.settings().$loading"><table ng-table="tableParamsDetail" class="table table-striped table-hover m-b-none" pager-target="#ng-paginationdetail"><tr ng-repeat="item in $data"><td data-title="\'发送时间\'">{{item.uid}}</td><td data-title="\'手机号\'">{{item.name}}</td><td data-title="\'接收者类型\'">{{item.email}}</td><td data-title="\'发送结果\'" style="width:30%">{{item.op_name}} <span class="text-muted m-l-xs" ng-if="item.comment">[{{item.comment}}]</span></td><td data-title="\'业务类型\'">{{item.res_name}}</td><td data-title="\'短信详情\'">{{item.res_id}}</td></tr><tr ng-if="!tableParamsDetail.settings().$loading" class="text-center"><td colspan="6" ng-if="$data.length==0">没有找到任何记录!!</td></tr></table></div></section><footer class="footer bg-white b-t"><div class="row text-center-xs"><div class="col-md-5 hidden-sm"><p class="text-muted m-t">总共{{tableParamsDetail.total()}}条 当前为第{{tableParamsDetail.page()}}页</p></div><div class="col-md-7 col-sm-12 text-right text-center-xs" id="ng-paginationdetail"></div></div></footer></section>'),e.put("/app/messages/messages.index.html",'<section class="panel panel-default"><header class="panel-heading font-bold">国内短信包（适用于中国大陆商户）</header><div class="panel-body"><section class="panel panel-default"><div class="row m-l-none m-r-none"><div class="col-sm-6 col-md-3 padder-v b-r"><a class="clear text-center" href="javascript:;"><span class="h4 block m-t-xs"><strong>52,000</strong></span> <small class="text-muted text-uc">总发送条数</small></a></div><div class="col-sm-6 col-md-3 padder-v b-r"><a class="clear text-center" href="javascript:;"><span class="h4 block m-t-xs"><strong id="bugs">468</strong></span> <small class="text-muted text-uc">成功发送数</small></a></div><div class="col-sm-6 col-md-3 padder-v b-r"><a class="clear text-center" href="javascript:;"><span class="h4 block m-t-xs"><strong id="firers">359</strong></span> <small class="text-muted text-uc">计费条数</small></a></div><div class="col-sm-6 col-md-2 padder-v b-r"><a class="clear text-center" href="javascript:;"><span class="h4 block m-t-xs"><strong>500.00</strong></span> <small class="text-muted text-uc">剩余条数</small></a></div><div class="col-sm-6 col-md-1 padder-v text-center"><button type="button" class="btn btn-sm btn-danger m-t-sm" ui-sref="app.messages.list({aid:accountBaseInfo.aid,type:3})">充值</button></div></div></section></div></section><section class="panel panel-default"><header class="panel-heading font-bold">国际短信包（适用于境外商户）</header><div class="panel-body"><section class="panel panel-default"><div class="row m-l-none m-r-none"><div class="col-sm-6 col-md-3 padder-v b-r"><a class="clear text-center" href="javascript:;"><span class="h4 block m-t-xs"><strong>52,000</strong></span> <small class="text-muted text-uc">总发送条数</small></a></div><div class="col-sm-6 col-md-3 padder-v b-r"><a class="clear text-center" href="javascript:;"><span class="h4 block m-t-xs"><strong id="bugs">468</strong></span> <small class="text-muted text-uc">成功发送数</small></a></div><div class="col-sm-6 col-md-3 padder-v b-r"><a class="clear text-center" href="javascript:;"><span class="h4 block m-t-xs"><strong id="firers">359</strong></span> <small class="text-muted text-uc">计费条数</small></a></div><div class="col-sm-6 col-md-2 padder-v b-r"><a class="clear text-center" href="javascript:;"><span class="h4 block m-t-xs"><strong>500.00</strong></span> <small class="text-muted text-uc">剩余条数</small></a></div><div class="col-sm-6 col-md-1 padder-v text-center"><button type="button" class="btn btn-sm btn-danger m-t-sm" ui-sref="app.messages.list({aid:accountBaseInfo.aid,type:3})">充值</button></div></div></section></div></section><section class="panel panel-default"><header class="panel-heading font-bold">短信包关联业务</header><div class="panel-body"><h5 class="b-b wrapper-b-sm"><a href="javascript:;">发送对象：粉丝</a></h5><ul class="list-unstyled overflow clearfix m-t wrapper-l-sm"><li class="pull-left w h-size75 overflow m-r m-b bg-light wrapper-xs"><span class="h4 block m-t-xs fontsize16"><span class="text-danger">会员卡</span></span> <span class="h4 block m-t fontsize13"><span class="text-success">应用场景：会员营销、短信验证</span></span></li><li class="pull-left w h-size75 overflow m-r m-b bg-light wrapper-xs"><span class="h4 block m-t-xs fontsize16"><span class="text-danger">会员卡</span></span> <span class="h4 block m-t fontsize13"><span class="text-success">应用场景：会员营销、短信验证</span></span></li><li class="pull-left w h-size75 overflow m-r m-b bg-light wrapper-xs"><span class="h4 block m-t-xs fontsize16"><span class="text-danger">会员卡</span></span> <span class="h4 block m-t fontsize13"><span class="text-success">应用场景：会员营销、短信验证</span></span></li><li class="pull-left w h-size75 overflow m-r m-b bg-light wrapper-xs"><span class="h4 block m-t-xs fontsize16"><span class="text-danger">会员卡</span></span> <span class="h4 block m-t fontsize13"><span class="text-success">应用场景：会员营销、短信验证</span></span></li><li class="pull-left w h-size75 overflow m-r m-b bg-light wrapper-xs"><span class="h4 block m-t-xs fontsize16"><span class="text-danger">会员卡</span></span> <span class="h4 block m-t fontsize13"><span class="text-success">应用场景：会员营销、短信验证</span></span></li></ul><h5 class="b-b wrapper-b-sm"><a href="javascript:;">发送对象：商家</a></h5><ul class="list-unstyled overflow clearfix m-t wrapper-l-sm"><li class="pull-left w h-size75 overflow m-r m-b bg-light wrapper-xs"><span class="h4 block m-t-xs fontsize16"><span class="text-danger">会员卡</span></span> <span class="h4 block m-t fontsize13"><span class="text-success">应用场景：会员营销、短信验证</span></span></li><li class="pull-left w h-size75 overflow m-r m-b bg-light wrapper-xs"><span class="h4 block m-t-xs fontsize16"><span class="text-danger">会员卡</span></span> <span class="h4 block m-t fontsize13"><span class="text-success">应用场景：会员营销、短信验证</span></span></li><li class="pull-left w h-size75 overflow m-r m-b bg-light wrapper-xs"><span class="h4 block m-t-xs fontsize16"><span class="text-danger">会员卡</span></span> <span class="h4 block m-t fontsize13"><span class="text-success">应用场景：会员营销、短信验证</span></span></li><li class="pull-left w h-size75 overflow m-r m-b bg-light wrapper-xs"><span class="h4 block m-t-xs fontsize16"><span class="text-danger">会员卡</span></span> <span class="h4 block m-t fontsize13"><span class="text-success">应用场景：会员营销、短信验证</span></span></li><li class="pull-left w h-size75 overflow m-r m-b bg-light wrapper-xs"><span class="h4 block m-t-xs fontsize16"><span class="text-danger">会员卡</span></span> <span class="h4 block m-t fontsize13"><span class="text-success">应用场景：会员营销、短信验证</span></span></li></ul></div></section>'),e.put("/app/messages/messages.list.html",'<section class="hbox stretch"><section class="vbox"><header class="header bg-white b-b clearfix"><p>短信包</p><a class="text-muted pull-right m-t pointer" href="javascript:;" back-state="" title="返回"><i class="fa fa-reply"></i></a></header><section class="scrollable wrapper"><div class="alert alert-info">1、短信包分国内短信与国际短信，适用场景不同，价格差别较大，请按需购买<br>2、短信发送服务分两类：一类发送至粉丝，包括验证码、活动信息等，一类发送至商户，主要包括订单提醒等<br>3、所有验证码类短信目前由微盟补贴，其他类型短信需商户自行购买短信包充值可用短信数量<br>4、由于涉及到第三方短信服务商，短信包购买后无法取消，请谨慎购买</div><div class="alert alert-danger" ng-if="isShowTips"><span class="text-danger">当前剩余短信条数为50条，赶快去充值吧！</span> <a class="text-href" href="javascript:;" ui-sref="app.messages.list({aid:accountBaseInfo.aid,type:3})">立即充值</a> <a class="pull-right" href="javascript:;" ng-click="closeTips()"><i class="fa fa-times"></i></a></div><section class="panel panel-default"><header class="panel-heading bg-light"><ul class="nav nav-tabs nav-white" style="margin:-11px -16px"><li class="ng-class:{active:$stateParams.type==1}"><a href="javascript:;" ui-sref="app.messages.list({aid:accountBaseInfo.aid,type:1})">短信包</a></li><li style="margin-left:-3px" class="ng-class:{active:$stateParams.type==2}"><a href="javascript:;" ui-sref="app.messages.list({aid:accountBaseInfo.aid,type:2})">消耗详情</a></li><li style="margin-left:-3px" class="ng-class:{active:$stateParams.type==3}"><a href="javascript:;" ui-sref="app.messages.list({aid:accountBaseInfo.aid,type:3})">充值</a></li></ul></header><div class="panel-body" ng-if="!pageLoading"><div class="tab-content"><div class="tab-pane active" id="classify" style="overflow-x:hidden" ui-view="subviewa"><div ng-if="$stateParams.type==1" ng-controller="messagePackageIndexCtrl" ng-include="\'/app/messages/messages.index.html\'"></div><div ng-if="$stateParams.type==2" ng-controller="messagePackageListCtrl" ng-include="\'/app/messages/messages.consume.html\'"></div><div ng-if="$stateParams.type==3" ng-controller="messagePackagePayCtrl" ng-include="\'/app/messages/messages.pay.html\'"></div></div></div></div></section></section></section></section>'),e.put("/app/messages/messages.pay.confirm.model.html",'<form class="form-horizontal" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="modal-header"><button type="button" class="close" ng-click="cancel()">&times;</button><h4 class="modal-title"><i class="fa fa-search m-r-xs"></i>提示</h4></div><div class="modal-body"><div class="form-group"><div class="col-sm-10 col-sm-offset-1"><p class="form-control-static">请您在新打开的页面完成支付</p></div></div></div><div class="modal-footer"><a class="btn btn-danger" ng-click="successpay()">支付成功</a> <a class="btn btn-default" ng-click="cancel()">重新下单</a></div></form>'),e.put("/app/messages/messages.pay.html",'<h5><strong>购买短信包</strong></h5><div class="row"><div class="col-sm-6"><section class="panel panel-default"><header class="panel-heading font-bold">国内短信包（适用于境外用户）</header><div class="panel-body"><section class="panel panel-default b-none"><div class="row m-l-none m-r-none b-a m-b-sm"><div class="col-sm-12"><p class="form-control-static">A套餐：100元／1000条 单价：0.1元／条 <a href="javascript:;" class="pull-right text-href" ng-click="toPay()">立即购买</a></p></div></div><div class="row m-l-none m-r-none b-a m-b-sm"><div class="col-sm-12"><p class="form-control-static">B套餐：100元／1000条 单价：0.1元／条 <a class="pull-right text-href">立即购买</a></p></div></div><div class="row m-l-none m-r-none b-a m-b-sm"><div class="col-sm-12"><p class="form-control-static">C套餐：100元／1000条 单价：0.1元／条 <a class="pull-right text-href">立即购买</a></p></div></div><div class="row m-l-none m-r-none b-a m-b-sm"><div class="col-sm-12"><p class="form-control-static">D套餐：100元／1000条 单价：0.1元／条 <a class="pull-right text-href">立即购买</a></p></div></div></section></div></section></div><div class="col-sm-6"><section class="panel panel-default"><header class="panel-heading font-bold">国际短信包（适用于境外商户）</header><div class="panel-body"><section class="panel panel-default b-none"><div class="row m-l-none m-r-none b-a m-b-sm"><div class="col-sm-12"><p class="form-control-static">A套餐：100元／1000条 单价：0.1元／条 <a class="pull-right text-href">立即购买</a></p></div></div><div class="row m-l-none m-r-none b-a m-b-sm"><div class="col-sm-12"><p class="form-control-static">B套餐：100元／1000条 单价：0.1元／条 <a class="pull-right text-href">立即购买</a></p></div></div><div class="row m-l-none m-r-none b-a m-b-sm"><div class="col-sm-12"><p class="form-control-static">C套餐：100元／1000条 单价：0.1元／条 <a class="pull-right text-href">立即购买</a></p></div></div><div class="row m-l-none m-r-none b-a m-b-sm"><div class="col-sm-12"><p class="form-control-static">D套餐：100元／1000条 单价：0.1元／条 <a class="pull-right text-href">立即购买</a></p></div></div></section></div></section></div></div><h5><strong>购买记录</strong></h5><section class="panel panel-default m-t-sm"><div class="table-responsive" loading-container="tableParamsPay.settings().$loading"><table ng-table="tableParamsPay" class="table table-striped table-hover m-b-none" pager-target="#ng-paginationpay"><tr ng-repeat="item in $data"><td data-title="\'购买时间\'">{{item.uid}}</td><td data-title="\'增值包类型\'">{{item.name}}</td><td data-title="\'套餐类型\'">{{item.email}}</td><td data-title="\'金额\'" style="width:30%">{{item.op_name}} <span class="text-muted m-l-xs" ng-if="item.comment">[{{item.comment}}]</span></td><td data-title="\'充值短信条数\'">{{item.res_name}}</td></tr><tr ng-if="!tableParamsPay.settings().$loading" class="text-center"><td colspan="5" ng-if="$data.length==0">没有找到任何记录!!</td></tr></table></div></section><footer class="footer bg-white b-t"><div class="row text-center-xs"><div class="col-md-5 hidden-sm"><p class="text-muted m-t">总共{{tableParamsPay.total()}}条 当前为第{{tableParamsPay.page()}}页</p></div><div class="col-md-7 col-sm-12 text-right text-center-xs" id="ng-paginationpay"></div></div></footer>'),e.put("/app/messages/messages.pay.model.html",'<form class="form-horizontal" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="modal-header"><button type="button" class="close" ng-click="cancel()">&times;</button><h4 class="modal-title">短信充值</h4></div><div class="modal-body"><div class="form-group"><label class="col-sm-2 control-label">充值帐号：</label><div class="col-sm-10"><p class="form-control-static">你可以的</p></div></div><div class="form-group"><label class="col-sm-2 control-label">当前条数：</label><div class="col-sm-10"><p class="form-control-static">0条</p></div></div><div class="form-group"><label class="col-sm-2 control-label">短信包套餐：</label><div class="col-sm-10"><p class="form-control-static">国内短信A套餐</p></div></div><div class="form-group"><label class="col-sm-2 control-label">充值条数：</label><div class="col-sm-10"><p class="form-control-static">1000条</p></div></div><div class="form-group"><label class="col-sm-2 control-label">应付金额：</label><div class="col-sm-10"><p class="form-control-static">50元</p></div></div><div class="form-group"><label class="col-sm-2 control-label">支付方式：</label><div class="col-sm-10"><p class="form-control-static">支付宝</p></div></div></div><div class="modal-footer"><a class="btn btn-danger" href="http://www.baidu.com/" ng-click="payLink()" target="_blank">充值</a> <button type="button" class="btn btn-default" ng-click="cancel()">取消</button></div></form>'),e.put("/app/messages/messages.recharge.html",""),e.put("/app/user/check.phone.html",""),e.put("/app/user/user.password.model.html",'<form class="form-horizontal" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="modal-header"><button type="button" class="close" ng-click="cancel()">&times;</button><h4 class="modal-title">修改密码</h4></div><div class="modal-body"><div class="form-group"><label class="col-sm-2 control-label must">密码</label><div class="col-sm-7"><input type="password" class="form-control" data-rule-required="true" data-rule-rangelength="[6,32]" name="password" ng-model="entity.password"></div></div></div><div class="modal-footer"><button type="submit" class="btn btn-primary" btn-loading="saveloading" loading-text="保存中...">保存</button> <button type="button" class="btn btn-default" ng-click="cancel()">取消</button></div></form>'),e.put("/app/components/address2/address.tpl.html",'<div class="form-inline"><div class="form-group"><div class="col-lg-12 m-r-xs"><select class="form-control mn140" ng-class="{\'input-sm\':isSmall}" name="provinces" ng-model="address.province" data-rule-required="{{required}}" ng-options="k as v for (k, v) in province" ng-disabled="ngReadonly"><option value="">请选择</option></select></div></div><div class="form-group"><div class="col-lg-12 m-r-xs"><select class="form-control mn120" ng-class="{\'input-sm\':isSmall}" name="city" ng-model="address.city" data-rule-required="{{required}}" ng-options="k as v for (k, v) in city" ng-disabled="ngReadonly"><option value="">请选择</option></select></div></div><div class="form-group" ng-if="addressNum > 2"><div class="col-lg-12"><select class="form-control mn120" ng-class="{\'input-sm\':isSmall}" name="district" ng-model="address.district" data-rule-required="{{required}}" ng-options="k as v for (k, v) in district" ng-disabled="ngReadonly"><option value="">请选择</option></select></div></div></div>'),e.put("/app/components/color/color.html",'<div class="angular-color-picker"><div class="_variations" ng-style="{ backgroundColor: hueBackgroundColor }"><div class="_whites"><div class="_blacks"><div class="_cursor" ng-if="colorCursor" ng-style="{ left: colorCursor.x - 5 + \'px\', top: colorCursor.y - 5 + \'px\' }"></div><div class="_mouse-trap" ng-mousedown="startDrag($event, \'color\')"></div></div></div></div><div class="_hues"><div class="_ie-1"></div><div class="_ie-2"></div><div class="_ie-3"></div><div class="_ie-4"></div><div class="_ie-5"></div><div class="_ie-6"></div><div class="_cursor" ng-style="{ top: hueCursor - 5 + \'px\' }"></div><div class="_mouse-trap" ng-mousedown="startDrag($event, \'hue\')"></div></div></div>'),e.put("/app/components/color/input.color.html",'<div class="color-input-panel" tabindex="1" ng-blur="showTextColorPicker($event, false)"><input type="text" class="form-control" name="textColor" ng-model="ngModel" ng-blur="checkWordsColour()"><div class="color-preview" ng-style="{\'background-color\': color.val}" ng-click="showTextColorPicker($event, !isShowTextColorPicker)"></div><div ng-if="isShowTextColorPicker" style="position: absolute;z-index: 10" ng-click="showTextColorPicker($event, true)"><color-picker ng-model="color.val"></color-picker></div></div>'),e.put("/app/components/color/wechat.color.html",'<div class="simple-color"><span class="color" ng-repeat="item in colorList" ng-style="{\'background-color\':item}" ng-class="{active:item==colorList[ngModel]}" ng-click="onSelect($index)"></span></div>'),e.put("/app/components/datetimepicker2/datetimepicker.html",'<div class="dropdown inline" dropdown="" is-open="dropdownStatusOpen"><a class="dropdown-toggle datetimepickerdropdown" dropdown-toggle="" href="javascript:;"><div class="input-group"><input type="text" class="form-control" readonly="readonly" ng-attr-data-rule-required="{{required?\'true\':\'false\'}}" ng-model="date"><span class="input-group-addon"><i class="fa fa-calendar"></i></span></div></a><ul class="dropdown-menu" ng-hide="isDay"><datetimepicker data-ng-model="date" is-open="dropdownStatusOpen"></datetimepicker></ul><ul class="dropdown-menu" ng-show="isDay"><datetimepicker data-ng-model="date" is-open="dropdownStatusOpen" min-view="day"></datetimepicker></ul></div>'),e.put("/app/components/dialogs/confirm.tpl.html",'<div class="modal-header dialog-header-confirm" ng-if="header"><button type="button" class="close" ng-click="no()">&times;</button><h4 class="modal-title">{{header}}</h4></div><div class="modal-body"><div ng-if="!header"><button type="button" class="close" ng-click="no()" ng-style="{\'margin-top\':\'-10px\'}">&times;</button></div><div class="xbody" ng-bind-html="msg"></div></div><div class="modal-footer"><button type="button" class="btn btn-primary" ng-click="yes()">{{"DIALOGS_YES" | translate}}</button> <button type="button" class="btn btn-default" ng-click="no()">{{"DIALOGS_NO" | translate}}</button></div>'),e.put("/app/components/dialogs/notify.tpl.html",'<div class="modal-header dialog-header-notify" ng-if="header"><button type="button" class="close" ng-click="close()">&times;</button><h4 class="modal-title">{{header}}</h4></div><div class="modal-body"><div ng-if="!header"><button type="button" class="close" ng-click="close()" ng-style="{\'margin-top\':\'-10px\'}">&times;</button></div><div class="xbody" ng-bind-html="msg"></div></div><div class="modal-footer"><button type="button" class="btn btn-primary" ng-click="close()">{{"DIALOGS_OK" | translate}}</button></div>'),e.put("/app/components/dialogs/wait.tpl.html",'<div class="modal-header dialog-header-wait" ng-if="header"><h4 class="modal-title">{{header}}</h4></div><div class="modal-body"><p ng-bind-html="msg"></p><div class="progress progress-striped active"><div class="progress-bar progress-bar-success" ng-style="getProgress()"></div><span class="sr-only">{{progress}}{{"DIALOGS_PERCENT_COMPLETE" | translate}}</span></div></div>'),e.put("/app/components/dropdown-select/dropdown-select.html",'<a dropdown-toggle="" class="btn {{dropdownselectsize}} btn-default dropdown-toggle"><span class="dropdown-label">{{checked.title}}</span> <span class="caret"></span></a><ul class="dropdown-menu dropdown-select dropdown-select-50"><li ng-repeat="item in data" ng-class="{active:item.value==checked.value}"><a href="javascript:;" ng-click="select(item)">{{item.title}}</a></li></ul>'),e.put("/app/components/fresco/fresco.img.html",'<img class="thumb-lg m-xs" ng-src="{{item}}" ng-repeat="item in list" ng-click="show($index)">'),e.put("/app/components/fresco/fresco.imgtext.html",'<a class="text-href m-xs" href="javascript:;" ng-repeat="item in list" ng-click="show($index)">预览</a>'),e.put("/app/components/icon/icon.html",'<div class="angular-icon-picker dropdown" dropdown=""><i class="icon {{ngModel | fontFilter}} m-r"></i> <a dropdown-toggle="">换一个</a><div class="dropdown-menu" role="menu" style="width: 622px"><a ng-repeat="item in iconList" ng-click="onSelect(item)"><i class="icon {{item | fontFilter}}"></i></a></div></div>'),e.put("/app/components/iconDateRangePicker/iconDateRangePicker.html",'<span class="input-group" ng-click="onFocus()"><span class="input-group-addon" ng-click="onClick($event)" style="padding: 0 8px;"><i class="fa fa-calculator"></i></span> <input date-range-picker="" class="form-control input-sm" type="text" style="min-width: 170px" data-rule-required="{{required}}" placeholder="请选择日期" ng-model="ngModel" readonly="readonly" ng-blur="onBlur()"></span>'),e.put("/app/components/kindeditor/kindeditor.img.html",'<img class="thumb_img" ng-src="{{imgPath||\'http://www.weimob.com/templates/kindeditor/attached/c3/e8/78/image/20130816/20130816220610_88488.jpg\'}}" style="max-height: 100px;"> <button class="btn btn-default" type="button" ng-click="select()">{{title||\'选择图片\'}}</button> <span class="help-inline">{{tip}}</span>'),e.put("/app/components/kindeditor/kindeditor.preview.html",'<div style="widit:100%;max-height: 420px;overflow: auto;" ng-class="{\'wrapper b-a b-light\':preview}"><div ng-bind-html="content" ng-if="preview"></div><div ng-hide="preview"><textarea rows="13" class="form-control" kindeditor="" data-ng-model="content" data-config="default"></textarea></div></div>'),e.put("/app/components/map/baidu.map.html",'<div class="angular-baidu-map" id="angular-baidu-map-{{mapId}}"></div>'),e.put("/app/components/popbox/popbox.confirm.html",'<a class="close m-r-xs m-t-xs" ng-click="$hide()">&times;</a><h3 class="popover-title">{{popupTitle||\'删除\'}}</h3><div class="popover-content"><p style="min-width: {{popupMinWidth||\'100\'}}px;"><b>{{popupBody||\'确定删除此条\'}}</b></p><a ng-click="popupConfirmCallback();$hide()" class="btn btn-danger btn-sm">{{popupConfirmButton||\'确定删除\'}}</a> <a ng-click="$hide()" class="btn btn-default btn-sm">{{popupClearButton||\'取消\'}}</a></div>'),e.put("/app/components/popbox/popbox.html",'<a class="close m-r-xs m-t-xs" ng-click="$hide()">&times;</a><h3 class="popover-title" ng-if="popupTitle">{{popupTitle}}</h3><div class="popover-content" ng-bind-html="popupBody" ng-if="popupBody"></div><div class="popover-content" ng-if="popupQrcode" style="text-align: center;"><qrcode data="{{popupQrcode}}" size="130" version="5"></qrcode></div>'),e.put("/app/components/popbox/popbox.menu.html",'<a class="close m-r-xs m-t-xs" ng-click="$hide()">&times;</a><h3 class="popover-title">{{popupTitle||\'操作选项\'}}</h3><div class="popover-content"><ul class="popbox-menu list-unstyled"><li ng-repeat="item in popupList" ng-class="{\'divider\':item.divider}"><a ui-sref="{{item.href}}" ng-click="item.method&&$hide();item.method($el)" ng-if="!item.divider"><i class="fa fa-{{item.icon}} text-muted m-r-xs"></i>{{item.name}}</a></li></ul></div>'),e.put("/app/components/upload/upload.button.html",'<span class="add" name="file" ngf-select="upload($file)" ngf-drag-over-class="\'dragover\'" ngf-allow-dir="true" ngf-accept="ngfAccept || \'*/*, *.*\'"><button class="{{buttonClass}}" ng-disabled="uploading"><span ng-if="uploading"><i class="fa fa-spinner fa-pulse fa-fw m-r-xs"></i> {{progressPercentage}}%</span> <span ng-if="!uploading"><i class="fa fa-plus m-r-xs"></i> {{buttonText || \'上传\'}}</span></button></span>'),e.put("/app/components/upload/upload.file.html",'<div class="uploadify-queue m-t-xs"><div id="upload{{$index}}" class="uploadify-queue-item" ng-repeat="f in files"><div ng-if="!f.success"><p class="m-r-xs inline">{{f.name}}</p><span class="m-r-xs">({{f.size|formatBytes}})</span><span class="m-r-xs">文件上传中<i class="fa fa-spinner fa-spin m-l-xs"></i></span></div></div></div><ul class="list-unstyled list-inline m-t upload-list"><li ng-repeat="f in fileList"><a href="javascript:;" class="close" ng-click="del($index)"><i class="fa fa-times-circle"></i></a> <span class="m-r-xs"><a href="{{f.url}}" class="text-href" target="_blank">{{f.yname}}</a></span><fresco-img-text ng-if="f.type==\'image\'" list="f.urls"></fresco-img-text></li><li class="add" ng-show="maxCount>fileList.length" ng-file-select="" ng-model="files" drag-over-class="dragover" ng-multiple="true" allow-dir="true" accept="image/*,.txt,.rar,.zip,.doc,.docx,.ini,.conf,.eml"><a class="btn btn-default btn-sm" href="javascript:;"><i class="fa fa-plus m-r-xs"></i>上传</a></li></ul><div class="help-block">最多{{maxCount}}个文件</div>'),e.put("/app/components/upload/upload.img.html",'<div class="uploadify-queue"><div id="upload{{$index}}" class="uploadify-queue-item" ng-repeat="f in files"><div ng-if="f.fileProgress<100"><p class="m-r-xs inline">{{f.name}}</p><span class="m-r-xs">({{f.size|formatBytes}})</span><span class="m-r-xs">{{f.fileProgress}}%</span><div class="uploadify-progress"><div class="uploadify-progress-bar" style="width: {{f.fileProgress}}%;"></div></div></div></div></div><ul class="list-unstyled list-inline m-t upload-list"><li ng-click="selectIndexFun($index)" ng-class="{\'index\':$index==selectIndex}" ng-repeat="f in fileList"><a href="javascript:;" class="close" ng-click="del($index)"><i class="fa fa-times-circle"></i></a> <img class="thumb-lg" ng-src="{{f.url}}"></li><li class="add" ng-show="!freLoading && maxCount>fileList.length" name="file" ngf-select="upload($files)" multiple="multiple" ngf-drag-over-class="\'dragover\'" ngf-multiple="true" ngf-allow-dir="true" ngf-accept="\'image/*\'"><a class="btn btn-default btn-sm" href="javascript:;"><i class="fa fa-plus m-r-xs"></i>上传</a></li><li class="add" ng-show="freLoading"><i class="fa fa-spinner fa-pulse m-r-xs"></i>上传中（{{fileProgress}}%）...</li></ul><div class="help-block" ng-if="tip">{{tip}}</div><div class="help-block" ng-if="!tip">最多{{maxCount}}个文件， 大小不超过{{maxSizeFile}}MB</div>'),e.put("/app/vip/card/index.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t" ng-if="navPath"><a class="text-href" ui-sref="app.vip.card.manage">会员卡</a> <label class="m-l-sm m-r-sm">/</label> <span ng-if="navPath===\'添加特权设置\'"><a class="text-href" ui-sref="app.vip.card.privilege">特权设置</a> <label class="m-l-sm m-r-sm">/</label></span> {{navPath}}</div><div class="m-t" ng-if="!navPath">会员卡</div></header><section class="scrollable wrapper"><div class="load" ng-if="parentLoading">数据加载中...</div><div ng-if="!parentLoading" ui-view=""></div></section></section>'),e.put("/app/vip/manage/consume.dialog.html",'<form class="form-horizontal" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="modal-header"><button type="button" class="close" ng-click="cancel()">&times;</button><h4 class="modal-title">会员消费</h4></div><div class="modal-body" ng-if="!pageLoading"><div class="panel-body"><div class="form-group" ng-if="needQuery"><div class="col-sm-3"><select class="form-control must" ng-model="queryType" ng-change="clearMember()"><option value="1">会员卡号</option><option value="2">手机号码</option></select></div><div class="col-sm-9 form-inline pos-rlt"><input ng-if="queryType == 2" class="form-control" name="Phone" ng-model="member.Phone" data-rule-required="true" data-rule-mobile="true" ng-change="queryMember(queryType)"> <input ng-if="queryType == 1" class="form-control" style="opacity: 0"> <input ng-if="queryType == 1" class="form-control pos-abt" style="left: 15px;" name="MemberCardNo" ng-model="member.MemberCardNo" data-rule-required="true" data-rule-maxlength="100" ng-change="queryMember(queryType)"> <label class="help-block error">{{queryError}}</label></div></div><div class="form-group" style="margin-top: -20px"><label class="col-sm-3 control-label"><span ng-if="!needQuery">会员信息</span></label><div class="col-sm-9" ng-if="member.Name"><div class="help-block">会员：{{member.Name}}，等级：{{member.Level.Value}}，折扣：{{member.DisCount | discount}}<br>余额：{{member.Amount}}，积分：{{member.Points}}</div></div></div><div class="form-group"><label class="col-sm-3 control-label must">消费总计</label><div class="col-sm-9 form-inline"><input class="form-control" name="TotalAmount" ng-model="entity.TotalAmount" data-rule-required="true" data-rule-ismoney="true" data-rule-min="0.01" data-rule-max="950000" ng-change="onChangeAmount()" ng-disabled="!member.Name"> 元 <label for="TotalAmount" class="help-block error"></label></div></div><div class="form-group"><label class="col-sm-3 control-label must">选择优惠</label><div class="col-sm-9 form-inline"><select class="form-control m-r-sm" ng-model="couponType" ng-change="onSelectCouponType(couponType)" ng-disabled="!member.Name"><option value="-1">不使用</option><option value="1">代金券</option></select><select class="form-control" ng-model="entity.SNNo" ng-if="couponType > -1" ng-options="item.SNNo as item.Name for item in coupons[couponType]" ng-change="onSelectCoupon(couponType, entity.SNNo)"><option value="">不使用</option></select></div></div><div class="form-group"><label class="col-sm-3 control-label must">实收金额</label><div class="col-sm-9 form-inline"><input class="form-control" name="RealAmount" ng-model="entity.RealAmount" data-rule-required="true" data-rule-ismoney="true" data-rule-min="0.01" data-rule-max="950000" ng-readonly="!(couponType == 0 && entity.CouponId)" ng-disabled="!member.Name"> 元 <label for="RealAmount" class="help-block error"></label></div></div><div class="form-group"><label class="col-sm-3 control-label must">支付方式</label><div class="col-sm-9 form-inline"><label class="checkbox-inline"><input type="checkbox" style="margin-top: 10px;" ng-model="member.isBlancheAmount" value="1" ng-disabled="!member.Name"> 余额支付 <input type="number" class="form-control no-spin" name="BlancheAmount" ng-model="entity.BlancheAmount" ng-readonly="!member.isBlancheAmount" data-rule-ismoney="true" style="width:100px;" data-rule-min="0" data-rule-max="{{member.Amount<entity.RealAmount?entity.Amount: entity.RealAmount}}"> 元 <label for="BlancheAmount" class="help-block error"></label></label><br><label class="checkbox-inline"><input type="checkbox" style="margin-top: 10px;" ng-model="member.isPoints" value="1" ng-disabled="!member.Name"> 积分抵现 <input type="number" class="form-control no-spin" name="Points" ng-model="entity.Points" ng-change="calcPointAmount()" ng-readonly="!member.isPoints" data-rule-integer="true" data-rule-min="0" data-rule-max="{{member.Points}}" style="width:100px;"> 分 = <input class="form-control" ng-model="PointAmount" readonly="readonly" style="width:100px;"> 元 <label for="Points" class="help-block error"></label></label><br><label class="checkbox-inline"><input type="checkbox" style="margin-top: 10px;" ng-model="member.isCashAmount" value="1" ng-disabled="!member.Name"> 现金支付 <input type="number" class="form-control no-spin" name="CashAmount" ng-model="entity.CashAmount" ng-change="calcBackAmount()" ng-readonly="!member.isCashAmount" data-rule-ismoney="true" data-rule-min="0" data-rule-max="95000" style="width:100px;"> 元 找零 <input class="form-control" name="BackAmount" ng-model="entity.BackAmount" readonly="readonly" style="width:100px;"> 元 <label for="CashAmount" class="help-block error"></label></label></div></div><div class="form-group"><label class="col-sm-3 control-label must">消费门店</label><div class="col-sm-9"><select class="form-control" name="StoreId" ng-model="entity.StoreId" ng-options="item.id as item.name for item in stores" ng-disabled="!member.Name"><option value="">总店</option></select></div></div><div class="form-group"><label class="col-sm-3 control-label">会员卡消费密码</label><div class="col-sm-9"><input class="form-control" type="password" ng-model="entity.MemberPassWord" ng-disabled="!member.Name"></div></div><div class="form-group"><label class="col-sm-3 control-label">商家确认密码</label><div class="col-sm-9"><input class="form-control" type="password" ng-model="entity.AdminPassWord" ng-disabled="!member.Name"></div></div><div class="form-group"><label class="col-sm-3 control-label must">操作员</label><div class="col-sm-9"><label class="control-label">{{businessBaseInfo.username}}</label></div></div><div class="form-group"><label class="col-sm-3 control-label">备注</label><div class="col-sm-9"><textarea name="Remark" class="form-control" rows="3" ng-model="entity.Remark" data-rule-maxlength="100" placeholder="最多100字" ng-disabled="!member.Name"></textarea></div></div></div></div><div class="modal-footer"><button type="submit" class="btn btn-sm btn-primary" btn-loading="saveloading" loading-text="保存中...">确定</button> <button type="button" class="btn btn-sm btn-default" ng-click="cancel()">取消</button></div></form>'),e.put("/app/vip/manage/consume.print.dialog.html",'<form class="form-horizontal" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="modal-header"><button type="button" class="close" ng-click="cancel()">&times;</button><h4 class="modal-title">打印消费小票</h4></div><div class="load" ng-if="pageLoading">数据加载中...</div><div class="modal-body" ng-if="!pageLoading"><iframe-print ng-if="printDiv" print-div-text="{{printDiv}}" data-close="cancel()" data-style="border: 1px solid #ddd;width: 58mm;"></iframe-print><div class="panel-consume hidden" id="print-div"><style type="text/css">\r\n                html {text-align: center;width: 58mm;}\r\n                body{color: #000;padding: 15px 9px 0 9px;margin: 0 auto;}\r\n                .m-r{margin-right:10px;} .fr{float: right}\r\n                .title{line-height: 80%;font-weight: 400;font-size: 14px;text-align: center;padding-bottom: 20px;font-family: \'Simsun\';}\r\n                table{width: 100%;word-wrap:break-word;word-break:break-all;border-collapse:collapse;font-size:12px;font-family:"Microsoft YaHei", "微软雅黑", "MicrosoftJhengHei", "华文细黑", "STHeiti", "MingLiu";}\r\n                td{ padding:1mm 0; }tr.borderTop{margin-top: 5px;border-top: 1px dashed #000;}\r\n            </style><style media="print">\r\n                .btn{display:none;}\r\n            </style><div class="title"><p><img ng-src="{{accountBaseInfo.avatar_url}}" width="120" height="120"></p><p>{{entity.StoreName}}</p><p ng-if="entity.tel">Tel：{{entity.tel}}</p></div><table cellpadding="0" cellspacing="0"><tr><td width="30%">交易单号：</td><td>{{entity.TradeNo}}</td></tr><tr><td>卡号：</td><td>{{entity.MemberCardNo}}</td></tr><tr><td>姓名：</td><td>{{entity.Name}}</td></tr><tr><td>支付方式：</td><td>{{entity.Payment}}</td></tr><tr class="borderTop"><td colspan="2"><div>消费金额：{{entity.TotalAmout | currencyFormat}} <span class="fr">实收总计：{{entity.RealAmount | currencyFormat}}</span></div></td></tr><tr class="borderTop" ng-if="entity.BlancheAmount || entity.CashAmount"><td colspan="2"></td></tr><tr ng-if="entity.BlancheAmount"><td colspan="2"><div class="fr">卡内余额：{{entity.Amount | currencyFormat}}</div></td></tr><tr ng-if="entity.CashAmount"><td colspan="2" ng-if="entity.BlancheAmount"><div class="fr" ng-if="entity.CashAmount">找零：{{entity.BackAmount | currencyFormat}}</div></td></tr><tr class="borderTop"><td colspan="2"></td></tr><tr ng-if="entity.BlancheAmount"><td>扣除余额：</td><td>{{entity.BlancheAmount | currencyFormat}}</td></tr><td colspan="2" ng-if="entity.CashAmount"><div class="m5">现金或POS机消费：{{entity.CashAmount|currencyFormat}}</div></td><tr ng-if="entity.Discount< 100"><td>折扣：</td><td>{{entity.LevelName}} {{entity.Discount | discount}}折</td></tr><tr><td>使用优惠：</td><td>{{entity.SNNo || \'暂无\'}}</td></tr><tr><td>消费积分：</td><td>{{entity.UsePoints}}分（抵扣{{entity.UsePointsAmount | currencyFormat}}元）</td></tr><tr><td>当前积分：</td><td>{{entity.NowPoints}}分</td></tr><tr class="borderTop"><td>操作员：</td><td>{{entity.Operator}}</td></tr><tr><td>交易时间：</td><td>{{entity.Time*1000 | date:\'yyyy-MM-dd HH:mm:ss\'}}</td></tr></table></div></div></form>'),e.put("/app/vip/manage/consume.result.dialog.html",'<form class="form-horizontal" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="modal-header"><button type="button" class="close" ng-click="cancel()">&times;</button><h4 class="modal-title">消费提示</h4></div><div class="modal-body"><div class="panel-body text-center"><div class="h3">消费成功</div><div class="m-t-sm">实收总计{{entity.RealAmount}}元</div></div></div><div class="modal-footer"><button type="button" class="btn btn-sm btn-primary" ng-click="printTicket()">打印小票</button> <button type="button" class="btn btn-sm btn-default" ng-click="cancel()">关闭</button></div></form>'),e.put("/app/vip/manage/create.label.dialog.html",'<form class="form-horizontal" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="modal-header"><button type="button" class="close" ng-click="cancel()">&times;</button><h4 class="modal-title"><label ng-if="!entity.Id">创建手动标签</label> <label ng-if="entity.Id">编辑手动标签</label></h4></div><div class="modal-body"><div class="panel-body"><div class="form-group"><label class="col-sm-3 control-label must">标签名称</label><div class="col-sm-9 form-inline"><input name="Name" class="form-control m-r-sm" ng-model="entity.Name" data-rule-required="true" data-rule-chinesemax="[10,20]" data-rule-username="true"> <span class="help-block inline">{{entity.Name | chineseLen:2}} / 10</span> <label for="Name" class="help-block error"></label></div></div></div></div><div class="modal-footer"><button type="submit" class="btn btn-sm btn-primary" btn-loading="saveloading" loading-text="保存中...">确定</button> <button type="button" class="btn btn-sm btn-default" ng-click="cancel()">关闭</button></div></form>'),e.put("/app/vip/manage/createLabel.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><a class="text-href" ui-sref="app.vip.manage">会员列表</a> <label class="m-l-sm m-r-sm">/</label> <a class="text-href" ui-sref="app.vip.manageLabel">会员标签管理</a> <label class="m-l-sm m-r-sm">/</label> <span ng-if="!id">新增条件标签</span> <span ng-if="id">编辑条件标签</span></div></header><section class="scrollable wrapper"><div class="load" ng-if="loading">数据加载中...</div><div class="panel panel-default wrapper" ng-if="!loading"><form class="form-horizontal vbox m-b" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="form-group"><label class="col-sm-2 control-label must">标签名称</label><div class="col-sm-10 m-b-sm form-inline"><input name="Name" class="form-control m-r-sm" ng-model="entity.Name" data-rule-required="true" data-rule-chinesemax="[10,20]" data-rule-username="true"> <span class="help-block inline">{{entity.Name | chineseLen:2}} / 10</span> <label for="Name" class="help-block error"></label></div></div><div><ul class="nav nav-underline"><li class=""><div class="h5 m-b-sm">条件设置</div></li></ul><div class="form-group"><label class="col-sm-2 control-label">条件关系</label><div class="col-sm-10 m-b-sm"><label class="radio-inline"><input type="radio" name="LevelType" ng-model="entity.ConditionType" value="0"> 满足一个条件即可</label> <label class="radio-inline"><input type="radio" name="LevelType" ng-model="entity.ConditionType" value="1"> 必须全部满足</label> <label for="ConditionType" class="help-block error"></label></div></div><div class="form-group"><label class="col-sm-2 control-label">时间条件</label><div class="col-sm-10 m-b-sm form-inline"><label class="checkbox-inline"><input type="checkbox" ng-model="entity.isActivateDay" value="1" style="margin-top: 10px;"> 开卡时间<select ng-readonly="entity.isActivateDay != 1" name="ActivateDay" ng-model="entity.ActivateDay" class="form-control m-l" data-rule-required="{{entity.isActivateDay}}" ng-options="item.val as item.text for item in activateDays"><option value="">请选择</option></select></label><br><label class="checkbox-inline"><input type="checkbox" ng-model="entity.isConsumingDay" value="1" style="margin-top: 10px;"> 交易时间<select ng-readonly="entity.isConsumingDay != 1" name="ConsumingDay" ng-model="entity.ConsumingDay" class="form-control m-l" data-rule-required="{{entity.isConsumingDay}}" ng-options="item.val as item.text for item in consumingDays"><option value="">请选择</option></select></label></div></div><div class="form-group"><label class="col-sm-2 control-label">会员条件</label><div class="col-sm-10 m-b-sm form-inline"><label class="checkbox-inline"><input type="checkbox" ng-model="entity.isLevelNo" value="1" style="margin-top: 10px;"> 会员等级<select ng-readonly="entity.isLevelNo != 1" name="LevelNo" ng-model="entity.LevelNo" class="form-control m-l" ng-options="item.LevelNo as item.LevelName for item in levels" data-rule-required="{{entity.isLevelNo}}"><option value="">请选择</option></select></label><br><label class="checkbox-inline"><input type="checkbox" ng-model="entity.isSex" value="1" style="margin-top: 10px;"> 会员性别<select ng-disabled="entity.isSex != 1" name="Sex" ng-model="entity.Sex" class="form-control m-l" data-rule-required="{{entity.isSex}}" ng-options="item.val as item.text for item in sexs"><option value="">请选择</option></select></label><br><label class="checkbox-inline" style="line-height: 30px;"><input type="checkbox" ng-model="entity.isAddress" value="1" style="margin-top: 10px;"> 会员地域<address2 ng-if="entity.isAddress" class="inline m-l" ng-model="address" address-num="2" data-required="true" data-selected="onAddressSelected(data)"></address2></label></div></div><div class="form-group"><label class="col-sm-2 control-label">交易条件</label><div class="col-sm-10 m-b-sm form-inline"><label class="checkbox-inline"><input type="checkbox" ng-model="entity.isTransactionsCount" value="1" style="margin-top: 10px;" ng-change="onChange(\'isTransactionsCount\', \'TransactionsCountMin\')"> <span class="inline m-r">交易笔数</span> <input ng-readonly="entity.isTransactionsCount != 1" name="TransactionsCountMin" ng-model="entity.TransactionsCountMin" class="form-control m-r" data-rule-number="true" data-rule-min="{{entity.isTransactionsCount?1:0}}" data-rule-max="100000000"> <span class="inline m-r">-</span> <input ng-readonly="entity.isTransactionsCount != 1" name="TransactionsCountMax" ng-model="entity.TransactionsCountMax" class="form-control" data-rule-number="true" data-rule-min="{{entity.TransactionsCountMin}}" data-rule-max="100000000"> 笔</label><br><label for="TransactionsCountMin" class="help-block error" style="margin-left: 90px;"></label> <label for="TransactionsCountMax" class="help-block error" style="margin-left: 90px;"></label> <label class="checkbox-inline"><input type="checkbox" ng-model="entity.isConsumingAmount" value="1" style="margin-top: 10px;" ng-change="onChange(\'isConsumingAmount\', \'ConsumingAmountMin\')"> <span class="inline m-r">累计消费</span> <input ng-readonly="entity.isConsumingAmount != 1" name="ConsumingAmountMin" ng-model="entity.ConsumingAmountMin" class="form-control m-r" data-rule-number="true" data-rule-min="{{entity.isConsumingAmount?1:0}}" data-rule-max="100000000"> <span class="inline m-r">-</span> <input ng-readonly="entity.isConsumingAmount != 1" name="ConsumingAmountMax" ng-model="entity.ConsumingAmountMax" class="form-control" data-rule-number="true" data-rule-min="{{entity.ConsumingAmountMin}}" data-rule-max="100000000"> 元</label><br><label for="ConsumingAmountMin" class="help-block error" style="margin-left: 90px;"></label> <label for="ConsumingAmountMax" class="help-block error" style="margin-left: 90px;"></label> <label class="checkbox-inline"><input type="checkbox" ng-model="entity.isPerSales" value="1" style="margin-top: 10px;" ng-change="onChange(\'isPerSales\', \'PerSalesMin\')"> <span class="inline m-r">客单价&nbsp; &nbsp;</span> <input ng-readonly="entity.isPerSales != 1" name="PerSalesMin" ng-model="entity.PerSalesMin" class="form-control m-r" data-rule-number="true" data-rule-max="100000000" data-rule-min="{{entity.isPerSales?1:0}}"> <span class="inline m-r">-</span> <input ng-readonly="entity.isPerSales != 1" name="PerSalesMax" ng-model="entity.PerSalesMax" class="form-control" data-rule-number="true" data-rule-min="{{entity.PerSalesMin}}" data-rule-max="100000000"> 元</label> <label for="PerSalesMin" class="help-block error" style="margin-left: 90px;"></label> <label for="PerSalesMax" class="help-block error" style="margin-left: 90px;"></label></div></div></div><div class="form-group"><label class="col-sm-2 control-label"></label><div class="col-sm-10"><button class="btn btn-sm btn-primary" ng-disabled="!canSave()" btn-loading="saveloading" loading-text="保存中...">保存</button></div></div></form></div></section></section>'),e.put("/app/vip/manage/index.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t">会员列表</div></header><section class="scrollable wrapper" style="overflow-x: auto"><div class="load" ng-if="parentLoading || loading">数据加载中...</div><div class="panel panel-default wrapper pull-left" ng-if="!parentLoading && !loading" style="min-width: 100%"><form class="form-horizontal m-b" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div ng-if="!isMore" class="form-inline m-t"><input class="form-control m-r-sm" placeholder="备注名、姓名、会员卡号、手机号" style="width: 240px;" ng-model="searchParams.Info" ng-keyup="searchEnter()"> <button class="btn btn-sm btn-default m-r-sm" type="button" ng-click="showMore()">更多</button> <button class="btn btn-sm btn-info" ng-click="search()">搜索</button></div><div ng-if="isMore"><div class="form-group m-t"><div class="col-sm-4"><label>会员信息（备注名、姓名、会员卡号、手机号）</label><br><input class="form-control" placeholder="不限" ng-model="searchParams.Info"></div><div class="col-sm-4"><label>会员等级</label><br><ui-select multiple="" ng-model="searchParams.ListLevelNo" theme="bootstrap" close-on-select="false"><ui-select-match placeholder="请选择会员等级...">{{$item.LevelName}}</ui-select-match><ui-select-choices repeat="item in vipDegrees | propsFilter: {LevelName: $select.search}" refresh-delay="0">{{item.LevelName}}</ui-select-choices></ui-select></div><div class="col-sm-4"><label>标签</label><br><ui-select multiple="" ng-model="searchParams.ListTagId" theme="bootstrap" close-on-select="false"><ui-select-match placeholder="请选择标签...">{{$item.Name}}</ui-select-match><ui-select-choices repeat="item in vipTags2 | propsFilter: {Name: $select.search}" refresh-delay="0">{{item.Name}}</ui-select-choices></ui-select></div></div><div class="form-group m-t"><div class="col-sm-2 form-inline"><label>性别</label><br><select class="form-control" ng-model="searchParams.Sex" ng-options="item.value as item.title for item in sexs"><option value="">不限</option></select></div><div class="col-sm-2 form-inline"><label>年龄</label><br><select class="form-control" ng-model="searchParams.Age" ng-options="item.value as item.title for item in ages"><option value="">不限</option></select></div><div class="col-sm-4"><label>地域</label><br><address2 ng-model="address" address-num="2" data-required="false" data-selected="onAddressSelected(data)"></address2></div><div class="col-sm-4 form-inline"><label>上次交易</label><br><select class="form-control" ng-model="searchParams.LastConsumingTime" ng-options="item.value as item.title for item in lastTimes"><option value="">不限</option></select></div></div><div class="form-group m-t form-inline"><div class="col-sm-4"><label>交易笔数（笔）</label><br><input class="form-control" style="width: 150px" placeholder="0" ng-model="searchParams.ConsumingCountMin" data-rule-integer="true" data-rule-min="0" data-rule-max="{{searchParams.ConsumingCountMax || 950000}}"> - <input class="form-control" style="width: 150px" placeholder="不限" ng-model="searchParams.ConsumingCountMax" data-rule-integer="true" data-rule-min="{{searchParams.ConsumingCountMin}}"></div><div class="col-sm-4"><label>交易金额（元）</label><br><input class="form-control" style="width: 150px" placeholder="0" ng-model="searchParams.AllConsumingAmountMin" data-rule-ismoney="true" data-rule-max="{{searchParams.AllConsumingAmountMax || 950000}}"> - <input class="form-control" style="width: 150px" placeholder="不限" data-rule-min="{{searchParams.AllConsumingAmountMin}}" ng-model="searchParams.AllConsumingAmountMax" data-rule-ismoney="true"></div><div class="col-sm-4" style="margin-top:26px;"><button class="btn btn-sm btn-default" type="button" ng-click="showMore()">收起</button> <button class="btn btn-sm btn-info m-r" ng-click="search()">搜索</button> <a class="text-href v-middle" ng-click="onClear()">清空</a></div></div></div></form><div class="m-t"><button class="btn btn-sm btn-info" ng-disabled="exportDataing" ng-click="exportMemberInfoList()"><span ng-if="exportDataing"><i ng-if="exportDataing" class="fa fa-spinner fa-pulse fa-fw"></i> 数据生成中...</span> <span ng-if="!exportDataing">导出会员数据</span></button> <a ng-if="exportData.Status == 1" class="text-href v-middle" ng-href="{{exportData.FileUrl}}" download="{{exportData.FileName}}">下载数据表格</a> <span style="margin-left: 134px;"><button class="btn btn-sm btn-default" ng-click="setTag(tableParams.checkboxes.items)" ng-disabled="!tableParams.checkboxes.items.length" title="{{tableParams.checkboxes.items.length?\'\':\'请选择对象\'}}">打标签</button> <button class="btn btn-sm btn-default" ng-click="setDegree(tableParams.checkboxes.items)" ng-disabled="!tableParams.checkboxes.items.length" title="{{tableParams.checkboxes.items.length?\'\':\'请选择对象\'}}">修改等级</button> <button class="btn btn-sm btn-default" popup-confirm="" popup-placement="left" popup-body="确定积分清零吗" popup-confirm-callback="clearPoint(tableParams.checkboxes.items)" popup-confirm-button="清零" popup-title="积分清零" ng-disabled="!tableParams.checkboxes.items.length" title="{{tableParams.checkboxes.items.length?\'\':\'请选择对象\'}}">积分清零</button> <button class="btn btn-sm btn-default" popup-confirm="" popup-placement="left" popup-body="确定冻结吗" popup-confirm-callback="freeze(tableParams.checkboxes.items, 1)" popup-confirm-button="冻结" popup-title="冻结" ng-disabled="!tableParams.checkboxes.items.length" title="{{tableParams.checkboxes.items.length?\'\':\'请选择对象\'}}">冻结</button> <button class="btn btn-sm btn-default" popup-confirm="" popup-placement="left" popup-body="确定解冻吗" popup-confirm-callback="freeze(tableParams.checkboxes.items, 0)" popup-confirm-button="解冻" popup-title="解冻" ng-disabled="!tableParams.checkboxes.items.length" title="{{tableParams.checkboxes.items.length?\'\':\'请选择对象\'}}">解冻</button></span> <span class="pull-right"><button class="btn btn-sm btn-default" ui-sref="app.vip.manageLabel">标签管理</button></span></div><div class="panel panel-default m-t pull-left" style="min-width: 100%" loading-container="loading || tableParams.settings().$loading"><table ng-table="tableParams" class="table bold table-hover m-b-none text-nowrap pos-rlt" checkbox-show="true" checkbox-key="Id" style="background-color: #fff"><tr ng-repeat="item in $data"><td data-title="\'客户信息\'" style="padding-bottom: 42px"><div style="margin-bottom: 8px"><div class="pos-abt v-top"><a class="text-ellipsis inline v-middle" style="max-width: 150px;" title="{{getName(item)}}" ui-sref="app.vip.manageVipView({id: item.MemberCardNo})"><img ng-if="item.HeadUrl" ng-src="{{item.HeadUrl | wechatImg:64 }}" width="48" height="48"> <img ng-if="!item.HeadUrl" src="http://stc.home.weimob.cn/assets/images/icons/avatar.png" width="48" height="48"></a></div><div style="margin-left: 60px;"><a class="text-ellipsis inline v-middle" style="max-width: 150px;" title="{{getName(item)}}" ui-sref="app.vip.manageVipView({id: item.MemberCardNo})">{{getName(item)}}</a> <label ng-if="item.MemberStatus !=2 && item.MemberStatus!=3" class="label label-gray m-l-sm">{{item.Level.Value}}</label> <label ng-if="item.MemberStatus ==2 || item.MemberStatus==3" class="label label-gray m-l-sm">{{item.MemberStatus | memberStatus}}</label></div></div><div class="text-nowrap pos-abt border-top" style="margin-left: 98px;"><label class="label label-border m-r-sm" ng-repeat="tag in item.Tags" ng-class="{\'label-info\':!isConditionTag(tag.Value),\'label-green\':isConditionTag(tag.Value)}">{{tag.Value}} <i ng-if="!isConditionTag(tag.Value)" class="fa fa-close pointer" ng-click="removeTag(item, tag)"></i></label> <label class="label label-add pointer" ng-click="setTag([item], item.Tags)"><i class="fa fa-plus"></i> 添加标签</label></div></td><td data-title="\'卡号\'">{{item.MemberCardNo}}</td><td data-title="\'手机\'">{{item.Phone}}</td><td data-title="\'可用余额\'">{{item.Amount | currencyFormat}}</td><td data-title="\'可用积分\'">{{item.Points}}</td><td data-title="\'累计消费\'">{{item.AllConsumingAmount | currencyFormat}}</td><td data-title="\'消费次数\'">{{item.ConsumingCount}}</td><td data-title="\'操作\'"><a class="text-href" style="margin-right: 5px;" ui-sref="app.vip.manageVipView({id: item.MemberCardNo})">详情</a> <a class="text-href" style="margin-right: 5px;" ng-click="recharge(item)">充值</a> <a class="text-href" style="margin-right: 5px;" ng-click="consume(item)">消费</a><div class="dropdown text-href inline" dropdown=""><a dropdown-toggle="">更多 <i class="fa fa-angle-down"></i></a><div class="dropdown-menu m-r" role="menu" style="min-width: 100px;"><div class="m-l"><a class="text-href" ng-click="setRemarkName(item)">备注</a></div><div class="m-l"><a class="text-href" ng-click="changePoints(item)">送积分</a></div><div class="m-l"><a class="text-href" ng-click="setDegree([item])">设等级</a></div><div class="m-l" ng-if="item.MemberStatus==3"><a class="text-href" ng-click="resetExpire(item)">重置有效期</a></div></div></div></td></tr><tr ng-if="!tableParams.settings().$loading" class="text-center"><td colspan="11" ng-if="$data.length==0">没有找到任何记录!</td></tr></table></div></div></section></section>'),e.put("/app/vip/manage/label.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><a class="text-href" ui-sref="app.vip.manage">会员列表</a> <label class="m-l-sm m-r-sm">/</label> 会员标签管理</div></header><section class="scrollable wrapper"><div class="load" ng-if="loading">数据加载中...</div><div class="panel panel-default wrapper"><div class="m-t"><div class="h4">手动标签 <a class="btn btn-sm btn-info m-l" ng-click="onCreateLabel()"><i class="fa fa-plus"></i> 新增手动标签</a><form class="form-horizontal m-b pull-right" form-validator="" formvalidatorconfig="eventformvalidate" method="post" style="margin-top: -18px;"><div class="form-inline m-t"><input class="form-control" placeholder="标签名称" ng-model="searchParams.text"> <button class="btn btn-sm btn-info m-r-lg">搜索</button></div></form></div><div class="m-t m-r inline" ng-repeat="item in vipTags" ng-if="item.Type == 0" vip-label-ctrl="" ng-model="item" del-tag="onDelTag(id)"></div></div><div class="m-t"><div class="h4">条件标签 <a ng-if="canAddConditionLabel()" class="btn btn-sm btn-success m-l" ui-sref="app.vip.createLabel"><i class="fa fa-plus"></i> 新增条件标签</a></div><div class="m-t m-r inline" ng-repeat="item in vipTags2" ng-if="item.Type == 1" vip-label-ctrl="" ng-model="item" del-tag="onDelTag(id)"></div></div></div></section></section>'),e.put("/app/vip/manage/points.dialog.html",'<form class="form-horizontal" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="modal-header"><button type="button" class="close" ng-click="cancel()">&times;</button><h4 class="modal-title">手动修改积分</h4></div><div class="modal-body" ng-if="!pageLoading"><div class="panel-body"><div class="form-group" ng-if="needQuery"><div class="col-sm-3"><select class="form-control must" ng-model="queryType" ng-change="clearMember()"><option value="1">会员卡号</option><option value="2">手机号码</option></select></div><div class="col-sm-9 form-inline pos-rlt"><input ng-if="queryType == 2" class="form-control" name="Phone" ng-model="member.Phone" data-rule-required="true" data-rule-mobile="true" ng-change="queryMember(queryType)"> <input ng-if="queryType == 1" class="form-control" style="opacity: 0"> <input ng-if="queryType == 1" class="form-control pos-abt" style="left: 15px;" name="MemberCardNo" ng-model="member.MemberCardNo" data-rule-required="true" data-rule-maxlength="100" ng-change="queryMember(queryType)"> <label class="help-block error">{{queryError}}</label></div></div><div class="form-group" style="margin-top: -20px"><label class="col-sm-3 control-label"><span ng-if="!needQuery">会员信息</span></label><div class="col-sm-9" ng-if="member.Name"><div class="help-block">会员：{{member.Name}}，等级：{{member.Level.Value}}，折扣：{{member.DisCount | discount}}<br>余额：{{member.Amount}}，积分：{{member.Points}}</div></div></div><div class="form-group"><label class="col-sm-3 control-label must">修改积分(增减)</label><div class="col-sm-9"><input class="form-control" name="Points" ng-model="entity.Points" data-rule-required="true" data-rule-integer="true" data-rule-min="{{member.Points?-member.Points:1}}" data-rule-max="1000000000" ng-disabled="!member.Name"> <label class="help-block">可用积分{{member.Points|| 0}}。 输入500，表示增加500;输入-500则表示减少500</label> <label for="Points" class="help-block error"></label></div></div><div class="form-group"><label class="col-sm-3 control-label must">修改门店</label><div class="col-sm-9"><select class="form-control" name="tag" ng-model="entity.StoreId" ng-options="item.id as item.name for item in stores" ng-disabled="!member.Name"><option value="">总店</option></select></div></div><div class="form-group"><label class="col-sm-3 control-label must">操作员</label><div class="col-sm-9"><label class="control-label">{{businessBaseInfo.username}}</label></div></div><div class="form-group"><label class="col-sm-3 control-label">备注</label><div class="col-sm-9"><textarea class="form-control" rows="3" ng-model="entity.Remark" data-rule-maxlength="100" placeholder="最多100字" ng-disabled="!member.Name"></textarea></div></div></div></div><div class="modal-footer"><button type="submit" class="btn btn-sm btn-primary" btn-loading="saveloading" loading-text="保存中...">确定</button> <button type="button" class="btn btn-sm btn-default" ng-click="cancel()">取消</button></div></form>'),e.put("/app/vip/manage/recharge.dialog.html",'<form class="form-horizontal" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="modal-header"><button type="button" class="close" ng-click="cancel()">&times;</button><h4 class="modal-title">会员充值</h4></div><div class="modal-body" ng-if="!pageLoading"><div class="panel-body"><div class="form-group" ng-if="needQuery"><div class="col-sm-3"><select class="form-control must" ng-model="queryType" ng-change="clearMember()"><option value="1">会员卡号</option><option value="2">手机号码</option></select></div><div class="col-sm-9 form-inline pos-rlt"><input ng-if="queryType == 2" class="form-control" name="Phone" ng-model="member.Phone" data-rule-required="true" data-rule-mobile="true" ng-change="queryMember(queryType)"> <input ng-if="queryType == 1" class="form-control" style="opacity: 0"> <input ng-if="queryType == 1" class="form-control pos-abt" style="left: 15px;" name="MemberCardNo" ng-model="member.MemberCardNo" data-rule-required="true" data-rule-maxlength="100" ng-change="queryMember(queryType)"> <label class="help-block error">{{queryError}}</label></div></div><div class="form-group" style="margin-top: -20px"><label class="col-sm-3 control-label"><span ng-if="!needQuery">会员信息</span></label><div class="col-sm-9" ng-if="member.Name"><div class="help-block">会员：{{member.Name}}，等级：{{member.Level.Value}}，折扣：{{member.DisCount | discount}}<br>余额：{{member.Amount}}，积分：{{member.Points}}</div></div></div><div class="form-group"><label class="col-sm-3 control-label must">充值金额</label><div class="col-sm-9 form-inline"><input class="form-control" name="Amount" ng-model="entity.Amount" data-rule-required="true" data-rule-ismoney="true" data-rule-min="0.01" data-rule-max="950000" ng-disabled="!member.Name"> 元 <label for="Amount" class="help-block error"></label></div></div><div class="form-group"><label class="col-sm-3 control-label must">充值门店</label><div class="col-sm-9"><select class="form-control" name="tag" ng-model="entity.StoreId" ng-options="item.id as item.name for item in stores" ng-disabled="!member.Name"><option value="">总店</option></select></div></div><div class="form-group"><label class="col-sm-3 control-label">充值密码</label><div class="col-sm-9"><input class="form-control" type="password" ng-model="entity.PassWord" ng-disabled="!member.Name"></div></div><div class="form-group"><label class="col-sm-3 control-label must">操作员</label><div class="col-sm-9"><label class="control-label">{{businessBaseInfo.username}}</label></div></div><div class="form-group"><label class="col-sm-3 control-label">备注</label><div class="col-sm-9"><textarea class="form-control" rows="3" ng-model="entity.Remark" data-rule-maxlength="100" placeholder="最多100字" ng-disabled="!member.Name"></textarea></div></div></div></div><div class="modal-footer"><button type="submit" class="btn btn-sm btn-primary" btn-loading="saveloading" loading-text="保存中...">确定</button> <button type="button" class="btn btn-sm btn-default" ng-click="cancel()">取消</button></div></form>'),e.put("/app/vip/manage/setDegree.dialog.html",'<form class="form-horizontal" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="modal-header"><button type="button" class="close" ng-click="cancel()">&times;</button><h4 class="modal-title">会员等级</h4></div><div class="modal-body" ng-if="!pageLoading"><div class="panel-body"><div class="form-group"><label class="col-sm-3 control-label must">请选择会员等级</label><div class="col-sm-9"><select class="form-control" name="degree" data-rule-required="true" ng-model="entity.level" ng-options="item.LevelName for item in vipDegrees"><option value="">请选择</option></select></div></div></div></div><div class="modal-footer"><button type="submit" class="btn btn-sm btn-primary" btn-loading="saveloading" loading-text="保存中...">确定</button> <button type="button" class="btn btn-sm btn-default" ng-click="cancel()">取消</button></div></form>'),e.put("/app/vip/manage/setRemarkName.dialog.html",'<form class="form-horizontal" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="modal-header"><button type="button" class="close" ng-click="cancel()">&times;</button><h4 class="modal-title">设置会员备注名称</h4></div><div class="modal-body"><div class="panel-body"><div class="form-group"><label class="col-sm-3 control-label must">备注名称</label><div class="col-sm-9"><input class="form-control" name="RemarkName" data-rule-required="true" ng-model="entity.NickName" data-rule-maxlength="100"></div></div></div></div><div class="modal-footer"><button type="submit" class="btn btn-sm btn-primary" btn-loading="saveloading" loading-text="保存中...">确定</button> <button type="button" class="btn btn-sm btn-default" ng-click="cancel()">取消</button></div></form>'),e.put("/app/vip/manage/setTag.dialog.html",'<form class="form-horizontal" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="modal-header"><button type="button" class="close" ng-click="cancel()">&times;</button><h4 class="modal-title">会员标签</h4></div><div class="modal-body" ng-if="!pageLoading"><div class="panel-body"><div class="form-group"><label class="col-sm-3 control-label must">请选择标签</label><div class="col-sm-9"><select class="form-control" name="tag" data-rule-required="true" ng-model="entity.tag" ng-options="item.Name for item in vipTags"><option value="">请选择</option></select></div></div></div></div><div class="modal-footer"><button type="submit" class="btn btn-sm btn-primary" btn-loading="saveloading" loading-text="保存中...">确定</button> <button type="button" class="btn btn-sm btn-default" ng-click="cancel()">取消</button></div></form>'),e.put("/app/vip/manage/tagMember.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><a class="text-href" ui-sref="app.vip.manage">会员列表</a> <label class="m-l-sm m-r-sm">/</label> {{entity.Name}}</div></header><section class="scrollable wrapper" style="overflow-x: auto"><div class="load" ng-if="parentLoading || loading">数据加载中...</div><div class="panel panel-default wrapper pull-left" ng-if="!parentLoading && !loading" style="min-width: 100%"><div class="m-t"><span><button class="btn btn-sm btn-default" ng-click="setTag(tableParams.checkboxes.items)" ng-disabled="!tableParams.checkboxes.items.length" title="{{tableParams.checkboxes.items.length?\'\':\'请选择对象\'}}">打标签</button> <button class="btn btn-sm btn-default" ng-click="setDegree(tableParams.checkboxes.items)" ng-disabled="!tableParams.checkboxes.items.length" title="{{tableParams.checkboxes.items.length?\'\':\'请选择对象\'}}">修改等级</button> <button class="btn btn-sm btn-default" popup-confirm="" popup-placement="left" popup-body="确定积分清零吗" popup-confirm-callback="clearPoint(tableParams.checkboxes.items)" popup-confirm-button="清零" popup-title="积分清零" ng-disabled="!tableParams.checkboxes.items.length" title="{{tableParams.checkboxes.items.length?\'\':\'请选择对象\'}}">积分清零</button> <button class="btn btn-sm btn-default" popup-confirm="" popup-placement="left" popup-body="确定冻结吗" popup-confirm-callback="freeze(tableParams.checkboxes.items, 1)" popup-confirm-button="冻结" popup-title="冻结" ng-disabled="!tableParams.checkboxes.items.length" title="{{tableParams.checkboxes.items.length?\'\':\'请选择对象\'}}">冻结</button> <button class="btn btn-sm btn-default" popup-confirm="" popup-placement="left" popup-body="确定解冻吗" popup-confirm-callback="freeze(tableParams.checkboxes.items, 0)" popup-confirm-button="解冻" popup-title="解冻" ng-disabled="!tableParams.checkboxes.items.length" title="{{tableParams.checkboxes.items.length?\'\':\'请选择对象\'}}">解冻</button></span> <span class="pull-right"><button class="btn btn-sm btn-default" ui-sref="app.vip.manageLabel">标签管理</button></span></div><div class="panel panel-default m-t pull-left" style="min-width: 100%" loading-container="loading || tableParams.settings().$loading"><table ng-table="tableParams" class="table bold table-hover m-b-none text-nowrap pos-rlt" checkbox-show="true" checkbox-key="Id" style="background-color: #fff"><tr ng-repeat="item in $data"><td data-title="\'客户信息\'" style="padding-bottom: 42px"><div style="margin-bottom: 8px"><a class="text-ellipsis inline v-middle" style="max-width: 80px;" title="{{item.Name}}" ui-sref="app.vip.manageVipView({id: item.MemberCardNo})">{{item.Name}}</a> <label ng-if="item.MemberStatus !=2 && item.MemberStatus!=3" class="label label-yellow m-l-sm">{{item.Level.Value}}</label> <label ng-if="item.MemberStatus ==2 || item.MemberStatus==3" class="label label-gray m-l-sm">{{item.MemberStatus | memberStatus}}</label></div><div class="text-nowrap pos-abt border-top" style="padding-left: 38px;"><label class="label label-border m-r-sm" ng-repeat="tag in item.Tags" ng-class="{\'label-info\':!isConditionTag(tag.Value),\'label-green\':isConditionTag(tag.Value)}">{{tag.Value}} <i ng-if="!isConditionTag(tag.Value)" class="fa fa-close pointer" ng-click="removeTag(item, tag)"></i></label> <label class="label label-add pointer" ng-click="setTag([item], item.Tags)"><i class="fa fa-plus"></i> 添加标签</label></div></td><td data-title="\'卡号\'">{{item.MemberCardNo}}</td><td data-title="\'手机\'">{{item.Phone}}</td><td data-title="\'可用余额\'">{{item.Amount | currencyFormat}}</td><td data-title="\'可用积分\'">{{item.Points}}</td><td data-title="\'累计消费\'">{{item.AllConsumingAmount | currencyFormat}}</td><td data-title="\'消费次数\'">{{item.ConsumingCount}}</td><td data-title="\'操作\'"><a class="text-href" style="margin-right: 5px;" ui-sref="app.vip.manageVipView({id: item.MemberCardNo})">详情</a> <a class="text-href" style="margin-right: 5px;" ng-click="recharge(item)">充值</a> <a class="text-href" style="margin-right: 5px;" ng-click="consume(item)">消费</a><div class="dropdown text-href inline" dropdown=""><a dropdown-toggle="">更多 <i class="fa fa-angle-down"></i></a><div class="dropdown-menu m-r" role="menu" style="min-width: 90px;"><div class="m-l"><a class="text-href" ng-click="setRemarkName(item)">备注</a></div><div class="m-l"><a class="text-href" ng-click="changePoints(item)">送积分</a></div><div class="m-l"><a class="text-href" ng-click="setDegree([item])">设等级</a></div></div></div></td></tr><tr ng-if="!tableParams.settings().$loading" class="text-center"><td colspan="11" ng-if="$data.length==0">没有找到任何记录!</td></tr></table></div></div></section></section>'),e.put("/app/vip/manage/useCoupon.dialog.html",'<form class="form-horizontal" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="modal-header"><button type="button" class="close" ng-click="cancel()">&times;</button><h4 class="modal-title">优惠券核销</h4></div><div class="modal-body" ng-if="!pageLoading"><div class="panel-body"><div class="form-group" ng-if="needQuery"><div class="col-sm-3"><select class="form-control must" ng-model="queryType"><option value="1">会员卡号</option><option value="2">手机号码</option></select></div><div class="col-sm-9 form-inline pos-rlt"><input ng-if="queryType == 2" class="form-control" name="Phone" ng-model="member.Phone" data-rule-required="true" data-rule-mobile="true" ng-change="queryMember(queryType)"> <input ng-if="queryType == 1" class="form-control pos-abt" style="left: 15px;" name="MemberCardNo" ng-model="member.MemberCardNo" data-rule-required="true" data-rule-maxlength="100" ng-change="queryMember(queryType)"> <label class="help-block error">{{queryError}}</label><div class="help-block" ng-if="member.queried">会员：{{member.Name}}，等级：{{member.Level.Value}}，折扣：{{member.DisCount | discount}}<br>余额：{{member.Amount}}，积分：{{member.Points}}</div></div></div><div class="form-group"><label class="col-sm-3 control-label must">选择优惠</label><div class="col-sm-9 form-inline"><select class="form-control" ng-model="entity.SNNo" ng-options="item.SNNo as item.Name + \' \' + item.SNNo for item in coupons" data-rule-required="true" ng-disabled="!member.Name"><option value="">请选择</option></select></div></div><div class="form-group"><label class="col-sm-3 control-label must">核销门店</label><div class="col-sm-9"><select class="form-control" name="StoreId" ng-model="entity.StoreId" ng-options="item.id as item.name for item in stores" ng-disabled="!member.Name"><option value="">总店</option></select></div></div></div></div><div class="modal-footer"><button type="submit" class="btn btn-sm btn-primary" btn-loading="saveloading" loading-text="保存中...">确定</button> <button type="button" class="btn btn-sm btn-default" ng-click="cancel()">取消</button></div></form>'),e.put("/app/vip/manage/vipView.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><a class="text-href" ui-sref="app.vip.manage">会员列表</a> <label class="m-l-sm m-r-sm">/</label> <label ng-if="entity.Name">{{entity.Name}}的详情</label></div></header><section class="scrollable wrapper"><div class="load" ng-if="loading">数据加载中...</div><div class="panel panel-default wrapper" ng-if="!loading"><div class="row m-b m-l m-r"><div class="pull-left m-r image-container"><img ng-if="entity.HeadUrl" ng-src="{{entity.HeadUrl | wechatImg:132 }}" width="132" height="132"> <img ng-if="!entity.HeadUrl" src="http://stc.home.weimob.cn/assets/images/icons/avatar.png" width="132" height="132"><div class="cover"><div class="middle pointer" style="margin-top: 46px;" ng-click="onUploadAvatar()"><i class="fa fa-refresh fa-2x" ng-class="{\'fa-spin\':isUploading}"></i><div>刷新</div></div></div></div><div class="pull-left m-b-sm no-padder"><div class="row"><div class="col-sm-12"><label class="help-inline font-bold">{{entity.Name}}</label></div></div><div class="row"><div class="col-sm-6 form-inline"><label class="help-inline m-r-sm">备注名</label> <span ng-switch="" on="isModifyRemarkName"><span ng-switch-when="true"><input class="form-control" ng-model="entity.NickName"></span> <span ng-switch-default="">{{entity.NickName || \'（未设置）\'}}</span></span> <a class="text-href m-l" ng-click="setRemarkName()">{{isModifyRemarkName? \'保存\':\'修改\'}}</a><br><label class="help-inline m-r-sm">手&nbsp;&nbsp;&nbsp;机</label> {{entity.Phone}}<br><label class="help-inline m-r-sm">余&nbsp;&nbsp;&nbsp;额</label> {{entity.Amount | currencyFormat}} 元</div><div class="col-sm-6"><label class="help-inline m-r-sm">等级</label> {{entity.Level.Value}}<br><label class="help-inline m-r-sm">卡号</label> {{entity.MemberCardNo}}<br><label class="help-inline m-r-sm">积分</label> {{entity.Points}}</div><div class="col-sm-12"><label class="help-inline m-r-sm">成长值</label> {{entity.GrowthValue}}<br><button class="btn btn-sm btn-info" ng-click="recharge(entity)">充值</button> <button class="btn btn-sm btn-info" ng-click="consume(entity)">消费</button> <button class="btn btn-sm btn-info" ng-click="changePoints(entity)">送积分</button> <button class="btn btn-sm btn-info" ng-click="setDegree(entity)">修改等级</button></div></div></div></div><div class="row m-b-lg m-l m-r"><div class="h4 m-b nav nav-underline padder-v">标签</div><label ng-repeat="tag in entity.Tags" class="label label-info m-r-sm">{{tag.Value}} <i class="fa fa-close pointer" ng-click="removeTag(entity, tag)"></i></label> <label class="label label-warning" ng-click="setTag([entity], entity.Tags)"><i class="fa fa-plus"></i> 添加标签</label></div><form class="row m-b-lg m-l m-r" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="h4 m-b nav nav-underline padder-v"><span class="pos-rlt" style="top: 15px;">客户信息</span><div class="pull-right" ng-if="!isEdit"><button type="button" class="btn btn-sm btn-info" ng-click="onEdit(true)">编辑</button></div><div class="pull-right" ng-if="isEdit"><button class="btn btn-sm btn-primary">保存</button> <button type="button" class="btn btn-sm btn-default" ng-click="onEdit(false)">取消</button></div></div><div class="row form-horizontal" ng-if="!isEdit"><div class="row" ng-repeat="item in templateInfos" ng-if="item.Display"><div class="col-sm-2 control-label">{{item.Name}}</div><div class="col-sm-10"><label class="control-label text-left">{{getValue(item.Name, item.IsCustom)}}</label></div></div></div><div class="row form-horizontal" ng-if="isEdit"><div class="row m-b-sm" ng-repeat="item in templateInfos" ng-if="item.Display"><div class="col-sm-2 control-label">{{item.Name}}</div><div class="col-sm-10 form-inline"><div ng-if="item.Modify"><input name="Name" ng-if="item.Name == \'姓名\'" class="form-control" ng-model="entity.Name" data-rule-required="{{item.Must}}"><select name="Sex" ng-if="item.Name == \'性别\'" class="form-control" ng-model="entity.Sex" data-rule-required="{{item.Must}}"><option value="0">请选择</option><option value="1">男</option><option value="2">女</option></select><datetimepicker2 ng-if="item.Name == \'生日\'" ng-model="entity.Birthday" is-day="true" required="item.Must"></datetimepicker2><input name="Phone" ng-if="item.Name == \'手机号\'" class="form-control" ng-model="entity.Phone" data-rule-required="{{item.Must}}"> <input name="EMail" ng-if="item.Name == \'邮箱\'" class="form-control" ng-model="entity.EMail" data-rule-required="{{item.Must}}"><address2 ng-if="item.Name == \'详细地址\'" ng-model="address" required="item.Must" selected="onAddress(data)"></address2><input name="Address" ng-if="item.Name == \'详细地址\'" class="form-control m-t" ng-model="entity.AddressInfo.Address" data-rule-required="{{item.Must}}"><select name="Degree" ng-if="item.Name == \'学历\'" class="form-control" ng-model="entity.Degree" ng-options="i as i|degree for i in degrees" data-rule-required="{{item.Must}}"><option value="">请选择</option></select><select name="Profession" ng-if="item.Name == \'行业\'" class="form-control" ng-model="entity.Profession" ng-options="i as i|profession for i in professions" data-rule-required="{{item.Must}}"><option value="">请选择</option></select><select name="Income" ng-if="item.Name == \'收入\'" class="form-control" ng-model="entity.Income" ng-options="i as i|income for i in incomes" data-rule-required="{{item.Must}}"><option value="">请选择</option></select><select name="Hobby" ng-if="item.Name == \'爱好\'" class="form-control" ng-model="entity.Hobby" ng-options="i as i|hobby for i in hobbies" data-rule-required="{{item.Must}}"><option value="">请选择</option></select><input name="Custom{{$index}}" ng-if="item.IsCustom" class="form-control" ng-model="custom[item.Name]" data-rule-required="{{item.Must}}"></div><label ng-if="!item.Modify" class="control-label text-left">{{getValue(item.Name, item.IsCustom)}}</label></div></div></div></form><div class="row m-b-lg m-l m-r"><div class="h4 m-b nav nav-underline padder-v">交易信息</div><div class="row form-horizontal"><div class="col-sm-4"><div class="row"><div class="col-sm-4 control-label">客户等级</div><div class="col-sm-8"><label class="control-label">{{entity.Level.Value}}</label></div></div><div class="row"><div class="col-sm-4 control-label">累计消费</div><div class="col-sm-8"><label class="control-label">{{entity.AllConsumingAmount | currencyFormat}}</label></div></div><div class="row"><div class="col-sm-4 control-label">累计积分</div><div class="col-sm-8"><label class="control-label">{{entity.AllPoints}}</label></div></div></div><div class="col-sm-4"><div class="row"><div class="col-sm-4 control-label">客户状态</div><div class="col-sm-8"><label class="control-label">{{entity.MemberStatus | memberStatus}}</label></div></div><div class="row"><div class="col-sm-4 control-label">消费次数</div><div class="col-sm-8"><label class="control-label">{{entity.ConsumingCount}}</label></div></div><div class="row"><div class="col-sm-4 control-label">上次消费时间</div><div class="col-sm-8"><label class="control-label" ng-if="entity.LastConsumingTime>0">{{entity.LastConsumingTime*1000 | date:\'yyyy-MM-dd HH:mm:ss\'}}</label></div></div></div><div class="col-sm-4"><div class="row"><div class="col-sm-4 control-label">客户来源</div><div class="col-sm-8"><label class="control-label">{{entity.FromType | userFromType}}</label></div></div><div class="row"><div class="col-sm-4 control-label">平均消费额</div><div class="col-sm-8"><label class="control-label">{{entity.AllConsumingAmount/entity.ConsumingCount | currencyFormat}}</label></div></div><div class="row"><div class="col-sm-4 control-label">开卡时间</div><div class="col-sm-8"><label class="control-label">{{entity.ActivateTime*1000 | date:\'yyyy-MM-dd HH:mm:ss\'}}</label></div></div></div></div></div><div class="wrapper w-f"><ul class="nav nav-tabs nav-white"><li role="presentation" ng-class="{active: curTab == 1}"><a ng-click="selectTab(1)">消费记录</a></li><li role="presentation" ng-class="{active: curTab == 2}"><a ng-click="selectTab(2)">充值记录</a></li><li role="presentation" ng-class="{active: curTab == 3}"><a ng-click="selectTab(3)">积分记录</a></li></ul><div ng-if="curTab==1" class="panel panel-default m-t"><div class="panel-body"><div class="table-responsive" loading-container="tableParamsConsuming.settings().$loading"><table ng-table="tableParamsConsuming" class="table table-striped"><tr ng-repeat="item in $data"><td data-title="\'交易编号\'">{{item.TradeNo }}</td><td data-title="\'消费时间\'">{{item.Time*1000 | date:\'yyyy-MM-dd HH:mm:ss\' }}</td><td data-title="\'消费门店\'">{{item.StoreName || \'总店\'}}</td><td data-title="\'消费总计\'">{{item.TotalAmout | currencyFormat }}</td><td data-title="\'实收金额\'">{{item.RealAmount | currencyFormat }}</td><td data-title="\'支付方式\'">{{item.Payment }}</td><td data-title="\'会员折扣\'">{{item.Discount }}</td><td data-title="\'消费积分\'">{{item.UsePoints }}</td><td data-title="\'卡券核销\'">{{item.SNNo }}</td><td data-title="\'操作员\'">{{item.Operator }}</td></tr><tr ng-if="!tableParamsConsuming.settings().$loading" class="text-center"><td colspan="11" ng-if="$data.length==0">没有找到任何记录!</td></tr></table></div></div></div><div ng-if="curTab==2" class="panel panel-default m-t"><div class="panel-body"><div class="table-responsive" loading-container="tableParamsRecharge.settings().$loading"><table ng-table="tableParamsRecharge" class="table table-striped"><tr ng-repeat="item in $data"><td data-title="\'会员卡号\'">{{item.MemberCardNo }}</td><td data-title="\'姓名\'">{{item.Name }}</td><td data-title="\'手机号码\'">{{item.Phone }}</td><td data-title="\'充值金额\'">{{item.Amount | currencyFormat }}</td><td data-title="\'充值时间\'">{{item.Time*1000 | date:\'yyyy-MM-dd HH:mm:ss\' }}</td><td data-title="\'充值门店\'">{{item.StoreName || \'总店\' }}</td><td data-title="\'操作员\'">{{item.Operator }}</td><td data-title="\'备注\'">{{item.Remark }}</td></tr><tr ng-if="!tableParamsRecharge.settings().$loading" class="text-center"><td colspan="11" ng-if="$data.length==0">没有找到任何记录!</td></tr></table></div></div></div><div ng-if="curTab==3" class="panel panel-default m-t"><div class="panel-body"><div class="table-responsive" loading-container="tableParamsPoints.settings().$loading"><table ng-table="tableParamsPoints" class="table table-striped"><tr ng-repeat="item in $data"><td data-title="\'交易名称\'">{{item.Title }}</td><td data-title="\'用户名\'">{{item.Name }}</td><td data-title="\'手机号码\'">{{item.Phone }}</td><td data-title="\'会员卡号\'">{{item.MemberCardNo }}</td><td data-title="\'交易时间\'">{{item.Time*1000 | date:\'yyyy-MM-dd HH:mm:ss\' }}</td><td data-title="\'积分\'" class="text-right">{{item.AddOrReduce?\'-\':\'+\'}}{{item.Points }}</td><td data-title="\'交易方式\'">{{item.PointsPayType | pointsPayType }}</td><td data-title="\'交易门店\'">{{item.StoreName || \'总店\'}}</td><td data-title="\'操作员\'">{{item.Operator }}</td><td data-title="\'备注\'">{{item.Remark }}</td></tr><tr ng-if="!tableParamsPoints.settings().$loading" class="text-center"><td colspan="11" ng-if="$data.length==0">没有找到任何记录!</td></tr></table></div></div></div></div></div></section></section>'),e.put("/app/vip/marketing/activationGiving.add.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><a class="text-href" ui-sref="app.vip.marketing">会员营销</a> <label class="m-l-sm m-r-sm">/</label> <a class="text-href" ui-sref="app.vip.marketingActivationGiving">开卡即送</a> <label class="m-l-sm m-r-sm">/</label> <span ng-if="!id">添加开卡即送</span> <span ng-if="id">编辑开卡即送</span></div></header><section class="scrollable wrapper"><div class="load" ng-if="loading">数据加载中...</div><div class="panel panel-default wrapper" ng-if="!loading"><form class="form-horizontal m-b" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="form-group m-t"><label class="col-sm-2 control-label must">活动名称</label><div class="col-sm-10 m-b-sm form-inline"><input type="text" class="form-control" name="Name" ng-model="entity.Name" data-rule-chinesemax="[40, 80]" data-rule-username="true"> <span class="help-inline">最多40个汉字</span> <label for="Name" class="help-block error"></label></div></div><div class="form-group m-t"><label class="col-sm-2 control-label must">活动时间</label><div class="col-sm-8 m-b-sm form-inline"><icon-date-range-picker ng-model="entity.time" required="true"></icon-date-range-picker></div></div><div class="form-group"><label class="col-sm-2 control-label must">赠送策略</label><div class="col-sm-10 form-inline"><vip-give-type-ctrl ng-model="entity" is-activation="true"></vip-give-type-ctrl></div></div><div class="form-group"><label class="col-sm-2 control-label">短信通知</label><div class="col-sm-10 form-inline"><label class="checkbox-inline"><input type="checkbox" ng-model="entity.IsNeedMessage" value="1"> 开启</label></div></div><div class="form-group m-t"><label class="col-sm-2 control-label"></label><div class="col-sm-4 m-b-sm"><button class="btn btn-sm btn-primary" btn-loading="saveloading" loading-text="保存中...">保存</button></div></div></form></div></section></section>'),e.put("/app/vip/marketing/activationGiving.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><a class="text-href" ui-sref="app.vip.marketing">会员营销</a> <label class="m-l-sm m-r-sm">/</label> 开卡即送</div></header><section class="scrollable wrapper"><div class="load" ng-if="loading">数据加载中...</div><div class="panel panel-default wrapper" ng-if="!loading"><div class="m-t"><a class="btn btn-sm btn-info" ui-sref="app.vip.marketingActivationGivingAdd"><i class="fa fa-plus"></i> 添加开卡即送</a> <button class="btn btn-sm btn-danger" popup-confirm="" popup-placement="left" popup-body="确定删除吗" popup-confirm-callback="delMulti(tableParams.checkboxes.items)" popup-confirm-button="删除" popup-title="删除" popup-if="tableParams.checkboxes.items.length" ng-class="{disabled:!tableParams.checkboxes.items.length}" title="{{tableParams.checkboxes.items.length?\'\':\'请选择操作对象\'}}">删除</button></div><div class="panel panel-default m-t" loading-container="tableParams.settings().$loading"><table ng-table="tableParams" class="table table-striped table-hover m-b-none text-nowrap pos-rlt" checkbox-show="true" checkbox-key="Id"><tr ng-repeat="item in $data"><td data-title="\'活动名称\'">{{item.Name}}</td><td data-title="\'赠送内容\'">{{item.Type | giving:item.Value}}</td><td data-title="\'有效期\'"><div ng-if="item.StartTime > 0">{{item.StartTime*1000 | date:\'yyyy-MM-dd HH:mm:ss\'}} - {{item.EndTime*1000 | date:\'yyyy-MM-dd HH:mm:ss\'}}</div></td><td data-title="\'状态\'">{{item.StartTime | endTime:item.EndTime}}</td><td data-title="\'操作\'"><a class="text-href m-r" ui-sref="app.vip.marketingActivationGivingAdd({id: item.Id})">编辑</a> <a class="text-href m-r" popup-confirm="" popup-placement="left" popup-body="确定删除吗" popup-confirm-callback="del(item)" popup-confirm-button="删除" popup-title="删除">删除</a></td></tr><tr ng-if="!tableParams.settings().$loading" class="text-center"><td colspan="11" ng-if="$data.length==0">没有找到任何记录!</td></tr></table></div></div></section></section>'),e.put("/app/vip/marketing/broadcast.add.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><a class="text-href" ui-sref="app.vip.marketing">会员营销</a> <label class="m-l-sm m-r-sm">/</label> <a class="text-href" ui-sref="app.vip.marketingBroadcast">会员广播</a> <label class="m-l-sm m-r-sm">/</label> <span ng-if="!id">添加广播</span> <span ng-if="id">编辑广播</span></div></header><section class="scrollable wrapper"><div class="load" ng-if="loading">数据加载中...</div><div class="panel panel-default wrapper" ng-if="!loading"><form class="form-horizontal m-b" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="form-group m-t"><label class="col-sm-2 control-label must">广播标题</label><div class="col-sm-10 m-b-sm form-inline"><input type="text" class="form-control m-r-sm" name="Title" ng-model="entity.Title" data-rule-chinesemax="[40, 80]" data-rule-username="true"> <span class="help-block inline">{{entity.Title | chineseLen:2}} / 40</span> <label for="Title" class="help-block error"></label></div></div><div class="form-group m-t"><label class="col-sm-2 control-label">推荐图标</label><div class="col-sm-4 m-b-sm"><img ng-if="entity.LogoPreview" ng-src="{{entity.LogoPreview}}"><div upload-img-list="" max-count="1" file-url="entity.Logo" max-size-file="1" tip="建议尺寸：200×200"></div></div></div><div class="form-group"><label class="col-sm-2 control-label must">选择人群</label><div class="col-sm-9 form-inline"><select class="form-control" name="MemberType" ng-model="entity.MemberType" ng-options="item.LevelNo as item.LevelName for item in levels"><option value="">全部</option></select></div></div><div class="form-group m-t"><label class="col-sm-2 control-label must">详细内容</label><div class="col-sm-10 m-b-sm"><textarea rows="3" class="form-control" kindeditor="" ng-model="entity.Detail" data-config="default"></textarea></div></div><div class="form-group m-t"><label class="col-sm-2 control-label"></label><div class="col-sm-4 m-b-sm"><button class="btn btn-sm btn-primary" btn-loading="saveloading" loading-text="保存中...">保存</button></div></div></form></div></section></section>'),e.put("/app/vip/marketing/broadcast.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><a class="text-href" ui-sref="app.vip.marketing">会员营销</a> <label class="m-l-sm m-r-sm">/</label> 会员广播</div></header><section class="scrollable wrapper"><div class="load" ng-if="loading">数据加载中...</div><div class="panel panel-default wrapper" ng-if="!loading"><div class="m-t"><a class="btn btn-sm btn-info" ui-sref="app.vip.marketingBroadcastAdd"><i class="fa fa-plus"></i> 添加会员广播</a> <button class="btn btn-sm btn-danger" popup-confirm="" popup-placement="left" popup-body="确定删除吗" popup-confirm-callback="delMulti(tableParams.checkboxes.items)" popup-confirm-button="删除" popup-title="删除" popup-if="tableParams.checkboxes.items.length" ng-class="{disabled:!tableParams.checkboxes.items.length}" title="{{tableParams.checkboxes.items.length?\'\':\'请选择操作对象\'}}">删除</button></div><div class="panel panel-default m-t" loading-container="tableParams.settings().$loading"><table ng-table="tableParams" class="table table-striped table-hover m-b-none text-nowrap pos-rlt" checkbox-show="true" checkbox-key="Id"><tr ng-repeat="item in $data"><td data-title="\'广播标题\'">{{item.Title}}</td><td data-title="\'内容\'"><div class="text-ellipsis" style="max-width: 600px;height: 18px;" ng-bind-html="item.Detail"></div></td><td data-title="\'创建时间\'">{{item.CreateTime*1000 | date:\'yyyy-MM-dd HH:mm:ss\'}}</td><td data-title="\'操作\'"><a class="text-href m-r" ui-sref="app.vip.marketingBroadcastAdd({id: item.Id})">编辑</a> <a class="text-href m-r" popup-confirm="" popup-placement="left" popup-body="确定删除吗" popup-confirm-callback="del(item)" popup-confirm-button="删除" popup-title="删除">删除</a></td></tr><tr ng-if="!tableParams.settings().$loading" class="text-center"><td colspan="11" ng-if="$data.length==0">没有找到任何记录!</td></tr></table></div></div></section></section>'),e.put("/app/vip/marketing/costGiving.add.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><a class="text-href" ui-sref="app.vip.marketing">会员营销</a> <label class="m-l-sm m-r-sm">/</label> <a class="text-href" ui-sref="app.vip.marketingCostGiving">消费赠送</a> <label class="m-l-sm m-r-sm">/</label> <span ng-if="!id">添加消费赠送</span> <span ng-if="id">编辑消费赠送</span></div></header><section class="scrollable wrapper"><div class="load" ng-if="loading">数据加载中...</div><div class="panel panel-default wrapper" ng-if="!loading"><form class="form-horizontal m-b" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="form-group m-t"><label class="col-sm-2 control-label must">活动名称</label><div class="col-sm-10 m-b-sm form-inline"><input type="text" class="form-control" name="Name" ng-model="entity.Name" data-rule-chinesemax="[40, 80]" data-rule-username="true"> <span class="help-inline">最多40个汉字</span> <label for="Name" class="help-block error"></label></div></div><div class="form-group m-t"><label class="col-sm-2 control-label must">活动时间</label><div class="col-sm-10 m-b-sm form-inline"><icon-date-range-picker ng-model="entity.time" required="true"></icon-date-range-picker></div></div><div class="form-group m-t"><label class="col-sm-2 control-label must">选择人群</label><div class="col-sm-10 m-b-sm form-inline"><select class="form-control" name="MemberType" ng-model="entity.MemberType" ng-options="item.LevelNo as item.LevelName for item in levels"><option value="">全部</option></select></div></div><div class="form-group m-t"><label class="col-sm-2 control-label must">赠送条件</label><div class="col-sm-10 m-b-sm form-inline"><label class="radio-inline"><input type="radio" ng-model="entity.GiveCondition" value="0" style="margin-top: 10px;"> 每消费 <input ng-readonly="entity.GiveCondition!= 0" name="ConditionValue" ng-model="entity.ConditionValue0" class="form-control" data-rule-ismoney="true" data-rule-max="100000000"> 元即送 <label class="error m-l">*例：设置100元送10元，消费100送10元，消费200送20元；上限值1亿</label></label> <label for="ConditionValue" class="help-block error"></label><br><label class="radio-inline"><input type="radio" ng-model="entity.GiveCondition" value="1" style="margin-top: 10px;"> 单次消费满 <input ng-readonly="entity.GiveCondition != 1" name="ConditionValue1" ng-model="entity.ConditionValue1" class="form-control" data-rule-ismoney="true" data-rule-max="100000000" style="width: 100px;"> 元即送 <label class="error m-l">*例：设置100元送10元，消费100送10元，消费200依然送10元；上限值1亿</label></label> <label for="ConditionValue1" class="help-block error"></label><br><label class="radio-inline"><input type="radio" ng-model="entity.GiveCondition" value="2" style="margin-top: 10px;"> 累计消费满 <input ng-readonly="entity.GiveCondition != 2" name="ConditionValue2" ng-model="entity.ConditionValue2" class="form-control" data-rule-ismoney="true" data-rule-max="100000000" style="width: 100px;"> 元即送 <label class="error m-l">*累计消费仅从活动开始算起；上限值1亿</label></label> <label for="ConditionValue2" class="help-block error"></label><br><label class="radio-inline"><input type="radio" ng-model="entity.GiveCondition" value="3"> 一个月未消费的</label></div></div><div class="form-group"><label class="col-sm-2 control-label must">赠送策略</label><div class="col-sm-10"><vip-give-type-ctrl ng-model="entity"></vip-give-type-ctrl></div></div><div class="form-group m-t"><label class="col-sm-2 control-label">活动门店</label><div class="col-sm-10 m-b-sm form-inline"><select class="form-control" ng-model="entity.StoreId" ng-options="item.id as item.name for item in stores"><option value="">全部门店</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label must">享受权限</label><div class="col-sm-10 form-inline"><label class="radio-inline"><input type="radio" ng-model="entity.LimitType" value="0"> 不限</label><br><label class="radio-inline"><input type="radio" ng-model="entity.LimitType" value="1"> 使用券消费的用户不享受</label></div></div><div class="form-group"><label class="col-sm-2 control-label">短信通知</label><div class="col-sm-10 form-inline"><label class="checkbox-inline"><input type="checkbox" ng-model="entity.IsNeedMessage" value="1"> 开启</label></div></div><div class="form-group m-t"><label class="col-sm-2 control-label"></label><div class="col-sm-4 m-b-sm"><button class="btn btn-primary" btn-loading="saveloading" loading-text="保存中...">保存</button></div></div></form></div></section></section>'),e.put("/app/vip/marketing/costGiving.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><a class="text-href" ui-sref="app.vip.marketing">会员营销</a> <label class="m-l-sm m-r-sm">/</label> 消费赠送</div></header><section class="scrollable wrapper"><div class="load" ng-if="loading">数据加载中...</div><div class="panel panel-default wrapper" ng-if="!loading"><div class="m-t"><a class="btn btn-sm btn-info" ui-sref="app.vip.marketingCostGivingAdd"><i class="fa fa-plus"></i> 添加消费赠送</a> <button class="btn btn-sm btn-danger" popup-confirm="" popup-placement="left" popup-body="确定删除吗" popup-confirm-callback="delMulti(tableParams.checkboxes.items)" popup-confirm-button="删除" popup-title="删除" popup-if="tableParams.checkboxes.items.length" ng-class="{disabled:!tableParams.checkboxes.items.length}" title="{{tableParams.checkboxes.items.length?\'\':\'请选择操作对象\'}}">删除</button></div><div class="panel panel-default m-t" loading-container="tableParams.settings().$loading"><table ng-table="tableParams" class="table table-striped table-hover m-b-none text-nowrap pos-rlt" checkbox-show="true" checkbox-key="Id"><tr ng-repeat="item in $data"><td data-title="\'活动名称\'">{{item.Name}}</td><td data-title="\'赠送内容\'">{{item.GiveType | giving:item.GiveValue}}</td><td data-title="\'有效期\'">{{item.StartTime*1000 | date:\'yyyy-MM-dd HH:mm:ss\'}} - {{item.EndTime*1000 | date:\'yyyy-MM-dd HH:mm:ss\'}}</td><td data-title="\'状态\'">{{item.StartTime | endTime:item.EndTime}}</td><td data-title="\'操作\'"><a class="text-href m-r" ui-sref="app.vip.marketingCostGivingAdd({id: item.Id})">编辑</a> <a class="text-href m-r" popup-confirm="" popup-placement="left" popup-body="确定删除吗" popup-confirm-callback="del(item)" popup-confirm-button="删除" popup-title="删除">删除</a></td></tr><tr ng-if="!tableParams.settings().$loading" class="text-center"><td colspan="11" ng-if="$data.length==0">没有找到任何记录!</td></tr></table></div></div></section></section>'),e.put("/app/vip/marketing/coupon.add.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><a class="text-href" ui-sref="app.vip.marketing">会员营销</a> <label class="m-l-sm m-r-sm">/</label> <a class="text-href" ui-sref="app.vip.marketingCoupon">优惠券</a> <label class="m-l-sm m-r-sm">/</label> <span ng-if="!id">添加优惠券</span> <span ng-if="id">编辑优惠券</span></div></header><section class="scrollable wrapper"><div class="load" ng-if="loading">数据加载中...</div><div class="panel panel-default wrapper" ng-if="!loading"><form class="form-horizontal m-b" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="form-group m-t"><label class="col-sm-2 control-label must">优惠券名称</label><div class="col-sm-10 m-b-sm form-inline"><input type="text" class="form-control m-r-sm" name="Name" ng-model="entity.Name" data-rule-chinesemax="[9, 18]" data-rule-username="true"> <span class="help-block inline">{{entity.Name | chineseLen:2}} / 9</span> <label for="Name" class="help-block error"></label></div></div><div class="form-group"><label class="col-sm-2 control-label must">优惠券类型</label><div class="col-sm-10 form-inline"><label class="radio-inline"><input type="radio" ng-model="entity.CouponType" value="0"> 优惠券 <label class="help-inline m-l">可为用户提供消费优惠或赠品服务</label></label><br><label class="radio-inline"><input type="radio" ng-model="entity.CouponType" value="1"> 代金券 <label class="help-inline m-l">可为用户提供抵扣现金服务。可设置成为“满*元，减*元”</label></label></div></div><div class="form-group m-t"><label class="col-sm-2 control-label must">有效期</label><div class="col-sm-10 m-b-sm form-inline"><icon-date-range-picker ng-model="entity.time" required="true"></icon-date-range-picker></div></div><div class="form-group m-t"><label class="col-sm-2 control-label must">选择人群</label><div class="col-sm-10 m-b-sm form-inline"><select class="form-control" name="MemberType" ng-model="entity.MemberType" ng-options="item.LevelNo as item.LevelName for item in levels"><option value="">全部</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label must">发放方式</label><div class="col-sm-10 form-inline"><label class="radio-inline"><input type="radio" ng-model="entity.GetType" value="0"> 直接领取 <label class="help-inline m-l">用户可直接在发现优惠中领取</label></label><br><label class="radio-inline"><input type="radio" class="pos-rlt" ng-model="entity.GetType" value="1" style="top: 11px;"> 积分兑换 <label class="help-inline m-l">用户通过营销活动获得，或需要</label> <input name="Points" class="form-control" ng-model="entity.Points" data-rule-positiveinteger="{{entity.GetType==1}}" data-rule-max="100000000"> <label class="help-inline">积分进行兑换</label></label> <label for="Points" class="help-block error"></label></div></div><div class="form-group m-t"><label class="col-sm-2 control-label">发放总数</label><div class="col-sm-10 m-b-sm form-inline"><input name="ConditionValue" ng-model="entity.TotalCount" class="form-control" data-rule-integer="true" data-rule-min="0" data-rule-max="1000000000"> <label class="error m-l">* 0表示不限</label></div></div><div class="form-group m-t"><label class="col-sm-2 control-label">每个用户可领取数</label><div class="col-sm-10 m-b-sm form-inline"><input name="ConditionValue" ng-model="entity.LimitCount" class="form-control" data-rule-integer="true" data-rule-min="0" data-rule-max="1000000000"> <label class="error m-l">* 0表示不限</label></div></div><div ng-if="entity.CouponType == 0"><div class="form-group m-t"><label class="col-sm-2 control-label">优惠券图片</label><div class="col-sm-10 m-b-sm"><img ng-if="entity.LogoPreview" ng-src="{{entity.LogoPreview}}"><div upload-img-list="" max-count="1" file-url="entity.Logo" max-size-file="1" tip="建议尺寸：420×220"></div></div></div><div class="form-group m-t"><label class="col-sm-2 control-label must">使用说明</label><div class="col-sm-10 m-b-sm"><textarea rows="5" class="form-control" kindeditor="" ng-model="entity.Description" data-config="default" data-rule-required="true"></textarea> <input name="Description" ng-model="entity.Description" data-rule-chinesemax="[5000,10000]" style="width: 0;height: 0;border: none;"> <span class="help-block">在此说明券的使用方式，如最低消费金额，优惠券打折信息，不与其他优惠同时使用、节假日不可使用等。</span></div></div></div><div ng-if="entity.CouponType==1"><div class="form-group m-t"><label class="col-sm-2 control-label must">消费金额满</label><div class="col-sm-10 m-b-sm form-inline"><input name="ConditionValue" ng-model="entity.ConditionAmount" class="form-control" data-rule-ismoney="true" data-rule-required="true" data-rule-max="1000000000"> 元</div></div><div class="form-group m-t"><label class="col-sm-2 control-label must">抵用金额</label><div class="col-sm-10 m-b-sm form-inline"><input name="ConditionValue" ng-model="entity.DiscountAmount" class="form-control" data-rule-ismoney="true" data-rule-required="true" data-rule-max="1000000000"> 元</div></div></div><div class="form-group m-t"><label class="col-sm-2 control-label"></label><div class="col-sm-4 m-b-sm"><button class="btn btn-sm btn-primary" btn-loading="saveloading" loading-text="保存中...">保存</button></div></div></form></div></section></section>'),e.put("/app/vip/marketing/coupon.getlist.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><a class="text-href" ui-sref="app.vip.marketing">会员营销</a> <label class="m-l-sm m-r-sm">/</label> <a class="text-href" ui-sref="app.vip.marketingCoupon">优惠券</a> <label class="m-l-sm m-r-sm">/</label> 派发列表</div></header><section class="scrollable wrapper" style="overflow-x: auto"><div class="load" ng-if="loading">数据加载中...</div><div class="panel panel-default wrapper pull-left" ng-if="!loading" style="min-width: 100%"><form class="form-horizontal m-b" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="select pos-rlt" dropdown="" dropdown-select="" ng-model="searchParams.use" data-list="uses" selected="search()"></div></form><div class="panel panel-default m-t pull-left" style="min-width: 100%" loading-container="tableParams.settings().$loading"><table ng-table="tableParams" class="table table-striped table-hover m-b-none text-nowrap pos-rlt" checkbox-show="true" checkbox-key="Id"><tr ng-repeat="item in $data"><td data-title="\'优惠券名称\'">{{item.CouponName}}</td><td data-title="\'用户名\'">{{item.MemberName}}</td><td data-title="\'电话\'">{{item.Tel}}</td><td data-title="\'SN码\'">{{item.SNNo}}</td><td data-title="\'SN码派发时间\'">{{item.GetTime*1000 | date:\'yyyy-MM-dd HH:mm:ss\'}}</td><td data-title="\'状态\'"><div ng-if="item.IsUsed">已使用</div><div ng-if="!item.IsUsed">未使用</div></td></tr><tr ng-if="!tableParams.settings().$loading" class="text-center"><td colspan="11" ng-if="$data.length==0">没有找到任何记录!</td></tr></table></div></div></section></section>'),e.put("/app/vip/marketing/coupon.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><a class="text-href" ui-sref="app.vip.marketing">会员营销</a> <label class="m-l-sm m-r-sm">/</label> 优惠券</div></header><section class="scrollable wrapper" style="overflow-x: auto"><div class="load" ng-if="loading">数据加载中...</div><div class="panel panel-default wrapper pull-left" ng-if="!loading" style="min-width: 100%"><form class="form-horizontal m-b" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="form-inline m-t"><input class="form-control" placeholder="请输入关键字" ng-model="searchParams.text" ng-keyup="searchEnter()"> <button class="btn btn-sm btn-info m-r-lg" ng-click="search()">搜索</button> <a class="btn btn-sm btn-primary m-r-sm" ui-sref="app.vip.marketingCouponAdd"><i class="fa fa-plus"></i> 添加优惠券</a></div></form><div class="panel panel-default m-t pull-left" style="min-width: 100%" loading-container="tableParams.settings().$loading"><table ng-table="tableParams" class="table table-striped table-hover m-b-none text-nowrap pos-rlt"><tr ng-repeat="item in $data"><td data-title="\'优惠券名称\'">{{item.Name}}</td><td data-title="\'类型\'">{{item.CouponType | couponType}}</td><td data-title="\'有效期\'">{{item.StartTime*1000 | date:\'yyyy-MM-dd HH:mm:ss\'}} - {{item.EndTime*1000 | date:\'yyyy-MM-dd HH:mm:ss\'}}</td><td data-title="\'状态\'">{{item.StartTime | endTime:item.EndTime}}</td><td data-title="\'库存\'">{{item.ResidualCount}}</td><td data-title="\'操作\'"><a class="text-href m-r" ui-sref="app.vip.marketingCouponGetList({id: item.Id})">派发列表</a> <a class="text-href m-r" ui-sref="app.vip.marketingCouponAdd({id: item.Id})">编辑</a> <a ng-if="!item.IsDel" class="text-href m-r" popup-confirm="" popup-placement="left" popup-body="确定删除吗" popup-confirm-callback="del(item)" popup-confirm-button="删除" popup-title="删除">删除</a> <a ng-if="item.IsDel" class="text-href m-r" ng-click="del(item, true)">撤销删除</a></td></tr><tr ng-if="!tableParams.settings().$loading" class="text-center"><td colspan="11" ng-if="$data.length==0">没有找到任何记录!</td></tr></table></div></div></section></section>'),e.put("/app/vip/marketing/index.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t">会员营销</div></header><section class="scrollable wrapper"><div class="load" ng-if="parentLoading || loading">数据加载中...</div><div class="panel panel-default wrapper" ng-if="!parentLoading && !loading"><div class="h5 m-b">营销工具</div><ul class="square-menu"><li><a ui-sref="app.vip.marketingCoupon"><i class="wmfont wm-youhuiquan"></i><label>优惠券</label></a></li><li><a ui-sref="app.vip.marketingPoint"><i class="wmfont wm-jifen"></i><label>会员积分</label></a></li><li><a ui-sref="app.vip.marketingRecommend"><i class="wmfont wm-tuijian"></i><label>每日推荐</label></a></li><li><a ui-sref="app.vip.marketingBroadcast"><i class="wmfont wm-guangbo"></i><label>会员广播</label></a></li></ul><div class="h5 m-t m-b">营销项目</div><ul class="square-menu"><li><a ui-sref="app.vip.marketingActivationGiving"><i class="wmfont wm-shuaqia"></i><label>开卡即送</label></a></li><li><a ui-sref="app.vip.marketingCostGiving"><i class="wmfont wm-zeng"></i><label>消费赠送</label></a></li><li><a ui-sref="app.vip.marketingRechargeGiving"><i class="wmfont wm-zeng"></i><label>充值赠送</label></a></li><li><a ui-sref="app.vip.marketingSolicitude"><i class="wmfont wm-yingxiaoguanhuai"></i><label>节日关怀</label></a></li></ul></div></section></section>'),e.put("/app/vip/marketing/point.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><a class="text-href" ui-sref="app.vip.marketing">会员营销</a> <label class="m-l-sm m-r-sm">/</label> 会员积分</div></header><section class="scrollable wrapper"><div class="load" ng-if="loading">数据加载中...</div><div class="panel panel-default wrapper" ng-if="!loading"><form class="form-horizontal m-b" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><ul class="nav nav-underline"><li class=""><div class="h5 m-b-sm">积分基础规则</div></li></ul><div class="form-group m-t"><label class="col-sm-2 control-label must">抵现规则</label><div class="col-sm-10 m-b-sm form-inline">每使用<select class="form-control" name="PointsPerYuan" ng-model="entity.PointsPerYuan" data-rule-integer="true"><option value="1">1</option><option value="10">10</option><option value="100">100</option><option value="1000">1000</option><option value="10000">10000</option></select>积分，抵扣 1 元 <label for="PointsPerYuan" class="help-block error"></label></div></div><div class="form-group"><label class="col-sm-2 control-label">清零规则</label><div class="col-sm-10 m-b-sm form-inline"><label class="radio-inline"><input type="radio" name="ClearType" ng-model="entity.ClearType" value="0"> 不清零</label><br><label class="radio-inline"><input type="radio" name="ClearType" ng-model="entity.ClearType" value="1"> 每自然年最后一天清除全部积分</label><br><label for="ClearType" class="help-block error"></label></div></div><ul class="nav nav-underline"><li class=""><div class="h5 m-b-sm">积分奖励规则</div></li></ul><div class="form-group m-t"><label class="col-sm-2 control-label">签到奖励</label><div class="col-sm-10 m-b-sm form-inline">每天签到奖励 <input type="text" class="form-control" name="PonitsDay" ng-model="entity.PonitsDay" data-rule-integer="true"> 积分 <label for="PonitsDay" class="help-block error"></label><br>每连续 <input type="text" class="form-control" name="Days" ng-model="entity.Days" data-rule-integer="true" data-rule-min="2"> 天签到，奖励 <input type="text" class="form-control" name="PointsAddition" ng-model="entity.PointsAddition" data-rule-integer="true"> 积分 <label for="Days" class="help-block error"></label> <label for="PointsAddition" class="help-block error"></label><br>连续签到，每天递增奖励 <input type="text" class="form-control" name="PointsAdditionPerDay" ng-model="entity.PointsAdditionPerDay" data-rule-integer="true"> 积分，最多奖励 <input type="text" class="form-control" name="AdditionDays" ng-model="entity.AdditionDays" data-rule-integer="true"> 天后不再递增 <label for="PointsAdditionPerDay" class="help-block error"></label> <label for="AdditionDays" class="help-block error"></label></div></div><div class="form-group m-t"><label class="col-sm-2 control-label">分享奖励</label><div class="col-sm-10 m-b-sm form-inline">每次分享奖励 <input type="text" class="form-control" name="SharePoints" ng-model="entity.SharePoints" data-rule-integer="true"> 积分，每人每天最多奖励 <input type="text" class="form-control" name="ShareCountPerDay" ng-model="entity.ShareCountPerDay" data-rule-integer="true" data-rule-min="0"> 次 <label for="SharePoints" class="help-block error"></label> <label for="ShareCountPerDay" class="help-block error"></label></div></div><ul class="nav nav-underline"><li class=""><div class="h5 inline m-b-sm m-r">积分攻略</div><span class="help-inline">注：此内容为积分规则的补充说明，内容仅供客户阅读，并不影响上述的积分规则设置</span></li></ul><div class="form-group m-t"><label class="col-sm-2 control-label">攻略内容</label><div class="col-sm-10 m-b-sm"><textarea rows="5" class="form-control" kindeditor="" ng-model="entity.PonitsStrategy" data-config="default"></textarea> <input name="PonitsStrategy" ng-model="entity.PonitsStrategy" data-rule-chinesemax="[5000,10000]" style="width: 0;height: 0;border: none;"></div></div><div class="form-group m-t"><label class="col-sm-2 control-label"></label><div class="col-sm-4 m-b-sm"><button class="btn btn-sm btn-primary" btn-loading="saveloading" loading-text="保存中...">保存</button> <button type="button" class="btn btn-sm btn-info" ng-click="onPreview()" ng-disabled="!entity.PointsPerYuan || entity.PointsPerYuan < 1">规则预览</button></div></div></form></div></section></section>'),e.put("/app/vip/marketing/pointExchange.add.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><a class="text-href" ui-sref="app.vip.marketing">会员营销</a> <label class="m-l-sm m-r-sm">/</label> <a class="text-href" ui-sref="app.vip.marketingPointExchange">积分兑换</a> <label class="m-l-sm m-r-sm">/</label> 添加积分兑换</div></header><section class="scrollable wrapper"><div class="load" ng-if="loading">数据加载中...</div><div class="panel panel-default wrapper" ng-if="!loading"><form class="form-horizontal m-b" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="form-group m-t"><label class="col-sm-2 control-label must">活动名称</label><div class="col-sm-10 m-b-sm form-inline"><input type="text" class="form-control" name="Name" ng-model="entity.Name" data-rule-chinesemax="[40, 80]" data-rule-username="true"> <span class="help-inline">最多40个汉字</span> <label for="Name" class="help-block error"></label></div></div><div class="form-group m-t"><label class="col-sm-2 control-label must">活动时间</label><div class="col-sm-10 m-b-sm form-inline"><icon-date-range-picker ng-model="entity.time" required="true"></icon-date-range-picker></div></div><div class="form-group m-t"><label class="col-sm-2 control-label must">选择人群</label><div class="col-sm-10 m-b-sm form-inline"><select class="form-control" name="MemberType" ng-model="entity.MemberType" ng-options="item.LevelNo as item.LevelName for item in levels"><option value="">全部</option></select></div></div><div class="form-group m-t"><label class="col-sm-2 control-label must">所需积分</label><div class="col-sm-10 m-b-sm form-inline"><input name="RechargeAmount" ng-model="entity.RechargeAmount" data-rule-required="true" class="form-control" data-rule-ismoney="true" data-rule-max="100000000"> <span class="help-inline">兑换一次所需的积分数，上限1亿</span> <label for="RechargeAmount" class="help-block error"></label></div></div><div class="form-group m-t"><label class="col-sm-2 control-label">可兑换次数</label><div class="col-sm-10 m-b-sm form-inline"><input name="RechargeAmount" ng-model="entity.RechargeAmount" class="form-control" data-rule-positiveinteger="true"> <span class="help-inline">每人可兑换次数，最大可设置到1亿次，不填表示不限次数</span> <label for="RechargeAmount" class="help-block error"></label></div></div><div class="form-group m-t"><label class="col-sm-2 control-label">可兑换总数</label><div class="col-sm-10 m-b-sm form-inline"><input name="RechargeAmount" ng-model="entity.RechargeAmount" class="form-control" data-rule-positiveinteger="true"> <span class="help-inline">活动总兑换总次数，最大可设置到1亿次，不填标示不限</span> <label for="RechargeAmount" class="help-block error"></label></div></div><div class="form-group m-t"><label class="col-sm-2 control-label">兑换内容</label><div class="col-sm-10 m-b-sm form-inline"><select class="form-control" ng-model="entity.StoreId"><option value="">全部门店</option></select><select class="form-control" ng-model="entity.StoreId"><option value="">全部门店</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label">短信通知</label><div class="col-sm-10 form-inline"><label class="checkbox-inline"><input type="checkbox" ng-model="entity.IsNeedMessage" value="1"> 开启</label></div></div><div class="form-group m-t"><label class="col-sm-2 control-label"></label><div class="col-sm-4 m-b-sm"><button class="btn btn-sm btn-primary" btn-loading="saveloading" loading-text="保存中...">保存</button></div></div></form></div></section></section>'),e.put("/app/vip/marketing/pointExchange.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><a class="text-href" ui-sref="app.vip.marketing">会员营销</a> <label class="m-l-sm m-r-sm">/</label> 积分兑换</div></header><section class="scrollable wrapper" style="overflow-x: auto"><div class="load" ng-if="loading">数据加载中...</div><div class="panel panel-default wrapper" ng-if="!loading" style="min-width: 100%"><div class="m-t"><a class="btn btn-info" ui-sref="app.vip.marketingPointExchangeAdd"><i class="fa fa-plus"></i> 添加积分兑换</a> <button class="btn btn-danger" popup-confirm="" popup-placement="left" popup-body="确定删除吗" popup-if="tableParams.checkboxes.items.length" popup-confirm-callback="delMulti(tableParams.checkboxes.items)" popup-confirm-button="删除" popup-title="删除" ng-class="{disabled:!tableParams.checkboxes.items.length}" title="{{tableParams.checkboxes.items.length?\'\':\'请选择操作对象\'}}">删除</button></div><div class="panel panel-default m-t" style="min-width: 100%" loading-container="tableParams.settings().$loading"><table ng-table="tableParams" class="table table-striped table-hover m-b-none text-nowrap pos-rlt" checkbox-show="true" checkbox-key="Id"><tr ng-repeat="item in $data"><td data-title="\'活动名称\'">{{item.Name}}</td><td data-title="\'活动类型\'">{{item.GiveType | giving:item.GiveValue}}</td><td data-title="\'有效期\'">{{item.StartTime*1000 | date:\'yyyy-MM-dd HH:mm:ss\'}} - {{item.EndTime*1000 | date:\'yyyy-MM-dd HH:mm:ss\'}}</td><td data-title="\'状态\'">{{item.StartTime | endTime:item.EndTime}}</td><td data-title="\'操作\'"><a class="text-href m-r" ui-sref="app.vip.marketingRechargeGiving({id: item.Id})">编辑</a> <a class="text-href m-r" popup-confirm="" popup-placement="left" popup-body="确定删除吗" popup-confirm-callback="del(item)" popup-confirm-button="删除" popup-title="删除">删除</a></td></tr><tr ng-if="!tableParams.settings().$loading" class="text-center"><td colspan="11" ng-if="$data.length==0">没有找到任何记录!</td></tr></table></div></div></section></section>'),e.put("/app/vip/marketing/pointPreview.dialog.html",'<form class="form-horizontal" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="modal-header"><button type="button" class="close" ng-click="cancel()">&times;</button><h4 class="modal-title">规则预览</h4></div><div class="modal-body"><div class="panel-mobile"><div class="head"><label>积分规则</label></div><div class="content wrapper"><div class="nav nav-underline">积分规则</div><div class="preview-rule clearfix"><label>使用规则</label><div>每使用{{entity.PointsPerYuan}}积分，抵扣 1 元<br>使用积分可兑换优惠券、活动资格<br>使用积分可进行抽奖活动</div></div><div class="preview-rule clearfix"><label>有效期</label><div><span ng-if="!entity.ClearType">永久有效</span> <span ng-if="entity.ClearType == 1">每自然年最后一天清除全部积分</span> <span ng-if="entity.ClearType == 2">每自然年最后一天清除非当年获得的积分</span></div></div><div class="preview-rule clearfix"><label>获得方式</label><div>通过消费获得赠送积分<br>每日签到赠送{{entity.PonitsDay}}积分，连续签到会额外奖励积分<br>参加公众号活动有机会获取积分奖励</div></div><div class="preview-rule clearfix"><label>积分攻略</label><div><iframe2 ng-if="entity.PonitsStrategy" ng-model="entity.PonitsStrategy"></iframe2></div></div></div></div></div><div class="modal-footer"><button type="submit" class="btn btn-sm btn-primary" btn-loading="saveloading" loading-text="保存中...">确定</button></div></form>'),e.put("/app/vip/marketing/rechargeGiving.add.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><a class="text-href" ui-sref="app.vip.marketing">会员营销</a> <label class="m-l-sm m-r-sm">/</label> <a class="text-href" ui-sref="app.vip.marketingRechargeGiving">充值赠送</a> <label class="m-l-sm m-r-sm">/</label> <span ng-if="!id">添加充值赠送</span> <span ng-if="id">编辑充值赠送</span></div></header><section class="scrollable wrapper"><div class="load" ng-if="loading">数据加载中...</div><div class="panel panel-default wrapper" ng-if="!loading"><form class="form-horizontal m-b" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="form-group m-t"><label class="col-sm-2 control-label must">活动名称</label><div class="col-sm-10 m-b-sm form-inline"><input type="text" class="form-control" name="Name" ng-model="entity.Name" data-rule-chinesemax="[40, 80]" data-rule-username="true"> <span class="help-inline">最多40个汉字</span> <label for="Name" class="help-block error"></label></div></div><div class="line line-dashed b-b line-lg pull-in"></div><div class="form-group m-t"><label class="col-sm-2 control-label must">活动时间</label><div class="col-sm-10 m-b-sm form-inline"><icon-date-range-picker ng-model="entity.time" required="true"></icon-date-range-picker></div></div><div class="line line-dashed b-b line-lg pull-in"></div><div class="form-group m-t"><label class="col-sm-2 control-label must">选择人群</label><div class="col-sm-10 m-b-sm form-inline"><select class="form-control" name="MemberType" ng-model="entity.MemberType" ng-options="item.LevelNo as item.LevelName for item in levels"><option value="">全部</option></select></div></div><div class="line line-dashed b-b line-lg pull-in"></div><div class="form-group"><label class="col-sm-2 control-label must">充值类型</label><div class="col-sm-10 form-inline"><label class="radio-inline"><input type="radio" ng-model="entity.RechargeType" value="0"> 不限</label> <label class="radio-inline"><input type="radio" ng-model="entity.RechargeType" value="1"> 线上充值</label> <label class="radio-inline"><input type="radio" ng-model="entity.RechargeType" value="2"> 线下充值</label></div></div><div class="line line-dashed b-b line-lg pull-in"></div><div class="form-group m-t"><label class="col-sm-2 control-label must">赠送条件</label><div class="col-sm-10 m-b-sm form-inline">单次充值满 <input name="RechargeAmount" ng-model="entity.RechargeAmount" class="form-control" data-rule-ismoney="true" data-rule-max="1000000000"> 元即送 <label for="RechargeAmount" class="help-block error"></label></div></div><div class="line line-dashed b-b line-lg pull-in"></div><div class="form-group"><label class="col-sm-2 control-label must">赠送策略</label><div class="col-sm-10 form-inline"><vip-give-type-ctrl ng-model="entity"></vip-give-type-ctrl></div></div><div class="line line-dashed b-b line-lg pull-in"></div><div class="form-group m-t"><label class="col-sm-2 control-label">活动门店</label><div class="col-sm-10 m-b-sm form-inline"><select class="form-control" ng-model="entity.StoreId" ng-options="item.id as item.name for item in stores"><option value="">全部门店</option></select></div></div><div class="line line-dashed b-b line-lg pull-in"></div><div class="form-group"><label class="col-sm-2 control-label">短信通知</label><div class="col-sm-10 form-inline"><label class="checkbox-inline"><input type="checkbox" ng-model="entity.IsNeedMessage" value="1"> 开启</label></div></div><div class="line line-dashed b-b line-lg pull-in"></div><div class="form-group m-t"><label class="col-sm-2 control-label"></label><div class="col-sm-4 m-b-sm"><button class="btn btn-sm btn-primary">保存</button></div></div></form></div></section></section>'),e.put("/app/vip/marketing/rechargeGiving.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><a class="text-href" ui-sref="app.vip.marketing">会员营销</a> <label class="m-l-sm m-r-sm">/</label> 充值赠送</div></header><section class="scrollable wrapper"><div class="load" ng-if="loading">数据加载中...</div><div class="panel panel-default wrapper" ng-if="!loading"><div class="m-t"><a class="btn btn-info" ui-sref="app.vip.marketingRechargeGivingAdd"><i class="fa fa-plus"></i> 添加充值赠送</a> <button class="btn btn-danger" popup-confirm="" popup-placement="left" popup-body="确定删除吗" popup-confirm-callback="delMulti(tableParams.checkboxes.items)" popup-confirm-button="删除" popup-title="删除" popup-if="tableParams.checkboxes.items.length" ng-class="{disabled:!tableParams.checkboxes.items.length}" title="{{tableParams.checkboxes.items.length?\'\':\'请选择操作对象\'}}">删除</button></div><div class="panel panel-default m-t" loading-container="tableParams.settings().$loading"><table ng-table="tableParams" class="table table-striped table-hover m-b-none text-nowrap pos-rlt" checkbox-show="true" checkbox-key="Id"><tr ng-repeat="item in $data"><td data-title="\'活动名称\'">{{item.Name}}</td><td data-title="\'赠送内容\'">{{item.GiveType | giving:item.GiveValue}}</td><td data-title="\'有效期\'">{{item.StartTime*1000 | date:\'yyyy-MM-dd HH:mm:ss\'}} - {{item.EndTime*1000 | date:\'yyyy-MM-dd HH:mm:ss\'}}</td><td data-title="\'状态\'">{{item.StartTime | endTime:item.EndTime}}</td><td data-title="\'操作\'"><a class="text-href m-r" ui-sref="app.vip.marketingRechargeGivingAdd({id: item.Id})">编辑</a> <a class="text-href m-r" popup-confirm="" popup-placement="left" popup-body="确定删除吗" popup-confirm-callback="del(item)" popup-confirm-button="删除" popup-title="删除">删除</a></td></tr><tr ng-if="!tableParams.settings().$loading" class="text-center"><td colspan="11" ng-if="$data.length==0">没有找到任何记录!</td></tr></table></div></div></section></section>'),e.put("/app/vip/marketing/recommend.add.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><a class="text-href" ui-sref="app.vip.marketing">会员营销</a> <label class="m-l-sm m-r-sm">/</label> <a class="text-href" ui-sref="app.vip.marketingRecommend">每日推荐</a> <label class="m-l-sm m-r-sm">/</label> <span ng-if="!id">添加每日推荐</span> <span ng-if="id">编辑每日推荐</span></div></header><section class="scrollable wrapper"><div class="load" ng-if="loading">数据加载中...</div><div class="panel panel-default wrapper" ng-if="!loading"><form class="form-horizontal m-b" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="form-group m-t"><label class="col-sm-3 control-label must">推荐标题</label><div class="col-sm-9 m-b-sm form-inline"><input type="text" class="form-control m-r-sm" name="Title" ng-model="entity.Name" data-rule-chinesemax="[40, 80]" data-rule-username="true"> <span class="help-block inline">{{entity.Name | chineseLen:2}} / 40</span> <label for="Title" class="help-block error"></label></div></div><div class="form-group m-t"><label class="col-sm-3 control-label must">显示顺序</label><div class="col-sm-9 m-b-sm form-inline"><input type="text" class="form-control" name="Sort" ng-model="entity.Sort" data-rule-min="0" data-rule-max="20" data-rule-integer="true"> <span class="help-inline">请填写0-20的数字，数字越小越靠前</span> <label for="Sort" class="help-block error"></label></div></div><div class="form-group m-t"><label class="col-sm-3 control-label">推荐图标</label><div class="col-sm-4 m-b-sm"><img ng-if="entity.LogoPreview" ng-src="{{entity.LogoPreview}}"><div upload-img-list="" max-count="1" file-url="entity.LogoUrl" max-size-file="1" tip="建议尺寸：200×200"></div></div></div><div class="recommend-ctrl"><vip-related-service-ctrl ng-model="entity" left-class="\'col-sm-3\'" right-class="\'col-sm-6\'"></vip-related-service-ctrl></div><div class="form-group m-t"><label class="col-sm-3 control-label"></label><div class="col-sm-4 m-b-sm"><button class="btn btn-sm btn-primary" btn-loading="saveloading" loading-text="保存中...">保存</button></div></div></form></div></section></section>'),e.put("/app/vip/marketing/recommend.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><a class="text-href" ui-sref="app.vip.marketing">会员营销</a> <label class="m-l-sm m-r-sm">/</label> 每日推荐</div></header><section class="scrollable wrapper"><div class="load" ng-if="loading">数据加载中...</div><div class="panel panel-default wrapper" ng-if="!loading"><div class="m-t"><a class="btn btn-sm btn-info" ui-sref="app.vip.marketingRecommendAdd"><i class="fa fa-plus"></i> 添加每日推荐</a> <button class="btn btn-sm btn-danger" popup-confirm="" popup-placement="left" popup-body="确定删除吗" popup-confirm-callback="delMulti(tableParams.checkboxes.items)" popup-confirm-button="删除" popup-title="删除" popup-if="tableParams.checkboxes.items.length" ng-class="{disabled:!tableParams.checkboxes.items.length}" title="{{tableParams.checkboxes.items.length?\'\':\'请选择操作对象\'}}">删除</button></div><div class="panel panel-default m-t" loading-container="tableParams.settings().$loading"><table ng-table="tableParams" class="table table-striped table-hover m-b-none text-nowrap pos-rlt" checkbox-show="true" checkbox-key="Id"><tr ng-repeat="item in $data"><td data-title="\'推荐名称\'">{{item.Name}}</td><td data-title="\'显示顺序\'">{{item.Sort}}</td><td data-title="\'事件类型\'">{{getName(\'type\' + item.BusinessType)}}</td><td data-title="\'事件行为\'">{{getName(\'subtype\' + item.SubType)}}</td><td data-title="\'操作\'"><a class="text-href m-r" ui-sref="app.vip.marketingRecommendAdd({id: item.Id})">编辑</a> <a class="text-href m-r" popup-confirm="" popup-placement="left" popup-body="确定删除吗" popup-confirm-callback="del(item)" popup-confirm-button="删除" popup-title="删除">删除</a></td></tr><tr ng-if="!tableParams.settings().$loading" class="text-center"><td colspan="11" ng-if="$data.length==0">没有找到任何记录!</td></tr></table></div></div></section></section>'),e.put("/app/vip/marketing/solicitude.add.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><a class="text-href" ui-sref="app.vip.marketing">会员营销</a> <label class="m-l-sm m-r-sm">/</label> <a class="text-href" ui-sref="app.vip.marketingSolicitude">会员关怀</a> <label class="m-l-sm m-r-sm">/</label> <span ng-if="!id">添加会员关怀</span> <span ng-if="id">编辑会员关怀</span></div></header><section class="scrollable wrapper"><div class="load" ng-if="loading">数据加载中...</div><div class="panel panel-default wrapper" ng-if="!loading"><form class="form-horizontal m-b" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="form-group m-t"><label class="col-sm-2 control-label must">节日名称</label><div class="col-sm-10 m-b-sm form-inline"><input type="text" class="form-control" name="Name" ng-model="entity.Name" data-rule-required="true" data-rule-chinesemax="[40, 80]" data-rule-username="true"> <span class="help-inline">最多40个汉字</span> <label for="Name" class="help-block error"></label></div></div><div class="form-group"><label class="col-sm-2 control-label must">节日类型</label><div class="col-sm-10 form-inline"><label class="radio-inline"><input name="Type" type="radio" ng-model="entity.Type" value="0" ng-disabled="entity.Id" data-rule-required="true"> 节日</label> <label class="radio-inline"><input name="Type" type="radio" ng-model="entity.Type" value="1" ng-disabled="entity.Id" data-rule-required="true"> 会员生日</label> <label for="Type" class="help-block error"></label> <label for="Type1" class="help-block error"></label></div></div><div class="form-group m-t"><label class="col-sm-2 control-label must">选择人群</label><div class="col-sm-10 m-b-sm form-inline"><select class="form-control" name="MemberType" ng-model="entity.MemberType" ng-options="item.LevelNo as item.LevelName for item in levels"><option value="">全部</option></select></div></div><div class="form-group"><label class="col-sm-2 control-label must">赠送策略</label><div class="col-sm-10 form-inline"><vip-give-type-ctrl ng-model="entity"></vip-give-type-ctrl></div></div><div class="form-group m-t"><label class="col-sm-2 control-label must">赠送时间</label><div class="col-sm-10 m-b-sm form-inline"><datetimepicker2 ng-if="entity.Type!=1" ng-model="entity.GiveTime" required="true"></datetimepicker2><span ng-if="entity.Type==1">生日前 <input name="GiveBeforeDay" ng-model="entity.GiveBeforeDay" data-rule-required="true" class="form-control" data-rule-integer="true" data-rule-min="0" data-rule-max="30"> 天的<select class="form-control" ng-model="entity.GiveShortTime" ng-options="item for item in shortTimes" data-rule-required="true"></select></span> <label for="GiveBeforeDay" class="help-block error"></label></div></div><div class="form-group"><label class="col-sm-2 control-label">短信通知</label><div class="col-sm-10 form-inline"><label class="checkbox-inline"><input type="checkbox" ng-model="entity.IsNeedMessage" value="1"> 开启</label></div></div><div class="form-group m-t"><label class="col-sm-2 control-label"></label><div class="col-sm-4 m-b-sm"><button class="btn btn-sm btn-primary" btn-loading="saveloading" loading-text="保存中...">保存</button></div></div></form></div></section></section>'),e.put("/app/vip/marketing/solicitude.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><a class="text-href" ui-sref="app.vip.marketing">会员营销</a> <label class="m-l-sm m-r-sm">/</label> 会员关怀</div></header><section class="scrollable wrapper"><div class="load" ng-if="loading">数据加载中...</div><div class="panel panel-default wrapper" ng-if="!loading"><div class="m-t">关怀类型： <button class="btn btn-sm {{QueryType==0? \'btn-info\': \'btn-default\'}} m-r-sm" ng-click="query(0)">全部</button> <button class="btn btn-sm {{QueryType==1? \'btn-info\': \'btn-default\'}} m-r-sm" ng-click="query(1)">节日关怀</button> <button class="btn btn-sm {{QueryType==2? \'btn-info\': \'btn-default\'}} m-r-sm" ng-click="query(2)">生日关怀</button></div><div class="m-t"><a class="btn btn-info btn-sm" ui-sref="app.vip.marketingSolicitudeAdd"><i class="fa fa-plus"></i> 添加会员关怀</a> <button class="btn btn-danger btn-sm" popup-confirm="" popup-placement="left" popup-body="确定删除吗" popup-confirm-callback="delMulti(tableParams.checkboxes.items)" popup-confirm-button="删除" popup-title="删除" popup-if="tableParams.checkboxes.items.length" ng-class="{disabled:!tableParams.checkboxes.items.length}" title="{{tableParams.checkboxes.items.length?\'\':\'请选择操作对象\'}}">删除</button></div><div class="panel panel-default m-t" loading-container="tableParams.settings().$loading"><table ng-table="tableParams" class="table table-striped table-hover m-b-none text-nowrap pos-rlt" checkbox-show="true" checkbox-key="Id"><tr ng-repeat="item in $data"><td data-title="\'节日名称\'">{{item.Name}}</td><td data-title="\'活动类型\'">{{item.Type | solicitudeType}}</td><td data-title="\'目标人群\'">{{getPeopleDesc(item.MemberType)}}</td><td data-title="\'消息发送时间\'"><div ng-if="item.Type == 0">{{item.GiveTime*1000 | date:\'yyyy-MM-dd\'}}</div><div ng-if="item.Type == 1">生日前{{item.GiveBeforeDay}}天的{{item.GiveShortTime}}</div></td><td data-title="\'操作\'"><a class="text-href m-r" ng-if="item.IsClose" ng-click="openSolicitude(item, 0)">开启</a> <a class="text-href m-r" ng-if="!item.IsClose" ng-click="openSolicitude(item, 1)">停止</a> <a class="text-href m-r" ui-sref="app.vip.marketingSolicitudeAdd({id: item.Id})">编辑</a> <a class="text-href m-r" popup-confirm="" popup-placement="left" popup-body="确定删除吗" popup-confirm-callback="del(item)" popup-confirm-button="删除" popup-title="删除">删除</a></td></tr><tr ng-if="!tableParams.settings().$loading" class="text-center"><td colspan="11" ng-if="$data.length==0">没有找到任何记录!</td></tr></table></div></div></section></section>'),e.put("/app/vip/trade/consume.data.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><a class="text-href" ui-sref="app.vip.trade">会员交易</a> <label class="m-l-sm m-r-sm">/</label> 消费统计</div></header><section class="scrollable wrapper"><div class="panel panel-default wrapper"><div class="form-inline m-b">按月份查看<select class="form-control m-l m-r" ng-model="searchParams.year" ng-options="item.val as item.text for item in years" ng-change="query()"></select><select class="form-control m-r" ng-model="searchParams.month" ng-options="item.val as item.text for item in months" ng-change="query()"></select>本月消费金额： {{consumeTotal |currencyFormat}}元</div><highchart ng-if="chartLoaded" id="chart1" style="height: 240px;"></highchart></div></section></section>'),e.put("/app/vip/trade/consume.log.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><a class="text-href" ui-sref="app.vip.trade">会员交易</a> <label class="m-l-sm m-r-sm">/</label> 消费查询</div></header><section class="scrollable wrapper" style="overflow-x: auto"><div class="panel panel-default"><form class="form-horizontal m-b wrapper" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="form-group m-b"><div class="col-sm-4"><div class="row"><label class="col-sm-5 control-label">会员名称</label><div class="col-sm-7"><input class="form-control" ng-model="searchParams.Name"></div></div></div><div class="col-sm-6"><div class="row"><label class="col-sm-3 control-label">消费门店</label><div class="col-sm-9 form-inline"><select class="form-control" ng-model="searchParams.StoreId" style="width: 200px;" ng-options="item.id as item.name for item in stores"><option value="">总店</option></select></div></div></div></div><div class="form-group m-b"><div class="col-sm-4"><div class="row"><label class="col-sm-5 control-label">消费类型</label><div class="col-sm-7"><select class="form-control" ng-model="searchParams.CouponType"><option value=""></option><option value="1">优惠券</option><option value="2">代金券</option></select></div></div></div><div class="col-sm-6"><div class="row"><label class="col-sm-3 control-label">消费日期</label><div class="col-sm-9 form-inline"><icon-date-range-picker ng-model="searchParams.time" init-empty="true"></icon-date-range-picker></div></div></div></div><div class="form-group m-b"><div class="col-sm-4"><div class="row"><label class="col-sm-5 control-label">会员手机号</label><div class="col-sm-7"><input class="form-control" ng-model="searchParams.Phone" data-rule-mobile="true"></div></div></div><div class="col-sm-6"><div class="row"><label class="col-sm-3 control-label">消费金额</label><div class="col-sm-9 form-inline"><input class="form-control" ng-model="searchParams.AmountMin" style="width: 90px" data-rule-number="true" data-rule-ismoney="true" data-rule-min="0.01" data-rule-max="95000"> 至 <input class="form-control" ng-model="searchParams.AmountMax" style="width:90px" data-rule-number="true" data-rule-ismoney="true" data-rule-min="0.01" data-rule-max="95000"></div></div></div></div><div class="border-top"><div class="m-t"><button class="btn btn-sm btn-primary m-r"><i class="fa fa-search"></i> 查询</button></div></div></form><div class="panel panel-default m-t pull-left" style="min-width: 100%" loading-container="tableParams.settings().$loading"><table ng-table="tableParams" class="table table-striped table-hover m-b-none text-nowrap pos-rlt"><tr ng-repeat="item in $data"><td data-title="\'\'" ng-if="!item.isCopy" class="text-center" style="padding-left: 0;padding-right: 0"><div ng-if="item.isMore" class="pointer full-width" ng-click="setMore($data, $index, false)"><i class="fa fa-minus"></i></div><div ng-if="!item.isMore" class="pointer full-width" ng-click="setMore($data, $index, true)"><i class="fa fa-plus"></i></div></td><td data-title="\'会员姓名\'" ng-if="!item.isCopy">{{item.Name}}</td><td data-title="\'手机号\'" ng-if="!item.isCopy">{{item.Phone}}</td><td data-title="\'消费门店\'" ng-if="!item.isCopy">{{item.StoreName || \'总店\'}}</td><td data-title="\'消费总计（元）\'" ng-if="!item.isCopy">{{item.TotalAmout| currencyFormat}}</td><td data-title="\'实收金额（元）\'" ng-if="!item.isCopy">{{item.RealAmount | currencyFormat}}</td><td data-title="\'消费时间\'" ng-if="!item.isCopy">{{item.Time*1000 | date:\'yyyy-MM-dd HH:mm:ss\'}}</td><td data-title="\'使用优惠\'" ng-if="!item.isCopy">{{item.CouponDes}}</td><td data-title="\'操作员\'" ng-if="!item.isCopy">{{item.Operator}}</td><td data-title="\'备注\'" ng-if="!item.isCopy">{{item.Remark}}</td><td data-title="\'操作\'" ng-if="!item.isCopy"><a class="text-href" ng-click="printTicket(item)">打印小票</a></td><td colspan="15" ng-if="item.isCopy"><label class="m-l m-r">支付方式：{{item.Payment}}</label> <label class="m-r">扣除余额：{{item.BlancheAmount}}</label> <label class="m-r">折扣：{{item.LevelName}} {{item.Discount| discount}}折</label> <label class="m-r">优惠sn码：{{item.SNNo || \'暂无\'}}</label> <label class="m-r">消费积分：{{item.UsePoints}}</label> <label class="m-r">当前积分：{{item.NowPoints}}</label></td></tr><tr ng-if="!tableParams.settings().$loading" class="text-center"><td colspan="11" ng-if="$data.length==0">没有找到任何记录!</td></tr></table></div></div></section></section>'),e.put("/app/vip/trade/index.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t">会员交易</div></header><section class="scrollable wrapper"><div class="load" ng-if="parentLoading || loading">数据加载中...</div><div class="panel panel-default wrapper" ng-if="!parentLoading && !loading"><div class="h5 m-b">快捷交易</div><ul class="square-menu"><li><a ng-click="consume()"><i class="wmfont wm-xiaofei"></i><label>消费</label></a></li><li><a ng-click="recharge()"><i class="wmfont wm-chongzhi"></i><label>充值</label></a></li><li><a ng-click="changePoints()"><i class="wmfont wm-xiugaijifen"></i><label>手动修改积分</label></a></li><li><a ng-click="useCoupon()"><i class="wmfont wm-hexiao"></i><label>优惠券核销</label></a></li></ul><div class="h5 m-t m-b">交易统计</div><ul class="square-menu"><li><a ui-sref="app.vip.tradeConsumeData"><i class="wmfont wm-tongji"></i><label>消费统计</label></a></li><li><a ui-sref="app.vip.tradeRechargeData"><i class="wmfont wm-tongji"></i><label>充值统计</label></a></li><li><a ui-sref="app.vip.tradePointData"><i class="wmfont wm-tongji"></i><label>积分统计</label></a></li></ul><div class="h5 m-t m-b">交易明细查询</div><ul class="square-menu"><li><a ui-sref="app.vip.tradeConsumeLog"><i class="wmfont wm-rizhichaxun"></i><label>消费查询</label></a></li><li><a ui-sref="app.vip.tradeRechargeLog"><i class="wmfont wm-rizhichaxun"></i><label>充值查询</label></a></li><li><a ui-sref="app.vip.tradePointLog"><i class="wmfont wm-rizhichaxun"></i><label>积分查询</label></a></li></ul></div></section></section>'),e.put("/app/vip/trade/point.data.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><a class="text-href" ui-sref="app.vip.trade">会员交易</a> <label class="m-l-sm m-r-sm">/</label> 积分统计</div></header><section class="scrollable wrapper"><div class="panel panel-default wrapper"><div class="alert alert-warning"><div><span class="font-bold">发出积分</span> : 该月所有粉丝通过公众账号获得的所有积分总额，无论以什么方式，如：消费，签到，转发等等</div><div class="m-t-sm"><span class="font-bold">收回积分</span> : 该月所有粉丝通过公众账号进行兑换花去的所有积分总额，也是商家该月从用户手中收回的所有积分总额</div></div><div class="form-inline m-b">按月份查看<select class="form-control m-l m-r" ng-model="searchParams.year" ng-options="item.val as item.text for item in years" ng-change="query()"></select><select class="form-control m-r" ng-model="searchParams.month" ng-options="item.val as item.text for item in months" ng-change="query()"></select></div><highchart ng-if="chartLoaded" id="chart1" style="height: 240px;"></highchart></div></section></section>'),e.put("/app/vip/trade/point.log.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><a class="text-href" ui-sref="app.vip.trade">会员交易</a> <label class="m-l-sm m-r-sm">/</label> 积分查询</div></header><section class="scrollable wrapper" style="overflow-x: auto"><div class="panel panel-default"><form class="form-horizontal m-b wrapper" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="form-group m-b"><div class="col-sm-4"><div class="row"><label class="col-sm-5 control-label">会员名称</label><div class="col-sm-7"><input class="form-control" ng-model="searchParams.Name"></div></div></div><div class="col-sm-6"><div class="row"><label class="col-sm-3 control-label">交易时间</label><div class="col-sm-9 form-inline"><icon-date-range-picker ng-model="searchParams.time" init-empty="true"></icon-date-range-picker></div></div></div></div><div class="form-group m-b"><div class="col-sm-4"><div class="row"><label class="col-sm-5 control-label">交易方式</label><div class="col-sm-7"><select class="form-control" ng-model="searchParams.PointsPayType" ng-options="item as item | pointsPayType for item in pointsPayTypes"><option value=""></option></select></div></div></div><div class="col-sm-6"><div class="row"><label class="col-sm-3 control-label">会员手机号</label><div class="col-sm-9 form-inline"><input class="form-control" ng-model="searchParams.Phone" data-rule-mobile="true" style="width: 200px;"></div></div></div></div><div class="border-top"><div class="m-t"><button class="btn btn-sm btn-primary m-r"><i class="fa fa-search"></i> 查询</button></div></div></form><div class="panel panel-default m-t pull-left" style="min-width: 100%" loading-container="tableParams.settings().$loading"><table ng-table="tableParams" class="table table-striped table-hover m-b-none text-nowrap pos-rlt"><tr ng-repeat="item in $data"><td data-title="\'交易名称\'">{{item.Title}}</td><td data-title="\'会员姓名\'">{{item.Name}}</td><td data-title="\'手机号\'">{{item.Phone}}</td><td data-title="\'会员卡号\'">{{item.MemberCardNo}}</td><td data-title="\'积分\'" class="text-right">{{item.AddOrReduce?\'-\':\'+\'}}{{item.Points}}</td><td data-title="\'交易方式\'">{{item.PointsPayType | pointsPayType}}</td><td data-title="\'交易门店\'">{{item.StoreName || \'总店\'}}</td><td data-title="\'交易时间\'">{{item.Time*1000 | date:\'yyyy-MM-dd HH:mm:ss\'}}</td><td data-title="\'操作员\'">{{item.Operator}}</td><td data-title="\'备注\'">{{item.Remark}}</td></tr><tr ng-if="!tableParams.settings().$loading" class="text-center"><td colspan="11" ng-if="$data.length==0">没有找到任何记录!</td></tr></table></div></div></section></section>'),e.put("/app/vip/trade/recharge.data.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><div class="m-t"><a class="text-href" ui-sref="app.vip.trade">会员交易</a> <label class="m-l-sm m-r-sm">/</label> 充值统计</div></div></header><section class="scrollable wrapper"><div class="panel panel-default wrapper"><div class="form-inline m-b">按月份查看<select class="form-control m-l m-r" ng-model="searchParams.year" ng-options="item.val as item.text for item in years" ng-change="query()"></select><select class="form-control m-r" ng-model="searchParams.month" ng-options="item.val as item.text for item in months" ng-change="query()"></select>本月实际充值金额：{{consumeTotal |currencyFormat}}元（不包含营销赠送金额）</div><highchart ng-if="chartLoaded" id="chart1" style="height: 240px;"></highchart></div></section></section>'),e.put("/app/vip/trade/recharge.log.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><div class="m-t"><a class="text-href" ui-sref="app.vip.trade">会员交易</a> <label class="m-l-sm m-r-sm">/</label> 充值查询</div></div></header><section class="scrollable wrapper" style="overflow-x: auto"><div class="panel panel-default"><form class="form-horizontal m-b wrapper" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="form-group m-b"><div class="col-sm-4"><div class="row"><label class="col-sm-5 control-label">会员名称</label><div class="col-sm-7"><input class="form-control" ng-model="searchParams.Name"></div></div></div><div class="col-sm-6"><div class="row"><label class="col-sm-3 control-label">充值门店</label><div class="col-sm-9 form-inline"><select class="form-control" ng-model="searchParams.StoreId" style="width: 200px;" ng-options="item.id as item.name for item in stores"><option value="">总店</option></select></div></div></div></div><div class="form-group m-b"><div class="col-sm-4"><div class="row"><label class="col-sm-5 control-label">会员手机号</label><div class="col-sm-7"><input class="form-control" ng-model="searchParams.Phone" data-rule-mobile="true"></div></div></div><div class="col-sm-6"><div class="row"><label class="col-sm-3 control-label">充值时间</label><div class="col-sm-9 form-inline"><icon-date-range-picker ng-model="searchParams.time" init-empty="true"></icon-date-range-picker></div></div></div></div><div class="form-group m-b"><div class="col-sm-4"><div class="row"><label class="col-sm-5 control-label">操作员</label><div class="col-sm-7"><input class="form-control" ng-model="searchParams.Operator" data-rule-mobile="true"></div></div></div><div class="col-sm-6"><div class="row"><label class="col-sm-3 control-label">充值金额</label><div class="col-sm-9 form-inline"><input class="form-control" ng-model="searchParams.AmountMin" style="width: 90px" data-rule-number="true" data-rule-ismoney="true" data-rule-min="0.01" data-rule-max="95000"> 至 <input class="form-control" ng-model="searchParams.AmountMax" style="width:90px" data-rule-number="true" data-rule-ismoney="true" data-rule-min="0.01" data-rule-max="95000"></div></div></div></div><div class="border-top"><div class="m-t"><button class="btn btn-sm btn-primary m-r"><i class="fa fa-search"></i> 查询</button></div></div></form><div class="panel panel-default m-t pull-left" style="min-width: 100%" loading-container="tableParams.settings().$loading"><table ng-table="tableParams" class="table table-striped table-hover m-b-none text-nowrap pos-rlt"><tr ng-repeat="item in $data"><td data-title="\'会员卡号\'">{{item.MemberCardNo}}</td><td data-title="\'会员姓名\'">{{item.Name}}</td><td data-title="\'手机号\'">{{item.Phone}}</td><td data-title="\'充值金额（元）\'">{{item.Amount| currencyFormat}}</td><td data-title="\'充值时间\'">{{item.Time*1000 | date:\'yyyy-MM-dd HH:mm:ss\'}}</td><td data-title="\'充值门店\'">{{item.StoreName || \'总店\'}}</td><td data-title="\'操作员\'">{{item.Operator}}</td><td data-title="\'备注\'">{{item.Remark}}</td></tr><tr ng-if="!tableParams.settings().$loading" class="text-center"><td colspan="11" ng-if="$data.length==0">没有找到任何记录!</td></tr></table></div></div></section></section>'),e.put("/app/vip/store/add.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t"><a class="text-href" ui-sref="app.vip.storeVip">实体店会员</a> <label class="m-l-sm m-r-sm">/</label> 添加实体店会员</div></header><section class="scrollable wrapper"><div class="panel panel-default wrapper"><form class="form-horizontal vbox m-b" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="form-group"><label class="col-sm-2 control-label must">会员姓名</label><div class="col-sm-10 m-b-sm form-inline"><input class="form-control" ng-model="entity.Name" data-rule-required="true" data-rule-chinesemax="[10,20]" data-rule-username="true"><div class="help-block">最多10个汉字</div></div></div><div class="line line-dashed b-b line-lg pull-in"></div><div class="form-group"><label class="col-sm-2 control-label must">手机</label><div class="col-sm-10 m-b-sm form-inline"><input class="form-control" name="Phone" ng-model="entity.Phone" data-rule-required="true" data-rule-mobile="true"></div></div><div class="line line-dashed b-b line-lg pull-in"></div><div class="form-group"><label class="col-sm-2 control-label">成长值</label><div class="col-sm-10 m-b-sm form-inline"><input class="form-control" ng-model="entity.GrowthValue" name="GrowthValue" data-rule-integer="true" data-rule-min="0" data-rule-max="1000000000"> <span class="help-inline">不填为零，上限10亿</span> <label for="GrowthValue" class="help-block error"></label></div></div><div class="line line-dashed b-b line-lg pull-in"></div><div class="form-group"><label class="col-sm-2 control-label">可用余额</label><div class="col-sm-10 m-b-sm form-inline"><input class="form-control" ng-model="entity.Amount" name="Amount" data-rule-integer="true" data-rule-min="0" data-rule-max="1000000000"> <span class="help-inline">不填为零，上限10亿</span> <label for="Amount" class="help-block error"></label></div></div><div class="line line-dashed b-b line-lg pull-in"></div><div class="form-group"><label class="col-sm-2 control-label">可用积分</label><div class="col-sm-10 m-b-sm form-inline"><input class="form-control" ng-model="entity.Points" name="Points" data-rule-integer="true" data-rule-min="0" data-rule-max="1000000000"> <span class="help-inline">不填为零，上限10亿</span> <label for="Points" class="help-block error"></label></div></div><div class="line line-dashed b-b line-lg pull-in"></div><div class="form-group"><label class="col-sm-2 control-label">累计消费</label><div class="col-sm-10 m-b-sm form-inline"><input class="form-control" ng-model="entity.AllConsumingAmount" name="AllConsumingAmount" data-rule-integer="true" data-rule-min="0" data-rule-max="1000000000"> <span class="help-inline">不填为零，上限10亿</span> <label for="AllConsumingAmount" class="help-block error"></label></div></div><div class="line line-dashed b-b line-lg pull-in"></div><div class="form-group"><label class="col-sm-2 control-label">累计积分</label><div class="col-sm-10 m-b-sm form-inline"><input class="form-control" ng-model="entity.AllPoints" name="AllPoints" data-rule-integer="true" data-rule-min="0" data-rule-max="1000000000"> <span class="help-inline">不填为零，上限10亿</span> <label for="AllPoints" class="help-block error"></label></div></div><div class="line line-dashed b-b line-lg pull-in"></div><div class="form-group"><label class="col-sm-2 control-label">性别</label><div class="col-sm-2 m-b-sm form-inline"><div class="select full-width" dropdown="" dropdown-select="" ng-model="entity.Sex" data-list="sexs"></div></div></div><div class="line line-dashed b-b line-lg pull-in"></div><div class="form-group"><label class="col-sm-2 control-label">生日</label><div class="col-sm-4 m-b-sm form-inline"><datetimepicker2 ng-model="entity.Birthday" is-day="true"></datetimepicker2></div></div><div class="line line-dashed b-b line-lg pull-in"></div><div class="form-group"><label class="col-sm-2 control-label">地址</label><div class="col-sm-10 m-b-sm"><address2 ng-model="address"></address2><input class="form-control m-t" ng-model="entity.Address.Address" name="Address" data-rule-chinesemax="[50, 100]" placeholder="请输入详细地址，请勿重复填写市区信息"></div></div><div class="line line-dashed b-b line-lg pull-in"></div><div class="form-group"><label class="col-sm-2 control-label"></label><div class="col-sm-10"><button class="btn btn-sm btn-primary" btn-loading="saveloading" loading-text="保存中...">保存</button></div></div></form></div></section></section>'),e.put("/app/vip/store/index.html",'<section class="vbox"><header class="header bg-white b-b clearfix"><div class="m-t">实体店会员</div></header><section class="scrollable wrapper"><div class="load" ng-if="parentLoading || loading">数据加载中...</div><div class="panel panel-default wrapper" ng-if="!parentLoading && !loading"><form class="form-horizontal m-b" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="form-inline m-t"><input class="form-control" placeholder="姓名、手机号" ng-model="searchParams.text"> <button class="btn btn-sm btn-default m-r-lg">搜索</button></div></form><div class="m-t"><upload-button button-class="btn btn-sm btn-primary" button-text="导入会员" upload-url="/apiVip/AddOfflineMemberInfoList" upload-finished="uploadFinished(data)" ngf-accept="\'Excel/*,.xls,.xlsx\'"></upload-button><a class="text-href pos-rlt" href="/assets/plus/member_demo.xls" download="会员导入模板.xls" style="top:3px">下载会员导入模板</a> <a class="btn btn-sm btn-info m-l-lg" ui-sref="app.vip.storeVipAdd">添加会员</a> <button class="btn btn-sm btn-danger can-events" popup-confirm="" popup-placement="left" popup-body="确定删除吗" popup-confirm-callback="del(tableParams.checkboxes.items)" popup-confirm-button="删除" popup-title="删除" ng-disabled="!tableParams.checkboxes.items.length" title="{{tableParams.checkboxes.items.length?\'\':\'请选择对象\'}}">删除</button></div><div class="panel panel-default m-t" loading-container="tableParams.settings().$loading"><table ng-table="tableParams" class="table table-striped table-hover m-b-none text-nowrap pos-rlt" checkbox-show="true" checkbox-key="Phone"><tr ng-repeat="item in $data"><td data-title="\'会员姓名\'">{{item.Name}}</td><td data-title="\'手机\'">{{item.Phone}}</td><td data-title="\'绑定状态\'">{{item.Status | storeVipStatus}}</td><td data-title="\'成长值\'">{{item.GrowthValue}}</td><td data-title="\'可用余额\'">{{item.Amount | currencyFormat}}</td><td data-title="\'可用积分\'">{{item.Points}}</td><td data-title="\'累计消费\'">{{item.AllConsumingAmount | currencyFormat}}</td><td data-title="\'性别\'">{{item.Sex | sex}}</td><td data-title="\'生日\'"><span ng-if="item.Birthday">{{item.Birthday*1000 | date:\'yyyy-MM-dd\'}}</span></td><td data-title="\'导入时间\'">{{item.AddTime*1000 | date:\'yyyy-MM-dd HH:mm:ss\'}}</td></tr><tr ng-if="!tableParams.settings().$loading" class="text-center"><td colspan="11" ng-if="$data.length==0">没有找到任何记录!</td></tr></table></div></div></section></section>'),e.put("/app/vip/card/business/addBusiness.dialog.html",'<form class="form-horizontal" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="modal-header"><button type="button" class="close" ng-click="cancel()">&times;</button><h4 class="modal-title">添加业务</h4></div><div class="load" ng-if="loading">数据加载中...</div><div class="modal-body" ng-if="!loading"><div class="panel-body"><div class="form-group"><label class="col-sm-3 control-label must">业务名称</label><div class="col-sm-9"><input type="text" class="form-control" name="name" data-rule-required="true" ng-model="entity.Name" data-rule-maxlength="50"></div></div><div class="form-group"><label class="col-sm-3 control-label must">显示顺序</label><div class="col-sm-9"><input type="text" class="form-control" name="order" data-rule-required="true" ng-model="entity.Sort" data-rule-digits="true"></div></div><div class="form-group"><label class="col-sm-3 control-label must">图标</label><div class="col-sm-9"><div icon-picker="" icon-list="iconList" ng-model="entity.LogoUrl"></div><div class="help-block">该图标用于二级页面右上角的缩略菜单和部分模板的首页主菜单</div></div></div><vip-related-service-ctrl ng-model="entity"></vip-related-service-ctrl></div></div><div class="modal-footer"><button type="submit" class="btn btn-sm btn-primary" btn-loading="saveloading" loading-text="保存中...">确定</button> <button type="button" class="btn btn-sm btn-default" ng-click="cancel()">取消</button></div></form>'),e.put("/app/vip/card/business/business.html",'<ul class="nav nav-tabs nav-white"><li class=""><a ui-sref="app.vip.card.manage">会员卡管理</a></li><li class=""><a ui-sref="app.vip.card.level">等级设置</a></li><li class=""><a ui-sref="app.vip.card.entry">入口设置</a></li><li class=""><a ui-sref="app.vip.card.privilege">特权设置</a></li><li class="active"><a ui-sref="app.vip.card.business">业务关联</a></li><li class=""><a ui-sref="app.vip.card.info">会员卡数据</a></li></ul><div class="load" ng-if="loading">数据加载中...</div><div ng-if="!loading" class="panel panel-default wrapper border-top-none clearfix"><div class="m-b"><button class="btn btn-sm btn-primary m-b" ng-if="tableParams.data.length < 3" ng-click="addBusiness()"><i class="fa fa-plus"></i> 添加业务</button> <label class="help-inline v-middle" ng-if="tableParams.data.length < 3" style="height: 28px;">您最多可以创建3个业务!</label><div class="panel panel-default pull-left" style="min-width: 100%" loading-container="tableParams.settings().$loading"><table ng-table="tableParams" class="table table-striped table-hover m-b-none text-nowrap pos-rlt"><tr ng-repeat="item in $data"><td data-title="\'业务名称\'">{{item.Name}}</td><td data-title="\'显示顺序\'">{{item.Sort}}</td><td data-title="\'事件类型\'">{{getName(\'type\' + item.BusinessType)}}</td><td data-title="\'事件行为\'">{{getName(\'subtype\' + item.SubType)}}</td><td data-title="\'操作员\'"><a class="text-href m-r" ng-click="addBusiness(item)">编辑</a> <a class="text-href m-r" popup-confirm="" popup-placement="left" popup-body="确定删除吗" popup-confirm-callback="delBusiness(item)" popup-confirm-button="删除" popup-title="删除">删除</a></td></tr><tr ng-if="!tableParams.settings().$loading" class="text-center"><td colspan="11" ng-if="$data.length==0">没有找到任何记录!</td></tr></table></div></div></div>'),e.put("/app/vip/card/entry/entry.html",'<ul class="nav nav-tabs nav-white"><li class=""><a ui-sref="app.vip.card.manage">会员卡管理</a></li><li class=""><a ui-sref="app.vip.card.level">等级设置</a></li><li class="active"><a ui-sref="app.vip.card.entry">入口设置</a></li><li class=""><a ui-sref="app.vip.card.privilege">特权设置</a></li><li class=""><a ui-sref="app.vip.card.business">业务关联</a></li><li class=""><a ui-sref="app.vip.card.info">会员卡数据</a></li></ul><div class="load" ng-if="loading">数据加载中...</div><div ng-if="!loading" class="panel panel-default wrapper border-top-none"><form class="form-horizontal vbox" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div><ul class="nav nav-underline" ng-if="urlInfo"><li class=""><div class="h5 m-b-sm">链接及二维码</div></li></ul><div class="form-group m-t" ng-if="urlInfo.CardUrl"><label class="col-sm-2 control-label must">会员卡链接</label><div class="col-sm-10 m-b-sm form-inline"><input class="form-control" readonly="readonly" ng-model="urlInfo.CardUrl" style="width: 380px"> <button class="btn btn-sm btn-default" type="button" zeroclipboard-ctrl="urlInfo.CardUrl">复制链接</button></div></div><div class="form-group" ng-if="urlInfo.CardQrCodeUrl"><label class="col-sm-2 control-label must">二维码</label><div class="col-sm-10 m-b-sm"><img ng-src="{{urlInfo.CardQrCodeUrl}}" width="180"><br><a class="text-href" ng-href="{{urlInfo.CardQrCodeUrl}}" download="shareQrCode" style="position: relative;top: 5px;left: 40px">下载二维码图片</a></div></div><div class="form-group m-t" ng-if="urlInfo.couponListUrl"><label class="col-sm-2 control-label must">发现优惠</label><div class="col-sm-10 m-b-sm form-inline"><input class="form-control" readonly="readonly" ng-model="urlInfo.couponListUrl" style="width: 380px"> <button class="btn btn-sm btn-default" type="button" zeroclipboard-ctrl="urlInfo.couponListUrl">复制链接</button></div></div><div class="form-group m-t" ng-if="urlInfo.signUrl"><label class="col-sm-2 control-label must">签到</label><div class="col-sm-10 m-b-sm form-inline"><input class="form-control" readonly="readonly" ng-model="urlInfo.signUrl" style="width: 380px"> <button class="btn btn-sm btn-default" type="button" zeroclipboard-ctrl="urlInfo.signUrl">复制链接</button></div></div><div class="form-group m-t" ng-if="urlInfo.exchangeUrl"><label class="col-sm-2 control-label must">积分兑换</label><div class="col-sm-10 m-b-sm form-inline"><input class="form-control" readonly="readonly" ng-model="urlInfo.exchangeUrl" style="width: 380px"> <button class="btn btn-sm btn-default" type="button" zeroclipboard-ctrl="urlInfo.exchangeUrl">复制链接</button></div></div><ul class="nav nav-underline"><li class=""><div class="h5 m-b-sm">好友、朋友圈分享</div></li></ul><div class="form-group m-t"><label class="col-sm-2 control-label">分享标题</label><div class="col-sm-9 m-b-sm form-inline"><input type="text" data-rule-chinesemax="[30,60]" class="form-control m-r-sm" name="ShareTitle" ng-model="entity.ShareTitle" data-rule-username="true" style="width: 350px"> <span class="help-block inline">{{entity.ShareTitle | chineseLen:2}} / 30</span></div></div><div class="form-group m-t"><label class="col-sm-2 control-label">分享描述</label><div class="col-sm-9 m-b-sm form-inline"><input type="text" data-rule-chinesemax="[50,100]" class="form-control m-r-sm" name="ShareDescription" ng-model="entity.ShareDescription" style="width: 350px"> <span class="help-block inline">{{entity.ShareDescription | chineseLen:2}} / 50</span></div></div><div class="form-group m-t"><label class="col-sm-2 control-label">分享图标</label><div class="col-sm-4 m-b-sm"><img ng-if="shareLogoUrl" ng-src="{{shareLogoUrl}}"><div upload-img-list="" max-count="1" file-url="entity.ShareLogoUrl" max-size-file="1" tip="建议尺寸：200×200"></div></div></div><div class="form-group m-t"><label class="col-sm-2 control-label"></label><div class="col-sm-4 m-b-sm"><button class="btn btn-sm btn-primary" btn-loading="saveloading" loading-text="保存中...">保存</button></div></div></div></form></div>'),e.put("/app/vip/card/info/info.html",'<ul class="nav nav-tabs nav-white"><li class=""><a ui-sref="app.vip.card.manage">会员卡管理</a></li><li class=""><a ui-sref="app.vip.card.level">等级设置</a></li><li class=""><a ui-sref="app.vip.card.entry">入口设置</a></li><li class=""><a ui-sref="app.vip.card.privilege">特权设置</a></li><li class=""><a ui-sref="app.vip.card.business">业务关联</a></li><li class="active"><a ui-sref="app.vip.card.info">会员卡数据</a></li></ul><div class="load" ng-if="loading">数据加载中...</div><div ng-if="!loading" class="panel panel-default wrapper border-top-none"><div class="form-inline m-b">按月份查看<select class="form-control m-l m-r" ng-model="searchParams.year" ng-options="item.val as item.text for item in years" ng-change="query()"></select><select class="form-control m-r" ng-model="searchParams.month" ng-options="item.val as item.text for item in months" ng-change="query()"></select>本月新增会员数： {{total}}</div><highchart ng-if="chartLoaded" id="chart1" style="height: 240px;"></highchart></div>'),e.put("/app/vip/card/level/level.html",'<ul class="nav nav-tabs nav-white"><li class=""><a ui-sref="app.vip.card.manage">会员卡管理</a></li><li class="active"><a ui-sref="app.vip.card.level">等级设置</a></li><li class=""><a ui-sref="app.vip.card.entry">入口设置</a></li><li class=""><a ui-sref="app.vip.card.privilege">特权设置</a></li><li class=""><a ui-sref="app.vip.card.info">会员卡数据</a></li></ul><div class="load" ng-if="loading">数据加载中...</div><div ng-if="!loading" class="panel panel-default wrapper border-top-none"><form class="form-horizontal vbox" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div><ul class="nav nav-underline"><li class=""><div class="h5 m-b-sm">等级规则</div></li></ul><div class="form-group"><label class="col-sm-2 control-label must">成长值依据</label><div class="col-sm-10 m-b-sm"><label class="radio-inline"><input type="radio" name="LevelType" ng-model="entity.LevelType" value="0" data-rule-required="true"> 累计消费 <span class="m-l help-inline">默认成长值等于该会员的累计消费值，且成长值随着消费的增加而增加</span></label><br><label class="radio-inline"><input type="radio" name="LevelType" ng-model="entity.LevelType" value="1"> 累计积分 <span class="m-l help-inline">默认成长值等于该会员的累计积分值，且成长值随着积分的增加而增加</span></label><br><label for="LevelType" class="help-block error"></label></div></div><div class="line line-dashed b-b line-lg pull-in"></div><div class="form-group"><label class="col-sm-2 control-label must">等级有效期</label><div class="col-sm-10 m-b-sm"><div><label class="radio-inline"><input type="radio" name="LevelClearType" ng-model="entity.LevelClearType" value="0" data-rule-required="true"> 永久有效</label></div><div class="form-inline"><label class="radio-inline"><input type="radio" name="LevelClearType" ng-model="entity.LevelClearType" value="1" data-rule-required="true"> 每个自然年扣除成长值</label></div><label for="LevelClearType" class="help-block error"></label> <label for="LevelClearInput" class="help-block error"></label></div></div><div class="line line-dashed b-b line-lg pull-in"></div><ul class="nav nav-underline"><li class=""><div class="h5 m-b-sm">等级规则</div></li></ul><table class="table m-b-none"><thead><tr><th>等级编号（1/10）</th><th>等级名称</th><th>成长值范围（大于0的整数且等级范围连续）</th><th>折扣率（1-100的整数）</th><th>成长值扣除数量</th></tr></thead><tr ng-repeat="item in entity.ListDetail"><td class="v-middle">{{$index + 1}}</td><td class="v-middle"><input name="LevelName{{$index}}" class="form-control" ng-model="item.LevelName" data-rule-required="true"></td><td class="form-inline text-nowrap v-middle"><label class="text-center v-middle" style="width: 70px; margin:0">{{item.LevelMin || 0}}</label> <label class="v-middle" style="margin:0">&nbsp;&nbsp;-&nbsp;&nbsp;</label> <input ng-if="!$last" name="LevelMax{{$index}}" class="form-control" ng-model="item.LevelMax" style="width: 100px;" data-rule-positiveinteger="true" data-rule-required="true" data-rule-min="{{getMinNum($index)}}" data-rule-max="{{getMaxNum($index)}}" ng-change="calcMin($index)"> <label ng-if="$last" class="text-center v-middle" style="margin:0">无限</label> <label for="LevelMax{{$index}}" class="help-block error" ng-if="!$last" style="position: relative;left: 100px;"></label></td><td class="form-inline text-nowrap v-middle"><input name="Discount{{$index}}" class="form-control" ng-model="item.Discount" data-rule-positiveinteger="true" data-rule-min="1" data-rule-max="100" data-rule-required="true" style="width: 50px;">% <label for="Discount{{$index}}" class="help-block error"></label></td><td class="v-middle"><input ng-if="entity.LevelClearType!=0" name="DeductValue{{$index}}" class="form-control" ng-model="item.DeductValue" data-rule-required="true" data-rule-digits="true"> <label ng-if="entity.LevelClearType==0">等级永久有效</label></td></tr></table><div class="m-l m-t"><button class="btn btn-sm btn-info" type="button" ng-click="addLevel()" ng-if="!entity.ListDetail.length || entity.ListDetail.length<10">添加等级</button> <button class="btn btn-sm btn-danger" type="button" ng-click="delLevel()" ng-if="entity.ListDetail.length>1">删除等级</button><br><button class="btn btn-sm btn-primary m-t" btn-loading="saveloading" loading-text="保存中...">保&nbsp;&nbsp;存</button></div></div></form></div>'),e.put("/app/vip/card/manage/addMemberInfo.dialog.html",'<form class="form-horizontal" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="modal-header"><button type="button" class="close" ng-click="cancel()">&times;</button><h4 class="modal-title"><span ng-if="!isEdit">添加</span><span ng-if="isEdit">编辑</span>自定义信息</h4></div><div class="modal-body" ng-if="!pageLoading"><div class="panel-body"><div class="form-group"><label class="control-label">请输入自定义信息名称</label><div class="m-t-sm form-inline"><input type="text" class="form-control m-r-sm" name="name" data-rule-required="true" ng-model="entity.Name" data-rule-chinesemax="[7,14]" data-rule-username="true"> <span class="help-block inline">{{entity.Name | chineseLen:2}} / 7</span> <label for="name" class="help-block error"></label></div></div><div class="form-group"><label class="checkbox-inline"><input type="checkbox" ng-model="hasValues" value="1"> 预设选项</label><div class="m-t-sm" ng-if="hasValues"><input type="text" class="form-control" ng-model="entity.strValue" data-rule-required="true" placeholder="选项1|选项2|选项3"></div></div></div></div><div class="modal-footer"><button type="submit" class="btn btn-sm btn-primary" btn-loading="saveloading" loading-text="保存中...">确定</button> <button type="button" class="btn btn-sm btn-default" ng-click="cancel()">取消</button></div></form>'),e.put("/app/vip/card/manage/create.html",'<ul class="wizard row panel p-l-0 p-r-0 padder"><li class="col-sm-6 step" ng-class="{\'selected\':curStep===1}"><font>1. 填写会员卡信息</font><label class="angular"></label></li><li class="col-sm-6 step" ng-class="{\'selected\':curStep===2}"><font>2. 会员卡功能设置</font><label class="angular"></label></li></ul><div class="load" ng-if="loading">数据加载中...</div><div class="panel panel-default wrapper" ng-if="!loading" ng-click="showTextColorPicker($event, false)"><form class="form-horizontal vbox" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div ng-if="curStep===1"><ul class="nav nav-underline"><li class=""><div class="h5 m-b-sm">基本信息</div></li></ul><div class="form-group m-t"><label class="col-sm-2 control-label must">会员卡标题</label><div class="col-sm-10 m-b-sm form-inline"><input type="text" data-rule-chinesemax="[9,18]" class="form-control m-r-sm" name="name" data-rule-required="true" ng-required="true" ng-model="entity.Name" data-rule-username="true"> <span class="help-block inline">{{entity.Name | chineseLen:2}} / 9</span> <label for="name" class="help-block error"></label></div></div><div class="form-group"><label class="col-sm-2 control-label">微信会员卡</label><div class="col-sm-10 m-b-sm"><label class="checkbox-inline m-r"><input type="checkbox" name="unseal" ng-model="entity.IsSyncWX" value="true"> 开启支持</label> <label class="help-block inline pos-rlt" style="top: 5px;">仅支持开通卡券功能的认证公众号</label> <label for="unseal" class="help-block error"></label></div></div><div class="form-group"><label class="col-sm-2 control-label must">会员卡颜色</label><div class="col-sm-10 m-b-sm"><div wechat-color-picker="" ng-model="entity.Colour"></div></div></div><div class="form-group"><label class="col-sm-2 control-label must">会员卡背景</label><div class="col-sm-10 m-b-sm form-inline"><div><label class="radio-inline"><input type="radio" name="bk" ng-model="entity.bkType" value="0" data-rule-required="true"> 模板背景</label><select class="form-control" name="BackGroundId" ng-model="entity.BackGroundId" ng-click="entity.bkType=0;" ng-disabled="entity.bkType!=0" ng-options="bk.value as bk.title for bk in bks" data-rule-required="{{entity.bkType==0}}"><option value="">请选择</option></select><div class="m-t" ng-if="entity.bkType==0 && entity.BackGroundId"><img width="300" height="180" style="border-radius: 10px;" ng-src="http://stc.weimob.com/img/web_bb/card/cardbg/card_bg{{entity.BackGroundId}}.png"></div></div><div class="m-t"><label class="radio-inline"><input type="radio" name="bk" ng-model="entity.bkType" value="1" data-rule-required="true"> 自定义背景</label><div ng-if="entity.BackGroundUrl" class="m-t-sm"><img ng-src="{{entity.BackGroundUrl}}" width="300" height="180" style="border-radius: 10px;"></div><div class="m-t-sm" upload-img-list="" max-count="1" file-url="entity.BackGroundUrl" max-size-file="1" tip="图片建议尺寸：500像素 * 300像素，大小不超过1MB"></div></div><label for="bk" class="help-block error"></label></div></div><div class="form-group"><label class="col-sm-2 control-label must">卡面字体颜色</label><div class="col-sm-4 m-b-sm"><div input-color="" ng-model="entity.WordsColour"></div></div></div><div class="form-group"><label class="col-sm-2 control-label must">会员卡号</label><div class="col-sm-10 m-b-sm"><div><label class="radio-inline m-r"><input type="radio" name="cardNum" ng-model="entity.CardNoType" value="0" data-rule-required="true"> 系统自动生成</label> <label class="help-block inline pos-rlt" style="top: 5px;">12位数字卡号</label></div><div class="m-t"><label class="radio-inline"><input type="radio" name="cardNum" ng-model="entity.CardNoType" value="1" data-rule-required="true"> 手机号作为卡号</label></div><div class="m-t form-inline"><label class="radio-inline"><input type="radio" name="cardNum" ng-model="entity.CardNoType" value="2" data-rule-required="true"> 自定义会员卡号（只允许字母和数字组合）</label><div class="m-t-sm" ng-if="entity.CardNoType==2"><input name="CardNoBefore" type="text" class="form-control" ng-model="entity.CardNoBefore" data-rule-required="true" data-rule-maxlength="6" data-rule-lettersnumbers="true"> 自定义前缀 最多6位 <input name="CardNoEnd" type="text" class="form-control m-l" ng-model="entity.CardNoEnd" data-rule-required="true" data-rule-maxlength="3" data-rule-lettersnumbers="true"> 自定义后缀 最多3位</div></div><label for="cardNum" class="help-block error"></label> <label for="CardNoBefore" class="help-block error"></label> <label for="CardNoEnd" class="help-block error"></label></div></div><div class="form-group"><label class="col-sm-2 control-label must">有效期</label><div class="col-sm-10 m-b-sm"><div><label class="radio-inline"><input type="radio" name="ExpireDateType" ng-model="entity.ExpireDateType" value="0" data-rule-required="true"> 永久有效</label></div><div class="m-t form-inline"><label class="radio-inline"><input type="radio" name="ExpireDateType" ng-model="entity.ExpireDateType" value="1" data-rule-required="true"> 指定日期</label><icon-date-range-picker ng-model="entity.enableDate" required="entity.ExpireDateType==1"></icon-date-range-picker></div><div class="m-t form-inline"><label class="radio-inline"><input type="radio" name="ExpireDateType" ng-model="entity.ExpireDateType" value="2" data-rule-required="true" style="margin-top: 10px;"> 固定长度 <label class="m-l">开卡后</label> <span ng-switch="" on="entity.ExpireDateType"><span ng-switch-when="2"><input type="text" class="form-control" name="ExpDayCount" ng-model="entity.ExpDayCount" data-rule-required="true" data-rule-positiveinteger="true"></span> <span ng-switch-default=""><input type="text" class="form-control" readonly="readonly"></span></span> 天有效</label></div><label for="ExpireDateType" class="help-block error"></label> <label for="ExpDayCount" class="help-block error" ng-if="entity.ExpireDateType==2"></label></div></div><div class="form-group"><label class="col-sm-2 control-label must">可用时段</label><div class="col-sm-10 m-b-sm"><div><label class="radio-inline"><input type="radio" name="timeRange" ng-model="entity.CanUseTimeType" value="0" data-rule-required="true"> 全部时段</label></div><div class="m-t"><label class="radio-inline"><input type="radio" name="timeRange" ng-model="entity.CanUseTimeType" value="1" data-rule-required="true"> 部分时段</label><div class="m-t-sm" ng-if="entity.CanUseTimeType==1"><label class="checkbox-inline" ng-repeat="item in canUseTimes"><input type="checkbox" name="CanUseTime" ng-model="item.check" ng-checked="item.check" value="item.val" data-rule-required="true"> {{item.title}}</label></div></div><label for="timeRange" class="help-block error"></label></div></div><ul class="nav nav-underline"><li class=""><div class="h5 m-b-sm">商户介绍</div></li></ul><div class="form-group m-t"><label class="col-sm-2 control-label">商户类型</label><div class="col-sm-10 m-b-sm"><div vip-merchant-ctrl="" ng-model="entity"></div></div></div><div class="form-group m-t"><label class="col-sm-2 control-label must">客服电话</label><div class="col-sm-10 m-b-sm form-inline"><input type="text" class="form-control" name="ServicePhoneNo" ng-model="entity.ServicePhoneNo" data-rule-phone="true" data-rule-required="true"> <span class="help-block">手机或固话，可加区号（如：021-88888888）</span></div></div><div class="form-group"><label class="col-sm-2 control-label">商户服务</label><div class="col-sm-10 m-b-sm"><label class="checkbox-inline" ng-repeat="item in MerchantService"><input type="checkbox" name="service" ng-model="item.check" value="1" ng-checked="item.check"> {{item.title}}</label></div></div><div class="form-group m-t"><label class="col-sm-2 control-label">商户地址</label><div class="col-sm-8 m-b-sm form-inline"><address2 ng-model="entity.Address" data-required="false" data-selected="onSearchMap(data)"></address2><div class="input-group m-t"><input type="text" class="form-control input-sm" placeholder="请输入详细地址，请勿重复填写市区信息" name="addressDetail" ng-model="entity.Address.Address" data-rule-chinesemax="[50,100]" style="width: 500px;"> <span class="input-group-btn"><button class="btn btn-sm btn-sm btn-default" type="button" title="搜索" ng-click="onSearchMap()"><i class="fa fa-search"></i></button></span></div><span class="help-block">注意：这个只是模糊定位，准确位置请地图上标注。 最多50字。</span><div class="m-t" baidu-map="" ng-model="entity.Address" address-changed="onAddressChanged(address)"></div><div class="m-t-sm"><input class="form-control" ng-model="entity.Address.Latitude" readonly="readonly"> <input class="form-control" ng-model="entity.Address.Longitude" readonly="readonly"></div></div></div><ul class="nav nav-underline"><li class=""><div class="h5 m-b-sm">会员卡详情</div></li></ul><div class="form-group m-t"><label class="col-sm-2 control-label must">特权说明</label><div class="col-sm-10 m-b-sm"><textarea type="text" data-rule-chinesemax="[200,400]" class="form-control" name="PrivilegeNote" data-rule-required="true" ng-model="entity.PrivilegeNote" rows="5"></textarea> <span class="help-block">此内容为建议参考,请按实际情况填写。例如：<br>1. 使用会员卡买单专享*折优惠；<br>2. 消费每满*元可享*积分；<br>3. 积分可用作消费抵扣，每*积分可抵*元；</span></div></div><div class="form-group m-t"><label class="col-sm-2 control-label">使用须知</label><div class="col-sm-10 m-b-sm"><textarea type="text" data-rule-chinesemax="[200,400]" class="form-control" name="Instructions" ng-model="entity.Instructions" rows="5"></textarea> <span class="help-block">此内容为建议参考,请按实际情况填写。例如：<br>1. 到店告知会员卡绑定的手机号也可使用，可不出示手机；<br>2. 每笔消费积分抵扣上限为*元；<br>3. 积分有效期为*年,过期清零。<br></span></div></div><div class="form-group m-t"><label class="col-sm-2 control-label must">操作提示</label><div class="col-sm-10 m-b-sm form-inline"><input type="text" data-rule-chinesemax="[16,32]" class="form-control m-r-sm" name="tip" data-rule-required="true" style="width: 250px;" ng-model="entity.Tips" placeholder="如：请付款前出示会员卡"> <span class="help-block inline">{{entity.Tips | chineseLen:2}} / 16</span> <label for="tip" class="help-block error"></label></div></div><div class="form-group m-t"><label class="col-sm-2 control-label"></label><div class="col-sm-4 m-b-sm"><button class="btn btn-sm btn-primary" ng-click="next()">下一步</button></div></div></div><div ng-if="curStep===2"><ul class="nav nav-underline"><li class=""><div class="h5 m-b-sm">激活设置</div></li></ul><div class="form-group"><label class="col-sm-2 control-label must">会员卡资料</label><div class="col-sm-10 m-b-sm"><table class="table"><thead><tr><th>信息名称</th><th>启用</th><th>必填</th><th>可修改</th><th>操作</th></tr></thead><tr ng-repeat="item in entity.MemberInfoTemplate"><td>{{item.Name}}</td><td><label class="i-switch bg-info" title="{{item.Display?\'启用\':\'未启用\'}}" ng-class="{disabled:item.Name ===\'手机号\' || item.Name ===\'姓名\'}"><input type="checkbox" ng-model="item.Display" ng-checked="item.Display" ng-disabled="item.Name ===\'手机号\' || item.Name ===\'姓名\'" ng-change="onChangeDisplay(item)"> <i></i></label></td><td><label class="i-switch bg-info" title="{{item.Must?\'必填\':\'非必填\'}}" ng-class="{disabled:item.Name ===\'手机号\' || item.Name ===\'姓名\'}"><input type="checkbox" ng-model="item.Must" ng-checked="item.Must" ng-disabled="item.Name ===\'手机号\' || item.Name ===\'姓名\'"> <i></i></label></td><td><label class="i-switch bg-info" title="{{item.Modify?\'可修改\':\'不可修改\'}}"><input type="checkbox" ng-model="item.Modify" ng-checked="item.Modify"> <i></i></label></td><td><div ng-if="item.IsCustom"><a class="text-href m-r" ng-click="addMemberInfo(item, $index)">编辑</a> <a class="text-href m-r" ng-click="delMemberInfo(item, $index)">删除</a></div></td></tr></table><div class="m-t" ng-if="canAddMemberInfo()"><a class="text-href" ng-click="addMemberInfo()">+ 添加自定义信息</a></div></div></div><ul class="nav nav-underline"><li class=""><div class="h5 m-b-sm">功能设置</div></li></ul><div class="form-group"><label class="col-sm-2 control-label must">扫码类型</label><div class="col-sm-10 m-b-sm"><label class="radio-inline"><input type="radio" name="CodeType" ng-model="entity.CodeType" value="0" data-rule-required="true"> 卡号和二维码 <img src="http://stc.home.weimob.cn/assets/images/qrCode.png" class="block m-t"></label> <label class="radio-inline"><input type="radio" name="CodeType" ng-model="entity.CodeType" value="1"> 卡号和条形码 <img src="http://stc.home.weimob.cn/assets/images/barCode.png" class="block m-t"></label> <label for="CodeType" class="help-block error"></label></div></div><div class="form-group"><label class="col-sm-2 control-label">充值功能</label><div class="col-sm-10 m-b-sm"><label class="checkbox-inline"><input type="checkbox" name="CanRechargeByPhone" ng-model="entity.CanRechargeByPhone" value="1" ng-checked="entity.CanRechargeByPhone"> 提供客户手机端充值功能</label> <label class="checkbox-inline"><input type="checkbox" name="RechargeSendMessage" ng-model="entity.RechargeSendMessage" ng-checked="entity.RechargeSendMessage" value="1"> 充值短信通知</label></div></div><div class="form-group m-t form-inline"><label class="col-sm-2 control-label">后台充值密码</label><div class="col-sm-10 m-b-sm"><input type="text" data-rule-maxlength="20" class="form-control" name="RechargePassWord" ng-model="entity.RechargePassWord"> <span class="help-block">如不填写，则后台充值时无需密码，如填写，充值时需填写输入密码，不超过20个字符</span></div></div><div class="form-group"><label class="col-sm-2 control-label">消费功能</label><div class="col-sm-10 m-b-sm"><label class="checkbox-inline"><input type="checkbox" name="CanConsumeByPhone" ng-model="entity.CanConsumeByPhone" value="1" ng-checked="entity.CanConsumeByPhone"> 提供客户手机端消费功能</label> <label class="checkbox-inline"><input type="checkbox" name="ConsumeSendMessage" ng-model="entity.ConsumeSendMessage" value="1" ng-checked="entity.ConsumeSendMessage"> 消费短信通知</label></div></div><div class="form-group m-t"><label class="col-sm-2 control-label">后台消费密码</label><div class="col-sm-10 m-b-sm form-inline"><input type="text" data-rule-maxlength="20" class="form-control" name="ConsumePassWord" ng-model="entity.ConsumePassWord" data-rule-username="true"> <span class="help-block">如不填写，则后台消费时无需密码，如填写，手机端确认使用优惠券等输入此密码，不超过20个字符</span></div></div><div class="form-group m-t"><label class="col-sm-2 control-label"></label><div class="col-sm-4 m-b-sm"><button class="btn btn-sm btn-primary" btn-loading="saveloading" loading-text="保存中...">保存</button> <button class="btn btn-sm btn-default" type="button" ng-click="last()" btn-loading="saveloading" loading-text="上一步">上一步</button></div></div></div></form></div>'),e.put("/app/vip/card/manage/inuse.html",'<ul class="nav nav-tabs nav-white"><li class="active"><a>会员卡管理</a></li><li class=""><a ui-sref="app.vip.card.level">等级设置</a></li><li class=""><a ui-sref="app.vip.card.entry">入口设置</a></li><li class=""><a ui-sref="app.vip.card.privilege">特权设置</a></li><li class=""><a ui-sref="app.vip.card.business">业务关联</a></li><li class=""><a ui-sref="app.vip.card.info">会员卡数据</a></li></ul><div class="panel panel-default border-top-none wrapper"><div class="alert alert-info"><div><span class="m-r v-middle">微信会员卡状态</span> <span class="m-r">已通过</span> <a class="btn btn-sm btn-info v-middle" ui-sref="app.vip.card.create({edit:1})">编辑会员卡</a></div><div class="m-t"><span class="m-r v-middle">微信会员卡编号</span> <span>{{entity.WeiChatId}}</span></div></div><div class="m-t m-b"><div vip-card-ctrl="" ng-model="entity"></div></div></div>'),e.put("/app/vip/card/manage/manage.html",'<div class="load" ng-if="loading">数据加载中...</div><div ng-if="!loading"><div ng-if="vipType == 0" ng-include="\'/app/vip/card/manage/uncreate.html\'"></div><div ng-if="vipType == 1" ng-include="\'/app/vip/card/manage/unavailable.html\'"></div><div ng-if="vipType == 2" ng-include="\'/app/vip/card/manage/unused.html\'"></div><div ng-if="vipType == 3" ng-include="\'/app/vip/card/manage/inuse.html\'"></div></div>'),e.put("/app/vip/card/manage/moveMember.dialog.html",'<form class="form-horizontal" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div class="modal-header"><button type="button" class="close" ng-click="cancel()">&times;</button><h4 class="modal-title">系统提示</h4></div><div class="modal-body" ng-if="!pageLoading"><div class="panel-body"><div class="form-group"><label class="control-label">检测到该公众号已使用原会员卡，请确定创建新版会员卡的方式。</label> <label class="m-t-sm" style="color: #e33438">注意：选定后无法更改，全新创建无法将会员信息导入。</label></div></div></div><div class="modal-footer"><button type="button" class="btn btn-sm btn-primary" ng-click="onMove(1)">导入原配置和数据</button> <button type="button" class="btn btn-sm btn-default" ng-click="onMove(2)">全新创建</button></div></form>'),e.put("/app/vip/card/manage/unavailable.html",'<ul class="nav nav-tabs nav-white"><li class="active"><a>会员卡管理</a></li><li class=""><a ui-sref="app.vip.card.level">等级设置</a></li><li class=""><a ui-sref="app.vip.card.entry">入口设置</a></li><li class=""><a ui-sref="app.vip.card.privilege">特权设置</a></li><li class=""><a ui-sref="app.vip.card.business">业务关联</a></li><li class=""><a ui-sref="app.vip.card.info">会员卡数据</a></li></ul><div class="panel panel-default border-top-none wrapper"><div class="alert alert-info"><div><span class="m-r v-middle">公众号暂不可开启微信原生会员卡功能支持</span> <a class="btn btn-sm btn-info v-middle" ui-sref="app.vip.card.create({edit:1})">编辑会员卡</a></div><div class="help-block m-t">微信原生会员卡功能可允许会员将领取到会员卡放入微信卡包并进行使用。 <a class="text-href" href="http://kf.qq.com/faq/120911VrYVrA150930ZjeMNf.html" target="_blank">了解详情</a></div></div><div class="m-t m-b"><div vip-card-ctrl="" ng-model="entity"></div></div></div>'),e.put("/app/vip/card/manage/uncreate.html",'<ul class="nav nav-tabs nav-white"><li class="active"><a>会员卡管理</a></li></ul><div class="panel panel-default border-top-none wrapper"><div class="alert alert-danger"><p class="font-bold">哪些商户暂不适合使用新版会员卡？</p><p>1. 使用了微盟开发平台会员接口的商户； 2. 使用了子门店系统的商户； 3. 使用了微盟旺铺的商户。</p><br><p class="font-bold">暂不适合使用新版会员卡的商户怎么办？</p><p>不必担心，新版会员卡随后也将在微盟开发平台发布对应的会员接口，方便使用原会员接口的商户进行升级。使用了子门店系统的商户， 门店系统也将尽快实现对新版会员卡的支持。而使用了微盟旺铺商户，将会有旺铺专用的会员卡产品发布，敬请期待！</p></div><div class="alert alert-info m-t"><div><span class="m-r v-middle">会员卡功能</span> <span class="m-r v-middle">未创建</span> <a class="btn btn-info v-middle" ng-click="onCreateMemberCard()" btn-loading="isMoving" loading-text="正在同步数据..." ng-disabled="isMoving">创建会员卡</a></div><div class="help-block m-t">注：认证公众号支持微信原生会员卡功能。</div></div><div class="m-t-lg"><div class="h3">产品介绍</div><div class="m-t">通过在微信内植入会员卡，基于全国7亿微信用户，帮助企业建立集品牌推广、会员管理、营销活动、统计报表于一体的微信会员管理平台。清晰记录企业用户的消费行为并进行数据分析；还可根据用户特征进行精细分类，从而实现各种模式的精准营销。</div></div><div class="m-t m-b"><div class="slider-box"><div class="content"><ul ng-style="getSlideStyle()"><li><img src="http://stc.home.weimob.cn/assets/images/vip/1.png"></li><li><img src="http://stc.home.weimob.cn/assets/images/vip/2.png"></li><li><img src="http://stc.home.weimob.cn/assets/images/vip/3.png"></li><li><img src="http://stc.home.weimob.cn/assets/images/vip/4.png"></li><li><img src="http://stc.home.weimob.cn/assets/images/vip/5.png"></li><li><img src="http://stc.home.weimob.cn/assets/images/vip/6.png"></li></ul></div><button class="pre" ng-click="moveSlide(1)"><i class="fa fa-fw fa-angle-left"></i></button> <button class="next" ng-click="moveSlide(-1)"><i class="fa fa-fw fa-angle-right"></i></button></div></div></div>'),e.put("/app/vip/card/manage/unused.html",'<ul class="nav nav-tabs nav-white"><li class="active"><a>会员卡管理</a></li><li class=""><a ui-sref="app.vip.card.level">等级设置</a></li><li class=""><a ui-sref="app.vip.card.entry">入口设置</a></li><li class=""><a ui-sref="app.vip.card.privilege">特权设置</a></li><li class=""><a ui-sref="app.vip.card.business">业务关联</a></li><li class=""><a ui-sref="app.vip.card.info">会员卡数据</a></li></ul><div class="panel panel-default border-top-none wrapper"><div class="alert alert-info"><div><span class="m-r v-middle">认证服务号（卡券功能开启且类目符合要求），可开启原生会员卡</span> <a class="btn btn-sm btn-info v-middle m-r" ng-click="onOpenSync()">尝试开启</a> <a class="btn btn-sm btn-info v-middle" ui-sref="app.vip.card.create({edit:1})">编辑会员卡</a></div><div class="help-block m-t">微信原生会员卡功能可允许会员将领取到会员卡放入微信卡包并进行使用。 <a class="text-href" href="http://kf.qq.com/faq/120911VrYVrA150930ZjeMNf.html" target="_blank">了解详情</a></div></div><div class="m-t m-b"><div vip-card-ctrl="" ng-model="entity"></div></div></div>'),e.put("/app/vip/card/manage/use.html",'<div class="panel panel-default wrapper"><div class="load" ng-if="loading">数据加载中...</div><form ng-if="!loading" class="form-horizontal vbox" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div><ul class="nav nav-underline m-b"><li class=""><div class="h5 m-b-sm">基本信息</div></li></ul><div class="form-group"><label class="col-sm-2 control-label must">会员卡颜色</label><div class="col-sm-10 m-b-sm"><div wechat-color-picker="" ng-model="entity.Colour"></div></div></div><div class="form-group"><label class="col-sm-2 control-label must">有效期</label><div class="col-sm-10 m-b-sm"><div><label class="radio-inline"><input type="radio" name="ExpireDateType" ng-model="entity.ExpireDateType" value="0" data-rule-required="true"> 永久有效</label></div><div class="m-t form-inline"><label class="radio-inline"><input type="radio" name="ExpireDateType" ng-model="entity.ExpireDateType" value="1" data-rule-required="true"> 指定日期</label><icon-date-range-picker ng-model="entity.enableDate" required="entity.ExpireDateType==1"></icon-date-range-picker></div><div class="m-t"><label class="radio-inline"><input type="radio" name="ExpireDateType" ng-model="entity.ExpireDateType" value="2" data-rule-required="true" style="margin-top: 10px;"> 固定长度 <label class="m-l">开卡后</label> <span ng-switch="" on="entity.ExpireDateType"><span ng-switch-when="2"><input type="text" class="form-control" name="ExpDayCount" ng-model="entity.ExpDayCount" data-rule-required="true" data-rule-positiveinteger="true" ng-readonly="isEdit"></span> <span ng-switch-default=""><input type="text" class="form-control" readonly="readonly"></span></span> 天有效</label></div><label for="ExpireDateType" class="help-block error"></label> <label for="ExpDayCount" class="help-block error"></label></div></div><div class="form-group"><label class="col-sm-2 control-label must">可用时段</label><div class="col-sm-10 m-b-sm"><div><label class="radio-inline"><input type="radio" name="timeRange" ng-model="entity.CanUseTimeType" value="0" data-rule-required="true"> 全部时段</label></div><div class="m-t"><label class="radio-inline"><input type="radio" name="timeRange" ng-model="entity.CanUseTimeType" value="1" data-rule-required="true"> 部分时段</label><div class="m-t-sm" ng-if="entity.CanUseTimeType==1"><label class="checkbox-inline" ng-repeat="item in canUseTimes"><input type="checkbox" name="CanUseTime" ng-model="item.check" value="item.val" data-rule-required="true"> {{item.title}}</label></div></div><label for="timeRange" class="help-block error"></label></div></div><div class="form-group"><label class="col-sm-2 control-label must">扫码类型</label><div class="col-sm-10 m-b-sm"><label class="radio-inline"><input type="radio" name="CodeType" ng-model="entity.CodeType" value="0" data-rule-required="true"> 卡号和二维码 <img src="http://stc.home.weimob.cn/assets/images/qrCode.png" class="block m-t"></label> <label class="radio-inline"><input type="radio" name="CodeType" ng-model="entity.CodeType" value="1"> 卡号和条形码 <img src="http://stc.home.weimob.cn/assets/images/barCode.png" class="block m-t"></label> <label for="CodeType" class="help-block error"></label></div></div><div class="form-group m-t"><label class="col-sm-2 control-label"></label><div class="col-sm-4 m-b-sm"><button class="btn btn-primary">确定</button></div></div></div></form></div>'),e.put("/app/vip/card/privilege/addPrivilege.html",'<div class="load" ng-if="loading">数据加载中...</div><div ng-if="!loading" class="panel panel-default wrapper"><form class="form-horizontal vbox" form-validator="" formvalidatorconfig="eventformvalidate" method="post"><div><div class="form-group"><label class="col-sm-2 control-label must">标题</label><div class="col-sm-4 m-b-sm"><input class="form-control" name="Title" ng-model="entity.Title" data-rule-required="true"> <span class="help-block">不超过30个汉字</span> <label for="Title" class="help-block error"></label></div></div><div class="form-group"><label class="col-sm-2 control-label must">选择人群</label><div class="col-sm-10 m-b-sm form-inline"><select class="form-control" ng-model="entity.MemberType" ng-options="item.LevelNo as item.LevelName for item in levels"></select></div></div><div class="form-group"><label class="col-sm-2 control-label must">时间设置</label><div class="col-sm-10 m-b-sm form-inline"><icon-date-range-picker ng-model="time.time" required="true"></icon-date-range-picker></div></div><div class="form-group"><label class="col-sm-2 control-label must">使用说明</label><div class="col-sm-10 m-b-sm"><textarea rows="5" class="form-control" kindeditor="" ng-model="entity.Context" data-config="default"></textarea> <input name="Context" ng-model="entity.Context" data-rule-chinesemax="[5000,10000]" style="width: 0;height: 0;border: none;"></div></div><div class="form-group m-t"><label class="col-sm-2 control-label"></label><div class="col-sm-4 m-b-sm"><button class="btn btn-sm btn-primary" btn-loading="saveloading" loading-text="保存中...">保存</button> <a class="btn btn-sm btn-default" ui-sref="app.vip.card.privilege">取消</a></div></div></div></form></div>'),e.put("/app/vip/card/privilege/privilege.html",'<ul class="nav nav-tabs nav-white"><li class=""><a ui-sref="app.vip.card.manage">会员卡管理</a></li><li class=""><a ui-sref="app.vip.card.level">等级设置</a></li><li class=""><a ui-sref="app.vip.card.entry">入口设置</a></li><li class="active"><a ui-sref="app.vip.card.privilege">特权设置</a></li><li class=""><a ui-sref="app.vip.card.business">业务关联</a></li><li class=""><a ui-sref="app.vip.card.info">会员卡数据</a></li></ul><div class="panel panel-default wrapper border-top-none"><div><a class="btn btn-sm btn-info" type="button" ui-sref="app.vip.card.addPrivilege"><i class="fa fa-plus"></i> 添加特权设置</a></div><div class="panel panel-default m-t" loading-container="tableParams.settings().$loading"><table ng-table="tableParams" class="table table-striped table-hover m-b-none text-nowrap"><tr ng-repeat="item in $data"><td data-title="\'特权标题\'">{{item.Title }}</td><td data-title="\'有效期\'">{{item.StartTime*1000 | date:\'yyyy-MM-dd\'}} - {{item.EndTime*1000 | date:\'yyyy-MM-dd\'}}</td><td data-title="\'特权内容\'"><div class="text-ellipsis" style="max-width: 500px;height: 18px;" ng-bind-html="item.Context"></div></td><td data-title="\'状态\'">{{getState(item)}}</td><td data-title="\'操作\'"><a class="text-href m-r" ui-sref="app.vip.card.addPrivilege({id:item.Id})">编辑</a> <a class="text-href" popup-confirm="" popup-placement="left" popup-body="确定删除该应用" popup-confirm-callback="delPrivilege(item.Id)">删除</a></td></tr><tr ng-if="!tableParams.settings().$loading" class="text-center"><td colspan="11" ng-if="$data.length==0">没有找到任何记录!</td></tr></table></div></div>'),e.put("/app/vip/components/card/card.html",'<div class=""><ul class="nav nav-underline m-b"><li class=""><div class="h4 m-b-sm">基本信息</div></li></ul><div class="row m-b"><div class="col-sm-2 title">会员卡标题</div><div class="col-sm-10">{{entity.Name}}</div></div><ul class="nav nav-underline m-t-lg m-b"><li class=""><div class="h4 m-b-sm">商户介绍</div></li></ul><div class="row m-b"><div class="col-sm-2 title">客服电话</div><div class="col-sm-10">{{entity.ServicePhoneNo}}</div></div><div class="row m-b"><div class="col-sm-2 title">商户服务</div><div class="col-sm-10"><label class="label label-gray m-r" ng-repeat="item in entity.MerchantService">{{item}}</label></div></div><div class="row m-b"><div class="col-sm-2 title">商户地址</div><div class="col-sm-10">{{entity.Address.ProvinceName}} {{entity.Address.CityName}} {{entity.Address.DistrictName}} {{entity.Address.Address}}</div></div><ul class="nav nav-underline m-t-lg m-b"><li class=""><div class="h4 m-b-sm">会员卡详情</div></li></ul><div class="row m-b"><div class="col-sm-2 title">特权介绍</div><div class="col-sm-10">{{entity.PrivilegeNote}}</div></div><div class="row m-b"><div class="col-sm-2 title">使用须知</div><div class="col-sm-10">{{entity.Instructions}}</div></div><div class="row m-b"><div class="col-sm-2 title">操作提示</div><div class="col-sm-10">{{entity.Tips}}</div></div><ul class="nav nav-underline m-t-lg m-b"><li class=""><div class="h4 m-b-sm">激活设置</div></li></ul><div class="row m-b"><div class="col-sm-2 title">会员资料</div><div class="col-sm-10"><table class="table" style="margin-left: -15px;"><thead><tr><th>信息名称</th><th>是否必填</th><th>是否可修改</th></tr></thead><tr ng-repeat="item in entity.MemberInfoTemplate" ng-if="item.Display"><td>{{item.Name}}</td><td>{{item.Must?\'必填\':\'选填\'}}</td><td>{{item.Modify?\'可修改\':\'不可修改\'}}</td></tr></table></div></div><ul class="nav nav-underline m-t-lg m-b"><li class=""><div class="h4 m-b-sm">功能设置</div></li></ul><div class="row m-b"><div class="col-sm-2 title">充值功能</div><div class="col-sm-10"><label ng-if="entity.CanRechargeByPhone" class="label label-gray">手机端支持</label> <label ng-if="entity.RechargeSendMessage" class="label label-gray">短信通知开启</label> <label ng-if="entity.RechargePassWord" class="label label-gray">需要密码</label></div></div><div class="row m-b"><div class="col-sm-2 title">消费功能</div><div class="col-sm-10"><label ng-if="entity.CanConsumeByPhone" class="label label-gray">手机端支持</label> <label ng-if="entity.ConsumeSendMessage" class="label label-gray">短信通知开启</label> <label ng-if="entity.ConsumePassWord" class="label label-gray">需要密码</label></div></div></div>'),e.put("/app/vip/components/giveType/give.type.html",'<div class="form-inline"><label class="radio-inline"><input name="GiveType" type="radio" ng-model="entity.GiveType" value="3" style="margin-top: 10px;" data-rule-required="true"> 送余额 <span ng-switch="" on="entity.GiveType"><span ng-switch-when="3"><input name="GiveValue3" ng-model="entity.GiveValue3" data-rule-required="true" class="form-control m-l" data-rule-ismoney="true" data-rule-max="100000000"></span> <span ng-switch-default=""><input class="form-control m-l" readonly="readonly"></span></span> 元 <label class="help-inline m-l">上限值1亿</label> <label for="GiveValue3" class="help-block error" ng-if="entity.GiveType==3"></label></label><br><label class="radio-inline"><input name="GiveType" type="radio" ng-model="entity.GiveType" value="0" style="margin-top: 10px;"> 送积分 <span ng-switch="" on="entity.GiveType"><span ng-switch-when="0"><input name="GiveValue0" ng-model="entity.GiveValue0" class="form-control m-l" data-rule-positiveinteger="true" data-rule-max="100000000" data-rule-required="true"></span> <span ng-switch-default=""><input class="form-control m-l" readonly="readonly"></span></span> 积分 <label class="help-inline m-l">上限值1亿</label> <label for="GiveValue0" class="help-block error" ng-if="entity.GiveType==0"></label></label><br><label class="radio-inline"><input name="GiveType" type="radio" ng-model="entity.GiveType" value="2" style="margin-top: 10px;"> <span class="v-middle" style="line-height: 30px;">送&nbsp;&nbsp;&nbsp;券</span></label><div style="margin-left: 78px; margin-top: -40px;" ng-switch="" on="entity.GiveType"><div ng-switch-when="2"><div ng-repeat="c in selectCoupons" class="m-t-sm"><select class="form-control m-r-sm" ng-model="c.couponType"><option value="-1">请选择</option><option value="0">优惠券</option><option value="1">代金券</option></select><select name="selectCoupon{{$index}}" class="form-control m-r-sm" ng-model="c.Value" ng-options="item.Id as item.Name for item in coupons[c.couponType]" data-rule-required="true"><option value="">请选择</option></select><a ng-if="!$first" class="text-href" type="button" ng-click="onDelCoupon($index)">删除</a> <label for="selectCoupon{{$index}}" class="help-block error"></label></div></div><div class="m-t-sm" ng-switch-default=""><select class="form-control m-r-sm" disabled="disabled"><option value="-1">请选择</option></select><select class="form-control m-r-sm" disabled="disabled"><option value="">请选择</option></select></div><button class="btn btn-sm btn-info m-t-sm" type="button" ng-click="onAddCoupon()" ng-disabled="entity.GiveType!=2 || selectCoupons.length>2"><i class="fa fa-plus"></i> 增加券</button></div><label for="GiveType" class="help-block error"></label></div>'),e.put("/app/vip/components/label/label.html",'<span class="inline" style="width: 200px;"><div class="panel" ng-class="{\'panel-info\':ngModel.Type==0, \'panel-green\':ngModel.Type==1}"><div class="panel-heading"><label class="text-ellipsis inline" style="max-width: 120px;" title="{{ngModel.Name}}">{{ngModel.Name}}</label> <a class="pull-right m-l-sm" popup-confirm="" popup-placement="left" popup-body="确定删除该标签" popup-confirm-callback="del()"><i class="fa fa-trash-o"></i></a> <a class="pull-right m-l-sm" ng-if="ngModel.Type == 1" ui-sref="app.vip.createLabel({id:ngModel.Id})"><i class="fa fa-edit"></i></a> <a class="pull-right m-l-sm" ng-if="ngModel.Type == 0" ng-click="onCreateLabel()"><i class="fa fa-edit"></i></a></div><div class="panel-body">人数： {{ngModel.MemberCount}} <a class="text-href pull-right m-l" ui-sref="app.vip.manageTagMember({id:ngModel.Id})">查询</a></div></div></span>'),e.put("/app/vip/components/merchant/merchant.html",'<span class="form-inline"><select class="form-control m-r-sm" ng-model="ngModel.MerchantType" ng-change="onSelect(ngModel.MerchantType)" ng-options="item.val as item.title for item in merchants"><option value="">请选择</option></select><select ng-if="childMerchants.length" class="form-control" ng-model="ngModel.MerchantSubType" ng-options="item.val as item.title for item in childMerchants"><option value="">请选择</option></select></span>'),e.put("/app/vip/components/relatedService/related.service.html",'<div class="form-group"><label class="col-sm-3 control-label must">外链类型</label><div class="col-sm-9"><select class="form-control" name="type" data-rule-required="true" ng-model="curService" ng-options="item.name for item in relatedServices" ng-change="onSelectType(curService)"><option value="">请选择</option></select></div></div><div class="form-group" ng-if="curService.type===\'link\'"><label class="col-sm-3 control-label must">页面URL</label><div class="col-sm-9"><input class="form-control" name="link" data-rule-required="true" ng-model="entity.Link" placeholder="必填,必须是正确的URL格式" data-rule-url="true"></div></div><div class="form-group" ng-if="curService.type===\'phone\'"><label class="col-sm-3 control-label must">电话号码</label><div class="col-sm-9"><input class="form-control" name="phone" data-rule-required="true" ng-model="entity.Phone" placeholder="必填,必须是正确的电话" data-rule-phone="true"></div></div><div class="form-group" ng-if="curService.type===\'navigation\'"><label class="col-sm-3 control-label must">经纬度</label><div class="col-sm-9 map"><div ng-if="entity.BusinessType===\'navigation\'" class="m-t"><div class="input-group m-t"><input type="text" class="form-control input-sm" placeholder="请输入详细地址" name="addressDetail" data-rule-required="true" ng-model="entity.AddressObj.Address" data-rule-chinesemax="[50,100]"> <span class="input-group-btn"><button class="btn btn-sm btn-sm btn-default" type="button" title="搜索" ng-click="onSearchMap()"><i class="fa fa-search"></i></button></span></div><span class="help-block">注意：这个只是模糊定位，准确位置请地图上标注。 最多50字。</span><div class="m-t" baidu-map="" ng-model="entity.AddressObj" address-changed="" map-id="mapId"></div></div></div></div><div class="form-group" ng-if="curService.items.length"><label class="col-sm-3 control-label must">{{entity.SubType | serviceTypeDesc}}</label><div class="col-sm-9"><select class="form-control" name="type" ng-model="entity.SubType" data-rule-required="true" ng-options="item.subtype as item.subname for item in curService.items" ng-change="onSelectSubType()"><option value="">请选择</option></select><div ng-if="entity.SubType && (curService.type===\'tw\' || curService.type===\'activity\' || curService.type===\'business\' || curService.type===\'life\')" class="panel panel-default m-t" loading-container="tableParams.settings().$loading" style="overflow: auto"><table ng-table="tableParams" class="table table-striped table-hover m-b-none text-nowrap pos-rlt"><tr ng-repeat="item in $data"><td><input type="radio" name="sid" ng-model="item.checked" value="{{item.sid}}" ng-change="onSelectSid(item.sid)"></td><td data-title="\'活动标题\'">{{item.subname }}</td><td data-title="\'触发关键词\'">{{item.keyword}}</td><td data-title="\'活动时间\'" ng-if="item.start_time">{{item.start_time}} - {{item.end_time}}</td></tr><tr ng-if="!tableParams.settings().$loading" class="text-center"><td colspan="11" ng-if="$data.length==0">没有找到任何记录!</td></tr></table></div></div></div>')
}]);